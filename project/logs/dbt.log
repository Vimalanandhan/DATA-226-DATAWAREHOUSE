[0m01:20:57.673661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a48cf7340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a46bc7760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a46bc7730>]}


============================== 01:20:57.685037 | 766c0158-4164-4f3e-98ab-1d2cc6d87e5f ==============================
[0m01:20:57.685037 [info ] [MainThread]: Running with dbt=1.7.1
[0m01:20:57.687498 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:20:59.855071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '766c0158-4164-4f3e-98ab-1d2cc6d87e5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99edfb4ee0>]}
[0m01:20:59.993913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '766c0158-4164-4f3e-98ab-1d2cc6d87e5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a46c00c10>]}
[0m01:21:00.000827 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m01:21:00.020185 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m01:21:00.044591 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:21:00.045822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '766c0158-4164-4f3e-98ab-1d2cc6d87e5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ede56df0>]}
[0m01:21:01.519712 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.stock_analytics.marts
- models.stock_analytics.staging
- models.stock_analytics
[0m01:21:01.528360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '766c0158-4164-4f3e-98ab-1d2cc6d87e5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99edc52370>]}
[0m01:21:01.778413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '766c0158-4164-4f3e-98ab-1d2cc6d87e5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99edc20f40>]}
[0m01:21:01.793358 [info ] [MainThread]: Found 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m01:21:01.794813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '766c0158-4164-4f3e-98ab-1d2cc6d87e5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99edf65070>]}
[0m01:21:01.796680 [info ] [MainThread]: 
[0m01:21:01.797961 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m01:21:01.799962 [debug] [MainThread]: Command end result
[0m01:21:01.851748 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.3028493, "process_user_time": 7.443861, "process_kernel_time": 5.360389, "process_mem_max_rss": "201648", "process_in_blocks": "56568", "process_out_blocks": "1648"}
[0m01:21:01.853364 [debug] [MainThread]: Command `dbt run` succeeded at 01:21:01.853077 after 4.30 seconds
[0m01:21:01.854445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a48cf7340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99edcc7730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99edf655b0>]}
[0m01:21:01.855588 [debug] [MainThread]: Flushing usage events
[0m01:21:08.309262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86f74b8b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86f531cbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86f531c3a0>]}


============================== 01:21:08.318620 | f294daba-ed10-4405-8c86-11800dc069d1 ==============================
[0m01:21:08.318620 [info ] [MainThread]: Running with dbt=1.7.1
[0m01:21:08.320665 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:21:09.729135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f294daba-ed10-4405-8c86-11800dc069d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86f6c322b0>]}
[0m01:21:09.847882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f294daba-ed10-4405-8c86-11800dc069d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f869c7c3f70>]}
[0m01:21:09.935008 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m01:21:09.953200 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m01:21:10.139899 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:21:10.162311 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:21:10.164258 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.stock_analytics.marts
- models.stock_analytics.staging
- models.stock_analytics
[0m01:21:10.173709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f294daba-ed10-4405-8c86-11800dc069d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f869c42dca0>]}
[0m01:21:10.306572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f294daba-ed10-4405-8c86-11800dc069d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f869c51a070>]}
[0m01:21:10.307850 [info ] [MainThread]: Found 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m01:21:10.313025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f294daba-ed10-4405-8c86-11800dc069d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f869c51a250>]}
[0m01:21:10.316709 [info ] [MainThread]: 
[0m01:21:10.320014 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m01:21:10.321934 [debug] [MainThread]: Command end result
[0m01:21:10.396863 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.1192517, "process_user_time": 5.834357, "process_kernel_time": 2.68808, "process_mem_max_rss": "200472", "process_in_blocks": "5856", "process_out_blocks": "0"}
[0m01:21:10.399141 [debug] [MainThread]: Command `dbt test` succeeded at 01:21:10.398807 after 2.12 seconds
[0m01:21:10.402000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86f74b8b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f869c631ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f869c7c3f70>]}
[0m01:21:10.403287 [debug] [MainThread]: Flushing usage events
[0m01:21:15.416336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcabe4f82e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcabc39eb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcabc39e310>]}


============================== 01:21:15.424864 | 1a665d6f-9678-4d4a-b7cf-451555c503da ==============================
[0m01:21:15.424864 [info ] [MainThread]: Running with dbt=1.7.1
[0m01:21:15.437103 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m01:21:16.595429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a665d6f-9678-4d4a-b7cf-451555c503da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcabc39e310>]}
[0m01:21:16.722012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a665d6f-9678-4d4a-b7cf-451555c503da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca5f6e5d60>]}
[0m01:21:16.744807 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m01:21:16.798086 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m01:21:16.940715 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:21:16.941644 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:21:16.942605 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.stock_analytics.staging
- models.stock_analytics
- models.stock_analytics.marts
[0m01:21:16.948048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a665d6f-9678-4d4a-b7cf-451555c503da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca5f442c10>]}
[0m01:21:17.064900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a665d6f-9678-4d4a-b7cf-451555c503da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca5f4aaf10>]}
[0m01:21:17.066844 [info ] [MainThread]: Found 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m01:21:17.067969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a665d6f-9678-4d4a-b7cf-451555c503da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca5f52b0d0>]}
[0m01:21:17.069229 [info ] [MainThread]: 
[0m01:21:17.075895 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m01:21:17.077657 [debug] [MainThread]: Command end result
[0m01:21:17.135011 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 1.8441712, "process_user_time": 4.996536, "process_kernel_time": 2.774756, "process_mem_max_rss": "201680", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:21:17.137300 [debug] [MainThread]: Command `dbt snapshot` succeeded at 01:21:17.136859 after 1.85 seconds
[0m01:21:17.138445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcabe4f82e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca5f767cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca5f7670a0>]}
[0m01:21:17.139434 [debug] [MainThread]: Flushing usage events
[0m01:36:53.422692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa25ef7b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa23dc7c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa23dc7700>]}


============================== 01:36:53.431889 | cc7d5ae1-6684-4ca5-8a7e-1df472db195f ==============================
[0m01:36:53.431889 [info ] [MainThread]: Running with dbt=1.7.1
[0m01:36:53.433380 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m01:36:54.854499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc7d5ae1-6684-4ca5-8a7e-1df472db195f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa257b1b20>]}
[0m01:36:54.962046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cc7d5ae1-6684-4ca5-8a7e-1df472db195f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9c7215850>]}
[0m01:36:54.966383 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m01:36:54.987952 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m01:36:55.515358 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 4 files added, 0 files changed.
[0m01:36:55.517624 [debug] [MainThread]: Partial parsing: added file: stock_analytics://models/stock_indicators.sql
[0m01:36:55.519099 [debug] [MainThread]: Partial parsing: added file: stock_analytics://models/stock_trend.sql
[0m01:36:55.520687 [debug] [MainThread]: Partial parsing: added file: stock_analytics://models/stock_rsi.sql
[0m01:36:55.536700 [debug] [MainThread]: Partial parsing: added file: stock_analytics://models/schema.yml
[0m01:36:55.875636 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.stock_analytics.stock_indicators' (models/stock_indicators.sql) depends on a node named 'stock_input' which was not found
[0m01:36:55.877744 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.5450408, "process_user_time": 5.931458, "process_kernel_time": 3.111255, "process_mem_max_rss": "259832", "process_in_blocks": "30488", "process_out_blocks": "1648", "command_success": false}
[0m01:36:55.879230 [debug] [MainThread]: Command `dbt run` failed at 01:36:55.879040 after 2.55 seconds
[0m01:36:55.880540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa25ef7b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9c40f9280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9c4164580>]}
[0m01:36:55.881876 [debug] [MainThread]: Flushing usage events
[0m02:46:49.833774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91c71b7bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91c507ac40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91c507a700>]}


============================== 02:46:49.841063 | 47370017-eb8b-47c4-8615-e55e3b2b790e ==============================
[0m02:46:49.841063 [info ] [MainThread]: Running with dbt=1.7.1
[0m02:46:49.842007 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:46:52.420829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '47370017-eb8b-47c4-8615-e55e3b2b790e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91c507a8e0>]}
[0m02:46:52.500589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '47370017-eb8b-47c4-8615-e55e3b2b790e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f916c3b1e20>]}
[0m02:46:52.504267 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m02:46:52.533639 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m02:46:53.207239 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 0 files changed.
[0m02:46:53.208297 [debug] [MainThread]: Partial parsing: added file: stock_analytics://models/stock_indicators.sql
[0m02:46:53.209379 [debug] [MainThread]: Partial parsing: added file: stock_analytics://models/stock_rsi.sql
[0m02:46:53.210531 [debug] [MainThread]: Partial parsing: added file: stock_analytics://models/stock_trend.sql
[0m02:46:53.211757 [debug] [MainThread]: Partial parsing: added file: stock_analytics://models/sources.yml
[0m02:46:53.213020 [debug] [MainThread]: Partial parsing: added file: stock_analytics://models/schema.yml
[0m02:46:53.541050 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.stock_analytics.staging
- models.stock_analytics.marts
[0m02:46:53.553217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '47370017-eb8b-47c4-8615-e55e3b2b790e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9123d6fc10>]}
[0m02:46:53.658846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '47370017-eb8b-47c4-8615-e55e3b2b790e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f916c178e20>]}
[0m02:46:53.660184 [info ] [MainThread]: Found 3 models, 2 tests, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m02:46:53.661192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47370017-eb8b-47c4-8615-e55e3b2b790e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f916c178cd0>]}
[0m02:46:53.665283 [info ] [MainThread]: 
[0m02:46:53.668306 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:46:53.670522 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MACKEREL'
[0m02:46:53.706076 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MACKEREL"
[0m02:46:53.707807 [debug] [ThreadPool]: On list_USER_DB_MACKEREL: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_MACKEREL"} */
show terse schemas in database USER_DB_MACKEREL
    limit 10000
[0m02:46:53.709790 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:46:54.980585 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m02:46:54.982991 [debug] [ThreadPool]: On list_USER_DB_MACKEREL: Close
[0m02:46:55.124597 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MACKEREL, now list_USER_DB_MACKEREL_RAW)
[0m02:46:55.145155 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MACKEREL_RAW"
[0m02:46:55.146685 [debug] [ThreadPool]: On list_USER_DB_MACKEREL_RAW: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_MACKEREL_RAW"} */
show terse objects in USER_DB_MACKEREL.RAW limit 10000
[0m02:46:55.147832 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:46:55.689667 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m02:46:55.695305 [debug] [ThreadPool]: On list_USER_DB_MACKEREL_RAW: Close
[0m02:46:55.870252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47370017-eb8b-47c4-8615-e55e3b2b790e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f916c415040>]}
[0m02:46:55.880897 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:46:55.882362 [info ] [MainThread]: 
[0m02:46:55.902657 [debug] [Thread-1  ]: Began running node model.stock_analytics.stock_rsi
[0m02:46:55.903359 [debug] [Thread-2  ]: Began running node model.stock_analytics.stock_trend
[0m02:46:55.904759 [info ] [Thread-1  ]: 1 of 3 START sql table model RAW.stock_rsi ..................................... [RUN]
[0m02:46:55.906742 [info ] [Thread-2  ]: 2 of 3 START sql table model RAW.stock_trend ................................... [RUN]
[0m02:46:55.908587 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_USER_DB_MACKEREL_RAW, now model.stock_analytics.stock_rsi)
[0m02:46:55.911076 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.stock_analytics.stock_trend'
[0m02:46:55.914576 [debug] [Thread-1  ]: Began compiling node model.stock_analytics.stock_rsi
[0m02:46:55.915601 [debug] [Thread-2  ]: Began compiling node model.stock_analytics.stock_trend
[0m02:46:55.942864 [debug] [Thread-2  ]: Writing injected SQL for node "model.stock_analytics.stock_trend"
[0m02:46:55.945067 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analytics.stock_rsi"
[0m02:46:56.002832 [debug] [Thread-2  ]: Timing info for model.stock_analytics.stock_trend (compile): 02:46:55.928656 => 02:46:56.001877
[0m02:46:56.006540 [debug] [Thread-2  ]: Began executing node model.stock_analytics.stock_trend
[0m02:46:56.018354 [debug] [Thread-1  ]: Timing info for model.stock_analytics.stock_rsi (compile): 02:46:55.916805 => 02:46:56.017764
[0m02:46:56.027891 [debug] [Thread-1  ]: Began executing node model.stock_analytics.stock_rsi
[0m02:46:56.060652 [debug] [Thread-2  ]: Writing runtime sql for node "model.stock_analytics.stock_trend"
[0m02:46:56.079330 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analytics.stock_rsi"
[0m02:46:56.114490 [debug] [Thread-2  ]: Using snowflake connection "model.stock_analytics.stock_trend"
[0m02:46:56.116994 [debug] [Thread-2  ]: On model.stock_analytics.stock_trend: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.stock_trend"} */
create or replace transient table USER_DB_MACKEREL.RAW.stock_trend
         as
        (WITH moving_averages AS (
    SELECT 
        symbol_date_key,
        symbol,
        close,
        AVG(close) OVER (PARTITION BY symbol ORDER BY symbol_date_key ROWS BETWEEN 4 PRECEDING AND CURRENT ROW) as ma_5,
        AVG(close) OVER (PARTITION BY symbol ORDER BY symbol_date_key ROWS BETWEEN 19 PRECEDING AND CURRENT ROW) as ma_20
    FROM USER_DB_MACKEREL.RAW.stock_input
)
SELECT 
    symbol_date_key,
    symbol,
    close,
    ma_5,
    ma_20,
    CASE 
        WHEN ma_5 > ma_20 THEN 'uptrend'
        WHEN ma_5 < ma_20 THEN 'downtrend'
        ELSE 'sideways'
    END as trend
FROM moving_averages
WHERE ma_5 IS NOT NULL AND ma_20 IS NOT NULL
        );
[0m02:46:56.119208 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m02:46:56.125590 [debug] [Thread-1  ]: Using snowflake connection "model.stock_analytics.stock_rsi"
[0m02:46:56.126820 [debug] [Thread-1  ]: On model.stock_analytics.stock_rsi: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.stock_rsi"} */
create or replace transient table USER_DB_MACKEREL.RAW.stock_rsi
         as
        (WITH price_change AS (
    SELECT 
        symbol_date_key,
        symbol,
        close,
        close - LAG(close) OVER (PARTITION BY symbol ORDER BY symbol_date_key) as price_diff
    FROM USER_DB_MACKEREL.RAW.stock_input
),
gain_loss AS (
    SELECT 
        symbol_date_key,
        symbol,
        close,
        CASE WHEN price_diff > 0 THEN price_diff ELSE 0 END as gain,
        CASE WHEN price_diff < 0 THEN ABS(price_diff) ELSE 0 END as loss
    FROM price_change
),
avg_gain_loss AS (
    SELECT 
        symbol_date_key,
        symbol,
        close,
        AVG(gain) OVER (PARTITION BY symbol ORDER BY symbol_date_key ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) as avg_gain,
        AVG(loss) OVER (PARTITION BY symbol ORDER BY symbol_date_key ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) as avg_loss
    FROM gain_loss
)
SELECT 
    symbol_date_key,
    symbol,
    close,
    avg_gain,
    avg_loss,
    CASE 
        WHEN avg_loss = 0 THEN 100
        ELSE 100 - (100 / (1 + (avg_gain / avg_loss)))
    END as rsi
FROM avg_gain_loss
WHERE avg_gain IS NOT NULL AND avg_loss IS NOT NULL
        );
[0m02:46:56.128124 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:46:56.552659 [debug] [Thread-2  ]: Snowflake adapter: Snowflake query id: 01bbd406-0304-fe9b-0004-59ff0023c9a2
[0m02:46:56.554307 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01bbd406-0304-fcae-0004-59ff0023d0b6
[0m02:46:56.555275 [debug] [Thread-2  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'USER_DB_MACKEREL.RAW.STOCK_INPUT' does not exist or not authorized.
[0m02:46:56.557617 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'USER_DB_MACKEREL.RAW.STOCK_INPUT' does not exist or not authorized.
[0m02:46:56.560239 [debug] [Thread-2  ]: Timing info for model.stock_analytics.stock_trend (execute): 02:46:56.008582 => 02:46:56.559708
[0m02:46:56.562234 [debug] [Thread-1  ]: Timing info for model.stock_analytics.stock_rsi (execute): 02:46:56.051181 => 02:46:56.561781
[0m02:46:56.564539 [debug] [Thread-2  ]: On model.stock_analytics.stock_trend: Close
[0m02:46:56.566637 [debug] [Thread-1  ]: On model.stock_analytics.stock_rsi: Close
[0m02:46:56.710322 [debug] [Thread-1  ]: Database Error in model stock_rsi (models/stock_rsi.sql)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_MACKEREL.RAW.STOCK_INPUT' does not exist or not authorized.
  compiled Code at target/run/stock_analytics/models/stock_rsi.sql
[0m02:46:56.713921 [debug] [Thread-2  ]: Database Error in model stock_trend (models/stock_trend.sql)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_MACKEREL.RAW.STOCK_INPUT' does not exist or not authorized.
  compiled Code at target/run/stock_analytics/models/stock_trend.sql
[0m02:46:56.715227 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47370017-eb8b-47c4-8615-e55e3b2b790e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9123412730>]}
[0m02:46:56.717151 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47370017-eb8b-47c4-8615-e55e3b2b790e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f912343cf10>]}
[0m02:46:56.720225 [error] [Thread-1  ]: 1 of 3 ERROR creating sql table model RAW.stock_rsi ............................ [[31mERROR[0m in 0.81s]
[0m02:46:56.723559 [error] [Thread-2  ]: 2 of 3 ERROR creating sql table model RAW.stock_trend .......................... [[31mERROR[0m in 0.81s]
[0m02:46:56.725210 [debug] [Thread-1  ]: Finished running node model.stock_analytics.stock_rsi
[0m02:46:56.726416 [debug] [Thread-2  ]: Finished running node model.stock_analytics.stock_trend
[0m02:46:56.729201 [debug] [Thread-4  ]: Began running node model.stock_analytics.stock_indicators
[0m02:46:56.730480 [info ] [Thread-4  ]: 3 of 3 SKIP relation RAW.stock_indicators ...................................... [[33mSKIP[0m]
[0m02:46:56.732869 [debug] [Thread-4  ]: Finished running node model.stock_analytics.stock_indicators
[0m02:46:56.740855 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:46:56.743049 [debug] [MainThread]: Connection 'model.stock_analytics.stock_rsi' was properly closed.
[0m02:46:56.744890 [debug] [MainThread]: Connection 'model.stock_analytics.stock_trend' was properly closed.
[0m02:46:56.746979 [info ] [MainThread]: 
[0m02:46:56.749142 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 3.08 seconds (3.08s).
[0m02:46:56.752788 [debug] [MainThread]: Command end result
[0m02:46:56.832212 [info ] [MainThread]: 
[0m02:46:56.834338 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m02:46:56.835768 [info ] [MainThread]: 
[0m02:46:56.837716 [error] [MainThread]:   Database Error in model stock_rsi (models/stock_rsi.sql)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_MACKEREL.RAW.STOCK_INPUT' does not exist or not authorized.
  compiled Code at target/run/stock_analytics/models/stock_rsi.sql
[0m02:46:56.838864 [info ] [MainThread]: 
[0m02:46:56.840424 [error] [MainThread]:   Database Error in model stock_trend (models/stock_trend.sql)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_MACKEREL.RAW.STOCK_INPUT' does not exist or not authorized.
  compiled Code at target/run/stock_analytics/models/stock_trend.sql
[0m02:46:56.841458 [info ] [MainThread]: 
[0m02:46:56.843268 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=1 TOTAL=3
[0m02:46:56.846349 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 7.1176314, "process_user_time": 5.967078, "process_kernel_time": 3.961081, "process_mem_max_rss": "260184", "process_in_blocks": "115416", "process_out_blocks": "4072", "command_success": false}
[0m02:46:56.847589 [debug] [MainThread]: Command `dbt run` failed at 02:46:56.847435 after 7.12 seconds
[0m02:46:56.848931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91c71b7bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f916c2db400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9123d6ffd0>]}
[0m02:46:56.850929 [debug] [MainThread]: Flushing usage events
[0m00:11:14.860051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB8C163450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB8C18D3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB8C18CD90>]}


============================== 00:11:14.868998 | 0af0213c-831a-4f63-af7a-722ad071f6a2 ==============================
[0m00:11:14.868998 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:11:14.872351 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:11:15.231752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0af0213c-831a-4f63-af7a-722ad071f6a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB8C2291D0>]}
[0m00:11:15.291934 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m00:11:15.296903 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m00:11:15.302536 [debug] [MainThread]: Command `dbt deps` succeeded at 00:11:15.301980 after 0.70 seconds
[0m00:11:15.303687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB8C14AC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB8C1D7B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB8C1D79D0>]}
[0m00:11:15.305958 [debug] [MainThread]: Flushing usage events
[0m00:11:15.721693 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:13:36.589142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A22F562710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A22F562250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A22F562F10>]}


============================== 00:13:36.595940 | f1546be4-9dee-4229-94b7-c6abd7226a79 ==============================
[0m00:13:36.595940 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:13:36.598096 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:13:36.614092 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_HOST'
[0m00:13:36.617024 [debug] [MainThread]: Command `dbt snapshot` failed at 00:13:36.616478 after 0.19 seconds
[0m00:13:36.618122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A22F54AAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A22F5B4C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A229782AD0>]}
[0m00:13:36.619195 [debug] [MainThread]: Flushing usage events
[0m00:13:37.145257 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:16:35.490771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DEB262DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DEB262950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DEB263690>]}


============================== 00:16:35.505295 | bdcb8eb0-3d7d-4148-9fb5-e2f793a5d047 ==============================
[0m00:16:35.505295 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:16:35.507294 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:16:35.525654 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_HOST'
[0m00:16:35.529558 [debug] [MainThread]: Command `dbt snapshot` failed at 00:16:35.528982 after 0.31 seconds
[0m00:16:35.530863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DEB2D7B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DEB07D890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DEB24AF10>]}
[0m00:16:35.532124 [debug] [MainThread]: Flushing usage events
[0m00:16:36.070382 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:17:06.249675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202B1A63410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202B1A8E050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202B1A62F90>]}


============================== 00:17:06.255878 | 46f21543-2b58-400e-b27b-6e3f8800a8f1 ==============================
[0m00:17:06.255878 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:17:06.261882 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:17:06.314397 [info ] [MainThread]: dbt version: 1.9.4
[0m00:17:06.316820 [info ] [MainThread]: python version: 3.11.9
[0m00:17:06.318886 [info ] [MainThread]: python path: C:\Users\vimal\Desktop\Github\sjsu-data226-SP25\dbt_venv_new\Scripts\python.exe
[0m00:17:06.320573 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m00:17:06.333312 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_HOST'
[0m00:17:06.336674 [debug] [MainThread]: Command `dbt debug` failed at 00:17:06.336674 after 0.34 seconds
[0m00:17:06.337790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202B1A4AC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202B1ABB810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202B1AB9950>]}
[0m00:17:06.338894 [debug] [MainThread]: Flushing usage events
[0m00:17:06.758555 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:05:02.132710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B783A9790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B7AEF6870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B7AEF7EC0>]}


============================== 00:05:02.140375 | 03378b45-5d07-4445-a3ec-d727923dc500 ==============================
[0m00:05:02.140375 [info ] [MainThread]: Running with dbt=1.8.2
[0m00:05:02.140375 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt', 'log_path': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:05:02.140375 [info ] [MainThread]: dbt version: 1.8.2
[0m00:05:02.158013 [info ] [MainThread]: python version: 3.12.3
[0m00:05:02.158013 [info ] [MainThread]: python path: C:\Users\vimal\Desktop\Github\sjsu-data226-SP25\dbt\.venv\Scripts\python.exe
[0m00:05:02.158013 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m00:05:02.407739 [info ] [MainThread]: Using profiles dir at C:\Users\vimal\Desktop\Github\sjsu-data226-SP25\dbt
[0m00:05:02.407739 [info ] [MainThread]: Using profiles.yml file at C:\Users\vimal\Desktop\Github\sjsu-data226-SP25\dbt\profiles.yml
[0m00:05:02.407739 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\vimal\Desktop\Github\sjsu-data226-SP25\dbt\dbt_project.yml
[0m00:05:02.416109 [info ] [MainThread]: adapter type: snowflake
[0m00:05:02.416109 [info ] [MainThread]: adapter version: 1.8.2
[0m00:05:02.490529 [info ] [MainThread]: Configuration:
[0m00:05:02.497897 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m00:05:02.497897 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:05:02.497897 [info ] [MainThread]: Required dependencies:
[0m00:05:02.497897 [debug] [MainThread]: Executing "git --help"
[0m00:05:02.556164 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:05:02.556164 [debug] [MainThread]: STDERR: "b''"
[0m00:05:02.556164 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m00:05:02.556164 [info ] [MainThread]: Connection:
[0m00:05:02.556164 [info ] [MainThread]:   account: SFEDU02-KSB65579
[0m00:05:02.564455 [info ] [MainThread]:   user: FALCON
[0m00:05:02.564455 [info ] [MainThread]:   database: USER_DB_FALCON
[0m00:05:02.564455 [info ] [MainThread]:   warehouse: FALCON_QUERY_WH
[0m00:05:02.564455 [info ] [MainThread]:   role: TRAINING_ROLE
[0m00:05:02.564455 [info ] [MainThread]:   schema: RAW
[0m00:05:02.564455 [info ] [MainThread]:   authenticator: None
[0m00:05:02.564455 [info ] [MainThread]:   oauth_client_id: None
[0m00:05:02.564455 [info ] [MainThread]:   query_tag: None
[0m00:05:02.564455 [info ] [MainThread]:   client_session_keep_alive: False
[0m00:05:02.572978 [info ] [MainThread]:   host: None
[0m00:05:02.574155 [info ] [MainThread]:   port: None
[0m00:05:02.574155 [info ] [MainThread]:   proxy_host: None
[0m00:05:02.576693 [info ] [MainThread]:   proxy_port: None
[0m00:05:02.578172 [info ] [MainThread]:   protocol: None
[0m00:05:02.578172 [info ] [MainThread]:   connect_retries: 1
[0m00:05:02.578172 [info ] [MainThread]:   connect_timeout: None
[0m00:05:02.581229 [info ] [MainThread]:   retry_on_database_errors: False
[0m00:05:02.581229 [info ] [MainThread]:   retry_all: False
[0m00:05:02.583818 [info ] [MainThread]:   insecure_mode: False
[0m00:05:02.584559 [info ] [MainThread]:   reuse_connections: None
[0m00:05:02.585586 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m00:05:02.773931 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m00:05:02.773931 [debug] [MainThread]: Using snowflake connection "debug"
[0m00:05:02.773931 [debug] [MainThread]: On debug: select 1 as id
[0m00:05:02.773931 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:05:03.742152 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.963 seconds
[0m00:05:03.744830 [debug] [MainThread]: On debug: Close
[0m00:05:03.871145 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m00:05:03.871145 [info ] [MainThread]: [32mAll checks passed![0m
[0m00:05:03.875031 [debug] [MainThread]: Command `dbt debug` succeeded at 00:05:03.875031 after 1.95 seconds
[0m00:05:03.875471 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m00:05:03.875471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B783A9790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B7AF3F3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B7AF3CA70>]}
[0m00:05:03.875471 [debug] [MainThread]: Flushing usage events
[0m00:09:18.896213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001827CED5520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001827CED4470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001827CED51C0>]}


============================== 00:09:18.904713 | 2ad0eaed-ec09-44df-aee2-8a08031090da ==============================
[0m00:09:18.904713 [info ] [MainThread]: Running with dbt=1.8.2
[0m00:09:18.906836 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select staging', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:09:19.513089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ad0eaed-ec09-44df-aee2-8a08031090da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001827EACC0E0>]}
[0m00:09:19.560910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ad0eaed-ec09-44df-aee2-8a08031090da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001827EF44CE0>]}
[0m00:09:19.561952 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m00:09:19.783107 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m00:09:19.848728 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m00:09:19.850458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2ad0eaed-ec09-44df-aee2-8a08031090da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001827F2BA990>]}
[0m00:09:20.634582 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:09:20.634582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2ad0eaed-ec09-44df-aee2-8a08031090da', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001827F1E3C20>]}
[0m00:09:20.782208 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.customer_churn.stg_address' (models\staging\stg_address.sql) depends on a source named 'raw.ADDRESS_STAGING' which was not found
[0m00:09:20.784672 [debug] [MainThread]: Command `dbt run` failed at 00:09:20.783608 after 2.23 seconds
[0m00:09:20.784672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001827CDA7C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001827F3D2D80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001827F41F890>]}
[0m00:09:20.784672 [debug] [MainThread]: Flushing usage events
[0m00:10:05.868954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216C10DE720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216C3BBACF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216C4347DD0>]}


============================== 00:10:05.884693 | 9c347c28-a7df-4af3-975f-7edbbe869a4a ==============================
[0m00:10:05.884693 [info ] [MainThread]: Running with dbt=1.8.2
[0m00:10:05.884693 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select staging', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:10:06.315749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c347c28-a7df-4af3-975f-7edbbe869a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216C44C45C0>]}
[0m00:10:06.357844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c347c28-a7df-4af3-975f-7edbbe869a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216C4093050>]}
[0m00:10:06.363908 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m00:10:06.622812 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m00:10:06.678900 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m00:10:06.678900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9c347c28-a7df-4af3-975f-7edbbe869a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216C68DA780>]}
[0m00:10:07.611060 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:10:07.626336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9c347c28-a7df-4af3-975f-7edbbe869a4a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216C68019D0>]}
[0m00:10:07.754358 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.customer_churn.stg_address' (models\staging\stg_address.sql) depends on a source named 'raw.ADDRESS_STAGING' which was not found
[0m00:10:07.754358 [debug] [MainThread]: Command `dbt run` failed at 00:10:07.754358 after 2.18 seconds
[0m00:10:07.754358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216C44EBEF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216C696AAB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216C65F2D80>]}
[0m00:10:07.754358 [debug] [MainThread]: Flushing usage events
[0m00:11:29.518464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E281CA2A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E28154A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E28156B40>]}


============================== 00:11:29.522502 | 6a6a90d5-7822-4c58-958c-1b27771b25be ==============================
[0m00:11:29.522502 [info ] [MainThread]: Running with dbt=1.8.2
[0m00:11:29.523516 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select staging', 'send_anonymous_usage_stats': 'True'}
[0m00:11:29.989238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a6a90d5-7822-4c58-958c-1b27771b25be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E2A199FD0>]}
[0m00:11:30.042315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6a6a90d5-7822-4c58-958c-1b27771b25be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E2A667620>]}
[0m00:11:30.042315 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m00:11:30.293685 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m00:11:30.363341 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m00:11:30.364019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6a6a90d5-7822-4c58-958c-1b27771b25be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E2AA52150>]}
[0m00:11:31.038118 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:11:31.043085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6a6a90d5-7822-4c58-958c-1b27771b25be', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E2ABEA270>]}
[0m00:11:31.164191 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.customer_churn.stock_indicators' (models\stock_indicators.sql) depends on a source named 'stock_data.stock_input' which was not found
[0m00:11:31.164191 [debug] [MainThread]: Command `dbt run` failed at 00:11:31.164191 after 1.92 seconds
[0m00:11:31.164191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E27D94CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E2A6AAD80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E2A975220>]}
[0m00:11:31.164191 [debug] [MainThread]: Flushing usage events
[0m00:17:48.790996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EA3A895B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EA65F3410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EA5722C60>]}


============================== 00:17:48.796632 | 63a05ea0-4b24-4dc4-98af-e1917af80897 ==============================
[0m00:17:48.796632 [info ] [MainThread]: Running with dbt=1.8.2
[0m00:17:48.797669 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select staging', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:17:49.247041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63a05ea0-4b24-4dc4-98af-e1917af80897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EA8437BF0>]}
[0m00:17:49.289898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '63a05ea0-4b24-4dc4-98af-e1917af80897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EA8816840>]}
[0m00:17:49.289898 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m00:17:49.472460 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m00:17:49.565417 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m00:17:49.565417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '63a05ea0-4b24-4dc4-98af-e1917af80897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EA8BB6CC0>]}
[0m00:17:50.421822 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:17:50.421822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '63a05ea0-4b24-4dc4-98af-e1917af80897', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EA8BB6DE0>]}
[0m00:17:50.431033 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stock_indicators' in the 'models' section of file 'models\schema.yml'
[0m00:17:50.432901 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stock_input' in the 'models' section of file 'models\schema.yml'
[0m00:17:50.619882 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.customer_churn.unique_stock_indicators_symbol_date_key.0073da1eba' (models\schema.yml) depends on a node named 'stock_indicators' in package '' which was not found
[0m00:17:50.621889 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.customer_churn.not_null_stock_indicators_symbol_date_key.99c1f3f22c' (models\schema.yml) depends on a node named 'stock_indicators' in package '' which was not found
[0m00:17:50.621889 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.customer_churn.not_null_stock_input_symbol_date_key.e2a84c6e48' (models\schema.yml) depends on a node named 'stock_input' in package '' which was not found
[0m00:17:50.697167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63a05ea0-4b24-4dc4-98af-e1917af80897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EA8E0CA10>]}
[0m00:17:50.780653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '63a05ea0-4b24-4dc4-98af-e1917af80897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EA8E38B30>]}
[0m00:17:50.782384 [info ] [MainThread]: Found 11 models, 7 sources, 459 macros
[0m00:17:50.782733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63a05ea0-4b24-4dc4-98af-e1917af80897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EA8F57F80>]}
[0m00:17:50.785073 [info ] [MainThread]: 
[0m00:17:50.785073 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:17:50.794354 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON'
[0m00:17:50.814007 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON"
[0m00:17:50.814007 [debug] [ThreadPool]: On list_USER_DB_FALCON: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON"} */
show terse schemas in database USER_DB_FALCON
    limit 10000
[0m00:17:50.814007 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:17:51.458155 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.654 seconds
[0m00:17:51.474237 [debug] [ThreadPool]: On list_USER_DB_FALCON: Close
[0m00:17:52.143479 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON, now create_USER_DB_FALCON_RAW_public)
[0m00:17:52.146878 [debug] [ThreadPool]: Creating schema "database: "USER_DB_FALCON"
schema: "RAW_public"
"
[0m00:17:52.155326 [debug] [ThreadPool]: Using snowflake connection "create_USER_DB_FALCON_RAW_public"
[0m00:17:52.155326 [debug] [ThreadPool]: On create_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "create_USER_DB_FALCON_RAW_public"} */
create schema if not exists USER_DB_FALCON.RAW_public
[0m00:17:52.155326 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:17:52.672556 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.513 seconds
[0m00:17:52.674568 [debug] [ThreadPool]: On create_USER_DB_FALCON_RAW_public: Close
[0m00:17:52.822442 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON_RAW_public'
[0m00:17:52.835977 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m00:17:52.835977 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show objects in USER_DB_FALCON.RAW_public limit 10000
[0m00:17:52.837989 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:17:54.053910 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.221 seconds
[0m00:17:54.053910 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m00:17:54.386984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63a05ea0-4b24-4dc4-98af-e1917af80897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EA9021A00>]}
[0m00:17:54.386984 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:17:54.386984 [info ] [MainThread]: 
[0m00:17:54.400024 [debug] [Thread-1 (]: Began running node model.customer_churn.stg_address
[0m00:17:54.400024 [debug] [Thread-2 (]: Began running node model.customer_churn.stg_autoinsurance_churn
[0m00:17:54.406925 [debug] [Thread-3 (]: Began running node model.customer_churn.stg_customer
[0m00:17:54.400024 [info ] [Thread-1 (]: 1 of 6 START sql view model RAW_public.stg_address ............................. [RUN]
[0m00:17:54.406925 [debug] [Thread-4 (]: Began running node model.customer_churn.stg_demographic
[0m00:17:54.406925 [info ] [Thread-2 (]: 2 of 6 START sql view model RAW_public.stg_autoinsurance_churn ................. [RUN]
[0m00:17:54.406925 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.customer_churn.stg_address'
[0m00:17:54.406925 [info ] [Thread-3 (]: 3 of 6 START sql view model RAW_public.stg_customer ............................ [RUN]
[0m00:17:54.413925 [info ] [Thread-4 (]: 4 of 6 START sql view model RAW_public.stg_demographic ......................... [RUN]
[0m00:17:54.414868 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.customer_churn.stg_autoinsurance_churn'
[0m00:17:54.414868 [debug] [Thread-1 (]: Began compiling node model.customer_churn.stg_address
[0m00:17:54.414868 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.customer_churn.stg_customer'
[0m00:17:54.414868 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.customer_churn.stg_demographic'
[0m00:17:54.414868 [debug] [Thread-2 (]: Began compiling node model.customer_churn.stg_autoinsurance_churn
[0m00:17:54.433160 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.stg_address"
[0m00:17:54.433160 [debug] [Thread-3 (]: Began compiling node model.customer_churn.stg_customer
[0m00:17:54.439783 [debug] [Thread-4 (]: Began compiling node model.customer_churn.stg_demographic
[0m00:17:54.439783 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer_churn.stg_autoinsurance_churn"
[0m00:17:54.450113 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.stg_customer"
[0m00:17:54.453360 [debug] [Thread-4 (]: Writing injected SQL for node "model.customer_churn.stg_demographic"
[0m00:17:54.453360 [debug] [Thread-3 (]: Began executing node model.customer_churn.stg_customer
[0m00:17:54.453360 [debug] [Thread-1 (]: Began executing node model.customer_churn.stg_address
[0m00:17:54.453360 [debug] [Thread-4 (]: Began executing node model.customer_churn.stg_demographic
[0m00:17:54.481568 [debug] [Thread-2 (]: Began executing node model.customer_churn.stg_autoinsurance_churn
[0m00:17:54.513015 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.stg_address"
[0m00:17:54.501299 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.stg_customer"
[0m00:17:54.513015 [debug] [Thread-4 (]: Writing runtime sql for node "model.customer_churn.stg_demographic"
[0m00:17:54.517032 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer_churn.stg_autoinsurance_churn"
[0m00:17:54.521340 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.stg_customer"
[0m00:17:54.521340 [debug] [Thread-3 (]: On model.customer_churn.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_customer"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_customer
  
   as (
    -- models/staging/stg_customer.sql

select
  individual_id,
  address_id,
  curr_ann_amt   as annual_premium,
  days_tenure,
  cust_orig_date
from USER_DB_FALCON.RAW.CUSTOMER_STAGING;
[0m00:17:54.521340 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:17:54.521340 [debug] [Thread-2 (]: Using snowflake connection "model.customer_churn.stg_autoinsurance_churn"
[0m00:17:54.521340 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.stg_address"
[0m00:17:54.521340 [debug] [Thread-2 (]: On model.customer_churn.stg_autoinsurance_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_autoinsurance_churn"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_autoinsurance_churn
  
   as (
    -- models/staging/stg_autoinsurance_churn.sql

select
  individual_id,
  churn_flag  -- 1=churn, 0=keep
from USER_DB_FALCON.RAW.AUTOINSURANCE_CHURN_STAGING;
[0m00:17:54.521340 [debug] [Thread-4 (]: Using snowflake connection "model.customer_churn.stg_demographic"
[0m00:17:54.521340 [debug] [Thread-1 (]: On model.customer_churn.stg_address: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_address"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_address
  
   as (
    -- models/staging/stg_address.sql

select
  address_id,
  street_address,
  city,
  state,
  county,
  latitude::float as lat,
  longitude::float as lon
from USER_DB_FALCON.RAW.ADDRESS_STAGING;
[0m00:17:54.521340 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:17:54.521340 [debug] [Thread-4 (]: On model.customer_churn.stg_demographic: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_demographic"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_demographic
  
   as (
    -- models/staging/stg_demographic.sql

select
  individual_id,
  age_in_years,
  date_of_birth,
  has_children,
  marital_status,
  home_owner,
  home_market_value,
  length_of_residence,
  college_degree
from USER_DB_FALCON.RAW.DEMOGRAPHIC_STAGING;
[0m00:17:54.530021 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:17:54.530021 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:17:54.939971 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01bc1e35-0305-21c8-0004-59ff00399f5e
[0m00:17:54.939971 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01bc1e35-0305-212a-0004-59ff003a3702
[0m00:17:54.939971 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 12 at position 40 unexpected ';'.
[0m00:17:54.939971 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 16 at position 43 unexpected ';'.
[0m00:17:54.939971 [debug] [Thread-3 (]: On model.customer_churn.stg_customer: Close
[0m00:17:54.948054 [debug] [Thread-4 (]: On model.customer_churn.stg_demographic: Close
[0m00:17:54.995763 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01bc1e35-0305-2374-0004-59ff0039dd16
[0m00:17:54.995763 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 9 at position 51 unexpected ';'.
[0m00:17:54.997775 [debug] [Thread-2 (]: On model.customer_churn.stg_autoinsurance_churn: Close
[0m00:17:55.090194 [debug] [Thread-3 (]: Database Error in model stg_customer (models\staging\stg_customer.sql)
  001003 (42000): SQL compilation error:
  syntax error line 12 at position 40 unexpected ';'.
  compiled code at target\run\customer_churn\models\staging\stg_customer.sql
[0m00:17:55.092468 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63a05ea0-4b24-4dc4-98af-e1917af80897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EA5E27920>]}
[0m00:17:55.094209 [error] [Thread-3 (]: 3 of 6 ERROR creating sql view model RAW_public.stg_customer ................... [[31mERROR[0m in 0.68s]
[0m00:17:55.094209 [debug] [Thread-3 (]: Finished running node model.customer_churn.stg_customer
[0m00:17:55.094209 [debug] [Thread-3 (]: Began running node model.customer_churn.stg_termination
[0m00:17:55.094209 [info ] [Thread-3 (]: 5 of 6 START sql view model RAW_public.stg_termination ......................... [RUN]
[0m00:17:55.097429 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer_churn.stg_customer, now model.customer_churn.stg_termination)
[0m00:17:55.097429 [debug] [Thread-3 (]: Began compiling node model.customer_churn.stg_termination
[0m00:17:55.101834 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.stg_termination"
[0m00:17:55.101834 [debug] [Thread-3 (]: Began executing node model.customer_churn.stg_termination
[0m00:17:55.104789 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.stg_termination"
[0m00:17:55.104789 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.stg_termination"
[0m00:17:55.104789 [debug] [Thread-3 (]: On model.customer_churn.stg_termination: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_termination"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_termination
  
   as (
    -- models/staging/stg_termination.sql

select
  individual_id,
  acct_suspd_date  as churn_date
from USER_DB_FALCON.RAW.TERMINATION_STAGING;
[0m00:17:55.109859 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:17:55.117316 [debug] [Thread-4 (]: Database Error in model stg_demographic (models\staging\stg_demographic.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 43 unexpected ';'.
  compiled code at target\run\customer_churn\models\staging\stg_demographic.sql
[0m00:17:55.118327 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63a05ea0-4b24-4dc4-98af-e1917af80897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EA9076210>]}
[0m00:17:55.119662 [error] [Thread-4 (]: 4 of 6 ERROR creating sql view model RAW_public.stg_demographic ................ [[31mERROR[0m in 0.70s]
[0m00:17:55.120290 [debug] [Thread-4 (]: Finished running node model.customer_churn.stg_demographic
[0m00:17:55.121492 [debug] [Thread-4 (]: Began running node model.customer_churn.stg_turning_movement
[0m00:17:55.121492 [info ] [Thread-4 (]: 6 of 6 START sql view model RAW_public.stg_turning_movement .................... [RUN]
[0m00:17:55.121492 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.customer_churn.stg_demographic, now model.customer_churn.stg_turning_movement)
[0m00:17:55.121492 [debug] [Thread-4 (]: Began compiling node model.customer_churn.stg_turning_movement
[0m00:17:55.127344 [debug] [Thread-4 (]: Writing injected SQL for node "model.customer_churn.stg_turning_movement"
[0m00:17:55.129199 [debug] [Thread-4 (]: Began executing node model.customer_churn.stg_turning_movement
[0m00:17:55.130705 [debug] [Thread-4 (]: Writing runtime sql for node "model.customer_churn.stg_turning_movement"
[0m00:17:55.130705 [debug] [Thread-4 (]: Using snowflake connection "model.customer_churn.stg_turning_movement"
[0m00:17:55.130705 [debug] [Thread-4 (]: On model.customer_churn.stg_turning_movement: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_turning_movement"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_turning_movement
  
   as (
    -- models/staging/stg_turning_movement.sql

select
  objectid,
  facilityid,
  intid,
  intname,
  nodeno,
  longitude::float as tm_lon,
  latitude::float  as tm_lat
from USER_DB_FALCON.RAW.TURNING_MOVEMENT;
[0m00:17:55.130705 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:17:55.295029 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bc1e35-0305-20d4-0004-59ff0039ccf2
[0m00:17:55.295029 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 14 at position 39 unexpected ';'.
[0m00:17:55.295029 [debug] [Thread-1 (]: On model.customer_churn.stg_address: Close
[0m00:17:55.455773 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01bc1e35-0305-212a-0004-59ff003a3706
[0m00:17:55.459577 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 9 at position 43 unexpected ';'.
[0m00:17:55.459577 [debug] [Thread-3 (]: On model.customer_churn.stg_termination: Close
[0m00:17:55.515773 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01bc1e35-0305-21c8-0004-59ff00399f62
[0m00:17:55.515773 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 14 at position 40 unexpected ';'.
[0m00:17:55.515773 [debug] [Thread-4 (]: On model.customer_churn.stg_turning_movement: Close
[0m00:17:55.589282 [debug] [Thread-3 (]: Database Error in model stg_termination (models\staging\stg_termination.sql)
  001003 (42000): SQL compilation error:
  syntax error line 9 at position 43 unexpected ';'.
  compiled code at target\run\customer_churn\models\staging\stg_termination.sql
[0m00:17:55.591308 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63a05ea0-4b24-4dc4-98af-e1917af80897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EA9074B30>]}
[0m00:17:55.591308 [error] [Thread-3 (]: 5 of 6 ERROR creating sql view model RAW_public.stg_termination ................ [[31mERROR[0m in 0.49s]
[0m00:17:55.591308 [debug] [Thread-3 (]: Finished running node model.customer_churn.stg_termination
[0m00:17:55.664268 [debug] [Thread-2 (]: Database Error in model stg_autoinsurance_churn (models\staging\stg_autoinsurance_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 9 at position 51 unexpected ';'.
  compiled code at target\run\customer_churn\models\staging\stg_autoinsurance_churn.sql
[0m00:17:55.665781 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63a05ea0-4b24-4dc4-98af-e1917af80897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EA8EB5250>]}
[0m00:17:55.666853 [error] [Thread-2 (]: 2 of 6 ERROR creating sql view model RAW_public.stg_autoinsurance_churn ........ [[31mERROR[0m in 1.25s]
[0m00:17:55.668459 [debug] [Thread-2 (]: Finished running node model.customer_churn.stg_autoinsurance_churn
[0m00:17:55.670819 [debug] [Thread-4 (]: Database Error in model stg_turning_movement (models\staging\stg_turning_movement.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 40 unexpected ';'.
  compiled code at target\run\customer_churn\models\staging\stg_turning_movement.sql
[0m00:17:55.671356 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63a05ea0-4b24-4dc4-98af-e1917af80897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EA8EB5250>]}
[0m00:17:55.672110 [error] [Thread-4 (]: 6 of 6 ERROR creating sql view model RAW_public.stg_turning_movement ........... [[31mERROR[0m in 0.55s]
[0m00:17:55.672679 [debug] [Thread-4 (]: Finished running node model.customer_churn.stg_turning_movement
[0m00:17:55.699376 [debug] [Thread-1 (]: Database Error in model stg_address (models\staging\stg_address.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 39 unexpected ';'.
  compiled code at target\run\customer_churn\models\staging\stg_address.sql
[0m00:17:55.703178 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63a05ea0-4b24-4dc4-98af-e1917af80897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EA1F98E30>]}
[0m00:17:55.703178 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model RAW_public.stg_address .................... [[31mERROR[0m in 1.30s]
[0m00:17:55.704768 [debug] [Thread-1 (]: Finished running node model.customer_churn.stg_address
[0m00:17:55.704768 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:17:55.704768 [debug] [MainThread]: Connection 'create_USER_DB_FALCON_RAW_public' was properly closed.
[0m00:17:55.704768 [debug] [MainThread]: Connection 'list_USER_DB_FALCON_RAW_public' was properly closed.
[0m00:17:55.704768 [debug] [MainThread]: Connection 'model.customer_churn.stg_address' was properly closed.
[0m00:17:55.704768 [debug] [MainThread]: Connection 'model.customer_churn.stg_autoinsurance_churn' was properly closed.
[0m00:17:55.704768 [debug] [MainThread]: Connection 'model.customer_churn.stg_termination' was properly closed.
[0m00:17:55.704768 [debug] [MainThread]: Connection 'model.customer_churn.stg_turning_movement' was properly closed.
[0m00:17:55.704768 [info ] [MainThread]: 
[0m00:17:55.704768 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 4.92 seconds (4.92s).
[0m00:17:55.704768 [debug] [MainThread]: Command end result
[0m00:17:55.733279 [info ] [MainThread]: 
[0m00:17:55.734562 [info ] [MainThread]: [31mCompleted with 6 errors and 0 warnings:[0m
[0m00:17:55.734562 [info ] [MainThread]: 
[0m00:17:55.734562 [error] [MainThread]:   Database Error in model stg_customer (models\staging\stg_customer.sql)
  001003 (42000): SQL compilation error:
  syntax error line 12 at position 40 unexpected ';'.
  compiled code at target\run\customer_churn\models\staging\stg_customer.sql
[0m00:17:55.736402 [info ] [MainThread]: 
[0m00:17:55.736402 [error] [MainThread]:   Database Error in model stg_demographic (models\staging\stg_demographic.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 43 unexpected ';'.
  compiled code at target\run\customer_churn\models\staging\stg_demographic.sql
[0m00:17:55.736402 [info ] [MainThread]: 
[0m00:17:55.736402 [error] [MainThread]:   Database Error in model stg_termination (models\staging\stg_termination.sql)
  001003 (42000): SQL compilation error:
  syntax error line 9 at position 43 unexpected ';'.
  compiled code at target\run\customer_churn\models\staging\stg_termination.sql
[0m00:17:55.739819 [info ] [MainThread]: 
[0m00:17:55.739819 [error] [MainThread]:   Database Error in model stg_autoinsurance_churn (models\staging\stg_autoinsurance_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 9 at position 51 unexpected ';'.
  compiled code at target\run\customer_churn\models\staging\stg_autoinsurance_churn.sql
[0m00:17:55.742909 [info ] [MainThread]: 
[0m00:17:55.742909 [error] [MainThread]:   Database Error in model stg_turning_movement (models\staging\stg_turning_movement.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 40 unexpected ';'.
  compiled code at target\run\customer_churn\models\staging\stg_turning_movement.sql
[0m00:17:55.745786 [info ] [MainThread]: 
[0m00:17:55.745786 [error] [MainThread]:   Database Error in model stg_address (models\staging\stg_address.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 39 unexpected ';'.
  compiled code at target\run\customer_churn\models\staging\stg_address.sql
[0m00:17:55.747792 [info ] [MainThread]: 
[0m00:17:55.749802 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=6 SKIP=0 TOTAL=6
[0m00:17:55.751396 [debug] [MainThread]: Command `dbt run` failed at 00:17:55.751396 after 7.24 seconds
[0m00:17:55.751396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EA5754D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EA65F3410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EA65F1610>]}
[0m00:17:55.753454 [debug] [MainThread]: Flushing usage events
[0m00:22:23.200745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA25A067E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA25299D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA25A06810>]}


============================== 00:22:23.206537 | 405837ed-0cc2-4141-b3f4-b1aa42e710d8 ==============================
[0m00:22:23.206537 [info ] [MainThread]: Running with dbt=1.8.2
[0m00:22:23.209068 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt', 'log_path': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select staging', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:22:23.673388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '405837ed-0cc2-4141-b3f4-b1aa42e710d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA251DD160>]}
[0m00:22:23.715846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '405837ed-0cc2-4141-b3f4-b1aa42e710d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA27C28E00>]}
[0m00:22:23.715846 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m00:22:23.899690 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m00:22:23.987629 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:22:23.987629 [debug] [MainThread]: Partial parsing: updated file: customer_churn://models\schema.yml
[0m00:22:24.035126 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:22:24.035126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '405837ed-0cc2-4141-b3f4-b1aa42e710d8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA28187FB0>]}
[0m00:22:24.263994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '405837ed-0cc2-4141-b3f4-b1aa42e710d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA2814ED20>]}
[0m00:22:24.409383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '405837ed-0cc2-4141-b3f4-b1aa42e710d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA28154290>]}
[0m00:22:24.409383 [info ] [MainThread]: Found 11 models, 10 data tests, 7 sources, 459 macros
[0m00:22:24.409383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '405837ed-0cc2-4141-b3f4-b1aa42e710d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA2816D130>]}
[0m00:22:24.417394 [info ] [MainThread]: 
[0m00:22:24.417394 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:22:24.417394 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON'
[0m00:22:24.425545 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON"
[0m00:22:24.425545 [debug] [ThreadPool]: On list_USER_DB_FALCON: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON"} */
show terse schemas in database USER_DB_FALCON
    limit 10000
[0m00:22:24.425545 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:22:25.053306 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.625 seconds
[0m00:22:25.053306 [debug] [ThreadPool]: On list_USER_DB_FALCON: Close
[0m00:22:25.512909 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON_RAW_public'
[0m00:22:25.522429 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m00:22:25.522429 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show objects in USER_DB_FALCON.RAW_public limit 10000
[0m00:22:25.522429 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:22:26.012912 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.488 seconds
[0m00:22:26.012912 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m00:22:26.144935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '405837ed-0cc2-4141-b3f4-b1aa42e710d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA2816F9B0>]}
[0m00:22:26.144935 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:22:26.152606 [info ] [MainThread]: 
[0m00:22:26.157490 [debug] [Thread-1 (]: Began running node model.customer_churn.stg_address
[0m00:22:26.158119 [debug] [Thread-2 (]: Began running node model.customer_churn.stg_autoinsurance_churn
[0m00:22:26.158119 [debug] [Thread-3 (]: Began running node model.customer_churn.stg_customer
[0m00:22:26.158900 [debug] [Thread-4 (]: Began running node model.customer_churn.stg_demographic
[0m00:22:26.159595 [info ] [Thread-1 (]: 1 of 6 START sql view model RAW_public.stg_address ............................. [RUN]
[0m00:22:26.161548 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.customer_churn.stg_address'
[0m00:22:26.161938 [debug] [Thread-1 (]: Began compiling node model.customer_churn.stg_address
[0m00:22:26.159905 [info ] [Thread-2 (]: 2 of 6 START sql view model RAW_public.stg_autoinsurance_churn ................. [RUN]
[0m00:22:26.167888 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.stg_address"
[0m00:22:26.168715 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.customer_churn.stg_autoinsurance_churn'
[0m00:22:26.160601 [info ] [Thread-3 (]: 3 of 6 START sql view model RAW_public.stg_customer ............................ [RUN]
[0m00:22:26.170115 [debug] [Thread-1 (]: Began executing node model.customer_churn.stg_address
[0m00:22:26.170682 [debug] [Thread-2 (]: Began compiling node model.customer_churn.stg_autoinsurance_churn
[0m00:22:26.160959 [info ] [Thread-4 (]: 4 of 6 START sql view model RAW_public.stg_demographic ......................... [RUN]
[0m00:22:26.171542 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.customer_churn.stg_customer'
[0m00:22:26.194353 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer_churn.stg_autoinsurance_churn"
[0m00:22:26.196820 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.stg_address"
[0m00:22:26.196820 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.customer_churn.stg_demographic'
[0m00:22:26.196820 [debug] [Thread-3 (]: Began compiling node model.customer_churn.stg_customer
[0m00:22:26.196820 [debug] [Thread-4 (]: Began compiling node model.customer_churn.stg_demographic
[0m00:22:26.196820 [debug] [Thread-2 (]: Began executing node model.customer_churn.stg_autoinsurance_churn
[0m00:22:26.196820 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.stg_address"
[0m00:22:26.204611 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.stg_customer"
[0m00:22:26.207070 [debug] [Thread-4 (]: Writing injected SQL for node "model.customer_churn.stg_demographic"
[0m00:22:26.207485 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer_churn.stg_autoinsurance_churn"
[0m00:22:26.207485 [debug] [Thread-1 (]: On model.customer_churn.stg_address: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_address"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_address
  
   as (
    -- models/staging/stg_address.sql

select
  address_id,
  street_address,
  city,
  state,
  county,
  latitude::float as lat,
  longitude::float as lon
from USER_DB_FALCON.RAW.ADDRESS_STAGING;
[0m00:22:26.207485 [debug] [Thread-3 (]: Began executing node model.customer_churn.stg_customer
[0m00:22:26.207485 [debug] [Thread-2 (]: Using snowflake connection "model.customer_churn.stg_autoinsurance_churn"
[0m00:22:26.207485 [debug] [Thread-4 (]: Began executing node model.customer_churn.stg_demographic
[0m00:22:26.207485 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:22:26.207485 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.stg_customer"
[0m00:22:26.207485 [debug] [Thread-2 (]: On model.customer_churn.stg_autoinsurance_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_autoinsurance_churn"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_autoinsurance_churn
  
   as (
    -- models/staging/stg_autoinsurance_churn.sql

select
  individual_id,
  churn_flag  -- 1=churn, 0=keep
from USER_DB_FALCON.RAW.AUTOINSURANCE_CHURN_STAGING;
[0m00:22:26.207485 [debug] [Thread-4 (]: Writing runtime sql for node "model.customer_churn.stg_demographic"
[0m00:22:26.207485 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:22:26.207485 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.stg_customer"
[0m00:22:26.207485 [debug] [Thread-4 (]: Using snowflake connection "model.customer_churn.stg_demographic"
[0m00:22:26.221763 [debug] [Thread-3 (]: On model.customer_churn.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_customer"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_customer
  
   as (
    -- models/staging/stg_customer.sql

select
  individual_id,
  address_id,
  curr_ann_amt   as annual_premium,
  days_tenure,
  cust_orig_date
from USER_DB_FALCON.RAW.CUSTOMER_STAGING;
[0m00:22:26.222475 [debug] [Thread-4 (]: On model.customer_churn.stg_demographic: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_demographic"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_demographic
  
   as (
    -- models/staging/stg_demographic.sql

select
  individual_id,
  age_in_years,
  date_of_birth,
  has_children,
  marital_status,
  home_owner,
  home_market_value,
  length_of_residence,
  college_degree
from USER_DB_FALCON.RAW.DEMOGRAPHIC_STAGING;
[0m00:22:26.222475 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:22:26.222475 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:22:26.618918 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01bc1e3a-0305-1c2f-0004-59ff003a29fa
[0m00:22:26.618918 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 16 at position 43 unexpected ';'.
[0m00:22:26.618918 [debug] [Thread-4 (]: On model.customer_churn.stg_demographic: Close
[0m00:22:26.623490 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01bc1e3a-0305-1c2f-0004-59ff003a29f6
[0m00:22:26.623490 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 9 at position 51 unexpected ';'.
[0m00:22:26.623490 [debug] [Thread-2 (]: On model.customer_churn.stg_autoinsurance_churn: Close
[0m00:22:26.754813 [debug] [Thread-4 (]: Database Error in model stg_demographic (models\staging\stg_demographic.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 43 unexpected ';'.
  compiled code at target\run\customer_churn\models\staging\stg_demographic.sql
[0m00:22:26.770687 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '405837ed-0cc2-4141-b3f4-b1aa42e710d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA28428C20>]}
[0m00:22:26.770687 [error] [Thread-4 (]: 4 of 6 ERROR creating sql view model RAW_public.stg_demographic ................ [[31mERROR[0m in 0.56s]
[0m00:22:26.770687 [debug] [Thread-4 (]: Finished running node model.customer_churn.stg_demographic
[0m00:22:26.770687 [debug] [Thread-4 (]: Began running node model.customer_churn.stg_termination
[0m00:22:26.770687 [debug] [Thread-2 (]: Database Error in model stg_autoinsurance_churn (models\staging\stg_autoinsurance_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 9 at position 51 unexpected ';'.
  compiled code at target\run\customer_churn\models\staging\stg_autoinsurance_churn.sql
[0m00:22:26.770687 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '405837ed-0cc2-4141-b3f4-b1aa42e710d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA282B2810>]}
[0m00:22:26.770687 [info ] [Thread-4 (]: 5 of 6 START sql view model RAW_public.stg_termination ......................... [RUN]
[0m00:22:26.770687 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.customer_churn.stg_demographic, now model.customer_churn.stg_termination)
[0m00:22:26.770687 [debug] [Thread-4 (]: Began compiling node model.customer_churn.stg_termination
[0m00:22:26.770687 [debug] [Thread-4 (]: Writing injected SQL for node "model.customer_churn.stg_termination"
[0m00:22:26.770687 [debug] [Thread-4 (]: Began executing node model.customer_churn.stg_termination
[0m00:22:26.770687 [debug] [Thread-4 (]: Writing runtime sql for node "model.customer_churn.stg_termination"
[0m00:22:26.770687 [error] [Thread-2 (]: 2 of 6 ERROR creating sql view model RAW_public.stg_autoinsurance_churn ........ [[31mERROR[0m in 0.60s]
[0m00:22:26.784248 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01bc1e3a-0305-212a-0004-59ff003a370e
[0m00:22:26.786070 [debug] [Thread-4 (]: Using snowflake connection "model.customer_churn.stg_termination"
[0m00:22:26.786070 [debug] [Thread-2 (]: Finished running node model.customer_churn.stg_autoinsurance_churn
[0m00:22:26.786070 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 12 at position 40 unexpected ';'.
[0m00:22:26.786070 [debug] [Thread-4 (]: On model.customer_churn.stg_termination: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_termination"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_termination
  
   as (
    -- models/staging/stg_termination.sql

select
  individual_id,
  acct_suspd_date  as churn_date
from USER_DB_FALCON.RAW.TERMINATION_STAGING;
[0m00:22:26.788452 [debug] [Thread-2 (]: Began running node model.customer_churn.stg_turning_movement
[0m00:22:26.788452 [debug] [Thread-3 (]: On model.customer_churn.stg_customer: Close
[0m00:22:26.788452 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:22:26.788452 [info ] [Thread-2 (]: 6 of 6 START sql view model RAW_public.stg_turning_movement .................... [RUN]
[0m00:22:26.794165 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer_churn.stg_autoinsurance_churn, now model.customer_churn.stg_turning_movement)
[0m00:22:26.794165 [debug] [Thread-2 (]: Began compiling node model.customer_churn.stg_turning_movement
[0m00:22:26.802522 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer_churn.stg_turning_movement"
[0m00:22:26.804830 [debug] [Thread-2 (]: Began executing node model.customer_churn.stg_turning_movement
[0m00:22:26.805872 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer_churn.stg_turning_movement"
[0m00:22:26.805872 [debug] [Thread-2 (]: Using snowflake connection "model.customer_churn.stg_turning_movement"
[0m00:22:26.805872 [debug] [Thread-2 (]: On model.customer_churn.stg_turning_movement: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_turning_movement"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_turning_movement
  
   as (
    -- models/staging/stg_turning_movement.sql

select
  objectid,
  facilityid,
  intid,
  intname,
  nodeno,
  longitude::float as tm_lon,
  latitude::float  as tm_lat
from USER_DB_FALCON.RAW.TURNING_MOVEMENT;
[0m00:22:26.805872 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:22:27.253516 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bc1e3a-0305-24f3-0004-59ff003af08e
[0m00:22:27.253516 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 14 at position 39 unexpected ';'.
[0m00:22:27.255338 [debug] [Thread-1 (]: On model.customer_churn.stg_address: Close
[0m00:22:27.256085 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01bc1e3a-0305-24f3-0004-59ff003af08a
[0m00:22:27.256085 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 14 at position 40 unexpected ';'.
[0m00:22:27.256085 [debug] [Thread-2 (]: On model.customer_churn.stg_turning_movement: Close
[0m00:22:27.286480 [debug] [Thread-3 (]: Database Error in model stg_customer (models\staging\stg_customer.sql)
  001003 (42000): SQL compilation error:
  syntax error line 12 at position 40 unexpected ';'.
  compiled code at target\run\customer_churn\models\staging\stg_customer.sql
[0m00:22:27.286480 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '405837ed-0cc2-4141-b3f4-b1aa42e710d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA2855BFE0>]}
[0m00:22:27.286480 [error] [Thread-3 (]: 3 of 6 ERROR creating sql view model RAW_public.stg_customer ................... [[31mERROR[0m in 1.11s]
[0m00:22:27.286480 [debug] [Thread-3 (]: Finished running node model.customer_churn.stg_customer
[0m00:22:27.286480 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01bc1e3a-0305-2374-0004-59ff0039dd1e
[0m00:22:27.286480 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 9 at position 43 unexpected ';'.
[0m00:22:27.286480 [debug] [Thread-4 (]: On model.customer_churn.stg_termination: Close
[0m00:22:27.383374 [debug] [Thread-2 (]: Database Error in model stg_turning_movement (models\staging\stg_turning_movement.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 40 unexpected ';'.
  compiled code at target\run\customer_churn\models\staging\stg_turning_movement.sql
[0m00:22:27.383374 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '405837ed-0cc2-4141-b3f4-b1aa42e710d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA2855A570>]}
[0m00:22:27.383374 [error] [Thread-2 (]: 6 of 6 ERROR creating sql view model RAW_public.stg_turning_movement ........... [[31mERROR[0m in 0.59s]
[0m00:22:27.383374 [debug] [Thread-2 (]: Finished running node model.customer_churn.stg_turning_movement
[0m00:22:27.391814 [debug] [Thread-1 (]: Database Error in model stg_address (models\staging\stg_address.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 39 unexpected ';'.
  compiled code at target\run\customer_churn\models\staging\stg_address.sql
[0m00:22:27.391814 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '405837ed-0cc2-4141-b3f4-b1aa42e710d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA285587A0>]}
[0m00:22:27.391814 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model RAW_public.stg_address .................... [[31mERROR[0m in 1.23s]
[0m00:22:27.391814 [debug] [Thread-1 (]: Finished running node model.customer_churn.stg_address
[0m00:22:27.418493 [debug] [Thread-4 (]: Database Error in model stg_termination (models\staging\stg_termination.sql)
  001003 (42000): SQL compilation error:
  syntax error line 9 at position 43 unexpected ';'.
  compiled code at target\run\customer_churn\models\staging\stg_termination.sql
[0m00:22:27.418493 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '405837ed-0cc2-4141-b3f4-b1aa42e710d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA28559580>]}
[0m00:22:27.418493 [error] [Thread-4 (]: 5 of 6 ERROR creating sql view model RAW_public.stg_termination ................ [[31mERROR[0m in 0.65s]
[0m00:22:27.423857 [debug] [Thread-4 (]: Finished running node model.customer_churn.stg_termination
[0m00:22:27.424994 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:22:27.424994 [debug] [MainThread]: Connection 'list_USER_DB_FALCON' was properly closed.
[0m00:22:27.424994 [debug] [MainThread]: Connection 'list_USER_DB_FALCON_RAW_public' was properly closed.
[0m00:22:27.424994 [debug] [MainThread]: Connection 'model.customer_churn.stg_address' was properly closed.
[0m00:22:27.424994 [debug] [MainThread]: Connection 'model.customer_churn.stg_turning_movement' was properly closed.
[0m00:22:27.424994 [debug] [MainThread]: Connection 'model.customer_churn.stg_customer' was properly closed.
[0m00:22:27.424994 [debug] [MainThread]: Connection 'model.customer_churn.stg_termination' was properly closed.
[0m00:22:27.424994 [info ] [MainThread]: 
[0m00:22:27.424994 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 3.01 seconds (3.01s).
[0m00:22:27.424994 [debug] [MainThread]: Command end result
[0m00:22:27.448408 [info ] [MainThread]: 
[0m00:22:27.448408 [info ] [MainThread]: [31mCompleted with 6 errors and 0 warnings:[0m
[0m00:22:27.448408 [info ] [MainThread]: 
[0m00:22:27.448408 [error] [MainThread]:   Database Error in model stg_demographic (models\staging\stg_demographic.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 43 unexpected ';'.
  compiled code at target\run\customer_churn\models\staging\stg_demographic.sql
[0m00:22:27.448408 [info ] [MainThread]: 
[0m00:22:27.448408 [error] [MainThread]:   Database Error in model stg_autoinsurance_churn (models\staging\stg_autoinsurance_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 9 at position 51 unexpected ';'.
  compiled code at target\run\customer_churn\models\staging\stg_autoinsurance_churn.sql
[0m00:22:27.456696 [info ] [MainThread]: 
[0m00:22:27.456696 [error] [MainThread]:   Database Error in model stg_customer (models\staging\stg_customer.sql)
  001003 (42000): SQL compilation error:
  syntax error line 12 at position 40 unexpected ';'.
  compiled code at target\run\customer_churn\models\staging\stg_customer.sql
[0m00:22:27.456696 [info ] [MainThread]: 
[0m00:22:27.456696 [error] [MainThread]:   Database Error in model stg_turning_movement (models\staging\stg_turning_movement.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 40 unexpected ';'.
  compiled code at target\run\customer_churn\models\staging\stg_turning_movement.sql
[0m00:22:27.456696 [info ] [MainThread]: 
[0m00:22:27.456696 [error] [MainThread]:   Database Error in model stg_address (models\staging\stg_address.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 39 unexpected ';'.
  compiled code at target\run\customer_churn\models\staging\stg_address.sql
[0m00:22:27.456696 [info ] [MainThread]: 
[0m00:22:27.456696 [error] [MainThread]:   Database Error in model stg_termination (models\staging\stg_termination.sql)
  001003 (42000): SQL compilation error:
  syntax error line 9 at position 43 unexpected ';'.
  compiled code at target\run\customer_churn\models\staging\stg_termination.sql
[0m00:22:27.456696 [info ] [MainThread]: 
[0m00:22:27.456696 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=6 SKIP=0 TOTAL=6
[0m00:22:27.465172 [debug] [MainThread]: Command `dbt run` failed at 00:22:27.465172 after 4.60 seconds
[0m00:22:27.465172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA24B48410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA24B49D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA25A576B0>]}
[0m00:22:27.465172 [debug] [MainThread]: Flushing usage events
[0m00:24:49.904132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EA6219520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EA85F99D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EA85F92E0>]}


============================== 00:24:49.912836 | f498acb6-0f62-49fa-b54c-58ada1dde7ee ==============================
[0m00:24:49.912836 [info ] [MainThread]: Running with dbt=1.8.2
[0m00:24:49.912836 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt', 'log_path': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select staging', 'send_anonymous_usage_stats': 'True'}
[0m00:24:50.413974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f498acb6-0f62-49fa-b54c-58ada1dde7ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EA8EE4530>]}
[0m00:24:50.504315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f498acb6-0f62-49fa-b54c-58ada1dde7ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EAAA43EC0>]}
[0m00:24:50.511543 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m00:24:50.689575 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m00:24:50.785629 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 6 files changed.
[0m00:24:50.785629 [debug] [MainThread]: Partial parsing: updated file: customer_churn://models\staging\stg_turning_movement.sql
[0m00:24:50.785629 [debug] [MainThread]: Partial parsing: updated file: customer_churn://models\staging\stg_address.sql
[0m00:24:50.785629 [debug] [MainThread]: Partial parsing: updated file: customer_churn://models\staging\stg_demographic.sql
[0m00:24:50.785629 [debug] [MainThread]: Partial parsing: updated file: customer_churn://models\staging\stg_customer.sql
[0m00:24:50.785629 [debug] [MainThread]: Partial parsing: updated file: customer_churn://models\staging\stg_termination.sql
[0m00:24:50.785629 [debug] [MainThread]: Partial parsing: updated file: customer_churn://models\staging\stg_autoinsurance_churn.sql
[0m00:24:50.998180 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:24:50.998180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f498acb6-0f62-49fa-b54c-58ada1dde7ee', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EAB491FD0>]}
[0m00:24:51.208790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f498acb6-0f62-49fa-b54c-58ada1dde7ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EAB478410>]}
[0m00:24:51.283012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f498acb6-0f62-49fa-b54c-58ada1dde7ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EA89CD100>]}
[0m00:24:51.283012 [info ] [MainThread]: Found 11 models, 10 data tests, 7 sources, 459 macros
[0m00:24:51.283012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f498acb6-0f62-49fa-b54c-58ada1dde7ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EAB4136B0>]}
[0m00:24:51.286539 [info ] [MainThread]: 
[0m00:24:51.286539 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:24:51.286539 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON'
[0m00:24:51.286539 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON"
[0m00:24:51.286539 [debug] [ThreadPool]: On list_USER_DB_FALCON: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON"} */
show terse schemas in database USER_DB_FALCON
    limit 10000
[0m00:24:51.286539 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:24:51.827420 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.528 seconds
[0m00:24:51.827420 [debug] [ThreadPool]: On list_USER_DB_FALCON: Close
[0m00:24:51.965564 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON_RAW_public'
[0m00:24:51.984121 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m00:24:51.984121 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show objects in USER_DB_FALCON.RAW_public limit 10000
[0m00:24:51.984121 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:24:52.550588 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.564 seconds
[0m00:24:52.553264 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m00:24:52.693062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f498acb6-0f62-49fa-b54c-58ada1dde7ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EAAF3BE90>]}
[0m00:24:52.693062 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:24:52.693062 [info ] [MainThread]: 
[0m00:24:52.698196 [debug] [Thread-1 (]: Began running node model.customer_churn.stg_address
[0m00:24:52.698196 [debug] [Thread-2 (]: Began running node model.customer_churn.stg_autoinsurance_churn
[0m00:24:52.701255 [debug] [Thread-3 (]: Began running node model.customer_churn.stg_customer
[0m00:24:52.701255 [debug] [Thread-4 (]: Began running node model.customer_churn.stg_demographic
[0m00:24:52.701255 [info ] [Thread-1 (]: 1 of 6 START sql view model RAW_public.stg_address ............................. [RUN]
[0m00:24:52.701255 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.customer_churn.stg_address'
[0m00:24:52.701255 [debug] [Thread-1 (]: Began compiling node model.customer_churn.stg_address
[0m00:24:52.708505 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.stg_address"
[0m00:24:52.701255 [info ] [Thread-2 (]: 2 of 6 START sql view model RAW_public.stg_autoinsurance_churn ................. [RUN]
[0m00:24:52.708505 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.customer_churn.stg_autoinsurance_churn'
[0m00:24:52.708505 [debug] [Thread-2 (]: Began compiling node model.customer_churn.stg_autoinsurance_churn
[0m00:24:52.713184 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer_churn.stg_autoinsurance_churn"
[0m00:24:52.713184 [debug] [Thread-1 (]: Began executing node model.customer_churn.stg_address
[0m00:24:52.701255 [info ] [Thread-3 (]: 3 of 6 START sql view model RAW_public.stg_customer ............................ [RUN]
[0m00:24:52.733346 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.stg_address"
[0m00:24:52.701255 [info ] [Thread-4 (]: 4 of 6 START sql view model RAW_public.stg_demographic ......................... [RUN]
[0m00:24:52.733346 [debug] [Thread-2 (]: Began executing node model.customer_churn.stg_autoinsurance_churn
[0m00:24:52.741369 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.customer_churn.stg_customer'
[0m00:24:52.741369 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.customer_churn.stg_demographic'
[0m00:24:52.741369 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.stg_address"
[0m00:24:52.741369 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer_churn.stg_autoinsurance_churn"
[0m00:24:52.741369 [debug] [Thread-3 (]: Began compiling node model.customer_churn.stg_customer
[0m00:24:52.741369 [debug] [Thread-4 (]: Began compiling node model.customer_churn.stg_demographic
[0m00:24:52.741369 [debug] [Thread-1 (]: On model.customer_churn.stg_address: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_address"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_address
  
   as (
    -- models/staging/stg_address.sql

select
  address_id,
  street_address,
  city,
  state,
  county,
  latitude::float as lat,
  longitude::float as lon
from USER_DB_FALCON.RAW.ADDRESS_STAGING
  );
[0m00:24:52.749846 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.stg_customer"
[0m00:24:52.749846 [debug] [Thread-4 (]: Writing injected SQL for node "model.customer_churn.stg_demographic"
[0m00:24:52.749846 [debug] [Thread-2 (]: Using snowflake connection "model.customer_churn.stg_autoinsurance_churn"
[0m00:24:52.749846 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:24:52.756502 [debug] [Thread-2 (]: On model.customer_churn.stg_autoinsurance_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_autoinsurance_churn"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_autoinsurance_churn
  
   as (
    -- models/staging/stg_autoinsurance_churn.sql

select
  individual_id,
  churn_flag  -- 1=churn, 0=keep
from USER_DB_FALCON.RAW.AUTOINSURANCE_CHURN_STAGING
  );
[0m00:24:52.756502 [debug] [Thread-3 (]: Began executing node model.customer_churn.stg_customer
[0m00:24:52.758224 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:24:52.758224 [debug] [Thread-4 (]: Began executing node model.customer_churn.stg_demographic
[0m00:24:52.761103 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.stg_customer"
[0m00:24:52.766664 [debug] [Thread-4 (]: Writing runtime sql for node "model.customer_churn.stg_demographic"
[0m00:24:52.766664 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.stg_customer"
[0m00:24:52.766664 [debug] [Thread-3 (]: On model.customer_churn.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_customer"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_customer
  
   as (
    -- models/staging/stg_customer.sql

select
  individual_id,
  address_id,
  curr_ann_amt   as annual_premium,
  days_tenure,
  cust_orig_date
from USER_DB_FALCON.RAW.CUSTOMER_STAGING
  );
[0m00:24:52.766664 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:24:52.773043 [debug] [Thread-4 (]: Using snowflake connection "model.customer_churn.stg_demographic"
[0m00:24:52.773043 [debug] [Thread-4 (]: On model.customer_churn.stg_demographic: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_demographic"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_demographic
  
   as (
    -- models/staging/stg_demographic.sql

select
  individual_id,
  age_in_years,
  date_of_birth,
  has_children,
  marital_status,
  home_owner,
  home_market_value,
  length_of_residence,
  college_degree
from USER_DB_FALCON.RAW.DEMOGRAPHIC_STAGING
  );
[0m00:24:52.773043 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:24:53.241969 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01bc1e3c-0305-1c2f-0004-59ff003a29fe
[0m00:24:53.242385 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 8 at position 2
invalid identifier 'AGE_IN_YEARS'
[0m00:24:53.242884 [debug] [Thread-4 (]: On model.customer_churn.stg_demographic: Close
[0m00:24:53.267415 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01bc1e3c-0305-25cb-0004-59ff003a873e
[0m00:24:53.267415 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 8 at position 2
invalid identifier 'CHURN_FLAG'
[0m00:24:53.267415 [debug] [Thread-2 (]: On model.customer_churn.stg_autoinsurance_churn: Close
[0m00:24:53.385651 [debug] [Thread-4 (]: Database Error in model stg_demographic (models\staging\stg_demographic.sql)
  000904 (42000): SQL compilation error: error line 8 at position 2
  invalid identifier 'AGE_IN_YEARS'
  compiled code at target\run\customer_churn\models\staging\stg_demographic.sql
[0m00:24:53.385651 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f498acb6-0f62-49fa-b54c-58ada1dde7ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EA85B7860>]}
[0m00:24:53.392176 [error] [Thread-4 (]: 4 of 6 ERROR creating sql view model RAW_public.stg_demographic ................ [[31mERROR[0m in 0.64s]
[0m00:24:53.393682 [debug] [Thread-4 (]: Finished running node model.customer_churn.stg_demographic
[0m00:24:53.393682 [debug] [Thread-4 (]: Began running node model.customer_churn.stg_termination
[0m00:24:53.393682 [info ] [Thread-4 (]: 5 of 6 START sql view model RAW_public.stg_termination ......................... [RUN]
[0m00:24:53.400908 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.customer_churn.stg_demographic, now model.customer_churn.stg_termination)
[0m00:24:53.400908 [debug] [Thread-4 (]: Began compiling node model.customer_churn.stg_termination
[0m00:24:53.408433 [debug] [Thread-4 (]: Writing injected SQL for node "model.customer_churn.stg_termination"
[0m00:24:53.409053 [debug] [Thread-4 (]: Began executing node model.customer_churn.stg_termination
[0m00:24:53.410059 [debug] [Thread-4 (]: Writing runtime sql for node "model.customer_churn.stg_termination"
[0m00:24:53.410059 [debug] [Thread-4 (]: Using snowflake connection "model.customer_churn.stg_termination"
[0m00:24:53.415633 [debug] [Thread-4 (]: On model.customer_churn.stg_termination: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_termination"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_termination
  
   as (
    -- models/staging/stg_termination.sql

select
  individual_id,
  acct_suspd_date  as churn_date
from USER_DB_FALCON.RAW.TERMINATION_STAGING
  );
[0m00:24:53.417122 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:24:53.436007 [debug] [Thread-2 (]: Database Error in model stg_autoinsurance_churn (models\staging\stg_autoinsurance_churn.sql)
  000904 (42000): SQL compilation error: error line 8 at position 2
  invalid identifier 'CHURN_FLAG'
  compiled code at target\run\customer_churn\models\staging\stg_autoinsurance_churn.sql
[0m00:24:53.436007 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f498acb6-0f62-49fa-b54c-58ada1dde7ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EAB834A40>]}
[0m00:24:53.436007 [error] [Thread-2 (]: 2 of 6 ERROR creating sql view model RAW_public.stg_autoinsurance_churn ........ [[31mERROR[0m in 0.73s]
[0m00:24:53.440085 [debug] [Thread-2 (]: Finished running node model.customer_churn.stg_autoinsurance_churn
[0m00:24:53.440085 [debug] [Thread-2 (]: Began running node model.customer_churn.stg_turning_movement
[0m00:24:53.440085 [info ] [Thread-2 (]: 6 of 6 START sql view model RAW_public.stg_turning_movement .................... [RUN]
[0m00:24:53.442097 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer_churn.stg_autoinsurance_churn, now model.customer_churn.stg_turning_movement)
[0m00:24:53.442097 [debug] [Thread-2 (]: Began compiling node model.customer_churn.stg_turning_movement
[0m00:24:53.443423 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer_churn.stg_turning_movement"
[0m00:24:53.443423 [debug] [Thread-2 (]: Began executing node model.customer_churn.stg_turning_movement
[0m00:24:53.443423 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer_churn.stg_turning_movement"
[0m00:24:53.451348 [debug] [Thread-2 (]: Using snowflake connection "model.customer_churn.stg_turning_movement"
[0m00:24:53.451348 [debug] [Thread-2 (]: On model.customer_churn.stg_turning_movement: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_turning_movement"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_turning_movement
  
   as (
    -- models/staging/stg_turning_movement.sql

select
  objectid,
  facilityid,
  intid,
  intname,
  nodeno,
  longitude::float as tm_lon,
  latitude::float  as tm_lat
from USER_DB_FALCON.RAW.TURNING_MOVEMENT
  );
[0m00:24:53.451348 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:24:53.473492 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.704 seconds
[0m00:24:53.507107 [debug] [Thread-3 (]: On model.customer_churn.stg_customer: Close
[0m00:24:53.514054 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.762 seconds
[0m00:24:53.522482 [debug] [Thread-1 (]: On model.customer_churn.stg_address: Close
[0m00:24:53.685508 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f498acb6-0f62-49fa-b54c-58ada1dde7ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EAAEF7A40>]}
[0m00:24:53.687024 [info ] [Thread-3 (]: 3 of 6 OK created sql view model RAW_public.stg_customer ....................... [[32mSUCCESS 1[0m in 0.94s]
[0m00:24:53.687024 [debug] [Thread-3 (]: Finished running node model.customer_churn.stg_customer
[0m00:24:54.009032 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.602 seconds
[0m00:24:54.024694 [debug] [Thread-4 (]: On model.customer_churn.stg_termination: Close
[0m00:24:54.107265 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f498acb6-0f62-49fa-b54c-58ada1dde7ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EAB762B70>]}
[0m00:24:54.107265 [info ] [Thread-1 (]: 1 of 6 OK created sql view model RAW_public.stg_address ........................ [[32mSUCCESS 1[0m in 1.41s]
[0m00:24:54.107265 [debug] [Thread-1 (]: Finished running node model.customer_churn.stg_address
[0m00:24:54.853376 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.400 seconds
[0m00:24:54.853376 [debug] [Thread-2 (]: On model.customer_churn.stg_turning_movement: Close
[0m00:24:54.853376 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f498acb6-0f62-49fa-b54c-58ada1dde7ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EAB97C980>]}
[0m00:24:54.864820 [info ] [Thread-4 (]: 5 of 6 OK created sql view model RAW_public.stg_termination .................... [[32mSUCCESS 1[0m in 1.45s]
[0m00:24:54.864820 [debug] [Thread-4 (]: Finished running node model.customer_churn.stg_termination
[0m00:24:55.645955 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f498acb6-0f62-49fa-b54c-58ada1dde7ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EAB9A4800>]}
[0m00:24:55.647567 [info ] [Thread-2 (]: 6 of 6 OK created sql view model RAW_public.stg_turning_movement ............... [[32mSUCCESS 1[0m in 2.20s]
[0m00:24:55.647567 [debug] [Thread-2 (]: Finished running node model.customer_churn.stg_turning_movement
[0m00:24:55.647567 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:24:55.647567 [debug] [MainThread]: Connection 'list_USER_DB_FALCON' was properly closed.
[0m00:24:55.647567 [debug] [MainThread]: Connection 'list_USER_DB_FALCON_RAW_public' was properly closed.
[0m00:24:55.647567 [debug] [MainThread]: Connection 'model.customer_churn.stg_address' was properly closed.
[0m00:24:55.647567 [debug] [MainThread]: Connection 'model.customer_churn.stg_turning_movement' was properly closed.
[0m00:24:55.647567 [debug] [MainThread]: Connection 'model.customer_churn.stg_customer' was properly closed.
[0m00:24:55.647567 [debug] [MainThread]: Connection 'model.customer_churn.stg_termination' was properly closed.
[0m00:24:55.647567 [info ] [MainThread]: 
[0m00:24:55.647567 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 4.36 seconds (4.36s).
[0m00:24:55.654952 [debug] [MainThread]: Command end result
[0m00:24:55.683720 [info ] [MainThread]: 
[0m00:24:55.683720 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m00:24:55.683720 [info ] [MainThread]: 
[0m00:24:55.683720 [error] [MainThread]:   Database Error in model stg_demographic (models\staging\stg_demographic.sql)
  000904 (42000): SQL compilation error: error line 8 at position 2
  invalid identifier 'AGE_IN_YEARS'
  compiled code at target\run\customer_churn\models\staging\stg_demographic.sql
[0m00:24:55.683720 [info ] [MainThread]: 
[0m00:24:55.683720 [error] [MainThread]:   Database Error in model stg_autoinsurance_churn (models\staging\stg_autoinsurance_churn.sql)
  000904 (42000): SQL compilation error: error line 8 at position 2
  invalid identifier 'CHURN_FLAG'
  compiled code at target\run\customer_churn\models\staging\stg_autoinsurance_churn.sql
[0m00:24:55.692061 [info ] [MainThread]: 
[0m00:24:55.692061 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
[0m00:24:55.692061 [debug] [MainThread]: Command `dbt run` failed at 00:24:55.692061 after 6.03 seconds
[0m00:24:55.692061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EA86A3500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EA7E93950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EA2893FB0>]}
[0m00:24:55.692061 [debug] [MainThread]: Flushing usage events
[0m00:28:45.837175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001994E41D7F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001994DD3F6B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001994DD3E6F0>]}


============================== 00:28:45.843206 | a3d2cb05-c844-44d7-8425-dd3c6708024c ==============================
[0m00:28:45.843206 [info ] [MainThread]: Running with dbt=1.8.2
[0m00:28:45.851585 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt', 'log_path': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select staging', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:28:46.272619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3d2cb05-c844-44d7-8425-dd3c6708024c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019950914500>]}
[0m00:28:46.310277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a3d2cb05-c844-44d7-8425-dd3c6708024c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199508E47A0>]}
[0m00:28:46.312100 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m00:28:46.467360 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m00:28:46.548945 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m00:28:46.548945 [debug] [MainThread]: Partial parsing: updated file: customer_churn://models\staging\stg_demographic.sql
[0m00:28:46.548945 [debug] [MainThread]: Partial parsing: updated file: customer_churn://models\staging\stg_termination.sql
[0m00:28:46.702391 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:28:46.702391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a3d2cb05-c844-44d7-8425-dd3c6708024c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019950EA7BC0>]}
[0m00:28:46.882848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3d2cb05-c844-44d7-8425-dd3c6708024c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001994E70BF20>]}
[0m00:28:47.034195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3d2cb05-c844-44d7-8425-dd3c6708024c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019950C73860>]}
[0m00:28:47.034195 [info ] [MainThread]: Found 11 models, 10 data tests, 7 sources, 459 macros
[0m00:28:47.034195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3d2cb05-c844-44d7-8425-dd3c6708024c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001994A8B3500>]}
[0m00:28:47.038119 [info ] [MainThread]: 
[0m00:28:47.039414 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:28:47.042445 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON'
[0m00:28:47.049851 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON"
[0m00:28:47.049851 [debug] [ThreadPool]: On list_USER_DB_FALCON: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON"} */
show terse schemas in database USER_DB_FALCON
    limit 10000
[0m00:28:47.049851 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:28:47.806896 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.757 seconds
[0m00:28:47.806896 [debug] [ThreadPool]: On list_USER_DB_FALCON: Close
[0m00:28:48.837192 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON_RAW_public'
[0m00:28:48.853102 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m00:28:48.853102 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show objects in USER_DB_FALCON.RAW_public limit 10000
[0m00:28:48.853102 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:28:49.313891 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.452 seconds
[0m00:28:49.313891 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m00:28:49.459148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3d2cb05-c844-44d7-8425-dd3c6708024c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199508E5EB0>]}
[0m00:28:49.459148 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:28:49.459148 [info ] [MainThread]: 
[0m00:28:49.477687 [debug] [Thread-1 (]: Began running node model.customer_churn.stg_address
[0m00:28:49.477687 [debug] [Thread-2 (]: Began running node model.customer_churn.stg_autoinsurance_churn
[0m00:28:49.477687 [debug] [Thread-3 (]: Began running node model.customer_churn.stg_customer
[0m00:28:49.480850 [debug] [Thread-4 (]: Began running node model.customer_churn.stg_demographic
[0m00:28:49.477687 [info ] [Thread-1 (]: 1 of 6 START sql view model RAW_public.stg_address ............................. [RUN]
[0m00:28:49.481583 [info ] [Thread-2 (]: 2 of 6 START sql view model RAW_public.stg_autoinsurance_churn ................. [RUN]
[0m00:28:49.482710 [info ] [Thread-3 (]: 3 of 6 START sql view model RAW_public.stg_customer ............................ [RUN]
[0m00:28:49.484340 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.customer_churn.stg_address'
[0m00:28:49.483061 [info ] [Thread-4 (]: 4 of 6 START sql view model RAW_public.stg_demographic ......................... [RUN]
[0m00:28:49.484848 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.customer_churn.stg_autoinsurance_churn'
[0m00:28:49.485668 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.customer_churn.stg_customer'
[0m00:28:49.486800 [debug] [Thread-1 (]: Began compiling node model.customer_churn.stg_address
[0m00:28:49.487469 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.customer_churn.stg_demographic'
[0m00:28:49.487469 [debug] [Thread-2 (]: Began compiling node model.customer_churn.stg_autoinsurance_churn
[0m00:28:49.487469 [debug] [Thread-3 (]: Began compiling node model.customer_churn.stg_customer
[0m00:28:49.493952 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.stg_address"
[0m00:28:49.493952 [debug] [Thread-4 (]: Began compiling node model.customer_churn.stg_demographic
[0m00:28:49.499195 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer_churn.stg_autoinsurance_churn"
[0m00:28:49.499195 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.stg_customer"
[0m00:28:49.506872 [debug] [Thread-4 (]: Writing injected SQL for node "model.customer_churn.stg_demographic"
[0m00:28:49.506872 [debug] [Thread-1 (]: Began executing node model.customer_churn.stg_address
[0m00:28:49.508238 [debug] [Thread-2 (]: Began executing node model.customer_churn.stg_autoinsurance_churn
[0m00:28:49.508238 [debug] [Thread-3 (]: Began executing node model.customer_churn.stg_customer
[0m00:28:49.508238 [debug] [Thread-4 (]: Began executing node model.customer_churn.stg_demographic
[0m00:28:49.535760 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.stg_address"
[0m00:28:49.535760 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer_churn.stg_autoinsurance_churn"
[0m00:28:49.535760 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.stg_customer"
[0m00:28:49.548103 [debug] [Thread-4 (]: Writing runtime sql for node "model.customer_churn.stg_demographic"
[0m00:28:49.549107 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.stg_address"
[0m00:28:49.549107 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.stg_customer"
[0m00:28:49.549107 [debug] [Thread-2 (]: Using snowflake connection "model.customer_churn.stg_autoinsurance_churn"
[0m00:28:49.551981 [debug] [Thread-1 (]: On model.customer_churn.stg_address: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_address"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_address
  
   as (
    -- models/staging/stg_address.sql

select
  address_id,
  street_address,
  city,
  state,
  county,
  latitude::float as lat,
  longitude::float as lon
from USER_DB_FALCON.RAW.ADDRESS_STAGING
  );
[0m00:28:49.551981 [debug] [Thread-3 (]: On model.customer_churn.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_customer"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_customer
  
   as (
    -- models/staging/stg_customer.sql

select
  individual_id,
  address_id,
  curr_ann_amt   as annual_premium,
  days_tenure,
  cust_orig_date
from USER_DB_FALCON.RAW.CUSTOMER_STAGING
  );
[0m00:28:49.551981 [debug] [Thread-4 (]: Using snowflake connection "model.customer_churn.stg_demographic"
[0m00:28:49.551981 [debug] [Thread-2 (]: On model.customer_churn.stg_autoinsurance_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_autoinsurance_churn"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_autoinsurance_churn
  
   as (
    -- models/staging/stg_autoinsurance_churn.sql

select
  individual_id,
  churn_flag  -- 1=churn, 0=keep
from USER_DB_FALCON.RAW.AUTOINSURANCE_CHURN_STAGING
  );
[0m00:28:49.551981 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:28:49.551981 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:28:49.551981 [debug] [Thread-4 (]: On model.customer_churn.stg_demographic: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_demographic"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_demographic
  
   as (
    select
  individual_id,
  AGE_IN_YEARS as age_in_years,
  DATE_OF_BIRTH as date_of_birth,
  HAS_CHILDREN as has_children,
  MARITAL_STATUS as marital_status,
  HOME_OWNER as home_owner,
  HOME_MARKET_VALUE as home_market_value,
  LENGTH_OF_RESIDENCE as length_of_residence,
  COLLEGE_DEGREE as college_degree
from USER_DB_FALCON.RAW.DEMOGRAPHIC_STAGING
  );
[0m00:28:49.551981 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:28:49.551981 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:28:49.985180 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01bc1e40-0305-2374-0004-59ff0039dd52
[0m00:28:49.985180 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 2
invalid identifier 'AGE_IN_YEARS'
[0m00:28:49.985180 [debug] [Thread-4 (]: On model.customer_churn.stg_demographic: Close
[0m00:28:50.229737 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.675 seconds
[0m00:28:50.250943 [debug] [Thread-1 (]: On model.customer_churn.stg_address: Close
[0m00:28:50.261010 [debug] [Thread-4 (]: Database Error in model stg_demographic (models\staging\stg_demographic.sql)
  000904 (42000): SQL compilation error: error line 6 at position 2
  invalid identifier 'AGE_IN_YEARS'
  compiled code at target\run\customer_churn\models\staging\stg_demographic.sql
[0m00:28:50.262253 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3d2cb05-c844-44d7-8425-dd3c6708024c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019951146FF0>]}
[0m00:28:50.263317 [error] [Thread-4 (]: 4 of 6 ERROR creating sql view model RAW_public.stg_demographic ................ [[31mERROR[0m in 0.77s]
[0m00:28:50.264337 [debug] [Thread-4 (]: Finished running node model.customer_churn.stg_demographic
[0m00:28:50.264840 [debug] [Thread-4 (]: Began running node model.customer_churn.stg_termination
[0m00:28:50.265522 [info ] [Thread-4 (]: 5 of 6 START sql view model RAW_public.stg_termination ......................... [RUN]
[0m00:28:50.266226 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.customer_churn.stg_demographic, now model.customer_churn.stg_termination)
[0m00:28:50.266226 [debug] [Thread-4 (]: Began compiling node model.customer_churn.stg_termination
[0m00:28:50.269486 [debug] [Thread-4 (]: Writing injected SQL for node "model.customer_churn.stg_termination"
[0m00:28:50.270758 [debug] [Thread-4 (]: Began executing node model.customer_churn.stg_termination
[0m00:28:50.274424 [debug] [Thread-4 (]: Writing runtime sql for node "model.customer_churn.stg_termination"
[0m00:28:50.275478 [debug] [Thread-4 (]: Using snowflake connection "model.customer_churn.stg_termination"
[0m00:28:50.275993 [debug] [Thread-4 (]: On model.customer_churn.stg_termination: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_termination"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_termination
  
   as (
    select
  individual_id,
  CHURN_FLAG as churn_flag
from USER_DB_FALCON.RAW.AUTOINSURANCE_CHURN_STAGING
  );
[0m00:28:50.276516 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:28:50.558126 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01bc1e40-0305-212a-0004-59ff003a373e
[0m00:28:50.558662 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 8 at position 2
invalid identifier 'CHURN_FLAG'
[0m00:28:50.559223 [debug] [Thread-2 (]: On model.customer_churn.stg_autoinsurance_churn: Close
[0m00:28:50.701205 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01bc1e40-0305-2374-0004-59ff0039dd56
[0m00:28:50.701205 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 2
invalid identifier 'CHURN_FLAG'
[0m00:28:50.701205 [debug] [Thread-4 (]: On model.customer_churn.stg_termination: Close
[0m00:28:50.711436 [debug] [Thread-2 (]: Database Error in model stg_autoinsurance_churn (models\staging\stg_autoinsurance_churn.sql)
  000904 (42000): SQL compilation error: error line 8 at position 2
  invalid identifier 'CHURN_FLAG'
  compiled code at target\run\customer_churn\models\staging\stg_autoinsurance_churn.sql
[0m00:28:50.711436 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3d2cb05-c844-44d7-8425-dd3c6708024c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199510C11C0>]}
[0m00:28:50.711436 [error] [Thread-2 (]: 2 of 6 ERROR creating sql view model RAW_public.stg_autoinsurance_churn ........ [[31mERROR[0m in 1.23s]
[0m00:28:50.711436 [debug] [Thread-2 (]: Finished running node model.customer_churn.stg_autoinsurance_churn
[0m00:28:50.711436 [debug] [Thread-2 (]: Began running node model.customer_churn.stg_turning_movement
[0m00:28:50.711436 [info ] [Thread-2 (]: 6 of 6 START sql view model RAW_public.stg_turning_movement .................... [RUN]
[0m00:28:50.716185 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer_churn.stg_autoinsurance_churn, now model.customer_churn.stg_turning_movement)
[0m00:28:50.716894 [debug] [Thread-2 (]: Began compiling node model.customer_churn.stg_turning_movement
[0m00:28:50.720094 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer_churn.stg_turning_movement"
[0m00:28:50.721281 [debug] [Thread-2 (]: Began executing node model.customer_churn.stg_turning_movement
[0m00:28:50.723156 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer_churn.stg_turning_movement"
[0m00:28:50.724366 [debug] [Thread-2 (]: Using snowflake connection "model.customer_churn.stg_turning_movement"
[0m00:28:50.724366 [debug] [Thread-2 (]: On model.customer_churn.stg_turning_movement: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_turning_movement"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_turning_movement
  
   as (
    -- models/staging/stg_turning_movement.sql

select
  objectid,
  facilityid,
  intid,
  intname,
  nodeno,
  longitude::float as tm_lon,
  latitude::float  as tm_lat
from USER_DB_FALCON.RAW.TURNING_MOVEMENT
  );
[0m00:28:50.724893 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:28:51.041944 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3d2cb05-c844-44d7-8425-dd3c6708024c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199512E78F0>]}
[0m00:28:51.046691 [debug] [Thread-4 (]: Database Error in model stg_termination (models\staging\stg_termination.sql)
  000904 (42000): SQL compilation error: error line 6 at position 2
  invalid identifier 'CHURN_FLAG'
  compiled code at target\run\customer_churn\models\staging\stg_termination.sql
[0m00:28:51.045147 [info ] [Thread-1 (]: 1 of 6 OK created sql view model RAW_public.stg_address ........................ [[32mSUCCESS 1[0m in 1.56s]
[0m00:28:51.050699 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3d2cb05-c844-44d7-8425-dd3c6708024c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199512E65A0>]}
[0m00:28:51.050699 [debug] [Thread-1 (]: Finished running node model.customer_churn.stg_address
[0m00:28:51.050699 [error] [Thread-4 (]: 5 of 6 ERROR creating sql view model RAW_public.stg_termination ................ [[31mERROR[0m in 0.78s]
[0m00:28:51.050699 [debug] [Thread-4 (]: Finished running node model.customer_churn.stg_termination
[0m00:28:51.397117 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.842 seconds
[0m00:28:51.400233 [debug] [Thread-3 (]: On model.customer_churn.stg_customer: Close
[0m00:28:51.547756 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3d2cb05-c844-44d7-8425-dd3c6708024c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199512C2A80>]}
[0m00:28:51.549767 [info ] [Thread-3 (]: 3 of 6 OK created sql view model RAW_public.stg_customer ....................... [[32mSUCCESS 1[0m in 2.06s]
[0m00:28:51.551836 [debug] [Thread-3 (]: Finished running node model.customer_churn.stg_customer
[0m00:28:51.804609 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.083 seconds
[0m00:28:51.810748 [debug] [Thread-2 (]: On model.customer_churn.stg_turning_movement: Close
[0m00:28:51.933921 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3d2cb05-c844-44d7-8425-dd3c6708024c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199512E7110>]}
[0m00:28:51.935920 [info ] [Thread-2 (]: 6 of 6 OK created sql view model RAW_public.stg_turning_movement ............... [[32mSUCCESS 1[0m in 1.22s]
[0m00:28:51.937499 [debug] [Thread-2 (]: Finished running node model.customer_churn.stg_turning_movement
[0m00:28:51.937499 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:28:51.944453 [debug] [MainThread]: Connection 'list_USER_DB_FALCON' was properly closed.
[0m00:28:51.945272 [debug] [MainThread]: Connection 'list_USER_DB_FALCON_RAW_public' was properly closed.
[0m00:28:51.945272 [debug] [MainThread]: Connection 'model.customer_churn.stg_address' was properly closed.
[0m00:28:51.945272 [debug] [MainThread]: Connection 'model.customer_churn.stg_turning_movement' was properly closed.
[0m00:28:51.945272 [debug] [MainThread]: Connection 'model.customer_churn.stg_customer' was properly closed.
[0m00:28:51.945272 [debug] [MainThread]: Connection 'model.customer_churn.stg_termination' was properly closed.
[0m00:28:51.945272 [info ] [MainThread]: 
[0m00:28:51.950829 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 4.91 seconds (4.91s).
[0m00:28:51.952901 [debug] [MainThread]: Command end result
[0m00:28:51.993808 [info ] [MainThread]: 
[0m00:28:51.993808 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m00:28:51.993808 [info ] [MainThread]: 
[0m00:28:52.000319 [error] [MainThread]:   Database Error in model stg_demographic (models\staging\stg_demographic.sql)
  000904 (42000): SQL compilation error: error line 6 at position 2
  invalid identifier 'AGE_IN_YEARS'
  compiled code at target\run\customer_churn\models\staging\stg_demographic.sql
[0m00:28:52.000319 [info ] [MainThread]: 
[0m00:28:52.002138 [error] [MainThread]:   Database Error in model stg_autoinsurance_churn (models\staging\stg_autoinsurance_churn.sql)
  000904 (42000): SQL compilation error: error line 8 at position 2
  invalid identifier 'CHURN_FLAG'
  compiled code at target\run\customer_churn\models\staging\stg_autoinsurance_churn.sql
[0m00:28:52.004072 [info ] [MainThread]: 
[0m00:28:52.004072 [error] [MainThread]:   Database Error in model stg_termination (models\staging\stg_termination.sql)
  000904 (42000): SQL compilation error: error line 6 at position 2
  invalid identifier 'CHURN_FLAG'
  compiled code at target\run\customer_churn\models\staging\stg_termination.sql
[0m00:28:52.004072 [info ] [MainThread]: 
[0m00:28:52.004072 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=3 SKIP=0 TOTAL=6
[0m00:28:52.007374 [debug] [MainThread]: Command `dbt run` failed at 00:28:52.007374 after 6.46 seconds
[0m00:28:52.008669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001994DAB1640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001994DD3E6F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001994DD3F6B0>]}
[0m00:28:52.008669 [debug] [MainThread]: Flushing usage events
[0m00:31:56.742752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280EAB87740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280EB1FD6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280E8ED2660>]}


============================== 00:31:56.749912 | 0fc78b9f-167a-4b66-85bb-7ebfddca8c2a ==============================
[0m00:31:56.749912 [info ] [MainThread]: Running with dbt=1.8.2
[0m00:31:56.749912 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt\\logs', 'profiles_dir': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select staging', 'send_anonymous_usage_stats': 'True'}
[0m00:31:57.067048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0fc78b9f-167a-4b66-85bb-7ebfddca8c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280ED2DFBF0>]}
[0m00:31:57.104825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0fc78b9f-167a-4b66-85bb-7ebfddca8c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280ED5147A0>]}
[0m00:31:57.104825 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m00:31:57.312098 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m00:31:57.411172 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:31:57.411172 [debug] [MainThread]: Partial parsing: updated file: customer_churn://models\staging\stg_demographic.sql
[0m00:31:57.701028 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:31:57.701028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0fc78b9f-167a-4b66-85bb-7ebfddca8c2a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280ED9E3AA0>]}
[0m00:31:57.924880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0fc78b9f-167a-4b66-85bb-7ebfddca8c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280EDAECFB0>]}
[0m00:31:57.981632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0fc78b9f-167a-4b66-85bb-7ebfddca8c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280ED7B5A00>]}
[0m00:31:57.981632 [info ] [MainThread]: Found 11 models, 10 data tests, 7 sources, 459 macros
[0m00:31:57.981632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fc78b9f-167a-4b66-85bb-7ebfddca8c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280ED5CD580>]}
[0m00:31:57.981632 [info ] [MainThread]: 
[0m00:31:57.981632 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:31:57.994991 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON'
[0m00:31:58.004348 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON"
[0m00:31:58.004348 [debug] [ThreadPool]: On list_USER_DB_FALCON: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON"} */
show terse schemas in database USER_DB_FALCON
    limit 10000
[0m00:31:58.004348 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:31:58.558877 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.553 seconds
[0m00:31:58.561542 [debug] [ThreadPool]: On list_USER_DB_FALCON: Close
[0m00:31:58.700603 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON_RAW_public'
[0m00:31:58.718609 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m00:31:58.718609 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show objects in USER_DB_FALCON.RAW_public limit 10000
[0m00:31:58.718609 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:31:59.146393 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.436 seconds
[0m00:31:59.163375 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m00:31:59.301091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fc78b9f-167a-4b66-85bb-7ebfddca8c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280E8D83BF0>]}
[0m00:31:59.301091 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:31:59.301091 [info ] [MainThread]: 
[0m00:31:59.317534 [debug] [Thread-1 (]: Began running node model.customer_churn.stg_address
[0m00:31:59.317534 [debug] [Thread-2 (]: Began running node model.customer_churn.stg_autoinsurance_churn
[0m00:31:59.317534 [info ] [Thread-1 (]: 1 of 6 START sql view model RAW_public.stg_address ............................. [RUN]
[0m00:31:59.317534 [debug] [Thread-3 (]: Began running node model.customer_churn.stg_customer
[0m00:31:59.317534 [debug] [Thread-4 (]: Began running node model.customer_churn.stg_demographic
[0m00:31:59.317534 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.customer_churn.stg_address'
[0m00:31:59.317534 [info ] [Thread-2 (]: 2 of 6 START sql view model RAW_public.stg_autoinsurance_churn ................. [RUN]
[0m00:31:59.323290 [info ] [Thread-3 (]: 3 of 6 START sql view model RAW_public.stg_customer ............................ [RUN]
[0m00:31:59.323290 [debug] [Thread-1 (]: Began compiling node model.customer_churn.stg_address
[0m00:31:59.323290 [info ] [Thread-4 (]: 4 of 6 START sql view model RAW_public.stg_demographic ......................... [RUN]
[0m00:31:59.323290 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.customer_churn.stg_autoinsurance_churn'
[0m00:31:59.331564 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.customer_churn.stg_customer'
[0m00:31:59.335788 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.stg_address"
[0m00:31:59.335788 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.customer_churn.stg_demographic'
[0m00:31:59.339592 [debug] [Thread-2 (]: Began compiling node model.customer_churn.stg_autoinsurance_churn
[0m00:31:59.340191 [debug] [Thread-3 (]: Began compiling node model.customer_churn.stg_customer
[0m00:31:59.340191 [debug] [Thread-4 (]: Began compiling node model.customer_churn.stg_demographic
[0m00:31:59.342201 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer_churn.stg_autoinsurance_churn"
[0m00:31:59.348229 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.stg_customer"
[0m00:31:59.348229 [debug] [Thread-1 (]: Began executing node model.customer_churn.stg_address
[0m00:31:59.352258 [debug] [Thread-4 (]: Writing injected SQL for node "model.customer_churn.stg_demographic"
[0m00:31:59.384154 [debug] [Thread-2 (]: Began executing node model.customer_churn.stg_autoinsurance_churn
[0m00:31:59.403120 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.stg_address"
[0m00:31:59.403120 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer_churn.stg_autoinsurance_churn"
[0m00:31:59.403120 [debug] [Thread-3 (]: Began executing node model.customer_churn.stg_customer
[0m00:31:59.409684 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.stg_customer"
[0m00:31:59.409684 [debug] [Thread-4 (]: Began executing node model.customer_churn.stg_demographic
[0m00:31:59.409684 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.stg_address"
[0m00:31:59.413113 [debug] [Thread-2 (]: Using snowflake connection "model.customer_churn.stg_autoinsurance_churn"
[0m00:31:59.415728 [debug] [Thread-4 (]: Writing runtime sql for node "model.customer_churn.stg_demographic"
[0m00:31:59.415728 [debug] [Thread-1 (]: On model.customer_churn.stg_address: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_address"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_address
  
   as (
    -- models/staging/stg_address.sql

select
  address_id,
  street_address,
  city,
  state,
  county,
  latitude::float as lat,
  longitude::float as lon
from USER_DB_FALCON.RAW.ADDRESS_STAGING
  );
[0m00:31:59.415728 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.stg_customer"
[0m00:31:59.415728 [debug] [Thread-2 (]: On model.customer_churn.stg_autoinsurance_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_autoinsurance_churn"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_autoinsurance_churn
  
   as (
    -- models/staging/stg_autoinsurance_churn.sql

select
  individual_id,
  churn_flag  -- 1=churn, 0=keep
from USER_DB_FALCON.RAW.AUTOINSURANCE_CHURN_STAGING
  );
[0m00:31:59.417924 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:31:59.418798 [debug] [Thread-3 (]: On model.customer_churn.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_customer"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_customer
  
   as (
    -- models/staging/stg_customer.sql

select
  individual_id,
  address_id,
  curr_ann_amt   as annual_premium,
  days_tenure,
  cust_orig_date
from USER_DB_FALCON.RAW.CUSTOMER_STAGING
  );
[0m00:31:59.418798 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:31:59.418798 [debug] [Thread-4 (]: Using snowflake connection "model.customer_churn.stg_demographic"
[0m00:31:59.418798 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:31:59.418798 [debug] [Thread-4 (]: On model.customer_churn.stg_demographic: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_demographic"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_demographic
  
   as (
    select
  INDIVIDUAL_ID,
  AGE_IN_YEARS,
  DATE_OF_BIRTH,
  HAS_CHILDREN,
  MARITAL_STATUS,
  HOME_OWNER,
  HOME_MARKET_VALUE,
  LENGTH_OF_RESIDENCE,
  COLLEGE_DEGREE
from USER_DB_FALCON.RAW.DEMOGRAPHIC_STAGING
  );
[0m00:31:59.418798 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:31:59.836701 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01bc1e44-0305-212a-0004-59ff003a375a
[0m00:31:59.838720 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 8 at position 2
invalid identifier 'CHURN_FLAG'
[0m00:31:59.840739 [debug] [Thread-2 (]: On model.customer_churn.stg_autoinsurance_churn: Close
[0m00:31:59.942450 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01bc1e44-0305-25ed-0004-59ff003b000e
[0m00:31:59.944179 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 2
invalid identifier 'AGE_IN_YEARS'
[0m00:31:59.944179 [debug] [Thread-4 (]: On model.customer_churn.stg_demographic: Close
[0m00:32:00.056308 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.643 seconds
[0m00:32:00.096807 [debug] [Thread-3 (]: On model.customer_churn.stg_customer: Close
[0m00:32:00.096807 [debug] [Thread-4 (]: Database Error in model stg_demographic (models\staging\stg_demographic.sql)
  000904 (42000): SQL compilation error: error line 6 at position 2
  invalid identifier 'AGE_IN_YEARS'
  compiled code at target\run\customer_churn\models\staging\stg_demographic.sql
[0m00:32:00.096807 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fc78b9f-167a-4b66-85bb-7ebfddca8c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280EDD16CC0>]}
[0m00:32:00.096807 [error] [Thread-4 (]: 4 of 6 ERROR creating sql view model RAW_public.stg_demographic ................ [[31mERROR[0m in 0.76s]
[0m00:32:00.096807 [debug] [Thread-4 (]: Finished running node model.customer_churn.stg_demographic
[0m00:32:00.096807 [debug] [Thread-4 (]: Began running node model.customer_churn.stg_termination
[0m00:32:00.096807 [info ] [Thread-4 (]: 5 of 6 START sql view model RAW_public.stg_termination ......................... [RUN]
[0m00:32:00.112937 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.customer_churn.stg_demographic, now model.customer_churn.stg_termination)
[0m00:32:00.112937 [debug] [Thread-4 (]: Began compiling node model.customer_churn.stg_termination
[0m00:32:00.112937 [debug] [Thread-4 (]: Writing injected SQL for node "model.customer_churn.stg_termination"
[0m00:32:00.112937 [debug] [Thread-4 (]: Began executing node model.customer_churn.stg_termination
[0m00:32:00.112937 [debug] [Thread-4 (]: Writing runtime sql for node "model.customer_churn.stg_termination"
[0m00:32:00.112937 [debug] [Thread-4 (]: Using snowflake connection "model.customer_churn.stg_termination"
[0m00:32:00.112937 [debug] [Thread-4 (]: On model.customer_churn.stg_termination: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_termination"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_termination
  
   as (
    select
  individual_id,
  CHURN_FLAG as churn_flag
from USER_DB_FALCON.RAW.AUTOINSURANCE_CHURN_STAGING
  );
[0m00:32:00.112937 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:32:00.146416 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.731 seconds
[0m00:32:00.153842 [debug] [Thread-1 (]: On model.customer_churn.stg_address: Close
[0m00:32:00.242720 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fc78b9f-167a-4b66-85bb-7ebfddca8c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280ED4A7770>]}
[0m00:32:00.242720 [info ] [Thread-3 (]: 3 of 6 OK created sql view model RAW_public.stg_customer ....................... [[32mSUCCESS 1[0m in 0.91s]
[0m00:32:00.242720 [debug] [Thread-3 (]: Finished running node model.customer_churn.stg_customer
[0m00:32:00.249153 [debug] [Thread-3 (]: Began running node model.customer_churn.stg_turning_movement
[0m00:32:00.249153 [info ] [Thread-3 (]: 6 of 6 START sql view model RAW_public.stg_turning_movement .................... [RUN]
[0m00:32:00.249153 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer_churn.stg_customer, now model.customer_churn.stg_turning_movement)
[0m00:32:00.249153 [debug] [Thread-3 (]: Began compiling node model.customer_churn.stg_turning_movement
[0m00:32:00.257411 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.stg_turning_movement"
[0m00:32:00.257411 [debug] [Thread-3 (]: Began executing node model.customer_churn.stg_turning_movement
[0m00:32:00.265642 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.stg_turning_movement"
[0m00:32:00.268087 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.stg_turning_movement"
[0m00:32:00.269647 [debug] [Thread-3 (]: On model.customer_churn.stg_turning_movement: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_turning_movement"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_turning_movement
  
   as (
    -- models/staging/stg_turning_movement.sql

select
  objectid,
  facilityid,
  intid,
  intname,
  nodeno,
  longitude::float as tm_lon,
  latitude::float  as tm_lat
from USER_DB_FALCON.RAW.TURNING_MOVEMENT
  );
[0m00:32:00.269647 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:32:00.286492 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fc78b9f-167a-4b66-85bb-7ebfddca8c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280EDD22630>]}
[0m00:32:00.286492 [info ] [Thread-1 (]: 1 of 6 OK created sql view model RAW_public.stg_address ........................ [[32mSUCCESS 1[0m in 0.97s]
[0m00:32:00.291803 [debug] [Thread-1 (]: Finished running node model.customer_churn.stg_address
[0m00:32:00.345198 [debug] [Thread-2 (]: Database Error in model stg_autoinsurance_churn (models\staging\stg_autoinsurance_churn.sql)
  000904 (42000): SQL compilation error: error line 8 at position 2
  invalid identifier 'CHURN_FLAG'
  compiled code at target\run\customer_churn\models\staging\stg_autoinsurance_churn.sql
[0m00:32:00.345198 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fc78b9f-167a-4b66-85bb-7ebfddca8c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280EDC3D700>]}
[0m00:32:00.345198 [error] [Thread-2 (]: 2 of 6 ERROR creating sql view model RAW_public.stg_autoinsurance_churn ........ [[31mERROR[0m in 1.02s]
[0m00:32:00.345198 [debug] [Thread-2 (]: Finished running node model.customer_churn.stg_autoinsurance_churn
[0m00:32:00.510396 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01bc1e44-0305-20d4-0004-59ff0039cd3e
[0m00:32:00.510396 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 2
invalid identifier 'CHURN_FLAG'
[0m00:32:00.510396 [debug] [Thread-4 (]: On model.customer_churn.stg_termination: Close
[0m00:32:00.637426 [debug] [Thread-4 (]: Database Error in model stg_termination (models\staging\stg_termination.sql)
  000904 (42000): SQL compilation error: error line 6 at position 2
  invalid identifier 'CHURN_FLAG'
  compiled code at target\run\customer_churn\models\staging\stg_termination.sql
[0m00:32:00.637968 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fc78b9f-167a-4b66-85bb-7ebfddca8c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280EDF4A6C0>]}
[0m00:32:00.638518 [error] [Thread-4 (]: 5 of 6 ERROR creating sql view model RAW_public.stg_termination ................ [[31mERROR[0m in 0.53s]
[0m00:32:00.639058 [debug] [Thread-4 (]: Finished running node model.customer_churn.stg_termination
[0m00:32:01.043791 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.777 seconds
[0m00:32:01.051840 [debug] [Thread-3 (]: On model.customer_churn.stg_turning_movement: Close
[0m00:32:01.177988 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fc78b9f-167a-4b66-85bb-7ebfddca8c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280EDCF4C20>]}
[0m00:32:01.180003 [info ] [Thread-3 (]: 6 of 6 OK created sql view model RAW_public.stg_turning_movement ............... [[32mSUCCESS 1[0m in 0.93s]
[0m00:32:01.180003 [debug] [Thread-3 (]: Finished running node model.customer_churn.stg_turning_movement
[0m00:32:01.180003 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:32:01.187988 [debug] [MainThread]: Connection 'list_USER_DB_FALCON' was properly closed.
[0m00:32:01.189323 [debug] [MainThread]: Connection 'list_USER_DB_FALCON_RAW_public' was properly closed.
[0m00:32:01.189829 [debug] [MainThread]: Connection 'model.customer_churn.stg_address' was properly closed.
[0m00:32:01.189829 [debug] [MainThread]: Connection 'model.customer_churn.stg_autoinsurance_churn' was properly closed.
[0m00:32:01.189829 [debug] [MainThread]: Connection 'model.customer_churn.stg_turning_movement' was properly closed.
[0m00:32:01.189829 [debug] [MainThread]: Connection 'model.customer_churn.stg_termination' was properly closed.
[0m00:32:01.189829 [info ] [MainThread]: 
[0m00:32:01.191714 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 3.21 seconds (3.21s).
[0m00:32:01.194884 [debug] [MainThread]: Command end result
[0m00:32:01.221517 [info ] [MainThread]: 
[0m00:32:01.233703 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m00:32:01.233703 [info ] [MainThread]: 
[0m00:32:01.233703 [error] [MainThread]:   Database Error in model stg_demographic (models\staging\stg_demographic.sql)
  000904 (42000): SQL compilation error: error line 6 at position 2
  invalid identifier 'AGE_IN_YEARS'
  compiled code at target\run\customer_churn\models\staging\stg_demographic.sql
[0m00:32:01.233703 [info ] [MainThread]: 
[0m00:32:01.233703 [error] [MainThread]:   Database Error in model stg_autoinsurance_churn (models\staging\stg_autoinsurance_churn.sql)
  000904 (42000): SQL compilation error: error line 8 at position 2
  invalid identifier 'CHURN_FLAG'
  compiled code at target\run\customer_churn\models\staging\stg_autoinsurance_churn.sql
[0m00:32:01.236857 [info ] [MainThread]: 
[0m00:32:01.237737 [error] [MainThread]:   Database Error in model stg_termination (models\staging\stg_termination.sql)
  000904 (42000): SQL compilation error: error line 6 at position 2
  invalid identifier 'CHURN_FLAG'
  compiled code at target\run\customer_churn\models\staging\stg_termination.sql
[0m00:32:01.237737 [info ] [MainThread]: 
[0m00:32:01.237737 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=3 SKIP=0 TOTAL=6
[0m00:32:01.237737 [debug] [MainThread]: Command `dbt run` failed at 00:32:01.237737 after 4.71 seconds
[0m00:32:01.237737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280EB356750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280EB3566C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280EB357A40>]}
[0m00:32:01.237737 [debug] [MainThread]: Flushing usage events
[0m00:35:20.802163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C03E323E60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C03B423920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C03F1F6360>]}


============================== 00:35:20.811037 | aa34fe73-a026-42a2-95d3-f99f1f65989d ==============================
[0m00:35:20.811037 [info ] [MainThread]: Running with dbt=1.8.2
[0m00:35:20.811037 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select staging', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:35:21.283961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa34fe73-a026-42a2-95d3-f99f1f65989d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C03EA473B0>]}
[0m00:35:21.316893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa34fe73-a026-42a2-95d3-f99f1f65989d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C04141A4E0>]}
[0m00:35:21.316893 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m00:35:21.466643 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m00:35:21.579207 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:35:21.579207 [debug] [MainThread]: Partial parsing: updated file: customer_churn://models\staging\stg_demographic.sql
[0m00:35:21.707320 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:35:21.722882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'aa34fe73-a026-42a2-95d3-f99f1f65989d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C04190E7E0>]}
[0m00:35:21.878330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa34fe73-a026-42a2-95d3-f99f1f65989d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0419728A0>]}
[0m00:35:21.949133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa34fe73-a026-42a2-95d3-f99f1f65989d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0417DA8D0>]}
[0m00:35:21.949133 [info ] [MainThread]: Found 11 models, 10 data tests, 7 sources, 459 macros
[0m00:35:21.949133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa34fe73-a026-42a2-95d3-f99f1f65989d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C041568F50>]}
[0m00:35:21.949133 [info ] [MainThread]: 
[0m00:35:21.949133 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:35:21.949133 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON'
[0m00:35:21.967980 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON"
[0m00:35:21.967980 [debug] [ThreadPool]: On list_USER_DB_FALCON: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON"} */
show terse schemas in database USER_DB_FALCON
    limit 10000
[0m00:35:21.967980 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:35:22.702483 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.747 seconds
[0m00:35:22.718231 [debug] [ThreadPool]: On list_USER_DB_FALCON: Close
[0m00:35:22.846306 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON_RAW_public'
[0m00:35:22.862523 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m00:35:22.862523 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show objects in USER_DB_FALCON.RAW_public limit 10000
[0m00:35:22.862523 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:35:23.373621 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.509 seconds
[0m00:35:23.373621 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m00:35:23.517400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa34fe73-a026-42a2-95d3-f99f1f65989d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C04141BDA0>]}
[0m00:35:23.517400 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:35:23.518629 [info ] [MainThread]: 
[0m00:35:23.526181 [debug] [Thread-1 (]: Began running node model.customer_churn.stg_address
[0m00:35:23.526181 [debug] [Thread-2 (]: Began running node model.customer_churn.stg_autoinsurance_churn
[0m00:35:23.526816 [debug] [Thread-3 (]: Began running node model.customer_churn.stg_customer
[0m00:35:23.527904 [debug] [Thread-4 (]: Began running node model.customer_churn.stg_demographic
[0m00:35:23.527496 [info ] [Thread-1 (]: 1 of 6 START sql view model RAW_public.stg_address ............................. [RUN]
[0m00:35:23.528594 [info ] [Thread-2 (]: 2 of 6 START sql view model RAW_public.stg_autoinsurance_churn ................. [RUN]
[0m00:35:23.530607 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.customer_churn.stg_address'
[0m00:35:23.531733 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.customer_churn.stg_autoinsurance_churn'
[0m00:35:23.529337 [info ] [Thread-3 (]: 3 of 6 START sql view model RAW_public.stg_customer ............................ [RUN]
[0m00:35:23.532587 [debug] [Thread-1 (]: Began compiling node model.customer_churn.stg_address
[0m00:35:23.529661 [info ] [Thread-4 (]: 4 of 6 START sql view model RAW_public.stg_demographic ......................... [RUN]
[0m00:35:23.533305 [debug] [Thread-2 (]: Began compiling node model.customer_churn.stg_autoinsurance_churn
[0m00:35:23.533950 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.customer_churn.stg_customer'
[0m00:35:23.540770 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.stg_address"
[0m00:35:23.541444 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.customer_churn.stg_demographic'
[0m00:35:23.544481 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer_churn.stg_autoinsurance_churn"
[0m00:35:23.545206 [debug] [Thread-3 (]: Began compiling node model.customer_churn.stg_customer
[0m00:35:23.546140 [debug] [Thread-4 (]: Began compiling node model.customer_churn.stg_demographic
[0m00:35:23.549935 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.stg_customer"
[0m00:35:23.550671 [debug] [Thread-1 (]: Began executing node model.customer_churn.stg_address
[0m00:35:23.551384 [debug] [Thread-2 (]: Began executing node model.customer_churn.stg_autoinsurance_churn
[0m00:35:23.554738 [debug] [Thread-4 (]: Writing injected SQL for node "model.customer_churn.stg_demographic"
[0m00:35:23.589116 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer_churn.stg_autoinsurance_churn"
[0m00:35:23.589116 [debug] [Thread-3 (]: Began executing node model.customer_churn.stg_customer
[0m00:35:23.593411 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.stg_address"
[0m00:35:23.595237 [debug] [Thread-4 (]: Began executing node model.customer_churn.stg_demographic
[0m00:35:23.598210 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.stg_customer"
[0m00:35:23.598210 [debug] [Thread-4 (]: Writing runtime sql for node "model.customer_churn.stg_demographic"
[0m00:35:23.601411 [debug] [Thread-2 (]: Using snowflake connection "model.customer_churn.stg_autoinsurance_churn"
[0m00:35:23.602147 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.stg_address"
[0m00:35:23.602147 [debug] [Thread-2 (]: On model.customer_churn.stg_autoinsurance_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_autoinsurance_churn"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_autoinsurance_churn
  
   as (
    -- models/staging/stg_autoinsurance_churn.sql

select
  individual_id,
  churn_flag  -- 1=churn, 0=keep
from USER_DB_FALCON.RAW.AUTOINSURANCE_CHURN_STAGING
  );
[0m00:35:23.602147 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.stg_customer"
[0m00:35:23.602147 [debug] [Thread-1 (]: On model.customer_churn.stg_address: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_address"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_address
  
   as (
    -- models/staging/stg_address.sql

select
  address_id,
  street_address,
  city,
  state,
  county,
  latitude::float as lat,
  longitude::float as lon
from USER_DB_FALCON.RAW.ADDRESS_STAGING
  );
[0m00:35:23.602147 [debug] [Thread-4 (]: Using snowflake connection "model.customer_churn.stg_demographic"
[0m00:35:23.602147 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:35:23.602147 [debug] [Thread-3 (]: On model.customer_churn.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_customer"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_customer
  
   as (
    -- models/staging/stg_customer.sql

select
  individual_id,
  address_id,
  curr_ann_amt   as annual_premium,
  days_tenure,
  cust_orig_date
from USER_DB_FALCON.RAW.CUSTOMER_STAGING
  );
[0m00:35:23.602147 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:35:23.602147 [debug] [Thread-4 (]: On model.customer_churn.stg_demographic: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_demographic"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_demographic
  
   as (
    select
  INDIVIDUAL_ID,
  "AGE_IN_YEARS",
  DATE_OF_BIRTH,
  HAS_CHILDREN,
  MARITAL_STATUS,
  HOME_OWNER,
  HOME_MARKET_VALUE,
  LENGTH_OF_RESIDENCE,
  COLLEGE_DEGREE
from USER_DB_FALCON.RAW.DEMOGRAPHIC_STAGING
  );
[0m00:35:23.602147 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:35:23.602147 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:35:24.167366 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01bc1e47-0305-2437-0004-59ff003a46a6
[0m00:35:24.167366 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 8 at position 2
invalid identifier 'CHURN_FLAG'
[0m00:35:24.167366 [debug] [Thread-2 (]: On model.customer_churn.stg_autoinsurance_churn: Close
[0m00:35:24.167366 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01bc1e47-0305-20d4-0004-59ff0039cd56
[0m00:35:24.167366 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 2
invalid identifier 'AGE_IN_YEARS'
[0m00:35:24.167366 [debug] [Thread-4 (]: On model.customer_churn.stg_demographic: Close
[0m00:35:24.308472 [debug] [Thread-4 (]: Database Error in model stg_demographic (models\staging\stg_demographic.sql)
  000904 (42000): SQL compilation error: error line 6 at position 2
  invalid identifier 'AGE_IN_YEARS'
  compiled code at target\run\customer_churn\models\staging\stg_demographic.sql
[0m00:35:24.308472 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa34fe73-a026-42a2-95d3-f99f1f65989d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C041CB1340>]}
[0m00:35:24.308472 [error] [Thread-4 (]: 4 of 6 ERROR creating sql view model RAW_public.stg_demographic ................ [[31mERROR[0m in 0.77s]
[0m00:35:24.308472 [debug] [Thread-4 (]: Finished running node model.customer_churn.stg_demographic
[0m00:35:24.308472 [debug] [Thread-4 (]: Began running node model.customer_churn.stg_termination
[0m00:35:24.308472 [info ] [Thread-4 (]: 5 of 6 START sql view model RAW_public.stg_termination ......................... [RUN]
[0m00:35:24.308472 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.customer_churn.stg_demographic, now model.customer_churn.stg_termination)
[0m00:35:24.308472 [debug] [Thread-4 (]: Began compiling node model.customer_churn.stg_termination
[0m00:35:24.308472 [debug] [Thread-4 (]: Writing injected SQL for node "model.customer_churn.stg_termination"
[0m00:35:24.324239 [debug] [Thread-4 (]: Began executing node model.customer_churn.stg_termination
[0m00:35:24.327442 [debug] [Thread-4 (]: Writing runtime sql for node "model.customer_churn.stg_termination"
[0m00:35:24.329925 [debug] [Thread-4 (]: Using snowflake connection "model.customer_churn.stg_termination"
[0m00:35:24.332660 [debug] [Thread-4 (]: On model.customer_churn.stg_termination: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_termination"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_termination
  
   as (
    select
  individual_id,
  CHURN_FLAG as churn_flag
from USER_DB_FALCON.RAW.AUTOINSURANCE_CHURN_STAGING
  );
[0m00:35:24.332660 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:35:24.349486 [debug] [Thread-2 (]: Database Error in model stg_autoinsurance_churn (models\staging\stg_autoinsurance_churn.sql)
  000904 (42000): SQL compilation error: error line 8 at position 2
  invalid identifier 'CHURN_FLAG'
  compiled code at target\run\customer_churn\models\staging\stg_autoinsurance_churn.sql
[0m00:35:24.349486 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa34fe73-a026-42a2-95d3-f99f1f65989d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C041B8C590>]}
[0m00:35:24.349486 [error] [Thread-2 (]: 2 of 6 ERROR creating sql view model RAW_public.stg_autoinsurance_churn ........ [[31mERROR[0m in 0.82s]
[0m00:35:24.349486 [debug] [Thread-2 (]: Finished running node model.customer_churn.stg_autoinsurance_churn
[0m00:35:24.353258 [debug] [Thread-2 (]: Began running node model.customer_churn.stg_turning_movement
[0m00:35:24.353258 [info ] [Thread-2 (]: 6 of 6 START sql view model RAW_public.stg_turning_movement .................... [RUN]
[0m00:35:24.353258 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer_churn.stg_autoinsurance_churn, now model.customer_churn.stg_turning_movement)
[0m00:35:24.353258 [debug] [Thread-2 (]: Began compiling node model.customer_churn.stg_turning_movement
[0m00:35:24.353258 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer_churn.stg_turning_movement"
[0m00:35:24.353258 [debug] [Thread-2 (]: Began executing node model.customer_churn.stg_turning_movement
[0m00:35:24.363217 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer_churn.stg_turning_movement"
[0m00:35:24.363643 [debug] [Thread-2 (]: Using snowflake connection "model.customer_churn.stg_turning_movement"
[0m00:35:24.363643 [debug] [Thread-2 (]: On model.customer_churn.stg_turning_movement: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_turning_movement"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_turning_movement
  
   as (
    -- models/staging/stg_turning_movement.sql

select
  objectid,
  facilityid,
  intid,
  intname,
  nodeno,
  longitude::float as tm_lon,
  latitude::float  as tm_lat
from USER_DB_FALCON.RAW.TURNING_MOVEMENT
  );
[0m00:35:24.363643 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:35:24.681184 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.074 seconds
[0m00:35:24.736642 [debug] [Thread-3 (]: On model.customer_churn.stg_customer: Close
[0m00:35:24.894840 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa34fe73-a026-42a2-95d3-f99f1f65989d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0413D7770>]}
[0m00:35:24.894840 [info ] [Thread-3 (]: 3 of 6 OK created sql view model RAW_public.stg_customer ....................... [[32mSUCCESS 1[0m in 1.36s]
[0m00:35:24.894840 [debug] [Thread-3 (]: Finished running node model.customer_churn.stg_customer
[0m00:35:24.894840 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.304 seconds
[0m00:35:24.914119 [debug] [Thread-1 (]: On model.customer_churn.stg_address: Close
[0m00:35:24.927891 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01bc1e47-0305-24f3-0004-59ff003af0d2
[0m00:35:24.930847 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 2
invalid identifier 'CHURN_FLAG'
[0m00:35:24.932021 [debug] [Thread-4 (]: On model.customer_churn.stg_termination: Close
[0m00:35:24.993926 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.637 seconds
[0m00:35:24.993926 [debug] [Thread-2 (]: On model.customer_churn.stg_turning_movement: Close
[0m00:35:25.109507 [debug] [Thread-4 (]: Database Error in model stg_termination (models\staging\stg_termination.sql)
  000904 (42000): SQL compilation error: error line 6 at position 2
  invalid identifier 'CHURN_FLAG'
  compiled code at target\run\customer_churn\models\staging\stg_termination.sql
[0m00:35:25.109507 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa34fe73-a026-42a2-95d3-f99f1f65989d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C041E270E0>]}
[0m00:35:25.114290 [error] [Thread-4 (]: 5 of 6 ERROR creating sql view model RAW_public.stg_termination ................ [[31mERROR[0m in 0.80s]
[0m00:35:25.114290 [debug] [Thread-4 (]: Finished running node model.customer_churn.stg_termination
[0m00:35:25.140361 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa34fe73-a026-42a2-95d3-f99f1f65989d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C041BECC20>]}
[0m00:35:25.142902 [info ] [Thread-2 (]: 6 of 6 OK created sql view model RAW_public.stg_turning_movement ............... [[32mSUCCESS 1[0m in 0.79s]
[0m00:35:25.142902 [debug] [Thread-2 (]: Finished running node model.customer_churn.stg_turning_movement
[0m00:35:25.637899 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa34fe73-a026-42a2-95d3-f99f1f65989d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C041CFB050>]}
[0m00:35:25.642937 [info ] [Thread-1 (]: 1 of 6 OK created sql view model RAW_public.stg_address ........................ [[32mSUCCESS 1[0m in 2.11s]
[0m00:35:25.645200 [debug] [Thread-1 (]: Finished running node model.customer_churn.stg_address
[0m00:35:25.649376 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:35:25.649376 [debug] [MainThread]: Connection 'list_USER_DB_FALCON' was properly closed.
[0m00:35:25.649376 [debug] [MainThread]: Connection 'list_USER_DB_FALCON_RAW_public' was properly closed.
[0m00:35:25.649376 [debug] [MainThread]: Connection 'model.customer_churn.stg_address' was properly closed.
[0m00:35:25.649376 [debug] [MainThread]: Connection 'model.customer_churn.stg_turning_movement' was properly closed.
[0m00:35:25.651249 [debug] [MainThread]: Connection 'model.customer_churn.stg_customer' was properly closed.
[0m00:35:25.651249 [debug] [MainThread]: Connection 'model.customer_churn.stg_termination' was properly closed.
[0m00:35:25.651249 [info ] [MainThread]: 
[0m00:35:25.651249 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 3.70 seconds (3.70s).
[0m00:35:25.655567 [debug] [MainThread]: Command end result
[0m00:35:25.704706 [info ] [MainThread]: 
[0m00:35:25.707230 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m00:35:25.708033 [info ] [MainThread]: 
[0m00:35:25.709623 [error] [MainThread]:   Database Error in model stg_demographic (models\staging\stg_demographic.sql)
  000904 (42000): SQL compilation error: error line 6 at position 2
  invalid identifier 'AGE_IN_YEARS'
  compiled code at target\run\customer_churn\models\staging\stg_demographic.sql
[0m00:35:25.711225 [info ] [MainThread]: 
[0m00:35:25.711569 [error] [MainThread]:   Database Error in model stg_autoinsurance_churn (models\staging\stg_autoinsurance_churn.sql)
  000904 (42000): SQL compilation error: error line 8 at position 2
  invalid identifier 'CHURN_FLAG'
  compiled code at target\run\customer_churn\models\staging\stg_autoinsurance_churn.sql
[0m00:35:25.711569 [info ] [MainThread]: 
[0m00:35:25.711569 [error] [MainThread]:   Database Error in model stg_termination (models\staging\stg_termination.sql)
  000904 (42000): SQL compilation error: error line 6 at position 2
  invalid identifier 'CHURN_FLAG'
  compiled code at target\run\customer_churn\models\staging\stg_termination.sql
[0m00:35:25.711569 [info ] [MainThread]: 
[0m00:35:25.711569 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=3 SKIP=0 TOTAL=6
[0m00:35:25.711569 [debug] [MainThread]: Command `dbt run` failed at 00:35:25.711569 after 5.13 seconds
[0m00:35:25.711569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C03F397FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C03EE5C230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C03EE5F560>]}
[0m00:35:25.711569 [debug] [MainThread]: Flushing usage events
[0m00:35:59.387599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256962B7CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256962D3260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256962D31D0>]}


============================== 00:35:59.398407 | 7677974c-896c-4927-9b16-c6dd91951e40 ==============================
[0m00:35:59.398407 [info ] [MainThread]: Running with dbt=1.8.2
[0m00:35:59.398407 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select staging', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:35:59.780299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7677974c-896c-4927-9b16-c6dd91951e40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256964370E0>]}
[0m00:35:59.822641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7677974c-896c-4927-9b16-c6dd91951e40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256981ACC20>]}
[0m00:35:59.823913 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m00:36:00.032157 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m00:36:00.122915 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m00:36:00.122915 [debug] [MainThread]: Partial parsing: updated file: customer_churn://models\staging\stg_termination.sql
[0m00:36:00.122915 [debug] [MainThread]: Partial parsing: updated file: customer_churn://models\staging\stg_autoinsurance_churn.sql
[0m00:36:00.122915 [debug] [MainThread]: Partial parsing: updated file: customer_churn://models\staging\stg_demographic.sql
[0m00:36:00.308515 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:36:00.309153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7677974c-896c-4927-9b16-c6dd91951e40', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256985EDFD0>]}
[0m00:36:00.475479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7677974c-896c-4927-9b16-c6dd91951e40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256989A37A0>]}
[0m00:36:00.550225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7677974c-896c-4927-9b16-c6dd91951e40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025698741D00>]}
[0m00:36:00.550225 [info ] [MainThread]: Found 11 models, 10 data tests, 7 sources, 459 macros
[0m00:36:00.550225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7677974c-896c-4927-9b16-c6dd91951e40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025698526570>]}
[0m00:36:00.550225 [info ] [MainThread]: 
[0m00:36:00.550225 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:36:00.557104 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON'
[0m00:36:00.564967 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON"
[0m00:36:00.564967 [debug] [ThreadPool]: On list_USER_DB_FALCON: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON"} */
show terse schemas in database USER_DB_FALCON
    limit 10000
[0m00:36:00.564967 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:36:01.098718 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.533 seconds
[0m00:36:01.101111 [debug] [ThreadPool]: On list_USER_DB_FALCON: Close
[0m00:36:02.090120 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON_RAW_public'
[0m00:36:02.106175 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m00:36:02.106175 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show objects in USER_DB_FALCON.RAW_public limit 10000
[0m00:36:02.106175 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:36:02.704477 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.590 seconds
[0m00:36:02.708768 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m00:36:02.841967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7677974c-896c-4927-9b16-c6dd91951e40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256952F4E60>]}
[0m00:36:02.841967 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:36:02.841967 [info ] [MainThread]: 
[0m00:36:02.841967 [debug] [Thread-1 (]: Began running node model.customer_churn.stg_address
[0m00:36:02.841967 [debug] [Thread-2 (]: Began running node model.customer_churn.stg_autoinsurance_churn
[0m00:36:02.841967 [info ] [Thread-1 (]: 1 of 6 START sql view model RAW_public.stg_address ............................. [RUN]
[0m00:36:02.850909 [debug] [Thread-3 (]: Began running node model.customer_churn.stg_customer
[0m00:36:02.850909 [debug] [Thread-4 (]: Began running node model.customer_churn.stg_demographic
[0m00:36:02.850909 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.customer_churn.stg_address'
[0m00:36:02.850370 [info ] [Thread-2 (]: 2 of 6 START sql view model RAW_public.stg_autoinsurance_churn ................. [RUN]
[0m00:36:02.850909 [info ] [Thread-3 (]: 3 of 6 START sql view model RAW_public.stg_customer ............................ [RUN]
[0m00:36:02.850909 [debug] [Thread-1 (]: Began compiling node model.customer_churn.stg_address
[0m00:36:02.850909 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.customer_churn.stg_autoinsurance_churn'
[0m00:36:02.850909 [info ] [Thread-4 (]: 4 of 6 START sql view model RAW_public.stg_demographic ......................... [RUN]
[0m00:36:02.850909 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.customer_churn.stg_customer'
[0m00:36:02.858647 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.stg_address"
[0m00:36:02.858647 [debug] [Thread-2 (]: Began compiling node model.customer_churn.stg_autoinsurance_churn
[0m00:36:02.858647 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.customer_churn.stg_demographic'
[0m00:36:02.858647 [debug] [Thread-3 (]: Began compiling node model.customer_churn.stg_customer
[0m00:36:02.867208 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer_churn.stg_autoinsurance_churn"
[0m00:36:02.867208 [debug] [Thread-4 (]: Began compiling node model.customer_churn.stg_demographic
[0m00:36:02.867208 [debug] [Thread-1 (]: Began executing node model.customer_churn.stg_address
[0m00:36:02.871365 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.stg_customer"
[0m00:36:02.872361 [debug] [Thread-4 (]: Writing injected SQL for node "model.customer_churn.stg_demographic"
[0m00:36:02.872361 [debug] [Thread-2 (]: Began executing node model.customer_churn.stg_autoinsurance_churn
[0m00:36:02.903357 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.stg_address"
[0m00:36:02.903357 [debug] [Thread-4 (]: Began executing node model.customer_churn.stg_demographic
[0m00:36:02.903357 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer_churn.stg_autoinsurance_churn"
[0m00:36:02.903357 [debug] [Thread-3 (]: Began executing node model.customer_churn.stg_customer
[0m00:36:02.909425 [debug] [Thread-4 (]: Writing runtime sql for node "model.customer_churn.stg_demographic"
[0m00:36:02.909425 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.stg_address"
[0m00:36:02.915895 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.stg_customer"
[0m00:36:02.916858 [debug] [Thread-2 (]: Using snowflake connection "model.customer_churn.stg_autoinsurance_churn"
[0m00:36:02.916858 [debug] [Thread-1 (]: On model.customer_churn.stg_address: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_address"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_address
  
   as (
    -- models/staging/stg_address.sql

select
  address_id,
  street_address,
  city,
  state,
  county,
  latitude::float as lat,
  longitude::float as lon
from USER_DB_FALCON.RAW.ADDRESS_STAGING
  );
[0m00:36:02.916858 [debug] [Thread-4 (]: Using snowflake connection "model.customer_churn.stg_demographic"
[0m00:36:02.916858 [debug] [Thread-2 (]: On model.customer_churn.stg_autoinsurance_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_autoinsurance_churn"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_autoinsurance_churn
  
   as (
    

select
  individual_id,
  churn              as churn_flag
from USER_DB_FALCON.RAW.AUTOINSURANCE_CHURN_STAGING
  );
[0m00:36:02.916858 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.stg_customer"
[0m00:36:02.924044 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:36:02.924044 [debug] [Thread-4 (]: On model.customer_churn.stg_demographic: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_demographic"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_demographic
  
   as (
    

select
  individual_id,
  income,
  has_children,
  length_of_reside    as length_of_residence,
  marital_status,
  home_owner,
  home_market_val     as home_market_value,
  college_degree,
  good_credit
from USER_DB_FALCON.RAW.DEMOGRAPHIC_STAGING
  );
[0m00:36:02.924044 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:36:02.924044 [debug] [Thread-3 (]: On model.customer_churn.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_customer"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_customer
  
   as (
    -- models/staging/stg_customer.sql

select
  individual_id,
  address_id,
  curr_ann_amt   as annual_premium,
  days_tenure,
  cust_orig_date
from USER_DB_FALCON.RAW.CUSTOMER_STAGING
  );
[0m00:36:02.924044 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:36:02.932479 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:36:03.627970 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01bc1e48-0305-2437-0004-59ff003a46b6
[0m00:36:03.628680 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 10 at position 2
invalid identifier 'LENGTH_OF_RESIDE'
[0m00:36:03.628680 [debug] [Thread-4 (]: On model.customer_churn.stg_demographic: Close
[0m00:36:03.707421 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.784 seconds
[0m00:36:03.727803 [debug] [Thread-1 (]: On model.customer_churn.stg_address: Close
[0m00:36:03.883967 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7677974c-896c-4927-9b16-c6dd91951e40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002569842FC50>]}
[0m00:36:03.886622 [info ] [Thread-1 (]: 1 of 6 OK created sql view model RAW_public.stg_address ........................ [[32mSUCCESS 1[0m in 1.03s]
[0m00:36:03.890494 [debug] [Thread-1 (]: Finished running node model.customer_churn.stg_address
[0m00:36:03.891222 [debug] [Thread-1 (]: Began running node model.customer_churn.stg_termination
[0m00:36:03.894102 [info ] [Thread-1 (]: 5 of 6 START sql view model RAW_public.stg_termination ......................... [RUN]
[0m00:36:03.896155 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer_churn.stg_address, now model.customer_churn.stg_termination)
[0m00:36:03.897304 [debug] [Thread-1 (]: Began compiling node model.customer_churn.stg_termination
[0m00:36:03.905928 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.stg_termination"
[0m00:36:03.906639 [debug] [Thread-1 (]: Began executing node model.customer_churn.stg_termination
[0m00:36:03.909937 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.stg_termination"
[0m00:36:03.911485 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.stg_termination"
[0m00:36:03.912127 [debug] [Thread-1 (]: On model.customer_churn.stg_termination: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_termination"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_termination
  
   as (
    

select
  individual_id,
  acct_suspd_date    as churn_date
from USER_DB_FALCON.RAW.TERMINATION_STAGING
  );
[0m00:36:03.914225 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:36:03.920170 [debug] [Thread-4 (]: Database Error in model stg_demographic (models\staging\stg_demographic.sql)
  000904 (42000): SQL compilation error: error line 10 at position 2
  invalid identifier 'LENGTH_OF_RESIDE'
  compiled code at target\run\customer_churn\models\staging\stg_demographic.sql
[0m00:36:03.920170 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7677974c-896c-4927-9b16-c6dd91951e40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025698D46240>]}
[0m00:36:03.921015 [error] [Thread-4 (]: 4 of 6 ERROR creating sql view model RAW_public.stg_demographic ................ [[31mERROR[0m in 1.06s]
[0m00:36:03.921814 [debug] [Thread-4 (]: Finished running node model.customer_churn.stg_demographic
[0m00:36:03.922569 [debug] [Thread-4 (]: Began running node model.customer_churn.stg_turning_movement
[0m00:36:03.923827 [info ] [Thread-4 (]: 6 of 6 START sql view model RAW_public.stg_turning_movement .................... [RUN]
[0m00:36:03.924394 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.customer_churn.stg_demographic, now model.customer_churn.stg_turning_movement)
[0m00:36:03.925535 [debug] [Thread-4 (]: Began compiling node model.customer_churn.stg_turning_movement
[0m00:36:03.928733 [debug] [Thread-4 (]: Writing injected SQL for node "model.customer_churn.stg_turning_movement"
[0m00:36:03.929423 [debug] [Thread-4 (]: Began executing node model.customer_churn.stg_turning_movement
[0m00:36:03.934267 [debug] [Thread-4 (]: Writing runtime sql for node "model.customer_churn.stg_turning_movement"
[0m00:36:03.936725 [debug] [Thread-4 (]: Using snowflake connection "model.customer_churn.stg_turning_movement"
[0m00:36:03.937524 [debug] [Thread-4 (]: On model.customer_churn.stg_turning_movement: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_turning_movement"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_turning_movement
  
   as (
    -- models/staging/stg_turning_movement.sql

select
  objectid,
  facilityid,
  intid,
  intname,
  nodeno,
  longitude::float as tm_lon,
  latitude::float  as tm_lat
from USER_DB_FALCON.RAW.TURNING_MOVEMENT
  );
[0m00:36:03.937524 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:36:04.290194 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.369 seconds
[0m00:36:04.302504 [debug] [Thread-3 (]: On model.customer_churn.stg_customer: Close
[0m00:36:04.460844 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7677974c-896c-4927-9b16-c6dd91951e40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025698EBC770>]}
[0m00:36:04.460844 [info ] [Thread-3 (]: 3 of 6 OK created sql view model RAW_public.stg_customer ....................... [[32mSUCCESS 1[0m in 1.61s]
[0m00:36:04.460844 [debug] [Thread-3 (]: Finished running node model.customer_churn.stg_customer
[0m00:36:04.484871 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.548 seconds
[0m00:36:04.488909 [debug] [Thread-4 (]: On model.customer_churn.stg_turning_movement: Close
[0m00:36:04.503308 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.586 seconds
[0m00:36:04.514074 [debug] [Thread-2 (]: On model.customer_churn.stg_autoinsurance_churn: Close
[0m00:36:04.648156 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7677974c-896c-4927-9b16-c6dd91951e40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025698EA96A0>]}
[0m00:36:04.648156 [info ] [Thread-2 (]: 2 of 6 OK created sql view model RAW_public.stg_autoinsurance_churn ............ [[32mSUCCESS 1[0m in 1.80s]
[0m00:36:04.648156 [debug] [Thread-2 (]: Finished running node model.customer_churn.stg_autoinsurance_churn
[0m00:36:04.685657 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7677974c-896c-4927-9b16-c6dd91951e40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025698EECA10>]}
[0m00:36:04.685657 [info ] [Thread-4 (]: 6 of 6 OK created sql view model RAW_public.stg_turning_movement ............... [[32mSUCCESS 1[0m in 0.76s]
[0m00:36:04.685657 [debug] [Thread-4 (]: Finished running node model.customer_churn.stg_turning_movement
[0m00:36:05.445578 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.539 seconds
[0m00:36:05.445578 [debug] [Thread-1 (]: On model.customer_churn.stg_termination: Close
[0m00:36:05.586000 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7677974c-896c-4927-9b16-c6dd91951e40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025698ECADE0>]}
[0m00:36:05.586000 [info ] [Thread-1 (]: 5 of 6 OK created sql view model RAW_public.stg_termination .................... [[32mSUCCESS 1[0m in 1.69s]
[0m00:36:05.586000 [debug] [Thread-1 (]: Finished running node model.customer_churn.stg_termination
[0m00:36:05.586000 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:36:05.586000 [debug] [MainThread]: Connection 'list_USER_DB_FALCON' was properly closed.
[0m00:36:05.586000 [debug] [MainThread]: Connection 'list_USER_DB_FALCON_RAW_public' was properly closed.
[0m00:36:05.586000 [debug] [MainThread]: Connection 'model.customer_churn.stg_termination' was properly closed.
[0m00:36:05.586000 [debug] [MainThread]: Connection 'model.customer_churn.stg_autoinsurance_churn' was properly closed.
[0m00:36:05.586000 [debug] [MainThread]: Connection 'model.customer_churn.stg_customer' was properly closed.
[0m00:36:05.586000 [debug] [MainThread]: Connection 'model.customer_churn.stg_turning_movement' was properly closed.
[0m00:36:05.594580 [info ] [MainThread]: 
[0m00:36:05.594580 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 5.04 seconds (5.04s).
[0m00:36:05.594580 [debug] [MainThread]: Command end result
[0m00:36:05.619787 [info ] [MainThread]: 
[0m00:36:05.619787 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:36:05.619787 [info ] [MainThread]: 
[0m00:36:05.619787 [error] [MainThread]:   Database Error in model stg_demographic (models\staging\stg_demographic.sql)
  000904 (42000): SQL compilation error: error line 10 at position 2
  invalid identifier 'LENGTH_OF_RESIDE'
  compiled code at target\run\customer_churn\models\staging\stg_demographic.sql
[0m00:36:05.619787 [info ] [MainThread]: 
[0m00:36:05.619787 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m00:36:05.619787 [debug] [MainThread]: Command `dbt run` failed at 00:36:05.619787 after 6.42 seconds
[0m00:36:05.619787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025690171D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025695FFD970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025695FFDC40>]}
[0m00:36:05.619787 [debug] [MainThread]: Flushing usage events
[0m00:37:05.500174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202DBE47E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202DB0256D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202DB75ACC0>]}


============================== 00:37:05.516161 | 3b43344c-ecdf-47f1-a28d-a86676765b1e ==============================
[0m00:37:05.516161 [info ] [MainThread]: Running with dbt=1.8.2
[0m00:37:05.532152 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt\\logs', 'profiles_dir': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select staging', 'send_anonymous_usage_stats': 'True'}
[0m00:37:05.907083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b43344c-ecdf-47f1-a28d-a86676765b1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202DB69F560>]}
[0m00:37:05.945692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b43344c-ecdf-47f1-a28d-a86676765b1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202DE05A870>]}
[0m00:37:05.946465 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m00:37:06.121018 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m00:37:06.200692 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:37:06.200692 [debug] [MainThread]: Partial parsing: updated file: customer_churn://models\staging\stg_demographic.sql
[0m00:37:06.342336 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:37:06.354121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3b43344c-ecdf-47f1-a28d-a86676765b1e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202DE00C440>]}
[0m00:37:06.513688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b43344c-ecdf-47f1-a28d-a86676765b1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202DE56F560>]}
[0m00:37:06.627506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b43344c-ecdf-47f1-a28d-a86676765b1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202DE4BA510>]}
[0m00:37:06.627506 [info ] [MainThread]: Found 11 models, 10 data tests, 7 sources, 459 macros
[0m00:37:06.627506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b43344c-ecdf-47f1-a28d-a86676765b1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202DE114350>]}
[0m00:37:06.627506 [info ] [MainThread]: 
[0m00:37:06.627506 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:37:06.642793 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON'
[0m00:37:06.658755 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON"
[0m00:37:06.658755 [debug] [ThreadPool]: On list_USER_DB_FALCON: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON"} */
show terse schemas in database USER_DB_FALCON
    limit 10000
[0m00:37:06.658755 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:37:07.404818 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.752 seconds
[0m00:37:07.417934 [debug] [ThreadPool]: On list_USER_DB_FALCON: Close
[0m00:37:07.560691 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON_RAW_public'
[0m00:37:07.569211 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m00:37:07.569211 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show objects in USER_DB_FALCON.RAW_public limit 10000
[0m00:37:07.575440 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:37:08.377952 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.805 seconds
[0m00:37:08.377952 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m00:37:08.522641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b43344c-ecdf-47f1-a28d-a86676765b1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202DE104770>]}
[0m00:37:08.524420 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:37:08.524420 [info ] [MainThread]: 
[0m00:37:08.531705 [debug] [Thread-1 (]: Began running node model.customer_churn.stg_address
[0m00:37:08.531705 [debug] [Thread-2 (]: Began running node model.customer_churn.stg_autoinsurance_churn
[0m00:37:08.531705 [debug] [Thread-3 (]: Began running node model.customer_churn.stg_customer
[0m00:37:08.531705 [debug] [Thread-4 (]: Began running node model.customer_churn.stg_demographic
[0m00:37:08.531705 [info ] [Thread-1 (]: 1 of 6 START sql view model RAW_public.stg_address ............................. [RUN]
[0m00:37:08.531705 [info ] [Thread-2 (]: 2 of 6 START sql view model RAW_public.stg_autoinsurance_churn ................. [RUN]
[0m00:37:08.531705 [info ] [Thread-3 (]: 3 of 6 START sql view model RAW_public.stg_customer ............................ [RUN]
[0m00:37:08.539826 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.customer_churn.stg_address'
[0m00:37:08.531705 [info ] [Thread-4 (]: 4 of 6 START sql view model RAW_public.stg_demographic ......................... [RUN]
[0m00:37:08.541410 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.customer_churn.stg_autoinsurance_churn'
[0m00:37:08.541936 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.customer_churn.stg_customer'
[0m00:37:08.543689 [debug] [Thread-1 (]: Began compiling node model.customer_churn.stg_address
[0m00:37:08.544291 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.customer_churn.stg_demographic'
[0m00:37:08.544813 [debug] [Thread-2 (]: Began compiling node model.customer_churn.stg_autoinsurance_churn
[0m00:37:08.545334 [debug] [Thread-3 (]: Began compiling node model.customer_churn.stg_customer
[0m00:37:08.553049 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.stg_address"
[0m00:37:08.553567 [debug] [Thread-4 (]: Began compiling node model.customer_churn.stg_demographic
[0m00:37:08.556471 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer_churn.stg_autoinsurance_churn"
[0m00:37:08.559623 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.stg_customer"
[0m00:37:08.561998 [debug] [Thread-4 (]: Writing injected SQL for node "model.customer_churn.stg_demographic"
[0m00:37:08.562772 [debug] [Thread-1 (]: Began executing node model.customer_churn.stg_address
[0m00:37:08.584684 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.stg_address"
[0m00:37:08.585253 [debug] [Thread-2 (]: Began executing node model.customer_churn.stg_autoinsurance_churn
[0m00:37:08.585975 [debug] [Thread-3 (]: Began executing node model.customer_churn.stg_customer
[0m00:37:08.586601 [debug] [Thread-4 (]: Began executing node model.customer_churn.stg_demographic
[0m00:37:08.590139 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer_churn.stg_autoinsurance_churn"
[0m00:37:08.591441 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.stg_address"
[0m00:37:08.593496 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.stg_customer"
[0m00:37:08.595901 [debug] [Thread-4 (]: Writing runtime sql for node "model.customer_churn.stg_demographic"
[0m00:37:08.595901 [debug] [Thread-1 (]: On model.customer_churn.stg_address: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_address"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_address
  
   as (
    -- models/staging/stg_address.sql

select
  address_id,
  street_address,
  city,
  state,
  county,
  latitude::float as lat,
  longitude::float as lon
from USER_DB_FALCON.RAW.ADDRESS_STAGING
  );
[0m00:37:08.597216 [debug] [Thread-2 (]: Using snowflake connection "model.customer_churn.stg_autoinsurance_churn"
[0m00:37:08.598266 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.stg_customer"
[0m00:37:08.598266 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:37:08.598980 [debug] [Thread-2 (]: On model.customer_churn.stg_autoinsurance_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_autoinsurance_churn"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_autoinsurance_churn
  
   as (
    

select
  individual_id,
  churn              as churn_flag
from USER_DB_FALCON.RAW.AUTOINSURANCE_CHURN_STAGING
  );
[0m00:37:08.599632 [debug] [Thread-3 (]: On model.customer_churn.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_customer"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_customer
  
   as (
    -- models/staging/stg_customer.sql

select
  individual_id,
  address_id,
  curr_ann_amt   as annual_premium,
  days_tenure,
  cust_orig_date
from USER_DB_FALCON.RAW.CUSTOMER_STAGING
  );
[0m00:37:08.600380 [debug] [Thread-4 (]: Using snowflake connection "model.customer_churn.stg_demographic"
[0m00:37:08.601812 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:37:08.602518 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:37:08.603185 [debug] [Thread-4 (]: On model.customer_churn.stg_demographic: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_demographic"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_demographic
  
   as (
    --- models/staging/stg_demographic.sql
+++ models/staging/stg_demographic.sql
@@
-select
-  individual_id,
-  income,
-  has_children,
-  length_of_reside    as length_of_residence,
-  marital_status,
-  home_owner,
-  home_market_val     as home_market_value,
-  college_degree,
-  good_credit
+select
+  individual_id,
+  income,
+  has_children,
+  length_of_reside   as length_of_residence,  -- use the actual column name
+  marital_status,
+  home_owner,
+  home_market_val    as home_market_value,
+  college_degree,
+  good_credit
 from USER_DB_FALCON.RAW.DEMOGRAPHIC_STAGING
  );
[0m00:37:08.605446 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:37:08.972166 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01bc1e49-0305-25cb-0004-59ff003a8796
[0m00:37:08.972166 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 5 at position 0 unexpected '+'.
[0m00:37:08.972166 [debug] [Thread-4 (]: On model.customer_churn.stg_demographic: Close
[0m00:37:09.098814 [debug] [Thread-4 (]: Database Error in model stg_demographic (models\staging\stg_demographic.sql)
  001003 (42000): SQL compilation error:
  syntax error line 5 at position 0 unexpected '+'.
  compiled code at target\run\customer_churn\models\staging\stg_demographic.sql
[0m00:37:09.098814 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b43344c-ecdf-47f1-a28d-a86676765b1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202DB69F890>]}
[0m00:37:09.098814 [error] [Thread-4 (]: 4 of 6 ERROR creating sql view model RAW_public.stg_demographic ................ [[31mERROR[0m in 0.55s]
[0m00:37:09.098814 [debug] [Thread-4 (]: Finished running node model.customer_churn.stg_demographic
[0m00:37:09.098814 [debug] [Thread-4 (]: Began running node model.customer_churn.stg_termination
[0m00:37:09.098814 [info ] [Thread-4 (]: 5 of 6 START sql view model RAW_public.stg_termination ......................... [RUN]
[0m00:37:09.116001 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.customer_churn.stg_demographic, now model.customer_churn.stg_termination)
[0m00:37:09.116001 [debug] [Thread-4 (]: Began compiling node model.customer_churn.stg_termination
[0m00:37:09.118206 [debug] [Thread-4 (]: Writing injected SQL for node "model.customer_churn.stg_termination"
[0m00:37:09.118206 [debug] [Thread-4 (]: Began executing node model.customer_churn.stg_termination
[0m00:37:09.121638 [debug] [Thread-4 (]: Writing runtime sql for node "model.customer_churn.stg_termination"
[0m00:37:09.123229 [debug] [Thread-4 (]: Using snowflake connection "model.customer_churn.stg_termination"
[0m00:37:09.125031 [debug] [Thread-4 (]: On model.customer_churn.stg_termination: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_termination"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_termination
  
   as (
    

select
  individual_id,
  acct_suspd_date    as churn_date
from USER_DB_FALCON.RAW.TERMINATION_STAGING
  );
[0m00:37:09.125031 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:37:09.261992 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.666 seconds
[0m00:37:09.309223 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.711 seconds
[0m00:37:09.308437 [debug] [Thread-3 (]: On model.customer_churn.stg_customer: Close
[0m00:37:09.314484 [debug] [Thread-1 (]: On model.customer_churn.stg_address: Close
[0m00:37:09.443795 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b43344c-ecdf-47f1-a28d-a86676765b1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202DE8F4E90>]}
[0m00:37:09.443795 [info ] [Thread-1 (]: 1 of 6 OK created sql view model RAW_public.stg_address ........................ [[32mSUCCESS 1[0m in 0.90s]
[0m00:37:09.443795 [debug] [Thread-1 (]: Finished running node model.customer_churn.stg_address
[0m00:37:09.459609 [debug] [Thread-1 (]: Began running node model.customer_churn.stg_turning_movement
[0m00:37:09.459609 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b43344c-ecdf-47f1-a28d-a86676765b1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202DE00FBC0>]}
[0m00:37:09.459609 [info ] [Thread-1 (]: 6 of 6 START sql view model RAW_public.stg_turning_movement .................... [RUN]
[0m00:37:09.459609 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer_churn.stg_address, now model.customer_churn.stg_turning_movement)
[0m00:37:09.459609 [info ] [Thread-3 (]: 3 of 6 OK created sql view model RAW_public.stg_customer ....................... [[32mSUCCESS 1[0m in 0.92s]
[0m00:37:09.467898 [debug] [Thread-1 (]: Began compiling node model.customer_churn.stg_turning_movement
[0m00:37:09.467898 [debug] [Thread-3 (]: Finished running node model.customer_churn.stg_customer
[0m00:37:09.470919 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.stg_turning_movement"
[0m00:37:09.476296 [debug] [Thread-1 (]: Began executing node model.customer_churn.stg_turning_movement
[0m00:37:09.482559 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.stg_turning_movement"
[0m00:37:09.482559 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.stg_turning_movement"
[0m00:37:09.482559 [debug] [Thread-1 (]: On model.customer_churn.stg_turning_movement: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_turning_movement"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_turning_movement
  
   as (
    -- models/staging/stg_turning_movement.sql

select
  objectid,
  facilityid,
  intid,
  intname,
  nodeno,
  longitude::float as tm_lon,
  latitude::float  as tm_lat
from USER_DB_FALCON.RAW.TURNING_MOVEMENT
  );
[0m00:37:09.482559 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:37:09.710141 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.585 seconds
[0m00:37:09.710141 [debug] [Thread-4 (]: On model.customer_churn.stg_termination: Close
[0m00:37:09.849809 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.248 seconds
[0m00:37:09.851467 [debug] [Thread-2 (]: On model.customer_churn.stg_autoinsurance_churn: Close
[0m00:37:09.855689 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b43344c-ecdf-47f1-a28d-a86676765b1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202DEA27140>]}
[0m00:37:09.855689 [info ] [Thread-4 (]: 5 of 6 OK created sql view model RAW_public.stg_termination .................... [[32mSUCCESS 1[0m in 0.74s]
[0m00:37:09.855689 [debug] [Thread-4 (]: Finished running node model.customer_churn.stg_termination
[0m00:37:10.291878 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b43344c-ecdf-47f1-a28d-a86676765b1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202DE923FB0>]}
[0m00:37:10.291878 [info ] [Thread-2 (]: 2 of 6 OK created sql view model RAW_public.stg_autoinsurance_churn ............ [[32mSUCCESS 1[0m in 1.74s]
[0m00:37:10.294042 [debug] [Thread-2 (]: Finished running node model.customer_churn.stg_autoinsurance_churn
[0m00:37:10.308788 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.827 seconds
[0m00:37:10.317028 [debug] [Thread-1 (]: On model.customer_churn.stg_turning_movement: Close
[0m00:37:10.455826 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b43344c-ecdf-47f1-a28d-a86676765b1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202DEA3C4D0>]}
[0m00:37:10.455826 [info ] [Thread-1 (]: 6 of 6 OK created sql view model RAW_public.stg_turning_movement ............... [[32mSUCCESS 1[0m in 1.00s]
[0m00:37:10.455826 [debug] [Thread-1 (]: Finished running node model.customer_churn.stg_turning_movement
[0m00:37:10.455826 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:37:10.455826 [debug] [MainThread]: Connection 'list_USER_DB_FALCON' was properly closed.
[0m00:37:10.455826 [debug] [MainThread]: Connection 'list_USER_DB_FALCON_RAW_public' was properly closed.
[0m00:37:10.455826 [debug] [MainThread]: Connection 'model.customer_churn.stg_turning_movement' was properly closed.
[0m00:37:10.455826 [debug] [MainThread]: Connection 'model.customer_churn.stg_autoinsurance_churn' was properly closed.
[0m00:37:10.455826 [debug] [MainThread]: Connection 'model.customer_churn.stg_customer' was properly closed.
[0m00:37:10.455826 [debug] [MainThread]: Connection 'model.customer_churn.stg_termination' was properly closed.
[0m00:37:10.455826 [info ] [MainThread]: 
[0m00:37:10.471705 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 3.83 seconds (3.83s).
[0m00:37:10.471705 [debug] [MainThread]: Command end result
[0m00:37:10.522953 [info ] [MainThread]: 
[0m00:37:10.522953 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:37:10.522953 [info ] [MainThread]: 
[0m00:37:10.522953 [error] [MainThread]:   Database Error in model stg_demographic (models\staging\stg_demographic.sql)
  001003 (42000): SQL compilation error:
  syntax error line 5 at position 0 unexpected '+'.
  compiled code at target\run\customer_churn\models\staging\stg_demographic.sql
[0m00:37:10.522953 [info ] [MainThread]: 
[0m00:37:10.522953 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m00:37:10.538309 [debug] [MainThread]: Command `dbt run` failed at 00:37:10.538309 after 5.36 seconds
[0m00:37:10.539975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202DBD0CCB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202DBCEA840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202DBCEAF30>]}
[0m00:37:10.539975 [debug] [MainThread]: Flushing usage events
[0m00:37:33.729523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B24D629520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2501754C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B250177C20>]}


============================== 00:37:33.732506 | 4514231f-b1f3-495a-b1c6-6481813e7a47 ==============================
[0m00:37:33.732506 [info ] [MainThread]: Running with dbt=1.8.2
[0m00:37:33.733751 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select staging', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:37:34.182045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4514231f-b1f3-495a-b1c6-6481813e7a47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B250177C20>]}
[0m00:37:34.255553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4514231f-b1f3-495a-b1c6-6481813e7a47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B25235A6C0>]}
[0m00:37:34.258235 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m00:37:34.493917 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m00:37:34.584190 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:37:34.584968 [debug] [MainThread]: Partial parsing: updated file: customer_churn://models\staging\stg_demographic.sql
[0m00:37:34.775477 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:37:34.776585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4514231f-b1f3-495a-b1c6-6481813e7a47', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2524CD760>]}
[0m00:37:34.916848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4514231f-b1f3-495a-b1c6-6481813e7a47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B25286D010>]}
[0m00:37:35.008573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4514231f-b1f3-495a-b1c6-6481813e7a47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B252625E80>]}
[0m00:37:35.008573 [info ] [MainThread]: Found 11 models, 10 data tests, 7 sources, 459 macros
[0m00:37:35.010047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4514231f-b1f3-495a-b1c6-6481813e7a47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B252385C70>]}
[0m00:37:35.011138 [info ] [MainThread]: 
[0m00:37:35.011563 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:37:35.014717 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON'
[0m00:37:35.025017 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON"
[0m00:37:35.025017 [debug] [ThreadPool]: On list_USER_DB_FALCON: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON"} */
show terse schemas in database USER_DB_FALCON
    limit 10000
[0m00:37:35.025701 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:37:35.578651 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.554 seconds
[0m00:37:35.583838 [debug] [ThreadPool]: On list_USER_DB_FALCON: Close
[0m00:37:36.490934 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON_RAW_public'
[0m00:37:36.495938 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m00:37:36.497684 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show objects in USER_DB_FALCON.RAW_public limit 10000
[0m00:37:36.497684 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:37:37.034231 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.536 seconds
[0m00:37:37.038728 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m00:37:37.178411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4514231f-b1f3-495a-b1c6-6481813e7a47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2523856D0>]}
[0m00:37:37.178825 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:37:37.179941 [info ] [MainThread]: 
[0m00:37:37.187855 [debug] [Thread-1 (]: Began running node model.customer_churn.stg_address
[0m00:37:37.189422 [debug] [Thread-2 (]: Began running node model.customer_churn.stg_autoinsurance_churn
[0m00:37:37.189880 [debug] [Thread-3 (]: Began running node model.customer_churn.stg_customer
[0m00:37:37.188308 [info ] [Thread-1 (]: 1 of 6 START sql view model RAW_public.stg_address ............................. [RUN]
[0m00:37:37.192179 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.customer_churn.stg_address'
[0m00:37:37.192614 [debug] [Thread-1 (]: Began compiling node model.customer_churn.stg_address
[0m00:37:37.199815 [debug] [Thread-4 (]: Began running node model.customer_churn.stg_demographic
[0m00:37:37.189880 [info ] [Thread-2 (]: 2 of 6 START sql view model RAW_public.stg_autoinsurance_churn ................. [RUN]
[0m00:37:37.204277 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.stg_address"
[0m00:37:37.204676 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.customer_churn.stg_autoinsurance_churn'
[0m00:37:37.191277 [info ] [Thread-3 (]: 3 of 6 START sql view model RAW_public.stg_customer ............................ [RUN]
[0m00:37:37.200925 [info ] [Thread-4 (]: 4 of 6 START sql view model RAW_public.stg_demographic ......................... [RUN]
[0m00:37:37.207657 [debug] [Thread-2 (]: Began compiling node model.customer_churn.stg_autoinsurance_churn
[0m00:37:37.207657 [debug] [Thread-1 (]: Began executing node model.customer_churn.stg_address
[0m00:37:37.209085 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.customer_churn.stg_customer'
[0m00:37:37.210720 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.customer_churn.stg_demographic'
[0m00:37:37.215114 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer_churn.stg_autoinsurance_churn"
[0m00:37:37.261960 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.stg_address"
[0m00:37:37.263713 [debug] [Thread-3 (]: Began compiling node model.customer_churn.stg_customer
[0m00:37:37.263713 [debug] [Thread-4 (]: Began compiling node model.customer_churn.stg_demographic
[0m00:37:37.271923 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.stg_customer"
[0m00:37:37.272934 [debug] [Thread-2 (]: Began executing node model.customer_churn.stg_autoinsurance_churn
[0m00:37:37.280016 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.stg_address"
[0m00:37:37.278394 [debug] [Thread-4 (]: Writing injected SQL for node "model.customer_churn.stg_demographic"
[0m00:37:37.289169 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer_churn.stg_autoinsurance_churn"
[0m00:37:37.290989 [debug] [Thread-1 (]: On model.customer_churn.stg_address: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_address"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_address
  
   as (
    -- models/staging/stg_address.sql

select
  address_id,
  street_address,
  city,
  state,
  county,
  latitude::float as lat,
  longitude::float as lon
from USER_DB_FALCON.RAW.ADDRESS_STAGING
  );
[0m00:37:37.292864 [debug] [Thread-3 (]: Began executing node model.customer_churn.stg_customer
[0m00:37:37.294184 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:37:37.296041 [debug] [Thread-4 (]: Began executing node model.customer_churn.stg_demographic
[0m00:37:37.302131 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.stg_customer"
[0m00:37:37.303945 [debug] [Thread-2 (]: Using snowflake connection "model.customer_churn.stg_autoinsurance_churn"
[0m00:37:37.314501 [debug] [Thread-4 (]: Writing runtime sql for node "model.customer_churn.stg_demographic"
[0m00:37:37.315843 [debug] [Thread-2 (]: On model.customer_churn.stg_autoinsurance_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_autoinsurance_churn"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_autoinsurance_churn
  
   as (
    

select
  individual_id,
  churn              as churn_flag
from USER_DB_FALCON.RAW.AUTOINSURANCE_CHURN_STAGING
  );
[0m00:37:37.318068 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.stg_customer"
[0m00:37:37.319483 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:37:37.320906 [debug] [Thread-3 (]: On model.customer_churn.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_customer"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_customer
  
   as (
    -- models/staging/stg_customer.sql

select
  individual_id,
  address_id,
  curr_ann_amt   as annual_premium,
  days_tenure,
  cust_orig_date
from USER_DB_FALCON.RAW.CUSTOMER_STAGING
  );
[0m00:37:37.324157 [debug] [Thread-4 (]: Using snowflake connection "model.customer_churn.stg_demographic"
[0m00:37:37.328655 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:37:37.330096 [debug] [Thread-4 (]: On model.customer_churn.stg_demographic: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_demographic"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_demographic
  
   as (
    --- models/staging/stg_demographic.sql
+++ models/staging/stg_demographic.sql
@@
-select
-  individual_id,
-  income,
-  has_children,
-  length_of_reside    as length_of_residence,
-  marital_status,
-  home_owner,
-  home_market_val     as home_market_value,
-  college_degree,
-  good_credit
-select
+  individual_id,
+  income,
+  has_children,
+  length_of_reside   as length_of_residence,  -- use the actual column name
+  marital_status,
+  home_owner,
+  home_market_val    as home_market_value,
+  college_degree,
+  good_credit
 from USER_DB_FALCON.RAW.DEMOGRAPHIC_STAGING
  );
[0m00:37:37.334212 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:37:37.841149 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01bc1e49-0305-21e4-0004-59ff0039bdfa
[0m00:37:37.848962 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 5 at position 0 unexpected '+'.
[0m00:37:37.848962 [debug] [Thread-4 (]: On model.customer_churn.stg_demographic: Close
[0m00:37:37.860250 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.541 seconds
[0m00:37:37.903870 [debug] [Thread-2 (]: On model.customer_churn.stg_autoinsurance_churn: Close
[0m00:37:37.967184 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.639 seconds
[0m00:37:37.969207 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.677 seconds
[0m00:37:37.974775 [debug] [Thread-3 (]: On model.customer_churn.stg_customer: Close
[0m00:37:37.982295 [debug] [Thread-1 (]: On model.customer_churn.stg_address: Close
[0m00:37:38.003894 [debug] [Thread-4 (]: Database Error in model stg_demographic (models\staging\stg_demographic.sql)
  001003 (42000): SQL compilation error:
  syntax error line 5 at position 0 unexpected '+'.
  compiled code at target\run\customer_churn\models\staging\stg_demographic.sql
[0m00:37:38.006644 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4514231f-b1f3-495a-b1c6-6481813e7a47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B252B7BE60>]}
[0m00:37:38.006644 [error] [Thread-4 (]: 4 of 6 ERROR creating sql view model RAW_public.stg_demographic ................ [[31mERROR[0m in 0.79s]
[0m00:37:38.006644 [debug] [Thread-4 (]: Finished running node model.customer_churn.stg_demographic
[0m00:37:38.014307 [debug] [Thread-4 (]: Began running node model.customer_churn.stg_termination
[0m00:37:38.014307 [info ] [Thread-4 (]: 5 of 6 START sql view model RAW_public.stg_termination ......................... [RUN]
[0m00:37:38.014307 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.customer_churn.stg_demographic, now model.customer_churn.stg_termination)
[0m00:37:38.014307 [debug] [Thread-4 (]: Began compiling node model.customer_churn.stg_termination
[0m00:37:38.022398 [debug] [Thread-4 (]: Writing injected SQL for node "model.customer_churn.stg_termination"
[0m00:37:38.022398 [debug] [Thread-4 (]: Began executing node model.customer_churn.stg_termination
[0m00:37:38.022398 [debug] [Thread-4 (]: Writing runtime sql for node "model.customer_churn.stg_termination"
[0m00:37:38.022398 [debug] [Thread-4 (]: Using snowflake connection "model.customer_churn.stg_termination"
[0m00:37:38.022398 [debug] [Thread-4 (]: On model.customer_churn.stg_termination: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_termination"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_termination
  
   as (
    

select
  individual_id,
  acct_suspd_date    as churn_date
from USER_DB_FALCON.RAW.TERMINATION_STAGING
  );
[0m00:37:38.022398 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:37:38.118893 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4514231f-b1f3-495a-b1c6-6481813e7a47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B252BEEC90>]}
[0m00:37:38.127403 [info ] [Thread-3 (]: 3 of 6 OK created sql view model RAW_public.stg_customer ....................... [[32mSUCCESS 1[0m in 0.91s]
[0m00:37:38.127403 [debug] [Thread-3 (]: Finished running node model.customer_churn.stg_customer
[0m00:37:38.127403 [debug] [Thread-3 (]: Began running node model.customer_churn.stg_turning_movement
[0m00:37:38.127403 [info ] [Thread-3 (]: 6 of 6 START sql view model RAW_public.stg_turning_movement .................... [RUN]
[0m00:37:38.135953 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer_churn.stg_customer, now model.customer_churn.stg_turning_movement)
[0m00:37:38.135953 [debug] [Thread-3 (]: Began compiling node model.customer_churn.stg_turning_movement
[0m00:37:38.135953 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.stg_turning_movement"
[0m00:37:38.135953 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4514231f-b1f3-495a-b1c6-6481813e7a47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B252C22120>]}
[0m00:37:38.135953 [debug] [Thread-3 (]: Began executing node model.customer_churn.stg_turning_movement
[0m00:37:38.135953 [info ] [Thread-1 (]: 1 of 6 OK created sql view model RAW_public.stg_address ........................ [[32mSUCCESS 1[0m in 0.94s]
[0m00:37:38.149240 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.stg_turning_movement"
[0m00:37:38.149240 [debug] [Thread-1 (]: Finished running node model.customer_churn.stg_address
[0m00:37:38.152413 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.stg_turning_movement"
[0m00:37:38.152413 [debug] [Thread-3 (]: On model.customer_churn.stg_turning_movement: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_turning_movement"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_turning_movement
  
   as (
    -- models/staging/stg_turning_movement.sql

select
  objectid,
  facilityid,
  intid,
  intname,
  nodeno,
  longitude::float as tm_lon,
  latitude::float  as tm_lat
from USER_DB_FALCON.RAW.TURNING_MOVEMENT
  );
[0m00:37:38.152413 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:37:38.824018 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4514231f-b1f3-495a-b1c6-6481813e7a47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2523178F0>]}
[0m00:37:38.825752 [info ] [Thread-2 (]: 2 of 6 OK created sql view model RAW_public.stg_autoinsurance_churn ............ [[32mSUCCESS 1[0m in 1.62s]
[0m00:37:38.827908 [debug] [Thread-2 (]: Finished running node model.customer_churn.stg_autoinsurance_churn
[0m00:37:38.860272 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.830 seconds
[0m00:37:38.863425 [debug] [Thread-4 (]: On model.customer_churn.stg_termination: Close
[0m00:37:39.439062 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.285 seconds
[0m00:37:39.441503 [debug] [Thread-3 (]: On model.customer_churn.stg_turning_movement: Close
[0m00:37:39.984213 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4514231f-b1f3-495a-b1c6-6481813e7a47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2523178F0>]}
[0m00:37:39.984213 [info ] [Thread-4 (]: 5 of 6 OK created sql view model RAW_public.stg_termination .................... [[32mSUCCESS 1[0m in 1.97s]
[0m00:37:39.986094 [debug] [Thread-4 (]: Finished running node model.customer_churn.stg_termination
[0m00:37:40.395589 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4514231f-b1f3-495a-b1c6-6481813e7a47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B252AC58E0>]}
[0m00:37:40.399515 [info ] [Thread-3 (]: 6 of 6 OK created sql view model RAW_public.stg_turning_movement ............... [[32mSUCCESS 1[0m in 2.27s]
[0m00:37:40.402398 [debug] [Thread-3 (]: Finished running node model.customer_churn.stg_turning_movement
[0m00:37:40.406914 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:37:40.407421 [debug] [MainThread]: Connection 'list_USER_DB_FALCON' was properly closed.
[0m00:37:40.408506 [debug] [MainThread]: Connection 'list_USER_DB_FALCON_RAW_public' was properly closed.
[0m00:37:40.408506 [debug] [MainThread]: Connection 'model.customer_churn.stg_address' was properly closed.
[0m00:37:40.408506 [debug] [MainThread]: Connection 'model.customer_churn.stg_autoinsurance_churn' was properly closed.
[0m00:37:40.410269 [debug] [MainThread]: Connection 'model.customer_churn.stg_turning_movement' was properly closed.
[0m00:37:40.410269 [debug] [MainThread]: Connection 'model.customer_churn.stg_termination' was properly closed.
[0m00:37:40.412063 [info ] [MainThread]: 
[0m00:37:40.413857 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 5.40 seconds (5.40s).
[0m00:37:40.415867 [debug] [MainThread]: Command end result
[0m00:37:40.465038 [info ] [MainThread]: 
[0m00:37:40.466739 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:37:40.467259 [info ] [MainThread]: 
[0m00:37:40.468305 [error] [MainThread]:   Database Error in model stg_demographic (models\staging\stg_demographic.sql)
  001003 (42000): SQL compilation error:
  syntax error line 5 at position 0 unexpected '+'.
  compiled code at target\run\customer_churn\models\staging\stg_demographic.sql
[0m00:37:40.468305 [info ] [MainThread]: 
[0m00:37:40.468305 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m00:37:40.468305 [debug] [MainThread]: Command `dbt run` failed at 00:37:40.468305 after 7.24 seconds
[0m00:37:40.468305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B25030FEF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B250340BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B24A011D00>]}
[0m00:37:40.468305 [debug] [MainThread]: Flushing usage events
[0m00:38:18.010346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002559EC56990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002559EBB1D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002559E4AEFF0>]}


============================== 00:38:18.016408 | 48fbe43f-3155-4f95-ba5e-8d2ea610c9c6 ==============================
[0m00:38:18.016408 [info ] [MainThread]: Running with dbt=1.8.2
[0m00:38:18.016408 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt', 'log_path': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select staging', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:38:18.401450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '48fbe43f-3155-4f95-ba5e-8d2ea610c9c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002559F2E8A40>]}
[0m00:38:18.433100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '48fbe43f-3155-4f95-ba5e-8d2ea610c9c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255A084CC20>]}
[0m00:38:18.433100 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m00:38:18.589960 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m00:38:18.700252 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:38:18.700252 [debug] [MainThread]: Partial parsing: updated file: customer_churn://models\staging\stg_demographic.sql
[0m00:38:18.868180 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:38:18.869617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '48fbe43f-3155-4f95-ba5e-8d2ea610c9c6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255A0F91490>]}
[0m00:38:19.042870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '48fbe43f-3155-4f95-ba5e-8d2ea610c9c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255A0FDABA0>]}
[0m00:38:19.107806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '48fbe43f-3155-4f95-ba5e-8d2ea610c9c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255A13B15E0>]}
[0m00:38:19.107806 [info ] [MainThread]: Found 11 models, 10 data tests, 7 sources, 459 macros
[0m00:38:19.107806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48fbe43f-3155-4f95-ba5e-8d2ea610c9c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255A0F37A40>]}
[0m00:38:19.123424 [info ] [MainThread]: 
[0m00:38:19.123424 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:38:19.123424 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON'
[0m00:38:19.131042 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON"
[0m00:38:19.131042 [debug] [ThreadPool]: On list_USER_DB_FALCON: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON"} */
show terse schemas in database USER_DB_FALCON
    limit 10000
[0m00:38:19.131042 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:38:19.602991 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.472 seconds
[0m00:38:19.611100 [debug] [ThreadPool]: On list_USER_DB_FALCON: Close
[0m00:38:20.090347 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON_RAW_public'
[0m00:38:20.107741 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m00:38:20.107741 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show objects in USER_DB_FALCON.RAW_public limit 10000
[0m00:38:20.107741 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:38:20.726341 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.619 seconds
[0m00:38:20.742270 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m00:38:20.901121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48fbe43f-3155-4f95-ba5e-8d2ea610c9c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255A13B17F0>]}
[0m00:38:20.901121 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:38:20.901121 [info ] [MainThread]: 
[0m00:38:20.906124 [debug] [Thread-1 (]: Began running node model.customer_churn.stg_address
[0m00:38:20.906124 [debug] [Thread-2 (]: Began running node model.customer_churn.stg_autoinsurance_churn
[0m00:38:20.906124 [debug] [Thread-3 (]: Began running node model.customer_churn.stg_customer
[0m00:38:20.906124 [debug] [Thread-4 (]: Began running node model.customer_churn.stg_demographic
[0m00:38:20.906124 [info ] [Thread-1 (]: 1 of 6 START sql view model RAW_public.stg_address ............................. [RUN]
[0m00:38:20.906124 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.customer_churn.stg_address'
[0m00:38:20.906124 [debug] [Thread-1 (]: Began compiling node model.customer_churn.stg_address
[0m00:38:20.906124 [info ] [Thread-2 (]: 2 of 6 START sql view model RAW_public.stg_autoinsurance_churn ................. [RUN]
[0m00:38:20.913562 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.stg_address"
[0m00:38:20.906124 [info ] [Thread-3 (]: 3 of 6 START sql view model RAW_public.stg_customer ............................ [RUN]
[0m00:38:20.913562 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.customer_churn.stg_autoinsurance_churn'
[0m00:38:20.906124 [info ] [Thread-4 (]: 4 of 6 START sql view model RAW_public.stg_demographic ......................... [RUN]
[0m00:38:20.913562 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.customer_churn.stg_customer'
[0m00:38:20.913562 [debug] [Thread-2 (]: Began compiling node model.customer_churn.stg_autoinsurance_churn
[0m00:38:20.913562 [debug] [Thread-1 (]: Began executing node model.customer_churn.stg_address
[0m00:38:20.913562 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.customer_churn.stg_demographic'
[0m00:38:20.913562 [debug] [Thread-3 (]: Began compiling node model.customer_churn.stg_customer
[0m00:38:20.920164 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer_churn.stg_autoinsurance_churn"
[0m00:38:20.936433 [debug] [Thread-4 (]: Began compiling node model.customer_churn.stg_demographic
[0m00:38:20.946676 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.stg_customer"
[0m00:38:20.960217 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.stg_address"
[0m00:38:20.962752 [debug] [Thread-4 (]: Writing injected SQL for node "model.customer_churn.stg_demographic"
[0m00:38:20.964330 [debug] [Thread-2 (]: Began executing node model.customer_churn.stg_autoinsurance_churn
[0m00:38:20.964330 [debug] [Thread-3 (]: Began executing node model.customer_churn.stg_customer
[0m00:38:20.964916 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.stg_address"
[0m00:38:20.967540 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer_churn.stg_autoinsurance_churn"
[0m00:38:20.968295 [debug] [Thread-4 (]: Began executing node model.customer_churn.stg_demographic
[0m00:38:20.969773 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.stg_customer"
[0m00:38:20.969773 [debug] [Thread-1 (]: On model.customer_churn.stg_address: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_address"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_address
  
   as (
    -- models/staging/stg_address.sql

select
  address_id,
  street_address,
  city,
  state,
  county,
  latitude::float as lat,
  longitude::float as lon
from USER_DB_FALCON.RAW.ADDRESS_STAGING
  );
[0m00:38:20.969773 [debug] [Thread-4 (]: Writing runtime sql for node "model.customer_churn.stg_demographic"
[0m00:38:20.977005 [debug] [Thread-2 (]: Using snowflake connection "model.customer_churn.stg_autoinsurance_churn"
[0m00:38:20.978818 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:38:20.979706 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.stg_customer"
[0m00:38:20.979706 [debug] [Thread-2 (]: On model.customer_churn.stg_autoinsurance_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_autoinsurance_churn"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_autoinsurance_churn
  
   as (
    

select
  individual_id,
  churn              as churn_flag
from USER_DB_FALCON.RAW.AUTOINSURANCE_CHURN_STAGING
  );
[0m00:38:20.979706 [debug] [Thread-4 (]: Using snowflake connection "model.customer_churn.stg_demographic"
[0m00:38:20.979706 [debug] [Thread-3 (]: On model.customer_churn.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_customer"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_customer
  
   as (
    -- models/staging/stg_customer.sql

select
  individual_id,
  address_id,
  curr_ann_amt   as annual_premium,
  days_tenure,
  cust_orig_date
from USER_DB_FALCON.RAW.CUSTOMER_STAGING
  );
[0m00:38:20.979706 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:38:20.979706 [debug] [Thread-4 (]: On model.customer_churn.stg_demographic: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_demographic"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_demographic
  
   as (
    

select
  individual_id,
  income,
  has_children,
  length_of_reside    as length_of_residence,
  marital_status,
  home_owner,
  home_market_val     as home_market_value,
  college_degree,
  good_credit
from USER_DB_FALCON.RAW.DEMOGRAPHIC_STAGING
  );
[0m00:38:20.979706 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:38:20.979706 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:38:21.433524 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01bc1e4a-0305-21e4-0004-59ff0039be02
[0m00:38:21.433524 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 10 at position 2
invalid identifier 'LENGTH_OF_RESIDE'
[0m00:38:21.433524 [debug] [Thread-4 (]: On model.customer_churn.stg_demographic: Close
[0m00:38:21.525986 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.537 seconds
[0m00:38:21.543953 [debug] [Thread-3 (]: On model.customer_churn.stg_customer: Close
[0m00:38:21.569172 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.587 seconds
[0m00:38:21.569172 [debug] [Thread-2 (]: On model.customer_churn.stg_autoinsurance_churn: Close
[0m00:38:21.601363 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.625 seconds
[0m00:38:21.601363 [debug] [Thread-1 (]: On model.customer_churn.stg_address: Close
[0m00:38:21.872811 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48fbe43f-3155-4f95-ba5e-8d2ea610c9c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002559E4AF7A0>]}
[0m00:38:21.872811 [info ] [Thread-1 (]: 1 of 6 OK created sql view model RAW_public.stg_address ........................ [[32mSUCCESS 1[0m in 0.97s]
[0m00:38:21.888553 [debug] [Thread-4 (]: Database Error in model stg_demographic (models\staging\stg_demographic.sql)
  000904 (42000): SQL compilation error: error line 10 at position 2
  invalid identifier 'LENGTH_OF_RESIDE'
  compiled code at target\run\customer_churn\models\staging\stg_demographic.sql
[0m00:38:21.888553 [debug] [Thread-1 (]: Finished running node model.customer_churn.stg_address
[0m00:38:21.888553 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48fbe43f-3155-4f95-ba5e-8d2ea610c9c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255A15D3B60>]}
[0m00:38:21.888553 [debug] [Thread-1 (]: Began running node model.customer_churn.stg_termination
[0m00:38:21.888553 [error] [Thread-4 (]: 4 of 6 ERROR creating sql view model RAW_public.stg_demographic ................ [[31mERROR[0m in 0.97s]
[0m00:38:21.888553 [debug] [Thread-4 (]: Finished running node model.customer_churn.stg_demographic
[0m00:38:21.888553 [info ] [Thread-1 (]: 5 of 6 START sql view model RAW_public.stg_termination ......................... [RUN]
[0m00:38:21.902997 [debug] [Thread-4 (]: Began running node model.customer_churn.stg_turning_movement
[0m00:38:21.902997 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer_churn.stg_address, now model.customer_churn.stg_termination)
[0m00:38:21.907016 [info ] [Thread-4 (]: 6 of 6 START sql view model RAW_public.stg_turning_movement .................... [RUN]
[0m00:38:21.907016 [debug] [Thread-1 (]: Began compiling node model.customer_churn.stg_termination
[0m00:38:21.911208 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.customer_churn.stg_demographic, now model.customer_churn.stg_turning_movement)
[0m00:38:21.917035 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.stg_termination"
[0m00:38:21.917858 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48fbe43f-3155-4f95-ba5e-8d2ea610c9c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255A1746960>]}
[0m00:38:21.917858 [debug] [Thread-4 (]: Began compiling node model.customer_churn.stg_turning_movement
[0m00:38:21.917858 [info ] [Thread-2 (]: 2 of 6 OK created sql view model RAW_public.stg_autoinsurance_churn ............ [[32mSUCCESS 1[0m in 1.00s]
[0m00:38:21.925867 [debug] [Thread-4 (]: Writing injected SQL for node "model.customer_churn.stg_turning_movement"
[0m00:38:21.931271 [debug] [Thread-2 (]: Finished running node model.customer_churn.stg_autoinsurance_churn
[0m00:38:21.931271 [debug] [Thread-1 (]: Began executing node model.customer_churn.stg_termination
[0m00:38:21.940010 [debug] [Thread-4 (]: Began executing node model.customer_churn.stg_turning_movement
[0m00:38:21.940010 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.stg_termination"
[0m00:38:21.948053 [debug] [Thread-4 (]: Writing runtime sql for node "model.customer_churn.stg_turning_movement"
[0m00:38:21.948053 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.stg_termination"
[0m00:38:21.948053 [debug] [Thread-1 (]: On model.customer_churn.stg_termination: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_termination"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_termination
  
   as (
    

select
  individual_id,
  acct_suspd_date    as churn_date
from USER_DB_FALCON.RAW.TERMINATION_STAGING
  );
[0m00:38:21.948053 [debug] [Thread-4 (]: Using snowflake connection "model.customer_churn.stg_turning_movement"
[0m00:38:21.948053 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:38:21.955964 [debug] [Thread-4 (]: On model.customer_churn.stg_turning_movement: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_turning_movement"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_turning_movement
  
   as (
    -- models/staging/stg_turning_movement.sql

select
  objectid,
  facilityid,
  intid,
  intname,
  nodeno,
  longitude::float as tm_lon,
  latitude::float  as tm_lat
from USER_DB_FALCON.RAW.TURNING_MOVEMENT
  );
[0m00:38:21.955964 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:38:22.147973 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48fbe43f-3155-4f95-ba5e-8d2ea610c9c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255A0E43B30>]}
[0m00:38:22.147973 [info ] [Thread-3 (]: 3 of 6 OK created sql view model RAW_public.stg_customer ....................... [[32mSUCCESS 1[0m in 1.23s]
[0m00:38:22.147973 [debug] [Thread-3 (]: Finished running node model.customer_churn.stg_customer
[0m00:38:22.581425 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.626 seconds
[0m00:38:22.582162 [debug] [Thread-1 (]: On model.customer_churn.stg_termination: Close
[0m00:38:22.597366 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.640 seconds
[0m00:38:22.597366 [debug] [Thread-4 (]: On model.customer_churn.stg_turning_movement: Close
[0m00:38:22.693098 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48fbe43f-3155-4f95-ba5e-8d2ea610c9c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255A186C1A0>]}
[0m00:38:22.693098 [info ] [Thread-1 (]: 5 of 6 OK created sql view model RAW_public.stg_termination .................... [[32mSUCCESS 1[0m in 0.79s]
[0m00:38:22.693098 [debug] [Thread-1 (]: Finished running node model.customer_churn.stg_termination
[0m00:38:22.725211 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48fbe43f-3155-4f95-ba5e-8d2ea610c9c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002559E4AF7A0>]}
[0m00:38:22.725211 [info ] [Thread-4 (]: 6 of 6 OK created sql view model RAW_public.stg_turning_movement ............... [[32mSUCCESS 1[0m in 0.81s]
[0m00:38:22.730371 [debug] [Thread-4 (]: Finished running node model.customer_churn.stg_turning_movement
[0m00:38:22.731336 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:38:22.731336 [debug] [MainThread]: Connection 'list_USER_DB_FALCON' was properly closed.
[0m00:38:22.731336 [debug] [MainThread]: Connection 'list_USER_DB_FALCON_RAW_public' was properly closed.
[0m00:38:22.731336 [debug] [MainThread]: Connection 'model.customer_churn.stg_termination' was properly closed.
[0m00:38:22.731336 [debug] [MainThread]: Connection 'model.customer_churn.stg_autoinsurance_churn' was properly closed.
[0m00:38:22.731336 [debug] [MainThread]: Connection 'model.customer_churn.stg_customer' was properly closed.
[0m00:38:22.731336 [debug] [MainThread]: Connection 'model.customer_churn.stg_turning_movement' was properly closed.
[0m00:38:22.731336 [info ] [MainThread]: 
[0m00:38:22.731336 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 3.61 seconds (3.61s).
[0m00:38:22.731336 [debug] [MainThread]: Command end result
[0m00:38:22.763727 [info ] [MainThread]: 
[0m00:38:22.766282 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:38:22.766282 [info ] [MainThread]: 
[0m00:38:22.766282 [error] [MainThread]:   Database Error in model stg_demographic (models\staging\stg_demographic.sql)
  000904 (42000): SQL compilation error: error line 10 at position 2
  invalid identifier 'LENGTH_OF_RESIDE'
  compiled code at target\run\customer_churn\models\staging\stg_demographic.sql
[0m00:38:22.770061 [info ] [MainThread]: 
[0m00:38:22.770061 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m00:38:22.770061 [debug] [MainThread]: Command `dbt run` failed at 00:38:22.770061 after 5.03 seconds
[0m00:38:22.770061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255A0D524B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002559E0F6A20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002559E0F4500>]}
[0m00:38:22.770061 [debug] [MainThread]: Flushing usage events
[0m00:39:53.124059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002656AE37E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002656AE87170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002656AE85730>]}


============================== 00:39:53.127381 | 1a711cea-3f1c-47f3-8c0c-3863984e3a6a ==============================
[0m00:39:53.127381 [info ] [MainThread]: Running with dbt=1.8.2
[0m00:39:53.127998 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select staging', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:39:53.540730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a711cea-3f1c-47f3-8c0c-3863984e3a6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002656AFB4AD0>]}
[0m00:39:53.620820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a711cea-3f1c-47f3-8c0c-3863984e3a6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002656D09A7B0>]}
[0m00:39:53.620820 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m00:39:53.780462 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m00:39:53.917655 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:39:53.918666 [debug] [MainThread]: Partial parsing: updated file: customer_churn://models\staging\stg_demographic.sql
[0m00:39:54.112018 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:39:54.112560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1a711cea-3f1c-47f3-8c0c-3863984e3a6a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002656D1838F0>]}
[0m00:39:54.341730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a711cea-3f1c-47f3-8c0c-3863984e3a6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002656D69C440>]}
[0m00:39:54.411386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a711cea-3f1c-47f3-8c0c-3863984e3a6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002656D553680>]}
[0m00:39:54.411386 [info ] [MainThread]: Found 11 models, 10 data tests, 7 sources, 459 macros
[0m00:39:54.411386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a711cea-3f1c-47f3-8c0c-3863984e3a6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002656D1B08F0>]}
[0m00:39:54.411386 [info ] [MainThread]: 
[0m00:39:54.411386 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:39:54.411386 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON'
[0m00:39:54.428885 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON"
[0m00:39:54.430483 [debug] [ThreadPool]: On list_USER_DB_FALCON: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON"} */
show terse schemas in database USER_DB_FALCON
    limit 10000
[0m00:39:54.430483 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:39:55.054610 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.624 seconds
[0m00:39:55.056313 [debug] [ThreadPool]: On list_USER_DB_FALCON: Close
[0m00:39:55.178574 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON_RAW_public'
[0m00:39:55.195761 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m00:39:55.197772 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show objects in USER_DB_FALCON.RAW_public limit 10000
[0m00:39:55.197772 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:39:55.655718 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.458 seconds
[0m00:39:55.658993 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m00:39:55.783933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a711cea-3f1c-47f3-8c0c-3863984e3a6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002656D09A1E0>]}
[0m00:39:55.784938 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:39:55.786091 [info ] [MainThread]: 
[0m00:39:55.793285 [debug] [Thread-1 (]: Began running node model.customer_churn.stg_address
[0m00:39:55.795141 [debug] [Thread-2 (]: Began running node model.customer_churn.stg_autoinsurance_churn
[0m00:39:55.796152 [debug] [Thread-3 (]: Began running node model.customer_churn.stg_customer
[0m00:39:55.793730 [info ] [Thread-1 (]: 1 of 6 START sql view model RAW_public.stg_address ............................. [RUN]
[0m00:39:55.796589 [debug] [Thread-4 (]: Began running node model.customer_churn.stg_demographic
[0m00:39:55.797953 [info ] [Thread-2 (]: 2 of 6 START sql view model RAW_public.stg_autoinsurance_churn ................. [RUN]
[0m00:39:55.799726 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.customer_churn.stg_address'
[0m00:39:55.798717 [info ] [Thread-3 (]: 3 of 6 START sql view model RAW_public.stg_customer ............................ [RUN]
[0m00:39:55.801125 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.customer_churn.stg_autoinsurance_churn'
[0m00:39:55.801125 [info ] [Thread-4 (]: 4 of 6 START sql view model RAW_public.stg_demographic ......................... [RUN]
[0m00:39:55.802585 [debug] [Thread-1 (]: Began compiling node model.customer_churn.stg_address
[0m00:39:55.803593 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.customer_churn.stg_customer'
[0m00:39:55.804017 [debug] [Thread-2 (]: Began compiling node model.customer_churn.stg_autoinsurance_churn
[0m00:39:55.805047 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.customer_churn.stg_demographic'
[0m00:39:55.813873 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.stg_address"
[0m00:39:55.814274 [debug] [Thread-3 (]: Began compiling node model.customer_churn.stg_customer
[0m00:39:55.818508 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer_churn.stg_autoinsurance_churn"
[0m00:39:55.818954 [debug] [Thread-4 (]: Began compiling node model.customer_churn.stg_demographic
[0m00:39:55.822837 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.stg_customer"
[0m00:39:55.825441 [debug] [Thread-4 (]: Writing injected SQL for node "model.customer_churn.stg_demographic"
[0m00:39:55.826417 [debug] [Thread-1 (]: Began executing node model.customer_churn.stg_address
[0m00:39:55.826417 [debug] [Thread-2 (]: Began executing node model.customer_churn.stg_autoinsurance_churn
[0m00:39:55.828139 [debug] [Thread-3 (]: Began executing node model.customer_churn.stg_customer
[0m00:39:55.860543 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.stg_address"
[0m00:39:55.863962 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer_churn.stg_autoinsurance_churn"
[0m00:39:55.865835 [debug] [Thread-4 (]: Began executing node model.customer_churn.stg_demographic
[0m00:39:55.867665 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.stg_customer"
[0m00:39:55.871198 [debug] [Thread-4 (]: Writing runtime sql for node "model.customer_churn.stg_demographic"
[0m00:39:55.871198 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.stg_address"
[0m00:39:55.872699 [debug] [Thread-2 (]: Using snowflake connection "model.customer_churn.stg_autoinsurance_churn"
[0m00:39:55.873086 [debug] [Thread-1 (]: On model.customer_churn.stg_address: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_address"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_address
  
   as (
    -- models/staging/stg_address.sql

select
  address_id,
  street_address,
  city,
  state,
  county,
  latitude::float as lat,
  longitude::float as lon
from USER_DB_FALCON.RAW.ADDRESS_STAGING
  );
[0m00:39:55.874102 [debug] [Thread-4 (]: Using snowflake connection "model.customer_churn.stg_demographic"
[0m00:39:55.874102 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.stg_customer"
[0m00:39:55.874102 [debug] [Thread-2 (]: On model.customer_churn.stg_autoinsurance_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_autoinsurance_churn"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_autoinsurance_churn
  
   as (
    

select
  individual_id,
  churn              as churn_flag
from USER_DB_FALCON.RAW.AUTOINSURANCE_CHURN_STAGING
  );
[0m00:39:55.874102 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:39:55.874102 [debug] [Thread-4 (]: On model.customer_churn.stg_demographic: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_demographic"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_demographic
  
   as (
    

select
  individual_id,
  income,
  has_children,
  length_of_residence    as length_of_residence,  -- exact match
  marital_status,
  home_owner,
  home_market_value      as home_market_value,
  college_degree,
  good_credit
from USER_DB_FALCON.RAW.DEMOGRAPHIC_STAGING
  );
[0m00:39:55.874102 [debug] [Thread-3 (]: On model.customer_churn.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_customer"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_customer
  
   as (
    -- models/staging/stg_customer.sql

select
  individual_id,
  address_id,
  curr_ann_amt   as annual_premium,
  days_tenure,
  cust_orig_date
from USER_DB_FALCON.RAW.CUSTOMER_STAGING
  );
[0m00:39:55.874102 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:39:55.874102 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:39:55.879089 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:39:56.517249 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.641 seconds
[0m00:39:56.536474 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.657 seconds
[0m00:39:56.539846 [debug] [Thread-3 (]: On model.customer_churn.stg_customer: Close
[0m00:39:56.542168 [debug] [Thread-1 (]: On model.customer_churn.stg_address: Close
[0m00:39:56.551962 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.674 seconds
[0m00:39:56.555966 [debug] [Thread-4 (]: On model.customer_churn.stg_demographic: Close
[0m00:39:57.139869 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a711cea-3f1c-47f3-8c0c-3863984e3a6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002656D04FB00>]}
[0m00:39:57.141243 [info ] [Thread-3 (]: 3 of 6 OK created sql view model RAW_public.stg_customer ....................... [[32mSUCCESS 1[0m in 1.34s]
[0m00:39:57.142249 [debug] [Thread-3 (]: Finished running node model.customer_churn.stg_customer
[0m00:39:57.142732 [debug] [Thread-3 (]: Began running node model.customer_churn.stg_termination
[0m00:39:57.142732 [info ] [Thread-3 (]: 5 of 6 START sql view model RAW_public.stg_termination ......................... [RUN]
[0m00:39:57.143737 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer_churn.stg_customer, now model.customer_churn.stg_termination)
[0m00:39:57.143737 [debug] [Thread-3 (]: Began compiling node model.customer_churn.stg_termination
[0m00:39:57.145910 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.stg_termination"
[0m00:39:57.145910 [debug] [Thread-3 (]: Began executing node model.customer_churn.stg_termination
[0m00:39:57.148732 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.stg_termination"
[0m00:39:57.149164 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.stg_termination"
[0m00:39:57.149164 [debug] [Thread-3 (]: On model.customer_churn.stg_termination: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_termination"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_termination
  
   as (
    

select
  individual_id,
  acct_suspd_date    as churn_date
from USER_DB_FALCON.RAW.TERMINATION_STAGING
  );
[0m00:39:57.150247 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:39:57.230768 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.353 seconds
[0m00:39:57.231876 [debug] [Thread-2 (]: On model.customer_churn.stg_autoinsurance_churn: Close
[0m00:39:57.231876 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a711cea-3f1c-47f3-8c0c-3863984e3a6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002656D69DAF0>]}
[0m00:39:57.239984 [info ] [Thread-1 (]: 1 of 6 OK created sql view model RAW_public.stg_address ........................ [[32mSUCCESS 1[0m in 1.43s]
[0m00:39:57.241391 [debug] [Thread-1 (]: Finished running node model.customer_churn.stg_address
[0m00:39:57.241391 [debug] [Thread-1 (]: Began running node model.customer_churn.stg_turning_movement
[0m00:39:57.242398 [info ] [Thread-1 (]: 6 of 6 START sql view model RAW_public.stg_turning_movement .................... [RUN]
[0m00:39:57.242398 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer_churn.stg_address, now model.customer_churn.stg_turning_movement)
[0m00:39:57.244214 [debug] [Thread-1 (]: Began compiling node model.customer_churn.stg_turning_movement
[0m00:39:57.246378 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.stg_turning_movement"
[0m00:39:57.247383 [debug] [Thread-1 (]: Began executing node model.customer_churn.stg_turning_movement
[0m00:39:57.250082 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.stg_turning_movement"
[0m00:39:57.250082 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.stg_turning_movement"
[0m00:39:57.251929 [debug] [Thread-1 (]: On model.customer_churn.stg_turning_movement: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_turning_movement"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_turning_movement
  
   as (
    -- models/staging/stg_turning_movement.sql

select
  objectid,
  facilityid,
  intid,
  intname,
  nodeno,
  longitude::float as tm_lon,
  latitude::float  as tm_lat
from USER_DB_FALCON.RAW.TURNING_MOVEMENT
  );
[0m00:39:57.252360 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:39:57.274442 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a711cea-3f1c-47f3-8c0c-3863984e3a6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002656D945DF0>]}
[0m00:39:57.276037 [info ] [Thread-4 (]: 4 of 6 OK created sql view model RAW_public.stg_demographic .................... [[32mSUCCESS 1[0m in 1.47s]
[0m00:39:57.277283 [debug] [Thread-4 (]: Finished running node model.customer_churn.stg_demographic
[0m00:39:57.946733 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.696 seconds
[0m00:39:57.946733 [debug] [Thread-1 (]: On model.customer_churn.stg_turning_movement: Close
[0m00:39:57.946733 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a711cea-3f1c-47f3-8c0c-3863984e3a6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002656D7EC9B0>]}
[0m00:39:57.957379 [info ] [Thread-2 (]: 2 of 6 OK created sql view model RAW_public.stg_autoinsurance_churn ............ [[32mSUCCESS 1[0m in 2.15s]
[0m00:39:57.957379 [debug] [Thread-2 (]: Finished running node model.customer_churn.stg_autoinsurance_churn
[0m00:39:58.105316 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a711cea-3f1c-47f3-8c0c-3863984e3a6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002656D870C80>]}
[0m00:39:58.111059 [info ] [Thread-1 (]: 6 of 6 OK created sql view model RAW_public.stg_turning_movement ............... [[32mSUCCESS 1[0m in 0.86s]
[0m00:39:58.111059 [debug] [Thread-1 (]: Finished running node model.customer_churn.stg_turning_movement
[0m00:39:58.587088 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.437 seconds
[0m00:39:58.589092 [debug] [Thread-3 (]: On model.customer_churn.stg_termination: Close
[0m00:39:58.942700 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a711cea-3f1c-47f3-8c0c-3863984e3a6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002656D774590>]}
[0m00:39:58.944906 [info ] [Thread-3 (]: 5 of 6 OK created sql view model RAW_public.stg_termination .................... [[32mSUCCESS 1[0m in 1.80s]
[0m00:39:58.945996 [debug] [Thread-3 (]: Finished running node model.customer_churn.stg_termination
[0m00:39:58.947557 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:39:58.948073 [debug] [MainThread]: Connection 'list_USER_DB_FALCON' was properly closed.
[0m00:39:58.948073 [debug] [MainThread]: Connection 'list_USER_DB_FALCON_RAW_public' was properly closed.
[0m00:39:58.948590 [debug] [MainThread]: Connection 'model.customer_churn.stg_turning_movement' was properly closed.
[0m00:39:58.948590 [debug] [MainThread]: Connection 'model.customer_churn.stg_autoinsurance_churn' was properly closed.
[0m00:39:58.949141 [debug] [MainThread]: Connection 'model.customer_churn.stg_termination' was properly closed.
[0m00:39:58.949141 [debug] [MainThread]: Connection 'model.customer_churn.stg_demographic' was properly closed.
[0m00:39:58.949682 [info ] [MainThread]: 
[0m00:39:58.950327 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 4.54 seconds (4.54s).
[0m00:39:58.951908 [debug] [MainThread]: Command end result
[0m00:39:58.997153 [info ] [MainThread]: 
[0m00:39:58.997153 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:39:58.998157 [info ] [MainThread]: 
[0m00:39:58.998157 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m00:39:58.999841 [debug] [MainThread]: Command `dbt run` succeeded at 00:39:58.999841 after 6.16 seconds
[0m00:39:58.999841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002656AF8BE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002656B512480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002656AAC70B0>]}
[0m00:39:58.999841 [debug] [MainThread]: Flushing usage events
[0m00:40:55.586553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3C2842570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3C21E3110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3BF323C50>]}


============================== 00:40:55.586553 | 849b2236-164e-4f29-9ac7-14998044a5af ==============================
[0m00:40:55.586553 [info ] [MainThread]: Running with dbt=1.8.2
[0m00:40:55.586553 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select intermediate', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:40:55.987681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '849b2236-164e-4f29-9ac7-14998044a5af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3C2E6C7D0>]}
[0m00:40:56.024028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '849b2236-164e-4f29-9ac7-14998044a5af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3C4DE0F20>]}
[0m00:40:56.024028 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m00:40:56.338669 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m00:40:56.419627 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:40:56.419627 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:40:56.452363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '849b2236-164e-4f29-9ac7-14998044a5af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3C508EF60>]}
[0m00:40:56.530417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '849b2236-164e-4f29-9ac7-14998044a5af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3C54459D0>]}
[0m00:40:56.530417 [info ] [MainThread]: Found 11 models, 10 data tests, 7 sources, 459 macros
[0m00:40:56.530417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '849b2236-164e-4f29-9ac7-14998044a5af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3C53F5970>]}
[0m00:40:56.530417 [info ] [MainThread]: 
[0m00:40:56.530417 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:40:56.530417 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON'
[0m00:40:56.530417 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON"
[0m00:40:56.530417 [debug] [ThreadPool]: On list_USER_DB_FALCON: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON"} */
show terse schemas in database USER_DB_FALCON
    limit 10000
[0m00:40:56.530417 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:40:57.145535 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.600 seconds
[0m00:40:57.145535 [debug] [ThreadPool]: On list_USER_DB_FALCON: Close
[0m00:40:57.273474 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON_RAW_public'
[0m00:40:57.289378 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m00:40:57.289378 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show objects in USER_DB_FALCON.RAW_public limit 10000
[0m00:40:57.289378 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:40:57.732492 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.450 seconds
[0m00:40:57.732492 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m00:40:57.886864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '849b2236-164e-4f29-9ac7-14998044a5af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3C57BFDA0>]}
[0m00:40:57.886864 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:40:57.886864 [info ] [MainThread]: 
[0m00:40:57.894170 [debug] [Thread-1 (]: Began running node model.customer_churn.int_customer_enriched
[0m00:40:57.894170 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW_public.int_customer_enriched ................... [RUN]
[0m00:40:57.894170 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.customer_churn.int_customer_enriched'
[0m00:40:57.894170 [debug] [Thread-1 (]: Began compiling node model.customer_churn.int_customer_enriched
[0m00:40:57.923608 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.int_customer_enriched"
[0m00:40:57.926277 [debug] [Thread-1 (]: Began executing node model.customer_churn.int_customer_enriched
[0m00:40:57.956814 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.int_customer_enriched"
[0m00:40:57.956814 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.int_customer_enriched"
[0m00:40:57.956814 [debug] [Thread-1 (]: On model.customer_churn.int_customer_enriched: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.int_customer_enriched"} */
create or replace   view USER_DB_FALCON.RAW_public.int_customer_enriched
  
   as (
    -- models/intermediate/int_customer_enriched.sql


with cust as (
  select * from USER_DB_FALCON.RAW_public.stg_customer
),
addr as (
  select * from USER_DB_FALCON.RAW_public.stg_address
),
demo as (
  select * from USER_DB_FALCON.RAW_public.stg_demographic
)

select
  cust.individual_id,
  cust.annual_premium,
  cust.days_tenure,
  cust.cust_orig_date,
  demo.age_in_years,
  demo.marital_status,
  demo.has_children,
  demo.home_owner,
  demo.home_market_value,
  demo.length_of_residence,
  addr.city,
  addr.state,
  addr.county,
  addr.lat,
  addr.lon
from cust
left join demo using (individual_id)
left join addr using (address_id);
[0m00:40:57.956814 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:40:58.316326 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bc1e4c-0305-2374-0004-59ff0039ddb6
[0m00:40:58.316326 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 35 at position 33 unexpected ';'.
[0m00:40:58.316326 [debug] [Thread-1 (]: On model.customer_churn.int_customer_enriched: Close
[0m00:40:58.442717 [debug] [Thread-1 (]: Database Error in model int_customer_enriched (models\intermediate\int_customer_enriched.sql)
  001003 (42000): SQL compilation error:
  syntax error line 35 at position 33 unexpected ';'.
  compiled code at target\run\customer_churn\models\intermediate\int_customer_enriched.sql
[0m00:40:58.458461 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '849b2236-164e-4f29-9ac7-14998044a5af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3C58B3B60>]}
[0m00:40:58.458461 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW_public.int_customer_enriched .......... [[31mERROR[0m in 0.55s]
[0m00:40:58.458461 [debug] [Thread-1 (]: Finished running node model.customer_churn.int_customer_enriched
[0m00:40:58.458461 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:40:58.458461 [debug] [MainThread]: Connection 'list_USER_DB_FALCON' was properly closed.
[0m00:40:58.458461 [debug] [MainThread]: Connection 'list_USER_DB_FALCON_RAW_public' was properly closed.
[0m00:40:58.458461 [debug] [MainThread]: Connection 'model.customer_churn.int_customer_enriched' was properly closed.
[0m00:40:58.458461 [info ] [MainThread]: 
[0m00:40:58.474635 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.93 seconds (1.93s).
[0m00:40:58.474635 [debug] [MainThread]: Command end result
[0m00:40:58.541760 [info ] [MainThread]: 
[0m00:40:58.541760 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:40:58.541760 [info ] [MainThread]: 
[0m00:40:58.541760 [error] [MainThread]:   Database Error in model int_customer_enriched (models\intermediate\int_customer_enriched.sql)
  001003 (42000): SQL compilation error:
  syntax error line 35 at position 33 unexpected ';'.
  compiled code at target\run\customer_churn\models\intermediate\int_customer_enriched.sql
[0m00:40:58.541760 [info ] [MainThread]: 
[0m00:40:58.541760 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:40:58.554717 [debug] [MainThread]: Command `dbt run` failed at 00:40:58.554717 after 3.21 seconds
[0m00:40:58.554717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3C323BB00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3C323BD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3C323BB30>]}
[0m00:40:58.556758 [debug] [MainThread]: Flushing usage events
[0m00:41:13.402615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CE5421C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CE5659610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CE4E5F0B0>]}


============================== 00:41:13.417751 | aae4f778-ba85-4c24-9069-9e41fc5e604d ==============================
[0m00:41:13.417751 [info ] [MainThread]: Running with dbt=1.8.2
[0m00:41:13.417751 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt', 'log_path': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select intermediate', 'send_anonymous_usage_stats': 'True'}
[0m00:41:13.859947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aae4f778-ba85-4c24-9069-9e41fc5e604d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CE56916A0>]}
[0m00:41:13.908942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aae4f778-ba85-4c24-9069-9e41fc5e604d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CE6F44500>]}
[0m00:41:13.908942 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m00:41:14.108443 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m00:41:14.211791 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:41:14.212979 [debug] [MainThread]: Partial parsing: updated file: customer_churn://models\intermediate\int_customer_enriched.sql
[0m00:41:14.549547 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:41:14.549547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'aae4f778-ba85-4c24-9069-9e41fc5e604d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CE7871EE0>]}
[0m00:41:14.851133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aae4f778-ba85-4c24-9069-9e41fc5e604d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CE472D8B0>]}
[0m00:41:14.956698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aae4f778-ba85-4c24-9069-9e41fc5e604d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CE7C7C080>]}
[0m00:41:14.956698 [info ] [MainThread]: Found 11 models, 10 data tests, 7 sources, 459 macros
[0m00:41:14.956698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aae4f778-ba85-4c24-9069-9e41fc5e604d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CE792E720>]}
[0m00:41:14.956698 [info ] [MainThread]: 
[0m00:41:14.956698 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:41:14.956698 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON'
[0m00:41:14.974546 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON"
[0m00:41:14.974546 [debug] [ThreadPool]: On list_USER_DB_FALCON: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON"} */
show terse schemas in database USER_DB_FALCON
    limit 10000
[0m00:41:14.974546 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:41:15.569245 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.601 seconds
[0m00:41:15.569245 [debug] [ThreadPool]: On list_USER_DB_FALCON: Close
[0m00:41:15.721164 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON_RAW_public'
[0m00:41:15.745754 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m00:41:15.745754 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show objects in USER_DB_FALCON.RAW_public limit 10000
[0m00:41:15.746844 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:41:16.348554 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.607 seconds
[0m00:41:16.355952 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m00:41:16.486994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aae4f778-ba85-4c24-9069-9e41fc5e604d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CE7C7C080>]}
[0m00:41:16.492028 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:41:16.492718 [info ] [MainThread]: 
[0m00:41:16.499741 [debug] [Thread-1 (]: Began running node model.customer_churn.int_customer_enriched
[0m00:41:16.499741 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW_public.int_customer_enriched ................... [RUN]
[0m00:41:16.499741 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.customer_churn.int_customer_enriched'
[0m00:41:16.499741 [debug] [Thread-1 (]: Began compiling node model.customer_churn.int_customer_enriched
[0m00:41:16.515821 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.int_customer_enriched"
[0m00:41:16.515821 [debug] [Thread-1 (]: Began executing node model.customer_churn.int_customer_enriched
[0m00:41:16.547332 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.int_customer_enriched"
[0m00:41:16.547332 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.int_customer_enriched"
[0m00:41:16.547332 [debug] [Thread-1 (]: On model.customer_churn.int_customer_enriched: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.int_customer_enriched"} */
create or replace   view USER_DB_FALCON.RAW_public.int_customer_enriched
  
   as (
    -- models/intermediate/int_customer_enriched.sql


with cust as (
  select * from USER_DB_FALCON.RAW_public.stg_customer
),
addr as (
  select * from USER_DB_FALCON.RAW_public.stg_address
),
demo as (
  select * from USER_DB_FALCON.RAW_public.stg_demographic
)

select
  cust.individual_id,
  cust.annual_premium,
  cust.days_tenure,
  cust.cust_orig_date,
  demo.age_in_years,
  demo.marital_status,
  demo.has_children,
  demo.home_owner,
  demo.home_market_value,
  demo.length_of_residence,
  addr.city,
  addr.state,
  addr.county,
  addr.lat,
  addr.lon
from cust
left join demo using (individual_id)
left join addr using (address_id)
  );
[0m00:41:16.547332 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:41:17.280467 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bc1e4d-0305-2374-0004-59ff0039ddba
[0m00:41:17.280467 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 22 at position 2
invalid identifier 'DEMO.AGE_IN_YEARS'
[0m00:41:17.280467 [debug] [Thread-1 (]: On model.customer_churn.int_customer_enriched: Close
[0m00:41:17.432875 [debug] [Thread-1 (]: Database Error in model int_customer_enriched (models\intermediate\int_customer_enriched.sql)
  000904 (42000): SQL compilation error: error line 22 at position 2
  invalid identifier 'DEMO.AGE_IN_YEARS'
  compiled code at target\run\customer_churn\models\intermediate\int_customer_enriched.sql
[0m00:41:17.432875 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aae4f778-ba85-4c24-9069-9e41fc5e604d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CE4E5F710>]}
[0m00:41:17.432875 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW_public.int_customer_enriched .......... [[31mERROR[0m in 0.93s]
[0m00:41:17.448723 [debug] [Thread-1 (]: Finished running node model.customer_churn.int_customer_enriched
[0m00:41:17.449759 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:41:17.449759 [debug] [MainThread]: Connection 'list_USER_DB_FALCON' was properly closed.
[0m00:41:17.449759 [debug] [MainThread]: Connection 'list_USER_DB_FALCON_RAW_public' was properly closed.
[0m00:41:17.449759 [debug] [MainThread]: Connection 'model.customer_churn.int_customer_enriched' was properly closed.
[0m00:41:17.449759 [info ] [MainThread]: 
[0m00:41:17.449759 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.49 seconds (2.49s).
[0m00:41:17.449759 [debug] [MainThread]: Command end result
[0m00:41:17.473500 [info ] [MainThread]: 
[0m00:41:17.473500 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:41:17.476681 [info ] [MainThread]: 
[0m00:41:17.476681 [error] [MainThread]:   Database Error in model int_customer_enriched (models\intermediate\int_customer_enriched.sql)
  000904 (42000): SQL compilation error: error line 22 at position 2
  invalid identifier 'DEMO.AGE_IN_YEARS'
  compiled code at target\run\customer_churn\models\intermediate\int_customer_enriched.sql
[0m00:41:17.476681 [info ] [MainThread]: 
[0m00:41:17.476681 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:41:17.476681 [debug] [MainThread]: Command `dbt run` failed at 00:41:17.476681 after 4.24 seconds
[0m00:41:17.476681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CE5607620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CE56254C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CE78C20C0>]}
[0m00:41:17.480786 [debug] [MainThread]: Flushing usage events
[0m00:42:38.452995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002660F6C85C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002661210EFC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002661210F680>]}


============================== 00:42:38.461606 | b6c0cbea-8985-4fb1-a2ab-6e89dd23ba3b ==============================
[0m00:42:38.461606 [info ] [MainThread]: Running with dbt=1.8.2
[0m00:42:38.461606 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select intermediate', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:42:39.052777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6c0cbea-8985-4fb1-a2ab-6e89dd23ba3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026614AC7A70>]}
[0m00:42:39.097263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6c0cbea-8985-4fb1-a2ab-6e89dd23ba3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266149C0BC0>]}
[0m00:42:39.098359 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m00:42:39.267043 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m00:42:39.366117 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:42:39.366117 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:42:39.401305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6c0cbea-8985-4fb1-a2ab-6e89dd23ba3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026614BDE3F0>]}
[0m00:42:39.496770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6c0cbea-8985-4fb1-a2ab-6e89dd23ba3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026614E44FE0>]}
[0m00:42:39.496770 [info ] [MainThread]: Found 11 models, 10 data tests, 7 sources, 459 macros
[0m00:42:39.496770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6c0cbea-8985-4fb1-a2ab-6e89dd23ba3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026614F68D10>]}
[0m00:42:39.496770 [info ] [MainThread]: 
[0m00:42:39.496770 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:42:39.496770 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON'
[0m00:42:39.514378 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON"
[0m00:42:39.516243 [debug] [ThreadPool]: On list_USER_DB_FALCON: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON"} */
show terse schemas in database USER_DB_FALCON
    limit 10000
[0m00:42:39.516243 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:42:40.668725 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.154 seconds
[0m00:42:40.668725 [debug] [ThreadPool]: On list_USER_DB_FALCON: Close
[0m00:42:40.860873 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON_RAW_public'
[0m00:42:40.876900 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m00:42:40.876900 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show objects in USER_DB_FALCON.RAW_public limit 10000
[0m00:42:40.876900 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:42:42.158090 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.278 seconds
[0m00:42:42.158090 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m00:42:42.284493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6c0cbea-8985-4fb1-a2ab-6e89dd23ba3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026614F465A0>]}
[0m00:42:42.284493 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:42:42.300654 [info ] [MainThread]: 
[0m00:42:42.300654 [debug] [Thread-1 (]: Began running node model.customer_churn.int_customer_enriched
[0m00:42:42.300654 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW_public.int_customer_enriched ................... [RUN]
[0m00:42:42.300654 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.customer_churn.int_customer_enriched'
[0m00:42:42.316518 [debug] [Thread-1 (]: Began compiling node model.customer_churn.int_customer_enriched
[0m00:42:42.324773 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.int_customer_enriched"
[0m00:42:42.333008 [debug] [Thread-1 (]: Began executing node model.customer_churn.int_customer_enriched
[0m00:42:42.359695 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.int_customer_enriched"
[0m00:42:42.374513 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.int_customer_enriched"
[0m00:42:42.374513 [debug] [Thread-1 (]: On model.customer_churn.int_customer_enriched: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.int_customer_enriched"} */
create or replace   view USER_DB_FALCON.RAW_public.int_customer_enriched
  
   as (
    -- models/intermediate/int_customer_enriched.sql


with cust as (
  select * from USER_DB_FALCON.RAW_public.stg_customer
),
addr as (
  select * from USER_DB_FALCON.RAW_public.stg_address
),
demo as (
  select * from USER_DB_FALCON.RAW_public.stg_demographic
)

select
  cust.individual_id,
  cust.annual_premium,
  cust.days_tenure,
  cust.cust_orig_date,
  demo.age_in_years,
  demo.marital_status,
  demo.has_children,
  demo.home_owner,
  demo.home_market_value,
  demo.length_of_residence,
  addr.city,
  addr.state,
  addr.county,
  addr.lat,
  addr.lon
from cust
left join demo using (individual_id)
left join addr using (address_id)
  );
[0m00:42:42.374513 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:42:43.200007 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bc1e4e-0305-2437-0004-59ff003a46e2
[0m00:42:43.200007 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 22 at position 2
invalid identifier 'DEMO.AGE_IN_YEARS'
[0m00:42:43.200007 [debug] [Thread-1 (]: On model.customer_churn.int_customer_enriched: Close
[0m00:42:43.359660 [debug] [Thread-1 (]: Database Error in model int_customer_enriched (models\intermediate\int_customer_enriched.sql)
  000904 (42000): SQL compilation error: error line 22 at position 2
  invalid identifier 'DEMO.AGE_IN_YEARS'
  compiled code at target\run\customer_churn\models\intermediate\int_customer_enriched.sql
[0m00:42:43.359660 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6c0cbea-8985-4fb1-a2ab-6e89dd23ba3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002661210F770>]}
[0m00:42:43.359660 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW_public.int_customer_enriched .......... [[31mERROR[0m in 1.06s]
[0m00:42:43.359660 [debug] [Thread-1 (]: Finished running node model.customer_churn.int_customer_enriched
[0m00:42:43.375691 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:42:43.375691 [debug] [MainThread]: Connection 'list_USER_DB_FALCON' was properly closed.
[0m00:42:43.375691 [debug] [MainThread]: Connection 'list_USER_DB_FALCON_RAW_public' was properly closed.
[0m00:42:43.375691 [debug] [MainThread]: Connection 'model.customer_churn.int_customer_enriched' was properly closed.
[0m00:42:43.379329 [info ] [MainThread]: 
[0m00:42:43.379329 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.88 seconds (3.88s).
[0m00:42:43.383178 [debug] [MainThread]: Command end result
[0m00:42:43.439357 [info ] [MainThread]: 
[0m00:42:43.443244 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:42:43.443244 [info ] [MainThread]: 
[0m00:42:43.443244 [error] [MainThread]:   Database Error in model int_customer_enriched (models\intermediate\int_customer_enriched.sql)
  000904 (42000): SQL compilation error: error line 22 at position 2
  invalid identifier 'DEMO.AGE_IN_YEARS'
  compiled code at target\run\customer_churn\models\intermediate\int_customer_enriched.sql
[0m00:42:43.443244 [info ] [MainThread]: 
[0m00:42:43.443244 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:42:43.443244 [debug] [MainThread]: Command `dbt run` failed at 00:42:43.443244 after 5.28 seconds
[0m00:42:43.443244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002660F6C85C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026614F6B020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026614F6B890>]}
[0m00:42:43.443244 [debug] [MainThread]: Flushing usage events
[0m00:43:17.706625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C37C8B95B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C37E5E6900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C37934F860>]}


============================== 00:43:17.714012 | de40ce00-b992-40c1-9d9b-fa2600939882 ==============================
[0m00:43:17.714012 [info ] [MainThread]: Running with dbt=1.8.2
[0m00:43:17.715519 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select intermediate', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:43:18.077617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de40ce00-b992-40c1-9d9b-fa2600939882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C3016D7A70>]}
[0m00:43:18.119701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'de40ce00-b992-40c1-9d9b-fa2600939882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C3016D73B0>]}
[0m00:43:18.119701 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m00:43:18.278426 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m00:43:18.371606 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:43:18.371606 [debug] [MainThread]: Partial parsing: updated file: customer_churn://models\intermediate\int_customer_enriched.sql
[0m00:43:18.534573 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:43:18.534573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'de40ce00-b992-40c1-9d9b-fa2600939882', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C3017EAC60>]}
[0m00:43:18.807638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de40ce00-b992-40c1-9d9b-fa2600939882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C301B60AD0>]}
[0m00:43:18.890555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de40ce00-b992-40c1-9d9b-fa2600939882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C301973170>]}
[0m00:43:18.890555 [info ] [MainThread]: Found 11 models, 10 data tests, 7 sources, 459 macros
[0m00:43:18.890555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de40ce00-b992-40c1-9d9b-fa2600939882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C301A7C230>]}
[0m00:43:18.890555 [info ] [MainThread]: 
[0m00:43:18.890555 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:43:18.890555 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON'
[0m00:43:18.906204 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON"
[0m00:43:18.906204 [debug] [ThreadPool]: On list_USER_DB_FALCON: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON"} */
show terse schemas in database USER_DB_FALCON
    limit 10000
[0m00:43:18.906204 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:43:19.471935 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.563 seconds
[0m00:43:19.471935 [debug] [ThreadPool]: On list_USER_DB_FALCON: Close
[0m00:43:19.628465 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON_RAW_public'
[0m00:43:19.640637 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m00:43:19.640637 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show objects in USER_DB_FALCON.RAW_public limit 10000
[0m00:43:19.640637 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:43:20.624727 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.986 seconds
[0m00:43:20.624727 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m00:43:20.752563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de40ce00-b992-40c1-9d9b-fa2600939882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C37F5D10D0>]}
[0m00:43:20.752563 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:43:20.752563 [info ] [MainThread]: 
[0m00:43:20.752563 [debug] [Thread-1 (]: Began running node model.customer_churn.int_customer_enriched
[0m00:43:20.752563 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW_public.int_customer_enriched ................... [RUN]
[0m00:43:20.752563 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.customer_churn.int_customer_enriched'
[0m00:43:20.752563 [debug] [Thread-1 (]: Began compiling node model.customer_churn.int_customer_enriched
[0m00:43:20.767891 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.int_customer_enriched"
[0m00:43:20.767891 [debug] [Thread-1 (]: Began executing node model.customer_churn.int_customer_enriched
[0m00:43:20.790087 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.int_customer_enriched"
[0m00:43:20.790087 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.int_customer_enriched"
[0m00:43:20.795539 [debug] [Thread-1 (]: On model.customer_churn.int_customer_enriched: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.int_customer_enriched"} */
create or replace   view USER_DB_FALCON.RAW_public.int_customer_enriched
  
   as (
    

with cust as (
    select
        individual_id,
        annual_premium,
        days_tenure,
        cust_orig_date,
        age_in_years,
        date_of_birth,
        address_id
    from USER_DB_FALCON.RAW_public.stg_customer
),

demo as (
    select
        individual_id,
        has_children,
        length_of_residence,
        marital_status,
        home_owner,
        home_market_value,
        college_degree,
        good_credit
    from USER_DB_FALCON.RAW_public.stg_demographic
),

addr as (
    select
        address_id,
        city,
        state,
        county,
        lat,
        lon
    from USER_DB_FALCON.RAW_public.stg_address
)

select
    cust.individual_id,
    cust.annual_premium,
    cust.days_tenure,
    cust.cust_orig_date,
    cust.age_in_years,
    cust.date_of_birth,
    demo.has_children,
    demo.length_of_residence,
    demo.marital_status,
    demo.home_owner,
    demo.home_market_value,
    addr.city,
    addr.state,
    addr.county,
    addr.lat,
    addr.lon
from cust
left join demo using (individual_id)
left join addr using (address_id);
[0m00:43:20.795539 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:43:21.166670 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bc1e4f-0305-1c2f-0004-59ff003a2a8a
[0m00:43:21.166670 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 61 at position 33 unexpected ';'.
[0m00:43:21.181740 [debug] [Thread-1 (]: On model.customer_churn.int_customer_enriched: Close
[0m00:43:21.309672 [debug] [Thread-1 (]: Database Error in model int_customer_enriched (models\intermediate\int_customer_enriched.sql)
  001003 (42000): SQL compilation error:
  syntax error line 61 at position 33 unexpected ';'.
  compiled code at target\run\customer_churn\models\intermediate\int_customer_enriched.sql
[0m00:43:21.311679 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de40ce00-b992-40c1-9d9b-fa2600939882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C37EC7B5F0>]}
[0m00:43:21.311679 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW_public.int_customer_enriched .......... [[31mERROR[0m in 0.56s]
[0m00:43:21.311679 [debug] [Thread-1 (]: Finished running node model.customer_churn.int_customer_enriched
[0m00:43:21.311679 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:43:21.311679 [debug] [MainThread]: Connection 'list_USER_DB_FALCON' was properly closed.
[0m00:43:21.311679 [debug] [MainThread]: Connection 'list_USER_DB_FALCON_RAW_public' was properly closed.
[0m00:43:21.311679 [debug] [MainThread]: Connection 'model.customer_churn.int_customer_enriched' was properly closed.
[0m00:43:21.311679 [info ] [MainThread]: 
[0m00:43:21.311679 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.42 seconds (2.42s).
[0m00:43:21.320164 [debug] [MainThread]: Command end result
[0m00:43:21.346676 [info ] [MainThread]: 
[0m00:43:21.356038 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:43:21.356038 [info ] [MainThread]: 
[0m00:43:21.356038 [error] [MainThread]:   Database Error in model int_customer_enriched (models\intermediate\int_customer_enriched.sql)
  001003 (42000): SQL compilation error:
  syntax error line 61 at position 33 unexpected ';'.
  compiled code at target\run\customer_churn\models\intermediate\int_customer_enriched.sql
[0m00:43:21.356038 [info ] [MainThread]: 
[0m00:43:21.360714 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:43:21.360714 [debug] [MainThread]: Command `dbt run` failed at 00:43:21.360714 after 3.84 seconds
[0m00:43:21.360714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C37F2AB110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C301B38740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C301BA2FC0>]}
[0m00:43:21.360714 [debug] [MainThread]: Flushing usage events
[0m00:43:32.948713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B66D907E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B66CA51280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B66CA506E0>]}


============================== 00:43:32.956857 | 4e519ef5-3da1-4130-b503-1651585523a0 ==============================
[0m00:43:32.956857 [info ] [MainThread]: Running with dbt=1.8.2
[0m00:43:32.956857 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select intermediate', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:43:33.338046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e519ef5-3da1-4130-b503-1651585523a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B66DAA4290>]}
[0m00:43:33.372410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4e519ef5-3da1-4130-b503-1651585523a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B66F7023C0>]}
[0m00:43:33.372410 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m00:43:33.538148 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m00:43:33.634568 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:43:33.634568 [debug] [MainThread]: Partial parsing: updated file: customer_churn://models\intermediate\int_customer_enriched.sql
[0m00:43:33.841158 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:43:33.841158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4e519ef5-3da1-4130-b503-1651585523a0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B66FF8AE10>]}
[0m00:43:34.102643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e519ef5-3da1-4130-b503-1651585523a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B66FA63860>]}
[0m00:43:34.206233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e519ef5-3da1-4130-b503-1651585523a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B66FFEC260>]}
[0m00:43:34.206766 [info ] [MainThread]: Found 11 models, 10 data tests, 7 sources, 459 macros
[0m00:43:34.207973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e519ef5-3da1-4130-b503-1651585523a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B66FF01280>]}
[0m00:43:34.210604 [info ] [MainThread]: 
[0m00:43:34.211647 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:43:34.212171 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON'
[0m00:43:34.224155 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON"
[0m00:43:34.224846 [debug] [ThreadPool]: On list_USER_DB_FALCON: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON"} */
show terse schemas in database USER_DB_FALCON
    limit 10000
[0m00:43:34.224846 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:43:35.333095 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.110 seconds
[0m00:43:35.333095 [debug] [ThreadPool]: On list_USER_DB_FALCON: Close
[0m00:43:35.747768 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON_RAW_public'
[0m00:43:35.766550 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m00:43:35.766550 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show objects in USER_DB_FALCON.RAW_public limit 10000
[0m00:43:35.766550 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:43:36.151045 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.387 seconds
[0m00:43:36.159608 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m00:43:36.299328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e519ef5-3da1-4130-b503-1651585523a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B670022D50>]}
[0m00:43:36.301738 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:43:36.301738 [info ] [MainThread]: 
[0m00:43:36.313409 [debug] [Thread-1 (]: Began running node model.customer_churn.int_customer_enriched
[0m00:43:36.315036 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW_public.int_customer_enriched ................... [RUN]
[0m00:43:36.316702 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.customer_churn.int_customer_enriched'
[0m00:43:36.317770 [debug] [Thread-1 (]: Began compiling node model.customer_churn.int_customer_enriched
[0m00:43:36.328343 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.int_customer_enriched"
[0m00:43:36.328984 [debug] [Thread-1 (]: Began executing node model.customer_churn.int_customer_enriched
[0m00:43:36.382839 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.int_customer_enriched"
[0m00:43:36.383446 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.int_customer_enriched"
[0m00:43:36.383446 [debug] [Thread-1 (]: On model.customer_churn.int_customer_enriched: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.int_customer_enriched"} */
create or replace   view USER_DB_FALCON.RAW_public.int_customer_enriched
  
   as (
    

with cust as (
    select
        individual_id,
        annual_premium,
        days_tenure,
        cust_orig_date,
        age_in_years,
        date_of_birth,
        address_id
    from USER_DB_FALCON.RAW_public.stg_customer
),

demo as (
    select
        individual_id,
        has_children,
        length_of_residence,
        marital_status,
        home_owner,
        home_market_value,
        college_degree,
        good_credit
    from USER_DB_FALCON.RAW_public.stg_demographic
),

addr as (
    select
        address_id,
        city,
        state,
        county,
        lat,
        lon
    from USER_DB_FALCON.RAW_public.stg_address
)

select
    cust.individual_id,
    cust.annual_premium,
    cust.days_tenure,
    cust.cust_orig_date,
    cust.age_in_years,
    cust.date_of_birth,
    demo.has_children,
    demo.length_of_residence,
    demo.marital_status,
    demo.home_owner,
    demo.home_market_value,
    addr.city,
    addr.state,
    addr.county,
    addr.lat,
    addr.lon
from cust
left join demo using (individual_id)
left join addr using (address_id)
  );
[0m00:43:36.383446 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:43:37.493222 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bc1e4f-0305-2374-0004-59ff0039ddbe
[0m00:43:37.494522 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 8
invalid identifier 'AGE_IN_YEARS'
[0m00:43:37.495821 [debug] [Thread-1 (]: On model.customer_churn.int_customer_enriched: Close
[0m00:43:37.621291 [debug] [Thread-1 (]: Database Error in model int_customer_enriched (models\intermediate\int_customer_enriched.sql)
  000904 (42000): SQL compilation error: error line 12 at position 8
  invalid identifier 'AGE_IN_YEARS'
  compiled code at target\run\customer_churn\models\intermediate\int_customer_enriched.sql
[0m00:43:37.621291 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e519ef5-3da1-4130-b503-1651585523a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B66FC6D4C0>]}
[0m00:43:37.629413 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW_public.int_customer_enriched .......... [[31mERROR[0m in 1.31s]
[0m00:43:37.629413 [debug] [Thread-1 (]: Finished running node model.customer_churn.int_customer_enriched
[0m00:43:37.637587 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:43:37.637587 [debug] [MainThread]: Connection 'list_USER_DB_FALCON' was properly closed.
[0m00:43:37.637587 [debug] [MainThread]: Connection 'list_USER_DB_FALCON_RAW_public' was properly closed.
[0m00:43:37.637587 [debug] [MainThread]: Connection 'model.customer_churn.int_customer_enriched' was properly closed.
[0m00:43:37.637587 [info ] [MainThread]: 
[0m00:43:37.637587 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.43 seconds (3.43s).
[0m00:43:37.637587 [debug] [MainThread]: Command end result
[0m00:43:37.687734 [info ] [MainThread]: 
[0m00:43:37.687734 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:43:37.687734 [info ] [MainThread]: 
[0m00:43:37.687734 [error] [MainThread]:   Database Error in model int_customer_enriched (models\intermediate\int_customer_enriched.sql)
  000904 (42000): SQL compilation error: error line 12 at position 8
  invalid identifier 'AGE_IN_YEARS'
  compiled code at target\run\customer_churn\models\intermediate\int_customer_enriched.sql
[0m00:43:37.687734 [info ] [MainThread]: 
[0m00:43:37.687734 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:43:37.696089 [debug] [MainThread]: Command `dbt run` failed at 00:43:37.696089 after 4.91 seconds
[0m00:43:37.696089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B66CA51280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B66D199220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B66FBE2240>]}
[0m00:43:37.696089 [debug] [MainThread]: Flushing usage events
[0m00:46:07.455602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002245C1A8FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002245D751EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224600285F0>]}


============================== 00:46:07.468643 | 1895ff39-9b10-4737-b226-f5c6115852b3 ==============================
[0m00:46:07.468643 [info ] [MainThread]: Running with dbt=1.8.2
[0m00:46:07.468643 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select staging', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:46:08.157134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1895ff39-9b10-4737-b226-f5c6115852b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002245F7D7470>]}
[0m00:46:08.189882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1895ff39-9b10-4737-b226-f5c6115852b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224603C47A0>]}
[0m00:46:08.189882 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m00:46:08.370973 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m00:46:08.457481 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:46:08.457481 [debug] [MainThread]: Partial parsing: updated file: customer_churn://models\staging\stg_customer.sql
[0m00:46:08.694588 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:46:08.694588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1895ff39-9b10-4737-b226-f5c6115852b3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224623F9F10>]}
[0m00:46:08.943287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1895ff39-9b10-4737-b226-f5c6115852b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002245FAD8E00>]}
[0m00:46:09.058374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1895ff39-9b10-4737-b226-f5c6115852b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224626C1C40>]}
[0m00:46:09.058374 [info ] [MainThread]: Found 11 models, 10 data tests, 7 sources, 459 macros
[0m00:46:09.058374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1895ff39-9b10-4737-b226-f5c6115852b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224624DB890>]}
[0m00:46:09.058374 [info ] [MainThread]: 
[0m00:46:09.058374 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:46:09.067244 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON'
[0m00:46:09.067244 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON"
[0m00:46:09.080572 [debug] [ThreadPool]: On list_USER_DB_FALCON: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON"} */
show terse schemas in database USER_DB_FALCON
    limit 10000
[0m00:46:09.080572 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:46:09.742948 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.673 seconds
[0m00:46:09.742948 [debug] [ThreadPool]: On list_USER_DB_FALCON: Close
[0m00:46:10.045457 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON_RAW_public'
[0m00:46:10.063661 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m00:46:10.063661 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show objects in USER_DB_FALCON.RAW_public limit 10000
[0m00:46:10.065671 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:46:10.672984 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.610 seconds
[0m00:46:10.672984 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m00:46:10.795158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1895ff39-9b10-4737-b226-f5c6115852b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224624B4C20>]}
[0m00:46:10.795158 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:46:10.795158 [info ] [MainThread]: 
[0m00:46:10.814316 [debug] [Thread-1 (]: Began running node model.customer_churn.stg_address
[0m00:46:10.817887 [debug] [Thread-2 (]: Began running node model.customer_churn.stg_autoinsurance_churn
[0m00:46:10.817887 [debug] [Thread-3 (]: Began running node model.customer_churn.stg_customer
[0m00:46:10.817887 [debug] [Thread-4 (]: Began running node model.customer_churn.stg_demographic
[0m00:46:10.817887 [info ] [Thread-1 (]: 1 of 6 START sql view model RAW_public.stg_address ............................. [RUN]
[0m00:46:10.817887 [info ] [Thread-2 (]: 2 of 6 START sql view model RAW_public.stg_autoinsurance_churn ................. [RUN]
[0m00:46:10.825178 [info ] [Thread-3 (]: 3 of 6 START sql view model RAW_public.stg_customer ............................ [RUN]
[0m00:46:10.827739 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.customer_churn.stg_address'
[0m00:46:10.831654 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.customer_churn.stg_autoinsurance_churn'
[0m00:46:10.827739 [info ] [Thread-4 (]: 4 of 6 START sql view model RAW_public.stg_demographic ......................... [RUN]
[0m00:46:10.832758 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.customer_churn.stg_customer'
[0m00:46:10.832758 [debug] [Thread-1 (]: Began compiling node model.customer_churn.stg_address
[0m00:46:10.832758 [debug] [Thread-2 (]: Began compiling node model.customer_churn.stg_autoinsurance_churn
[0m00:46:10.832758 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.customer_churn.stg_demographic'
[0m00:46:10.832758 [debug] [Thread-3 (]: Began compiling node model.customer_churn.stg_customer
[0m00:46:10.845326 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.stg_address"
[0m00:46:10.860433 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer_churn.stg_autoinsurance_churn"
[0m00:46:10.861494 [debug] [Thread-4 (]: Began compiling node model.customer_churn.stg_demographic
[0m00:46:10.865015 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.stg_customer"
[0m00:46:10.867028 [debug] [Thread-4 (]: Writing injected SQL for node "model.customer_churn.stg_demographic"
[0m00:46:10.867028 [debug] [Thread-1 (]: Began executing node model.customer_churn.stg_address
[0m00:46:10.867028 [debug] [Thread-2 (]: Began executing node model.customer_churn.stg_autoinsurance_churn
[0m00:46:10.912947 [debug] [Thread-4 (]: Began executing node model.customer_churn.stg_demographic
[0m00:46:10.929551 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer_churn.stg_autoinsurance_churn"
[0m00:46:10.929551 [debug] [Thread-3 (]: Began executing node model.customer_churn.stg_customer
[0m00:46:10.929551 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.stg_address"
[0m00:46:10.937895 [debug] [Thread-4 (]: Writing runtime sql for node "model.customer_churn.stg_demographic"
[0m00:46:10.937895 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.stg_customer"
[0m00:46:10.937895 [debug] [Thread-2 (]: Using snowflake connection "model.customer_churn.stg_autoinsurance_churn"
[0m00:46:10.937895 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.stg_address"
[0m00:46:10.937895 [debug] [Thread-2 (]: On model.customer_churn.stg_autoinsurance_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_autoinsurance_churn"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_autoinsurance_churn
  
   as (
    

select
  individual_id,
  churn              as churn_flag
from USER_DB_FALCON.RAW.AUTOINSURANCE_CHURN_STAGING
  );
[0m00:46:10.946024 [debug] [Thread-4 (]: Using snowflake connection "model.customer_churn.stg_demographic"
[0m00:46:10.946024 [debug] [Thread-1 (]: On model.customer_churn.stg_address: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_address"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_address
  
   as (
    -- models/staging/stg_address.sql

select
  address_id,
  street_address,
  city,
  state,
  county,
  latitude::float as lat,
  longitude::float as lon
from USER_DB_FALCON.RAW.ADDRESS_STAGING
  );
[0m00:46:10.946024 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.stg_customer"
[0m00:46:10.946024 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:46:10.946024 [debug] [Thread-4 (]: On model.customer_churn.stg_demographic: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_demographic"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_demographic
  
   as (
    

select
  individual_id,
  income,
  has_children,
  length_of_residence    as length_of_residence,  -- exact match
  marital_status,
  home_owner,
  home_market_value      as home_market_value,
  college_degree,
  good_credit
from USER_DB_FALCON.RAW.DEMOGRAPHIC_STAGING
  );
[0m00:46:10.946024 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:46:10.946024 [debug] [Thread-3 (]: On model.customer_churn.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_customer"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_customer
  
   as (
    

select
  individual_id,
  address_id,
  curr_ann_amt    as annual_premium,
  days_tenure,
  cust_orig_date,
  age_in_years,            -- bring this in
  date_of_birth            -- and this
from USER_DB_FALCON.RAW.CUSTOMER_STAGING
  );
[0m00:46:10.946024 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:46:10.951809 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:46:11.565037 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.628 seconds
[0m00:46:11.612081 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.661 seconds
[0m00:46:11.624262 [debug] [Thread-2 (]: On model.customer_churn.stg_autoinsurance_churn: Close
[0m00:46:11.624262 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.678 seconds
[0m00:46:11.624262 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.676 seconds
[0m00:46:11.628403 [debug] [Thread-3 (]: On model.customer_churn.stg_customer: Close
[0m00:46:11.634889 [debug] [Thread-1 (]: On model.customer_churn.stg_address: Close
[0m00:46:11.634889 [debug] [Thread-4 (]: On model.customer_churn.stg_demographic: Close
[0m00:46:11.770917 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1895ff39-9b10-4737-b226-f5c6115852b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002245FA9F740>]}
[0m00:46:11.770917 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1895ff39-9b10-4737-b226-f5c6115852b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022462D12A20>]}
[0m00:46:11.770917 [info ] [Thread-1 (]: 1 of 6 OK created sql view model RAW_public.stg_address ........................ [[32mSUCCESS 1[0m in 0.94s]
[0m00:46:11.770917 [debug] [Thread-1 (]: Finished running node model.customer_churn.stg_address
[0m00:46:11.770917 [info ] [Thread-3 (]: 3 of 6 OK created sql view model RAW_public.stg_customer ....................... [[32mSUCCESS 1[0m in 0.94s]
[0m00:46:11.770917 [debug] [Thread-1 (]: Began running node model.customer_churn.stg_termination
[0m00:46:11.770917 [debug] [Thread-3 (]: Finished running node model.customer_churn.stg_customer
[0m00:46:11.786821 [debug] [Thread-3 (]: Began running node model.customer_churn.stg_turning_movement
[0m00:46:11.786821 [info ] [Thread-1 (]: 5 of 6 START sql view model RAW_public.stg_termination ......................... [RUN]
[0m00:46:11.790269 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer_churn.stg_address, now model.customer_churn.stg_termination)
[0m00:46:11.790269 [debug] [Thread-1 (]: Began compiling node model.customer_churn.stg_termination
[0m00:46:11.794942 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.stg_termination"
[0m00:46:11.790269 [info ] [Thread-3 (]: 6 of 6 START sql view model RAW_public.stg_turning_movement .................... [RUN]
[0m00:46:11.794942 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer_churn.stg_customer, now model.customer_churn.stg_turning_movement)
[0m00:46:11.803379 [debug] [Thread-1 (]: Began executing node model.customer_churn.stg_termination
[0m00:46:11.803379 [debug] [Thread-3 (]: Began compiling node model.customer_churn.stg_turning_movement
[0m00:46:11.794942 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1895ff39-9b10-4737-b226-f5c6115852b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022462C1C440>]}
[0m00:46:11.805543 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.stg_termination"
[0m00:46:11.812046 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.stg_turning_movement"
[0m00:46:11.814637 [info ] [Thread-4 (]: 4 of 6 OK created sql view model RAW_public.stg_demographic .................... [[32mSUCCESS 1[0m in 0.96s]
[0m00:46:11.814637 [debug] [Thread-4 (]: Finished running node model.customer_churn.stg_demographic
[0m00:46:11.814637 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.stg_termination"
[0m00:46:11.819279 [debug] [Thread-1 (]: On model.customer_churn.stg_termination: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_termination"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_termination
  
   as (
    

select
  individual_id,
  acct_suspd_date    as churn_date
from USER_DB_FALCON.RAW.TERMINATION_STAGING
  );
[0m00:46:11.819279 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:46:11.819279 [debug] [Thread-3 (]: Began executing node model.customer_churn.stg_turning_movement
[0m00:46:11.828129 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.stg_turning_movement"
[0m00:46:11.828129 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.stg_turning_movement"
[0m00:46:11.836422 [debug] [Thread-3 (]: On model.customer_churn.stg_turning_movement: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_turning_movement"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_turning_movement
  
   as (
    -- models/staging/stg_turning_movement.sql

select
  objectid,
  facilityid,
  intid,
  intname,
  nodeno,
  longitude::float as tm_lon,
  latitude::float  as tm_lat
from USER_DB_FALCON.RAW.TURNING_MOVEMENT
  );
[0m00:46:11.836422 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:46:12.237481 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1895ff39-9b10-4737-b226-f5c6115852b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224623B7860>]}
[0m00:46:12.237481 [info ] [Thread-2 (]: 2 of 6 OK created sql view model RAW_public.stg_autoinsurance_churn ............ [[32mSUCCESS 1[0m in 1.41s]
[0m00:46:12.237481 [debug] [Thread-2 (]: Finished running node model.customer_churn.stg_autoinsurance_churn
[0m00:46:12.349811 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.519 seconds
[0m00:46:12.349811 [debug] [Thread-3 (]: On model.customer_churn.stg_turning_movement: Close
[0m00:46:12.672739 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1895ff39-9b10-4737-b226-f5c6115852b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022462C035C0>]}
[0m00:46:12.672739 [info ] [Thread-3 (]: 6 of 6 OK created sql view model RAW_public.stg_turning_movement ............... [[32mSUCCESS 1[0m in 0.88s]
[0m00:46:12.688820 [debug] [Thread-3 (]: Finished running node model.customer_churn.stg_turning_movement
[0m00:46:13.100721 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.280 seconds
[0m00:46:13.105509 [debug] [Thread-1 (]: On model.customer_churn.stg_termination: Close
[0m00:46:13.479442 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1895ff39-9b10-4737-b226-f5c6115852b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022462D11100>]}
[0m00:46:13.479442 [info ] [Thread-1 (]: 5 of 6 OK created sql view model RAW_public.stg_termination .................... [[32mSUCCESS 1[0m in 1.69s]
[0m00:46:13.495142 [debug] [Thread-1 (]: Finished running node model.customer_churn.stg_termination
[0m00:46:13.495142 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:46:13.495142 [debug] [MainThread]: Connection 'list_USER_DB_FALCON' was properly closed.
[0m00:46:13.495142 [debug] [MainThread]: Connection 'list_USER_DB_FALCON_RAW_public' was properly closed.
[0m00:46:13.495142 [debug] [MainThread]: Connection 'model.customer_churn.stg_termination' was properly closed.
[0m00:46:13.495142 [debug] [MainThread]: Connection 'model.customer_churn.stg_autoinsurance_churn' was properly closed.
[0m00:46:13.505785 [debug] [MainThread]: Connection 'model.customer_churn.stg_turning_movement' was properly closed.
[0m00:46:13.505785 [debug] [MainThread]: Connection 'model.customer_churn.stg_demographic' was properly closed.
[0m00:46:13.505785 [info ] [MainThread]: 
[0m00:46:13.507808 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 4.45 seconds (4.45s).
[0m00:46:13.512267 [debug] [MainThread]: Command end result
[0m00:46:13.572342 [info ] [MainThread]: 
[0m00:46:13.572342 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:46:13.575754 [info ] [MainThread]: 
[0m00:46:13.575754 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m00:46:13.575754 [debug] [MainThread]: Command `dbt run` succeeded at 00:46:13.575754 after 6.34 seconds
[0m00:46:13.575754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022460262840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002246039BE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224601A1DF0>]}
[0m00:46:13.579671 [debug] [MainThread]: Flushing usage events
[0m00:46:17.761622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E30DD9700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E3312BAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E33742A20>]}


============================== 00:46:17.779534 | f5310e1e-5ef2-4d70-8f58-1294c99eb9ea ==============================
[0m00:46:17.779534 [info ] [MainThread]: Running with dbt=1.8.2
[0m00:46:17.779534 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt', 'log_path': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select intermediate', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:46:18.264084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5310e1e-5ef2-4d70-8f58-1294c99eb9ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E33AF0EC0>]}
[0m00:46:18.308918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5310e1e-5ef2-4d70-8f58-1294c99eb9ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E35AC5FA0>]}
[0m00:46:18.309432 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m00:46:18.456245 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m00:46:18.675405 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:46:18.678680 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:46:18.707209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5310e1e-5ef2-4d70-8f58-1294c99eb9ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E35A9BE00>]}
[0m00:46:18.778770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5310e1e-5ef2-4d70-8f58-1294c99eb9ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E35EE6180>]}
[0m00:46:18.778770 [info ] [MainThread]: Found 11 models, 10 data tests, 7 sources, 459 macros
[0m00:46:18.778770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5310e1e-5ef2-4d70-8f58-1294c99eb9ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E35FEFF20>]}
[0m00:46:18.778770 [info ] [MainThread]: 
[0m00:46:18.778770 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:46:18.778770 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON'
[0m00:46:18.794708 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON"
[0m00:46:18.798320 [debug] [ThreadPool]: On list_USER_DB_FALCON: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON"} */
show terse schemas in database USER_DB_FALCON
    limit 10000
[0m00:46:18.798320 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:46:19.250911 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.452 seconds
[0m00:46:19.253624 [debug] [ThreadPool]: On list_USER_DB_FALCON: Close
[0m00:46:19.770150 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON_RAW_public'
[0m00:46:19.798159 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m00:46:19.798159 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show objects in USER_DB_FALCON.RAW_public limit 10000
[0m00:46:19.798159 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:46:20.153198 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.365 seconds
[0m00:46:20.166415 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m00:46:20.293239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5310e1e-5ef2-4d70-8f58-1294c99eb9ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E35FEABD0>]}
[0m00:46:20.293239 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:46:20.293239 [info ] [MainThread]: 
[0m00:46:20.293239 [debug] [Thread-1 (]: Began running node model.customer_churn.int_customer_enriched
[0m00:46:20.293239 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW_public.int_customer_enriched ................... [RUN]
[0m00:46:20.293239 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.customer_churn.int_customer_enriched'
[0m00:46:20.293239 [debug] [Thread-1 (]: Began compiling node model.customer_churn.int_customer_enriched
[0m00:46:20.313663 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.int_customer_enriched"
[0m00:46:20.314707 [debug] [Thread-1 (]: Began executing node model.customer_churn.int_customer_enriched
[0m00:46:20.332127 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.int_customer_enriched"
[0m00:46:20.335912 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.int_customer_enriched"
[0m00:46:20.335912 [debug] [Thread-1 (]: On model.customer_churn.int_customer_enriched: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.int_customer_enriched"} */
create or replace   view USER_DB_FALCON.RAW_public.int_customer_enriched
  
   as (
    

with cust as (
    select
        individual_id,
        annual_premium,
        days_tenure,
        cust_orig_date,
        age_in_years,
        date_of_birth,
        address_id
    from USER_DB_FALCON.RAW_public.stg_customer
),

demo as (
    select
        individual_id,
        has_children,
        length_of_residence,
        marital_status,
        home_owner,
        home_market_value,
        college_degree,
        good_credit
    from USER_DB_FALCON.RAW_public.stg_demographic
),

addr as (
    select
        address_id,
        city,
        state,
        county,
        lat,
        lon
    from USER_DB_FALCON.RAW_public.stg_address
)

select
    cust.individual_id,
    cust.annual_premium,
    cust.days_tenure,
    cust.cust_orig_date,
    cust.age_in_years,
    cust.date_of_birth,
    demo.has_children,
    demo.length_of_residence,
    demo.marital_status,
    demo.home_owner,
    demo.home_market_value,
    addr.city,
    addr.state,
    addr.county,
    addr.lat,
    addr.lon
from cust
left join demo using (individual_id)
left join addr using (address_id)
  );
[0m00:46:20.335912 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:46:21.439878 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.101 seconds
[0m00:46:21.454859 [debug] [Thread-1 (]: On model.customer_churn.int_customer_enriched: Close
[0m00:46:21.602588 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5310e1e-5ef2-4d70-8f58-1294c99eb9ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E35AC7770>]}
[0m00:46:21.604989 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW_public.int_customer_enriched .............. [[32mSUCCESS 1[0m in 1.31s]
[0m00:46:21.604989 [debug] [Thread-1 (]: Finished running node model.customer_churn.int_customer_enriched
[0m00:46:21.604989 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:46:21.604989 [debug] [MainThread]: Connection 'list_USER_DB_FALCON' was properly closed.
[0m00:46:21.604989 [debug] [MainThread]: Connection 'list_USER_DB_FALCON_RAW_public' was properly closed.
[0m00:46:21.604989 [debug] [MainThread]: Connection 'model.customer_churn.int_customer_enriched' was properly closed.
[0m00:46:21.604989 [info ] [MainThread]: 
[0m00:46:21.604989 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.83 seconds (2.83s).
[0m00:46:21.613432 [debug] [MainThread]: Command end result
[0m00:46:21.674095 [info ] [MainThread]: 
[0m00:46:21.674095 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:46:21.674095 [info ] [MainThread]: 
[0m00:46:21.683626 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:46:21.685135 [debug] [MainThread]: Command `dbt run` succeeded at 00:46:21.685135 after 4.20 seconds
[0m00:46:21.686295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E33742A20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E33217470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E331C3C20>]}
[0m00:46:21.686295 [debug] [MainThread]: Flushing usage events
[0m00:47:30.524309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA4B6600B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA4A8F70B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA4B5429F0>]}


============================== 00:47:30.531051 | b2c6169a-f451-4778-995d-bdcd35d358b0 ==============================
[0m00:47:30.531051 [info ] [MainThread]: Running with dbt=1.8.2
[0m00:47:30.531051 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select marts', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:47:31.033056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2c6169a-f451-4778-995d-bdcd35d358b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA4D341B50>]}
[0m00:47:31.082807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b2c6169a-f451-4778-995d-bdcd35d358b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA4CC8FB30>]}
[0m00:47:31.082807 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m00:47:31.275305 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m00:47:31.385662 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:47:31.386425 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:47:31.435272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b2c6169a-f451-4778-995d-bdcd35d358b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA4D8E01A0>]}
[0m00:47:31.500366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2c6169a-f451-4778-995d-bdcd35d358b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA4DCC09E0>]}
[0m00:47:31.500366 [info ] [MainThread]: Found 11 models, 10 data tests, 7 sources, 459 macros
[0m00:47:31.500366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2c6169a-f451-4778-995d-bdcd35d358b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA4D8E3350>]}
[0m00:47:31.508257 [info ] [MainThread]: 
[0m00:47:31.508257 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:47:31.509599 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON'
[0m00:47:31.521509 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON"
[0m00:47:31.521509 [debug] [ThreadPool]: On list_USER_DB_FALCON: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON"} */
show terse schemas in database USER_DB_FALCON
    limit 10000
[0m00:47:31.521509 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:47:32.254804 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.743 seconds
[0m00:47:32.267500 [debug] [ThreadPool]: On list_USER_DB_FALCON: Close
[0m00:47:32.394255 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON_RAW_public'
[0m00:47:32.411890 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m00:47:32.411890 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show objects in USER_DB_FALCON.RAW_public limit 10000
[0m00:47:32.411890 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:47:32.902009 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.487 seconds
[0m00:47:32.902009 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m00:47:33.039629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2c6169a-f451-4778-995d-bdcd35d358b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA4DCCBE60>]}
[0m00:47:33.039629 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:47:33.039629 [info ] [MainThread]: 
[0m00:47:33.045811 [debug] [Thread-1 (]: Began running node model.customer_churn.dim_address
[0m00:47:33.045811 [debug] [Thread-2 (]: Began running node model.customer_churn.dim_customer
[0m00:47:33.050137 [debug] [Thread-3 (]: Began running node model.customer_churn.fact_churn
[0m00:47:33.051884 [info ] [Thread-1 (]: 1 of 4 START sql table model RAW_public.dim_address ............................ [RUN]
[0m00:47:33.054079 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.customer_churn.dim_address'
[0m00:47:33.054079 [debug] [Thread-1 (]: Began compiling node model.customer_churn.dim_address
[0m00:47:33.063382 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.dim_address"
[0m00:47:33.051884 [info ] [Thread-2 (]: 2 of 4 START sql table model RAW_public.dim_customer ........................... [RUN]
[0m00:47:33.064693 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.customer_churn.dim_customer'
[0m00:47:33.064693 [debug] [Thread-2 (]: Began compiling node model.customer_churn.dim_customer
[0m00:47:33.053778 [info ] [Thread-3 (]: 3 of 4 START sql incremental model RAW_public.fact_churn ....................... [RUN]
[0m00:47:33.068575 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer_churn.dim_customer"
[0m00:47:33.070670 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.customer_churn.fact_churn'
[0m00:47:33.071149 [debug] [Thread-1 (]: Began executing node model.customer_churn.dim_address
[0m00:47:33.071149 [debug] [Thread-3 (]: Began compiling node model.customer_churn.fact_churn
[0m00:47:33.102804 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.dim_address"
[0m00:47:33.110935 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.fact_churn"
[0m00:47:33.113611 [debug] [Thread-2 (]: Began executing node model.customer_churn.dim_customer
[0m00:47:33.115162 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer_churn.dim_customer"
[0m00:47:33.115162 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.dim_address"
[0m00:47:33.115162 [debug] [Thread-1 (]: On model.customer_churn.dim_address: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.dim_address"} */
create or replace transient table USER_DB_FALCON.RAW_public.dim_address
         as
        (-- models/marts/dim_address.sql


select distinct
  individual_id,
  city,
  state,
  county,
  lat,
  lon
from USER_DB_FALCON.RAW_public.int_customer_enriched;
[0m00:47:33.115162 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:47:33.115162 [debug] [Thread-2 (]: Using snowflake connection "model.customer_churn.dim_customer"
[0m00:47:33.115162 [debug] [Thread-2 (]: On model.customer_churn.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.dim_customer"} */
create or replace transient table USER_DB_FALCON.RAW_public.dim_customer
         as
        (-- models/marts/dim_customer.sql


select distinct
  individual_id,
  date_diff('year', date_of_birth, current_date()) as age,
  marital_status,
  has_children,
  length_of_residence
from USER_DB_FALCON.RAW_public.int_customer_enriched;
[0m00:47:33.115162 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:47:33.115162 [debug] [Thread-3 (]: Began executing node model.customer_churn.fact_churn
[0m00:47:33.160635 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.fact_churn"
[0m00:47:33.162669 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:47:33.162669 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
create or replace transient table USER_DB_FALCON.RAW_public.fact_churn
         as
        (-- models/marts/fact_churn.sql


select
  t.individual_id,
  t.churn_date,
  e.city,
  e.state,
  e.county,
  e.age_in_years,
  e.days_tenure,
  e.annual_premium,
  c.churn_flag
from USER_DB_FALCON.RAW_public.stg_termination t
join USER_DB_FALCON.RAW_public.int_customer_enriched e
  using (individual_id)
left join USER_DB_FALCON.RAW_public.stg_autoinsurance_churn c
  using (individual_id)


;
[0m00:47:33.162669 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:47:33.499235 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01bc1e53-0305-212a-0004-59ff003a37c2
[0m00:47:33.499235 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 23 at position 0 unexpected ';'.
[0m00:47:33.499235 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: Close
[0m00:47:33.507691 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01bc1e53-0305-2374-0004-59ff0039ddc2
[0m00:47:33.507691 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 12 at position 52 unexpected ';'.
[0m00:47:33.507691 [debug] [Thread-2 (]: On model.customer_churn.dim_customer: Close
[0m00:47:33.636295 [debug] [Thread-2 (]: Database Error in model dim_customer (models\marts\dim_customer.sql)
  001003 (42000): SQL compilation error:
  syntax error line 12 at position 52 unexpected ';'.
  compiled code at target\run\customer_churn\models\marts\dim_customer.sql
[0m00:47:33.636295 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2c6169a-f451-4778-995d-bdcd35d358b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA4AE9F8F0>]}
[0m00:47:33.636295 [debug] [Thread-3 (]: Database Error in model fact_churn (models\marts\fact_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 23 at position 0 unexpected ';'.
  compiled code at target\run\customer_churn\models\marts\fact_churn.sql
[0m00:47:33.636295 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2c6169a-f451-4778-995d-bdcd35d358b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA4DDE8050>]}
[0m00:47:33.636295 [error] [Thread-2 (]: 2 of 4 ERROR creating sql table model RAW_public.dim_customer .................. [[31mERROR[0m in 0.57s]
[0m00:47:33.636295 [debug] [Thread-2 (]: Finished running node model.customer_churn.dim_customer
[0m00:47:33.636295 [error] [Thread-3 (]: 3 of 4 ERROR creating sql incremental model RAW_public.fact_churn .............. [[31mERROR[0m in 0.57s]
[0m00:47:33.644316 [debug] [Thread-3 (]: Finished running node model.customer_churn.fact_churn
[0m00:47:33.644316 [debug] [Thread-4 (]: Began running node model.customer_churn.churn_metrics
[0m00:47:33.644316 [info ] [Thread-4 (]: 4 of 4 SKIP relation RAW_public.churn_metrics .................................. [[33mSKIP[0m]
[0m00:47:33.644316 [debug] [Thread-4 (]: Finished running node model.customer_churn.churn_metrics
[0m00:47:33.751158 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bc1e53-0305-21e4-0004-59ff0039be26
[0m00:47:33.751729 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 13 at position 52 unexpected ';'.
[0m00:47:33.752253 [debug] [Thread-1 (]: On model.customer_churn.dim_address: Close
[0m00:47:33.860622 [debug] [Thread-1 (]: Database Error in model dim_address (models\marts\dim_address.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 52 unexpected ';'.
  compiled code at target\run\customer_churn\models\marts\dim_address.sql
[0m00:47:33.860622 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2c6169a-f451-4778-995d-bdcd35d358b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA4DEAB2C0>]}
[0m00:47:33.860622 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model RAW_public.dim_address ................... [[31mERROR[0m in 0.81s]
[0m00:47:33.860622 [debug] [Thread-1 (]: Finished running node model.customer_churn.dim_address
[0m00:47:33.860622 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:47:33.860622 [debug] [MainThread]: Connection 'list_USER_DB_FALCON' was properly closed.
[0m00:47:33.860622 [debug] [MainThread]: Connection 'list_USER_DB_FALCON_RAW_public' was properly closed.
[0m00:47:33.860622 [debug] [MainThread]: Connection 'model.customer_churn.dim_address' was properly closed.
[0m00:47:33.874330 [debug] [MainThread]: Connection 'model.customer_churn.dim_customer' was properly closed.
[0m00:47:33.874330 [debug] [MainThread]: Connection 'model.customer_churn.fact_churn' was properly closed.
[0m00:47:33.874330 [info ] [MainThread]: 
[0m00:47:33.876398 [info ] [MainThread]: Finished running 3 table models, 1 incremental model in 0 hours 0 minutes and 2.37 seconds (2.37s).
[0m00:47:33.879368 [debug] [MainThread]: Command end result
[0m00:47:33.946317 [info ] [MainThread]: 
[0m00:47:33.947425 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m00:47:33.948851 [info ] [MainThread]: 
[0m00:47:33.951932 [error] [MainThread]:   Database Error in model dim_customer (models\marts\dim_customer.sql)
  001003 (42000): SQL compilation error:
  syntax error line 12 at position 52 unexpected ';'.
  compiled code at target\run\customer_churn\models\marts\dim_customer.sql
[0m00:47:33.953965 [info ] [MainThread]: 
[0m00:47:33.953965 [error] [MainThread]:   Database Error in model fact_churn (models\marts\fact_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 23 at position 0 unexpected ';'.
  compiled code at target\run\customer_churn\models\marts\fact_churn.sql
[0m00:47:33.956012 [info ] [MainThread]: 
[0m00:47:33.959203 [error] [MainThread]:   Database Error in model dim_address (models\marts\dim_address.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 52 unexpected ';'.
  compiled code at target\run\customer_churn\models\marts\dim_address.sql
[0m00:47:33.961339 [info ] [MainThread]: 
[0m00:47:33.962353 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m00:47:33.962353 [debug] [MainThread]: Command `dbt run` failed at 00:47:33.962353 after 3.76 seconds
[0m00:47:33.966178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA4A7C6AB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA4AEDDE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA454C1D00>]}
[0m00:47:33.966178 [debug] [MainThread]: Flushing usage events
[0m00:48:01.553298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB9259DE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB9259D9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB925570B0>]}


============================== 00:48:01.569024 | 8610d550-2771-4b59-a170-d6b70da1a73e ==============================
[0m00:48:01.569024 [info ] [MainThread]: Running with dbt=1.8.2
[0m00:48:01.569024 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select marts', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:48:02.020799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8610d550-2771-4b59-a170-d6b70da1a73e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB92BA9640>]}
[0m00:48:02.062502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8610d550-2771-4b59-a170-d6b70da1a73e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB92EA7530>]}
[0m00:48:02.062502 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m00:48:02.217714 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m00:48:02.328942 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m00:48:02.328942 [debug] [MainThread]: Partial parsing: updated file: customer_churn://models\marts\fact_churn.sql
[0m00:48:02.328942 [debug] [MainThread]: Partial parsing: updated file: customer_churn://models\marts\dim_address.sql
[0m00:48:02.328942 [debug] [MainThread]: Partial parsing: updated file: customer_churn://models\marts\dim_customer.sql
[0m00:48:02.328942 [debug] [MainThread]: Partial parsing: updated file: customer_churn://models\marts\churn_metrics.sql
[0m00:48:02.503709 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:48:02.503709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8610d550-2771-4b59-a170-d6b70da1a73e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB94F66900>]}
[0m00:48:02.668252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8610d550-2771-4b59-a170-d6b70da1a73e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB954134A0>]}
[0m00:48:02.731685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8610d550-2771-4b59-a170-d6b70da1a73e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB951B2D20>]}
[0m00:48:02.731685 [info ] [MainThread]: Found 11 models, 10 data tests, 7 sources, 459 macros
[0m00:48:02.731685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8610d550-2771-4b59-a170-d6b70da1a73e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB94F22900>]}
[0m00:48:02.731685 [info ] [MainThread]: 
[0m00:48:02.731685 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:48:02.747507 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON'
[0m00:48:02.747507 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON"
[0m00:48:02.747507 [debug] [ThreadPool]: On list_USER_DB_FALCON: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON"} */
show terse schemas in database USER_DB_FALCON
    limit 10000
[0m00:48:02.747507 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:48:04.099129 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.352 seconds
[0m00:48:04.099129 [debug] [ThreadPool]: On list_USER_DB_FALCON: Close
[0m00:48:04.232774 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON_RAW_public'
[0m00:48:04.245010 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m00:48:04.245535 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show objects in USER_DB_FALCON.RAW_public limit 10000
[0m00:48:04.246054 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:48:04.623458 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.377 seconds
[0m00:48:04.628252 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m00:48:04.786237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8610d550-2771-4b59-a170-d6b70da1a73e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB9074BCE0>]}
[0m00:48:04.786650 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:48:04.786650 [info ] [MainThread]: 
[0m00:48:04.800285 [debug] [Thread-1 (]: Began running node model.customer_churn.dim_address
[0m00:48:04.803044 [debug] [Thread-2 (]: Began running node model.customer_churn.dim_customer
[0m00:48:04.803044 [debug] [Thread-3 (]: Began running node model.customer_churn.fact_churn
[0m00:48:04.806397 [info ] [Thread-1 (]: 1 of 4 START sql table model RAW_public.dim_address ............................ [RUN]
[0m00:48:04.807873 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.customer_churn.dim_address'
[0m00:48:04.807873 [info ] [Thread-2 (]: 2 of 4 START sql table model RAW_public.dim_customer ........................... [RUN]
[0m00:48:04.813406 [debug] [Thread-1 (]: Began compiling node model.customer_churn.dim_address
[0m00:48:04.816156 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.customer_churn.dim_customer'
[0m00:48:04.807873 [info ] [Thread-3 (]: 3 of 4 START sql incremental model RAW_public.fact_churn ....................... [RUN]
[0m00:48:04.831224 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.dim_address"
[0m00:48:04.831224 [debug] [Thread-2 (]: Began compiling node model.customer_churn.dim_customer
[0m00:48:04.831224 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.customer_churn.fact_churn'
[0m00:48:04.839259 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer_churn.dim_customer"
[0m00:48:04.839259 [debug] [Thread-3 (]: Began compiling node model.customer_churn.fact_churn
[0m00:48:04.841276 [debug] [Thread-1 (]: Began executing node model.customer_churn.dim_address
[0m00:48:04.847305 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.fact_churn"
[0m00:48:04.886285 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.dim_address"
[0m00:48:04.886285 [debug] [Thread-2 (]: Began executing node model.customer_churn.dim_customer
[0m00:48:04.886285 [debug] [Thread-3 (]: Began executing node model.customer_churn.fact_churn
[0m00:48:04.886285 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.dim_address"
[0m00:48:04.893160 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer_churn.dim_customer"
[0m00:48:04.903646 [debug] [Thread-1 (]: On model.customer_churn.dim_address: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.dim_address"} */
create or replace transient table USER_DB_FALCON.RAW_public.dim_address
         as
        (-- models/marts/dim_address.sql


select distinct
  individual_id,
  city,
  state,
  county,
  lat,
  lon
from USER_DB_FALCON.RAW_public.int_customer_enriched
        );
[0m00:48:04.942099 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.fact_churn"
[0m00:48:04.942099 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:48:04.942099 [debug] [Thread-2 (]: Using snowflake connection "model.customer_churn.dim_customer"
[0m00:48:04.942099 [debug] [Thread-2 (]: On model.customer_churn.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.dim_customer"} */
create or replace transient table USER_DB_FALCON.RAW_public.dim_customer
         as
        (-- models/marts/dim_customer.sql


select distinct
  individual_id,
  date_diff('year', date_of_birth, current_date()) as age,
  marital_status,
  has_children,
  length_of_residence
from USER_DB_FALCON.RAW_public.int_customer_enriched
        );
[0m00:48:04.942099 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:48:04.942099 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:48:04.942099 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
create or replace transient table USER_DB_FALCON.RAW_public.fact_churn
         as
        (-- models/marts/fact_churn.sql


select
  t.individual_id,
  t.churn_date,
  e.city,
  e.state,
  e.county,
  e.age_in_years,
  e.days_tenure,
  e.annual_premium,
  c.churn_flag
from USER_DB_FALCON.RAW_public.stg_termination t
join USER_DB_FALCON.RAW_public.int_customer_enriched e
  using (individual_id)
left join USER_DB_FALCON.RAW_public.stg_autoinsurance_churn c
  using (individual_id)


        );
[0m00:48:04.942099 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:48:05.616365 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01bc1e54-0305-25cb-0004-59ff003a87da
[0m00:48:05.620889 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002140 (42601): SQL compilation error:
Unknown function DATE_DIFF
[0m00:48:05.620889 [debug] [Thread-2 (]: On model.customer_churn.dim_customer: Close
[0m00:48:05.746549 [debug] [Thread-2 (]: Database Error in model dim_customer (models\marts\dim_customer.sql)
  002140 (42601): SQL compilation error:
  Unknown function DATE_DIFF
  compiled code at target\run\customer_churn\models\marts\dim_customer.sql
[0m00:48:05.749339 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8610d550-2771-4b59-a170-d6b70da1a73e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB92557950>]}
[0m00:48:05.750704 [error] [Thread-2 (]: 2 of 4 ERROR creating sql table model RAW_public.dim_customer .................. [[31mERROR[0m in 0.93s]
[0m00:48:05.751438 [debug] [Thread-2 (]: Finished running node model.customer_churn.dim_customer
[0m00:48:08.936522 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.993 seconds
[0m00:48:08.952062 [debug] [Thread-3 (]: Applying DROP to: USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
[0m00:48:08.983691 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:48:08.983691 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
drop view if exists USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp cascade
[0m00:48:09.080265 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.105 seconds
[0m00:48:09.108730 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: Close
[0m00:48:09.221771 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8610d550-2771-4b59-a170-d6b70da1a73e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB94E778F0>]}
[0m00:48:09.222801 [info ] [Thread-3 (]: 3 of 4 OK created sql incremental model RAW_public.fact_churn .................. [[32mSUCCESS 1[0m in 4.39s]
[0m00:48:09.223315 [debug] [Thread-3 (]: Finished running node model.customer_churn.fact_churn
[0m00:48:09.224347 [debug] [Thread-4 (]: Began running node model.customer_churn.churn_metrics
[0m00:48:09.224866 [info ] [Thread-4 (]: 4 of 4 START sql table model RAW_public.churn_metrics .......................... [RUN]
[0m00:48:09.225387 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.customer_churn.churn_metrics'
[0m00:48:09.225903 [debug] [Thread-4 (]: Began compiling node model.customer_churn.churn_metrics
[0m00:48:09.229013 [debug] [Thread-4 (]: Writing injected SQL for node "model.customer_churn.churn_metrics"
[0m00:48:09.230079 [debug] [Thread-4 (]: Began executing node model.customer_churn.churn_metrics
[0m00:48:09.232153 [debug] [Thread-4 (]: Writing runtime sql for node "model.customer_churn.churn_metrics"
[0m00:48:09.234225 [debug] [Thread-4 (]: Using snowflake connection "model.customer_churn.churn_metrics"
[0m00:48:09.234740 [debug] [Thread-4 (]: On model.customer_churn.churn_metrics: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.churn_metrics"} */
create or replace transient table USER_DB_FALCON.RAW_public.churn_metrics
         as
        (-- models/marts/churn_metrics.sql


with base as (
  select
    churn_date,
    churn_flag,
    state,
    county,
    age_in_years,
    days_tenure,
    annual_premium
  from USER_DB_FALCON.RAW_public.fact_churn
),

-- 1) monthly trend
monthly as (
  select
    date_trunc('month', churn_date) as month,
    count(*)                     as churn_count
  from base
  where churn_flag = 1
  group by 1
),

-- 2) by state
by_state as (
  select
    state,
    count(*)                     as churn_count
  from base
  where churn_flag = 1
  group by 1
),

-- 3) by age group
by_age as (
  select
    width_bucket(age_in_years, 20, 80, 6) as age_bucket,
    count(*)                            as churn_count
  from base
  where churn_flag = 1
  group by 1
),

-- 4) by tenure bucket
by_tenure as (
  select
    width_bucket(days_tenure, 0, 6000, 6) as tenure_bucket,
    count(*)                             as churn_count
  from base
  where churn_flag = 1
  group by 1
),

-- 5) by premium bucket
by_premium as (
  select
    width_bucket(annual_premium, 0, 2000, 5) as premium_bucket,
    count(*)                               as churn_count
  from base
  where churn_flag = 1
  group by 1
),

-- 6) map points (just pass through lat/lon & flag)
map_pts as (
  select
    churn_date,
    churn_flag,
    lat,
    lon
  from USER_DB_FALCON.RAW_public.int_customer_enriched e
  join USER_DB_FALCON.RAW_public.stg_termination t using (individual_id)
)

select * from monthly
union all
select * from by_state
union all
select * from by_age
union all
select * from by_tenure
union all
select * from by_premium
union all
select * from map_pts
        );
[0m00:48:09.235258 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:48:09.947517 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 5.001 seconds
[0m00:48:09.947517 [debug] [Thread-1 (]: On model.customer_churn.dim_address: Close
[0m00:48:10.011437 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01bc1e54-0305-1c2f-0004-59ff003a2aa2
[0m00:48:10.011437 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 72 at position 4
invalid identifier 'CHURN_FLAG'
[0m00:48:10.011437 [debug] [Thread-4 (]: On model.customer_churn.churn_metrics: Close
[0m00:48:10.122657 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8610d550-2771-4b59-a170-d6b70da1a73e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB9578AC30>]}
[0m00:48:10.122657 [info ] [Thread-1 (]: 1 of 4 OK created sql table model RAW_public.dim_address ....................... [[32mSUCCESS 1[0m in 5.31s]
[0m00:48:10.122657 [debug] [Thread-1 (]: Finished running node model.customer_churn.dim_address
[0m00:48:10.181573 [debug] [Thread-4 (]: Database Error in model churn_metrics (models\marts\churn_metrics.sql)
  000904 (42000): SQL compilation error: error line 72 at position 4
  invalid identifier 'CHURN_FLAG'
  compiled code at target\run\customer_churn\models\marts\churn_metrics.sql
[0m00:48:10.181573 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8610d550-2771-4b59-a170-d6b70da1a73e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB95604EF0>]}
[0m00:48:10.190089 [error] [Thread-4 (]: 4 of 4 ERROR creating sql table model RAW_public.churn_metrics ................. [[31mERROR[0m in 0.96s]
[0m00:48:10.191676 [debug] [Thread-4 (]: Finished running node model.customer_churn.churn_metrics
[0m00:48:10.191676 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:48:10.191676 [debug] [MainThread]: Connection 'list_USER_DB_FALCON' was properly closed.
[0m00:48:10.198671 [debug] [MainThread]: Connection 'list_USER_DB_FALCON_RAW_public' was properly closed.
[0m00:48:10.198671 [debug] [MainThread]: Connection 'model.customer_churn.dim_address' was properly closed.
[0m00:48:10.198671 [debug] [MainThread]: Connection 'model.customer_churn.dim_customer' was properly closed.
[0m00:48:10.198671 [debug] [MainThread]: Connection 'model.customer_churn.fact_churn' was properly closed.
[0m00:48:10.198671 [debug] [MainThread]: Connection 'model.customer_churn.churn_metrics' was properly closed.
[0m00:48:10.198671 [info ] [MainThread]: 
[0m00:48:10.198671 [info ] [MainThread]: Finished running 3 table models, 1 incremental model in 0 hours 0 minutes and 7.47 seconds (7.47s).
[0m00:48:10.207685 [debug] [MainThread]: Command end result
[0m00:48:10.258666 [info ] [MainThread]: 
[0m00:48:10.258666 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m00:48:10.258666 [info ] [MainThread]: 
[0m00:48:10.258666 [error] [MainThread]:   Database Error in model dim_customer (models\marts\dim_customer.sql)
  002140 (42601): SQL compilation error:
  Unknown function DATE_DIFF
  compiled code at target\run\customer_churn\models\marts\dim_customer.sql
[0m00:48:10.272801 [info ] [MainThread]: 
[0m00:48:10.274058 [error] [MainThread]:   Database Error in model churn_metrics (models\marts\churn_metrics.sql)
  000904 (42000): SQL compilation error: error line 72 at position 4
  invalid identifier 'CHURN_FLAG'
  compiled code at target\run\customer_churn\models\marts\churn_metrics.sql
[0m00:48:10.274058 [info ] [MainThread]: 
[0m00:48:10.274058 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m00:48:10.274058 [debug] [MainThread]: Command `dbt run` failed at 00:48:10.274058 after 8.97 seconds
[0m00:48:10.274058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB92CD3E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB929FDE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB92D07D40>]}
[0m00:48:10.274058 [debug] [MainThread]: Flushing usage events
[0m00:50:27.163511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5F10D9E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5F11EDC70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5F11ECCB0>]}


============================== 00:50:27.173108 | 099e9d3b-acdd-4ab4-ab6a-bf006d102015 ==============================
[0m00:50:27.173108 [info ] [MainThread]: Running with dbt=1.8.2
[0m00:50:27.173108 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt\\logs', 'profiles_dir': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select marts', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:50:27.684082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '099e9d3b-acdd-4ab4-ab6a-bf006d102015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5F36BB110>]}
[0m00:50:27.722949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '099e9d3b-acdd-4ab4-ab6a-bf006d102015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5F11EC3B0>]}
[0m00:50:27.722949 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m00:50:27.874165 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m00:50:27.972814 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m00:50:27.972814 [debug] [MainThread]: Partial parsing: updated file: customer_churn://models\marts\churn_metrics.sql
[0m00:50:27.983256 [debug] [MainThread]: Partial parsing: updated file: customer_churn://models\marts\dim_customer.sql
[0m00:50:28.193109 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:50:28.198399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '099e9d3b-acdd-4ab4-ab6a-bf006d102015', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5F04E4D70>]}
[0m00:50:28.405123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '099e9d3b-acdd-4ab4-ab6a-bf006d102015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5F3AA33B0>]}
[0m00:50:28.485146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '099e9d3b-acdd-4ab4-ab6a-bf006d102015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5F1A981A0>]}
[0m00:50:28.485146 [info ] [MainThread]: Found 11 models, 10 data tests, 7 sources, 459 macros
[0m00:50:28.485146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '099e9d3b-acdd-4ab4-ab6a-bf006d102015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5F01B2AE0>]}
[0m00:50:28.493301 [info ] [MainThread]: 
[0m00:50:28.493301 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:50:28.493301 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON'
[0m00:50:28.513725 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON"
[0m00:50:28.513725 [debug] [ThreadPool]: On list_USER_DB_FALCON: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON"} */
show terse schemas in database USER_DB_FALCON
    limit 10000
[0m00:50:28.513725 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:50:29.143110 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.634 seconds
[0m00:50:29.143110 [debug] [ThreadPool]: On list_USER_DB_FALCON: Close
[0m00:50:29.303781 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON_RAW_public'
[0m00:50:29.313329 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m00:50:29.313329 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show objects in USER_DB_FALCON.RAW_public limit 10000
[0m00:50:29.313329 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:50:30.335278 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.019 seconds
[0m00:50:30.336688 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m00:50:30.580619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '099e9d3b-acdd-4ab4-ab6a-bf006d102015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5F37FCDD0>]}
[0m00:50:30.580619 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:50:30.583559 [info ] [MainThread]: 
[0m00:50:30.592883 [debug] [Thread-1 (]: Began running node model.customer_churn.dim_address
[0m00:50:30.592883 [debug] [Thread-2 (]: Began running node model.customer_churn.dim_customer
[0m00:50:30.592883 [debug] [Thread-3 (]: Began running node model.customer_churn.fact_churn
[0m00:50:30.592883 [info ] [Thread-1 (]: 1 of 4 START sql table model RAW_public.dim_address ............................ [RUN]
[0m00:50:30.592883 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.customer_churn.dim_address'
[0m00:50:30.592883 [debug] [Thread-1 (]: Began compiling node model.customer_churn.dim_address
[0m00:50:30.592883 [info ] [Thread-2 (]: 2 of 4 START sql table model RAW_public.dim_customer ........................... [RUN]
[0m00:50:30.608134 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.dim_address"
[0m00:50:30.592883 [info ] [Thread-3 (]: 3 of 4 START sql incremental model RAW_public.fact_churn ....................... [RUN]
[0m00:50:30.608134 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.customer_churn.dim_customer'
[0m00:50:30.608134 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.customer_churn.fact_churn'
[0m00:50:30.612932 [debug] [Thread-2 (]: Began compiling node model.customer_churn.dim_customer
[0m00:50:30.612932 [debug] [Thread-1 (]: Began executing node model.customer_churn.dim_address
[0m00:50:30.612932 [debug] [Thread-3 (]: Began compiling node model.customer_churn.fact_churn
[0m00:50:30.616030 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer_churn.dim_customer"
[0m00:50:30.650148 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.fact_churn"
[0m00:50:30.658220 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.dim_address"
[0m00:50:30.658220 [debug] [Thread-3 (]: Began executing node model.customer_churn.fact_churn
[0m00:50:30.663081 [debug] [Thread-2 (]: Began executing node model.customer_churn.dim_customer
[0m00:50:30.663081 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.dim_address"
[0m00:50:30.683016 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer_churn.dim_customer"
[0m00:50:30.717198 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:50:30.717198 [debug] [Thread-1 (]: On model.customer_churn.dim_address: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.dim_address"} */
create or replace transient table USER_DB_FALCON.RAW_public.dim_address
         as
        (-- models/marts/dim_address.sql


select distinct
  individual_id,
  city,
  state,
  county,
  lat,
  lon
from USER_DB_FALCON.RAW_public.int_customer_enriched
        );
[0m00:50:30.717198 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
create or replace  temporary view USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
  
   as (
    -- models/marts/fact_churn.sql


select
  t.individual_id,
  t.churn_date,
  e.city,
  e.state,
  e.county,
  e.age_in_years,
  e.days_tenure,
  e.annual_premium,
  c.churn_flag
from USER_DB_FALCON.RAW_public.stg_termination t
join USER_DB_FALCON.RAW_public.int_customer_enriched e
  using (individual_id)
left join USER_DB_FALCON.RAW_public.stg_autoinsurance_churn c
  using (individual_id)


where t.churn_date > (select max(churn_date) from USER_DB_FALCON.RAW_public.fact_churn)

  );
[0m00:50:30.722869 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:50:30.722869 [debug] [Thread-2 (]: Using snowflake connection "model.customer_churn.dim_customer"
[0m00:50:30.722869 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:50:30.726793 [debug] [Thread-2 (]: On model.customer_churn.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.dim_customer"} */
create or replace transient table USER_DB_FALCON.RAW_public.dim_customer
         as
        (-- models/marts/dim_customer.sql


select distinct
  individual_id,
  age_in_years as age,
  marital_status,
  has_children,
  length_of_residence
from USER_DB_FALCON.RAW_public.int_customer_enriched
        );
[0m00:50:30.726793 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:50:31.943197 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.219 seconds
[0m00:50:31.958120 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:50:31.962962 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
[0m00:50:32.074416 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 0.111 seconds
[0m00:50:32.083453 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:50:32.083453 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table USER_DB_FALCON.RAW_public.fact_churn
[0m00:50:32.352936 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 0.270 seconds
[0m00:50:32.365859 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:50:32.373197 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table "USER_DB_FALCON"."RAW_PUBLIC"."FACT_CHURN"
[0m00:50:32.583170 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 0.215 seconds
[0m00:50:32.633323 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.fact_churn"
[0m00:50:32.633323 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:50:32.638678 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
-- back compat for old kwarg name
  
  begin;
[0m00:50:32.952978 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.314 seconds
[0m00:50:32.952978 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:50:32.952978 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
merge into USER_DB_FALCON.RAW_public.fact_churn as DBT_INTERNAL_DEST
        using USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.individual_id = DBT_INTERNAL_DEST.individual_id
                ) and (
                    DBT_INTERNAL_SOURCE.churn_date = DBT_INTERNAL_DEST.churn_date
                )

    
    when matched then update set
        "INDIVIDUAL_ID" = DBT_INTERNAL_SOURCE."INDIVIDUAL_ID","CHURN_DATE" = DBT_INTERNAL_SOURCE."CHURN_DATE","CITY" = DBT_INTERNAL_SOURCE."CITY","STATE" = DBT_INTERNAL_SOURCE."STATE","COUNTY" = DBT_INTERNAL_SOURCE."COUNTY","AGE_IN_YEARS" = DBT_INTERNAL_SOURCE."AGE_IN_YEARS","DAYS_TENURE" = DBT_INTERNAL_SOURCE."DAYS_TENURE","ANNUAL_PREMIUM" = DBT_INTERNAL_SOURCE."ANNUAL_PREMIUM","CHURN_FLAG" = DBT_INTERNAL_SOURCE."CHURN_FLAG"
    

    when not matched then insert
        ("INDIVIDUAL_ID", "CHURN_DATE", "CITY", "STATE", "COUNTY", "AGE_IN_YEARS", "DAYS_TENURE", "ANNUAL_PREMIUM", "CHURN_FLAG")
    values
        ("INDIVIDUAL_ID", "CHURN_DATE", "CITY", "STATE", "COUNTY", "AGE_IN_YEARS", "DAYS_TENURE", "ANNUAL_PREMIUM", "CHURN_FLAG")

;
[0m00:50:34.686473 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.956 seconds
[0m00:50:34.704766 [debug] [Thread-2 (]: On model.customer_churn.dim_customer: Close
[0m00:50:34.754049 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.032 seconds
[0m00:50:34.761587 [debug] [Thread-1 (]: On model.customer_churn.dim_address: Close
[0m00:50:34.839005 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '099e9d3b-acdd-4ab4-ab6a-bf006d102015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5F3677950>]}
[0m00:50:34.839005 [info ] [Thread-2 (]: 2 of 4 OK created sql table model RAW_public.dim_customer ...................... [[32mSUCCESS 1[0m in 4.23s]
[0m00:50:34.841069 [debug] [Thread-2 (]: Finished running node model.customer_churn.dim_customer
[0m00:50:34.903377 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '099e9d3b-acdd-4ab4-ab6a-bf006d102015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5F3FD7BC0>]}
[0m00:50:34.903377 [info ] [Thread-1 (]: 1 of 4 OK created sql table model RAW_public.dim_address ....................... [[32mSUCCESS 1[0m in 4.31s]
[0m00:50:34.907371 [debug] [Thread-1 (]: Finished running node model.customer_churn.dim_address
[0m00:50:35.423090 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 2.469 seconds
[0m00:50:35.423090 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:50:35.423090 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
COMMIT
[0m00:50:35.950576 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.523 seconds
[0m00:50:35.968037 [debug] [Thread-3 (]: Applying DROP to: USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
[0m00:50:35.973046 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:50:35.973046 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
drop view if exists USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp cascade
[0m00:50:36.102882 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.127 seconds
[0m00:50:36.107993 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: Close
[0m00:50:36.242873 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '099e9d3b-acdd-4ab4-ab6a-bf006d102015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5F3EB38C0>]}
[0m00:50:36.242873 [info ] [Thread-3 (]: 3 of 4 OK created sql incremental model RAW_public.fact_churn .................. [[32mSUCCESS 0[0m in 5.63s]
[0m00:50:36.251175 [debug] [Thread-3 (]: Finished running node model.customer_churn.fact_churn
[0m00:50:36.253190 [debug] [Thread-4 (]: Began running node model.customer_churn.churn_metrics
[0m00:50:36.253190 [info ] [Thread-4 (]: 4 of 4 START sql table model RAW_public.churn_metrics .......................... [RUN]
[0m00:50:36.253190 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.customer_churn.churn_metrics'
[0m00:50:36.258208 [debug] [Thread-4 (]: Began compiling node model.customer_churn.churn_metrics
[0m00:50:36.269804 [debug] [Thread-4 (]: Writing injected SQL for node "model.customer_churn.churn_metrics"
[0m00:50:36.269804 [debug] [Thread-4 (]: Began executing node model.customer_churn.churn_metrics
[0m00:50:36.273668 [debug] [Thread-4 (]: Writing runtime sql for node "model.customer_churn.churn_metrics"
[0m00:50:36.279607 [debug] [Thread-4 (]: Using snowflake connection "model.customer_churn.churn_metrics"
[0m00:50:36.279607 [debug] [Thread-4 (]: On model.customer_churn.churn_metrics: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.churn_metrics"} */
create or replace transient table USER_DB_FALCON.RAW_public.churn_metrics
         as
        (-- models/marts/churn_metrics.sql


with base as (
  select
    churn_date,
    churn_flag,
    state,
    county,
    age_in_years,
    days_tenure,
    annual_premium
  from USER_DB_FALCON.RAW_public.fact_churn
),

monthly as (
  select
    date_trunc('month', churn_date)       as period,
    sum(churn_flag)                       as churn_count
  from base
  group by 1
),

by_state as (
  select
    state                                 as category,
    sum(churn_flag)                       as churn_count
  from base
  group by 1
),

by_age as (
  select
    width_bucket(age_in_years, 20, 80, 6) as category,
    sum(churn_flag)                       as churn_count
  from base
  group by 1
),

by_tenure as (
  select
    width_bucket(days_tenure, 0, 6000, 6) as category,
    sum(churn_flag)                       as churn_count
  from base
  group by 1
),

by_premium as (
  select
    width_bucket(annual_premium, 0, 2000, 5) as category,
    sum(churn_flag)                         as churn_count
  from base
  group by 1
),

map_pts as (
  select
    f.churn_date,
    f.churn_flag,
    e.lat,
    e.lon
  from USER_DB_FALCON.RAW_public.fact_churn        f
  join USER_DB_FALCON.RAW_public.int_customer_enriched e
    using (individual_id)
)

select * from monthly
union all
select * from by_state
union all
select * from by_age
union all
select * from by_tenure
union all
select * from by_premium
union all
select * from map_pts
;
[0m00:50:36.281744 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:50:36.724285 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01bc1e56-0305-1c2f-0004-59ff003a2aae
[0m00:50:36.724285 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 80 at position 0 unexpected ';'.
[0m00:50:36.733357 [debug] [Thread-4 (]: On model.customer_churn.churn_metrics: Close
[0m00:50:36.953178 [debug] [Thread-4 (]: Database Error in model churn_metrics (models\marts\churn_metrics.sql)
  001003 (42000): SQL compilation error:
  syntax error line 80 at position 0 unexpected ';'.
  compiled code at target\run\customer_churn\models\marts\churn_metrics.sql
[0m00:50:36.958466 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '099e9d3b-acdd-4ab4-ab6a-bf006d102015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5F3E14AA0>]}
[0m00:50:36.958466 [error] [Thread-4 (]: 4 of 4 ERROR creating sql table model RAW_public.churn_metrics ................. [[31mERROR[0m in 0.71s]
[0m00:50:36.958466 [debug] [Thread-4 (]: Finished running node model.customer_churn.churn_metrics
[0m00:50:36.963078 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:50:36.968489 [debug] [MainThread]: Connection 'list_USER_DB_FALCON' was properly closed.
[0m00:50:36.968489 [debug] [MainThread]: Connection 'list_USER_DB_FALCON_RAW_public' was properly closed.
[0m00:50:36.968489 [debug] [MainThread]: Connection 'model.customer_churn.dim_address' was properly closed.
[0m00:50:36.968489 [debug] [MainThread]: Connection 'model.customer_churn.dim_customer' was properly closed.
[0m00:50:36.968489 [debug] [MainThread]: Connection 'model.customer_churn.fact_churn' was properly closed.
[0m00:50:36.968489 [debug] [MainThread]: Connection 'model.customer_churn.churn_metrics' was properly closed.
[0m00:50:36.973275 [info ] [MainThread]: 
[0m00:50:36.973275 [info ] [MainThread]: Finished running 3 table models, 1 incremental model in 0 hours 0 minutes and 8.48 seconds (8.48s).
[0m00:50:36.980104 [debug] [MainThread]: Command end result
[0m00:50:37.027625 [info ] [MainThread]: 
[0m00:50:37.027625 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:50:37.027625 [info ] [MainThread]: 
[0m00:50:37.033347 [error] [MainThread]:   Database Error in model churn_metrics (models\marts\churn_metrics.sql)
  001003 (42000): SQL compilation error:
  syntax error line 80 at position 0 unexpected ';'.
  compiled code at target\run\customer_churn\models\marts\churn_metrics.sql
[0m00:50:37.033347 [info ] [MainThread]: 
[0m00:50:37.033347 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m00:50:37.033347 [debug] [MainThread]: Command `dbt run` failed at 00:50:37.033347 after 10.10 seconds
[0m00:50:37.033347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5F05CDB80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5F3BAF1A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5F3BACDD0>]}
[0m00:50:37.033347 [debug] [MainThread]: Flushing usage events
[0m00:51:01.875962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002051717DB20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020516B2AA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020516B2BD40>]}


============================== 00:51:01.879401 | c5a581ee-50a5-4745-bfa0-d08b309e43d0 ==============================
[0m00:51:01.879401 [info ] [MainThread]: Running with dbt=1.8.2
[0m00:51:01.880619 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select marts', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:51:02.194006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c5a581ee-50a5-4745-bfa0-d08b309e43d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020519C66900>]}
[0m00:51:02.262876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c5a581ee-50a5-4745-bfa0-d08b309e43d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002051772C8F0>]}
[0m00:51:02.262876 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m00:51:02.412919 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m00:51:02.509360 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:51:02.509360 [debug] [MainThread]: Partial parsing: updated file: customer_churn://models\marts\churn_metrics.sql
[0m00:51:02.833193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c5a581ee-50a5-4745-bfa0-d08b309e43d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002051A09EC30>]}
[0m00:51:02.903235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c5a581ee-50a5-4745-bfa0-d08b309e43d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002051A07C2F0>]}
[0m00:51:02.903235 [info ] [MainThread]: Found 11 models, 10 data tests, 7 sources, 459 macros
[0m00:51:02.903235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5a581ee-50a5-4745-bfa0-d08b309e43d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002051A09CDA0>]}
[0m00:51:02.905913 [info ] [MainThread]: 
[0m00:51:02.905913 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:51:02.905913 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON'
[0m00:51:02.916577 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON"
[0m00:51:02.916577 [debug] [ThreadPool]: On list_USER_DB_FALCON: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON"} */
show terse schemas in database USER_DB_FALCON
    limit 10000
[0m00:51:02.916577 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:51:04.220648 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.300 seconds
[0m00:51:04.225321 [debug] [ThreadPool]: On list_USER_DB_FALCON: Close
[0m00:51:04.692892 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON_RAW_public'
[0m00:51:04.707536 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m00:51:04.708410 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show objects in USER_DB_FALCON.RAW_public limit 10000
[0m00:51:04.708410 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:51:05.427006 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.720 seconds
[0m00:51:05.431576 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m00:51:05.567461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5a581ee-50a5-4745-bfa0-d08b309e43d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002051A07C740>]}
[0m00:51:05.568517 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:51:05.569032 [info ] [MainThread]: 
[0m00:51:05.574267 [debug] [Thread-1 (]: Began running node model.customer_churn.dim_address
[0m00:51:05.574785 [debug] [Thread-2 (]: Began running node model.customer_churn.dim_customer
[0m00:51:05.575685 [debug] [Thread-3 (]: Began running node model.customer_churn.fact_churn
[0m00:51:05.575359 [info ] [Thread-1 (]: 1 of 4 START sql table model RAW_public.dim_address ............................ [RUN]
[0m00:51:05.576722 [info ] [Thread-2 (]: 2 of 4 START sql table model RAW_public.dim_customer ........................... [RUN]
[0m00:51:05.577758 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.customer_churn.dim_address'
[0m00:51:05.578844 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.customer_churn.dim_customer'
[0m00:51:05.577241 [info ] [Thread-3 (]: 3 of 4 START sql incremental model RAW_public.fact_churn ....................... [RUN]
[0m00:51:05.579381 [debug] [Thread-1 (]: Began compiling node model.customer_churn.dim_address
[0m00:51:05.579899 [debug] [Thread-2 (]: Began compiling node model.customer_churn.dim_customer
[0m00:51:05.580412 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.customer_churn.fact_churn'
[0m00:51:05.587303 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.dim_address"
[0m00:51:05.591266 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer_churn.dim_customer"
[0m00:51:05.591949 [debug] [Thread-3 (]: Began compiling node model.customer_churn.fact_churn
[0m00:51:05.599152 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.fact_churn"
[0m00:51:05.599152 [debug] [Thread-1 (]: Began executing node model.customer_churn.dim_address
[0m00:51:05.615559 [debug] [Thread-2 (]: Began executing node model.customer_churn.dim_customer
[0m00:51:05.623176 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.dim_address"
[0m00:51:05.623176 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer_churn.dim_customer"
[0m00:51:05.623176 [debug] [Thread-3 (]: Began executing node model.customer_churn.fact_churn
[0m00:51:05.623176 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.dim_address"
[0m00:51:05.648100 [debug] [Thread-2 (]: Using snowflake connection "model.customer_churn.dim_customer"
[0m00:51:05.656936 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:51:05.656936 [debug] [Thread-1 (]: On model.customer_churn.dim_address: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.dim_address"} */
create or replace transient table USER_DB_FALCON.RAW_public.dim_address
         as
        (-- models/marts/dim_address.sql


select distinct
  individual_id,
  city,
  state,
  county,
  lat,
  lon
from USER_DB_FALCON.RAW_public.int_customer_enriched
        );
[0m00:51:05.656936 [debug] [Thread-2 (]: On model.customer_churn.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.dim_customer"} */
create or replace transient table USER_DB_FALCON.RAW_public.dim_customer
         as
        (-- models/marts/dim_customer.sql


select distinct
  individual_id,
  age_in_years as age,
  marital_status,
  has_children,
  length_of_residence
from USER_DB_FALCON.RAW_public.int_customer_enriched
        );
[0m00:51:05.663184 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
create or replace  temporary view USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
  
   as (
    -- models/marts/fact_churn.sql


select
  t.individual_id,
  t.churn_date,
  e.city,
  e.state,
  e.county,
  e.age_in_years,
  e.days_tenure,
  e.annual_premium,
  c.churn_flag
from USER_DB_FALCON.RAW_public.stg_termination t
join USER_DB_FALCON.RAW_public.int_customer_enriched e
  using (individual_id)
left join USER_DB_FALCON.RAW_public.stg_autoinsurance_churn c
  using (individual_id)


where t.churn_date > (select max(churn_date) from USER_DB_FALCON.RAW_public.fact_churn)

  );
[0m00:51:05.663184 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:51:05.663184 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:51:05.665023 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:51:07.016857 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.354 seconds
[0m00:51:07.033251 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:51:07.033251 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
[0m00:51:07.182134 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 0.146 seconds
[0m00:51:07.184673 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:51:07.184673 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table USER_DB_FALCON.RAW_public.fact_churn
[0m00:51:07.443225 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 0.262 seconds
[0m00:51:07.466687 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:51:07.466687 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table "USER_DB_FALCON"."RAW_PUBLIC"."FACT_CHURN"
[0m00:51:07.646554 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 0.178 seconds
[0m00:51:07.713333 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.fact_churn"
[0m00:51:07.716476 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:51:07.716476 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
-- back compat for old kwarg name
  
  begin;
[0m00:51:08.093216 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.375 seconds
[0m00:51:08.093216 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:51:08.093216 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
merge into USER_DB_FALCON.RAW_public.fact_churn as DBT_INTERNAL_DEST
        using USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.individual_id = DBT_INTERNAL_DEST.individual_id
                ) and (
                    DBT_INTERNAL_SOURCE.churn_date = DBT_INTERNAL_DEST.churn_date
                )

    
    when matched then update set
        "INDIVIDUAL_ID" = DBT_INTERNAL_SOURCE."INDIVIDUAL_ID","CHURN_DATE" = DBT_INTERNAL_SOURCE."CHURN_DATE","CITY" = DBT_INTERNAL_SOURCE."CITY","STATE" = DBT_INTERNAL_SOURCE."STATE","COUNTY" = DBT_INTERNAL_SOURCE."COUNTY","AGE_IN_YEARS" = DBT_INTERNAL_SOURCE."AGE_IN_YEARS","DAYS_TENURE" = DBT_INTERNAL_SOURCE."DAYS_TENURE","ANNUAL_PREMIUM" = DBT_INTERNAL_SOURCE."ANNUAL_PREMIUM","CHURN_FLAG" = DBT_INTERNAL_SOURCE."CHURN_FLAG"
    

    when not matched then insert
        ("INDIVIDUAL_ID", "CHURN_DATE", "CITY", "STATE", "COUNTY", "AGE_IN_YEARS", "DAYS_TENURE", "ANNUAL_PREMIUM", "CHURN_FLAG")
    values
        ("INDIVIDUAL_ID", "CHURN_DATE", "CITY", "STATE", "COUNTY", "AGE_IN_YEARS", "DAYS_TENURE", "ANNUAL_PREMIUM", "CHURN_FLAG")

;
[0m00:51:08.905665 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.248 seconds
[0m00:51:08.937565 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 0.841 seconds
[0m00:51:08.953067 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:51:08.958280 [debug] [Thread-1 (]: On model.customer_churn.dim_address: Close
[0m00:51:08.958280 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
COMMIT
[0m00:51:09.218661 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.251 seconds
[0m00:51:09.232848 [debug] [Thread-3 (]: Applying DROP to: USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
[0m00:51:09.241573 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:51:09.246078 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
drop view if exists USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp cascade
[0m00:51:09.363189 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5a581ee-50a5-4745-bfa0-d08b309e43d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020519B77AD0>]}
[0m00:51:09.363189 [info ] [Thread-1 (]: 1 of 4 OK created sql table model RAW_public.dim_address ....................... [[32mSUCCESS 1[0m in 3.79s]
[0m00:51:09.363189 [debug] [Thread-1 (]: Finished running node model.customer_churn.dim_address
[0m00:51:09.442839 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.200 seconds
[0m00:51:09.442839 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: Close
[0m00:51:09.733050 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5a581ee-50a5-4745-bfa0-d08b309e43d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002051A263EF0>]}
[0m00:51:09.737874 [info ] [Thread-3 (]: 3 of 4 OK created sql incremental model RAW_public.fact_churn .................. [[32mSUCCESS 0[0m in 4.15s]
[0m00:51:09.737874 [debug] [Thread-3 (]: Finished running node model.customer_churn.fact_churn
[0m00:51:09.741569 [debug] [Thread-4 (]: Began running node model.customer_churn.churn_metrics
[0m00:51:09.743705 [info ] [Thread-4 (]: 4 of 4 START sql table model RAW_public.churn_metrics .......................... [RUN]
[0m00:51:09.743705 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.customer_churn.churn_metrics'
[0m00:51:09.743705 [debug] [Thread-4 (]: Began compiling node model.customer_churn.churn_metrics
[0m00:51:09.753280 [debug] [Thread-4 (]: Writing injected SQL for node "model.customer_churn.churn_metrics"
[0m00:51:09.753280 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 4.093 seconds
[0m00:51:09.760943 [debug] [Thread-2 (]: On model.customer_churn.dim_customer: Close
[0m00:51:09.763512 [debug] [Thread-4 (]: Began executing node model.customer_churn.churn_metrics
[0m00:51:09.773809 [debug] [Thread-4 (]: Writing runtime sql for node "model.customer_churn.churn_metrics"
[0m00:51:09.782862 [debug] [Thread-4 (]: Using snowflake connection "model.customer_churn.churn_metrics"
[0m00:51:09.782862 [debug] [Thread-4 (]: On model.customer_churn.churn_metrics: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.churn_metrics"} */
create or replace transient table USER_DB_FALCON.RAW_public.churn_metrics
         as
        (-- models/marts/churn_metrics.sql


with base as (
  select
    churn_date,
    churn_flag,
    state,
    county,
    age_in_years,
    days_tenure,
    annual_premium
  from USER_DB_FALCON.RAW_public.fact_churn
),

monthly as (
  select
    date_trunc('month', churn_date)       as period,
    sum(churn_flag)                       as churn_count
  from base
  group by 1
),

by_state as (
  select
    state                                 as category,
    sum(churn_flag)                       as churn_count
  from base
  group by 1
),

by_age as (
  select
    width_bucket(age_in_years, 20, 80, 6) as category,
    sum(churn_flag)                       as churn_count
  from base
  group by 1
),

by_tenure as (
  select
    width_bucket(days_tenure, 0, 6000, 6) as category,
    sum(churn_flag)                       as churn_count
  from base
  group by 1
),

by_premium as (
  select
    width_bucket(annual_premium, 0, 2000, 5) as category,
    sum(churn_flag)                         as churn_count
  from base
  group by 1
),

map_pts as (
  select
    f.churn_date,
    f.churn_flag,
    e.lat,
    e.lon
  from USER_DB_FALCON.RAW_public.fact_churn        f
  join USER_DB_FALCON.RAW_public.int_customer_enriched e
    using (individual_id)
)

select * from monthly
union all
select * from by_state
union all
select * from by_age
union all
select * from by_tenure
union all
select * from by_premium
union all
select * from map_pts
        );
[0m00:51:09.782862 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:51:10.012920 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5a581ee-50a5-4745-bfa0-d08b309e43d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002051A3BB530>]}
[0m00:51:10.012920 [info ] [Thread-2 (]: 2 of 4 OK created sql table model RAW_public.dim_customer ...................... [[32mSUCCESS 1[0m in 4.43s]
[0m00:51:10.023133 [debug] [Thread-2 (]: Finished running node model.customer_churn.dim_customer
[0m00:51:10.643038 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01bc1e57-0305-1c2f-0004-59ff003a2aba
[0m00:51:10.643038 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 001789 (42601): SQL compilation error:
invalid number of result columns for set operator input branches, expected 2, got 4 in branch 6
[0m00:51:10.643038 [debug] [Thread-4 (]: On model.customer_churn.churn_metrics: Close
[0m00:51:10.791259 [debug] [Thread-4 (]: Database Error in model churn_metrics (models\marts\churn_metrics.sql)
  001789 (42601): SQL compilation error:
  invalid number of result columns for set operator input branches, expected 2, got 4 in branch 6
  compiled code at target\run\customer_churn\models\marts\churn_metrics.sql
[0m00:51:10.791259 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5a581ee-50a5-4745-bfa0-d08b309e43d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002051A482B10>]}
[0m00:51:10.792868 [error] [Thread-4 (]: 4 of 4 ERROR creating sql table model RAW_public.churn_metrics ................. [[31mERROR[0m in 1.05s]
[0m00:51:10.792868 [debug] [Thread-4 (]: Finished running node model.customer_churn.churn_metrics
[0m00:51:10.792868 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:51:10.800962 [debug] [MainThread]: Connection 'list_USER_DB_FALCON' was properly closed.
[0m00:51:10.800962 [debug] [MainThread]: Connection 'list_USER_DB_FALCON_RAW_public' was properly closed.
[0m00:51:10.800962 [debug] [MainThread]: Connection 'model.customer_churn.dim_address' was properly closed.
[0m00:51:10.800962 [debug] [MainThread]: Connection 'model.customer_churn.dim_customer' was properly closed.
[0m00:51:10.800962 [debug] [MainThread]: Connection 'model.customer_churn.fact_churn' was properly closed.
[0m00:51:10.800962 [debug] [MainThread]: Connection 'model.customer_churn.churn_metrics' was properly closed.
[0m00:51:10.800962 [info ] [MainThread]: 
[0m00:51:10.803423 [info ] [MainThread]: Finished running 3 table models, 1 incremental model in 0 hours 0 minutes and 7.90 seconds (7.90s).
[0m00:51:10.803423 [debug] [MainThread]: Command end result
[0m00:51:10.834835 [info ] [MainThread]: 
[0m00:51:10.834835 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:51:10.834835 [info ] [MainThread]: 
[0m00:51:10.834835 [error] [MainThread]:   Database Error in model churn_metrics (models\marts\churn_metrics.sql)
  001789 (42601): SQL compilation error:
  invalid number of result columns for set operator input branches, expected 2, got 4 in branch 6
  compiled code at target\run\customer_churn\models\marts\churn_metrics.sql
[0m00:51:10.840559 [info ] [MainThread]: 
[0m00:51:10.840559 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m00:51:10.843219 [debug] [MainThread]: Command `dbt run` failed at 00:51:10.843219 after 9.19 seconds
[0m00:51:10.843219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205166B2D20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020516B2AA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002051811D100>]}
[0m00:51:10.843219 [debug] [MainThread]: Flushing usage events
[0m00:53:50.942994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FE4D67CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FE4CC22A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FE45B7080>]}


============================== 00:53:50.942994 | 77755a65-a589-4677-a8bb-ac8b47b2d45b ==============================
[0m00:53:50.942994 [info ] [MainThread]: Running with dbt=1.8.2
[0m00:53:50.942994 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select marts', 'send_anonymous_usage_stats': 'True'}
[0m00:53:51.373198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '77755a65-a589-4677-a8bb-ac8b47b2d45b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FE6E4C230>]}
[0m00:53:51.402757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '77755a65-a589-4677-a8bb-ac8b47b2d45b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FE70164B0>]}
[0m00:53:51.402757 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m00:53:51.563096 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m00:53:51.673027 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:53:51.673027 [debug] [MainThread]: Partial parsing: updated file: customer_churn://models\marts\churn_metrics.sql
[0m00:53:51.938668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '77755a65-a589-4677-a8bb-ac8b47b2d45b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FE74434D0>]}
[0m00:53:52.028013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '77755a65-a589-4677-a8bb-ac8b47b2d45b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FE7413410>]}
[0m00:53:52.028013 [info ] [MainThread]: Found 11 models, 10 data tests, 7 sources, 459 macros
[0m00:53:52.028013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77755a65-a589-4677-a8bb-ac8b47b2d45b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FE42495B0>]}
[0m00:53:52.032867 [info ] [MainThread]: 
[0m00:53:52.034985 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:53:52.039586 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON'
[0m00:53:52.055018 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON"
[0m00:53:52.055018 [debug] [ThreadPool]: On list_USER_DB_FALCON: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON"} */
show terse schemas in database USER_DB_FALCON
    limit 10000
[0m00:53:52.055018 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:53:52.584855 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.535 seconds
[0m00:53:52.584855 [debug] [ThreadPool]: On list_USER_DB_FALCON: Close
[0m00:53:52.736497 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON_RAW_public'
[0m00:53:52.752905 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m00:53:52.759454 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show objects in USER_DB_FALCON.RAW_public limit 10000
[0m00:53:52.759454 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:53:53.225453 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.465 seconds
[0m00:53:53.229488 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m00:53:53.867979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77755a65-a589-4677-a8bb-ac8b47b2d45b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FE6A2A6C0>]}
[0m00:53:53.870156 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:53:53.870156 [info ] [MainThread]: 
[0m00:53:53.876577 [debug] [Thread-1 (]: Began running node model.customer_churn.dim_address
[0m00:53:53.876577 [debug] [Thread-2 (]: Began running node model.customer_churn.dim_customer
[0m00:53:53.876577 [debug] [Thread-3 (]: Began running node model.customer_churn.fact_churn
[0m00:53:53.881697 [info ] [Thread-1 (]: 1 of 4 START sql table model RAW_public.dim_address ............................ [RUN]
[0m00:53:53.885672 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.customer_churn.dim_address'
[0m00:53:53.886683 [debug] [Thread-1 (]: Began compiling node model.customer_churn.dim_address
[0m00:53:53.894072 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.dim_address"
[0m00:53:53.883394 [info ] [Thread-2 (]: 2 of 4 START sql table model RAW_public.dim_customer ........................... [RUN]
[0m00:53:53.894072 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.customer_churn.dim_customer'
[0m00:53:53.896284 [debug] [Thread-1 (]: Began executing node model.customer_churn.dim_address
[0m00:53:53.883394 [info ] [Thread-3 (]: 3 of 4 START sql incremental model RAW_public.fact_churn ....................... [RUN]
[0m00:53:53.896590 [debug] [Thread-2 (]: Began compiling node model.customer_churn.dim_customer
[0m00:53:53.919954 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.dim_address"
[0m00:53:53.921102 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.customer_churn.fact_churn'
[0m00:53:53.923242 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer_churn.dim_customer"
[0m00:53:53.923242 [debug] [Thread-3 (]: Began compiling node model.customer_churn.fact_churn
[0m00:53:53.932124 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.fact_churn"
[0m00:53:53.933137 [debug] [Thread-2 (]: Began executing node model.customer_churn.dim_customer
[0m00:53:53.935561 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer_churn.dim_customer"
[0m00:53:53.936720 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.dim_address"
[0m00:53:53.936720 [debug] [Thread-1 (]: On model.customer_churn.dim_address: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.dim_address"} */
create or replace transient table USER_DB_FALCON.RAW_public.dim_address
         as
        (-- models/marts/dim_address.sql


select distinct
  individual_id,
  city,
  state,
  county,
  lat,
  lon
from USER_DB_FALCON.RAW_public.int_customer_enriched
        );
[0m00:53:53.936720 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:53:53.939483 [debug] [Thread-3 (]: Began executing node model.customer_churn.fact_churn
[0m00:53:53.953293 [debug] [Thread-2 (]: Using snowflake connection "model.customer_churn.dim_customer"
[0m00:53:53.963200 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:53:53.969396 [debug] [Thread-2 (]: On model.customer_churn.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.dim_customer"} */
create or replace transient table USER_DB_FALCON.RAW_public.dim_customer
         as
        (-- models/marts/dim_customer.sql


select distinct
  individual_id,
  age_in_years as age,
  marital_status,
  has_children,
  length_of_residence
from USER_DB_FALCON.RAW_public.int_customer_enriched
        );
[0m00:53:53.969396 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
create or replace  temporary view USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
  
   as (
    -- models/marts/fact_churn.sql


select
  t.individual_id,
  t.churn_date,
  e.city,
  e.state,
  e.county,
  e.age_in_years,
  e.days_tenure,
  e.annual_premium,
  c.churn_flag
from USER_DB_FALCON.RAW_public.stg_termination t
join USER_DB_FALCON.RAW_public.int_customer_enriched e
  using (individual_id)
left join USER_DB_FALCON.RAW_public.stg_autoinsurance_churn c
  using (individual_id)


where t.churn_date > (select max(churn_date) from USER_DB_FALCON.RAW_public.fact_churn)

  );
[0m00:53:53.970518 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:53:53.970518 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:53:55.098441 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.127 seconds
[0m00:53:55.119508 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:53:55.120155 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
[0m00:53:55.222826 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 0.106 seconds
[0m00:53:55.232872 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:53:55.232872 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table USER_DB_FALCON.RAW_public.fact_churn
[0m00:53:55.333099 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 0.097 seconds
[0m00:53:55.353010 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:53:55.353010 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table "USER_DB_FALCON"."RAW_PUBLIC"."FACT_CHURN"
[0m00:53:55.467481 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 0.112 seconds
[0m00:53:55.493059 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.fact_churn"
[0m00:53:55.494906 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:53:55.494906 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
-- back compat for old kwarg name
  
  begin;
[0m00:53:55.606755 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.112 seconds
[0m00:53:55.606755 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:53:55.606755 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
merge into USER_DB_FALCON.RAW_public.fact_churn as DBT_INTERNAL_DEST
        using USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.individual_id = DBT_INTERNAL_DEST.individual_id
                ) and (
                    DBT_INTERNAL_SOURCE.churn_date = DBT_INTERNAL_DEST.churn_date
                )

    
    when matched then update set
        "INDIVIDUAL_ID" = DBT_INTERNAL_SOURCE."INDIVIDUAL_ID","CHURN_DATE" = DBT_INTERNAL_SOURCE."CHURN_DATE","CITY" = DBT_INTERNAL_SOURCE."CITY","STATE" = DBT_INTERNAL_SOURCE."STATE","COUNTY" = DBT_INTERNAL_SOURCE."COUNTY","AGE_IN_YEARS" = DBT_INTERNAL_SOURCE."AGE_IN_YEARS","DAYS_TENURE" = DBT_INTERNAL_SOURCE."DAYS_TENURE","ANNUAL_PREMIUM" = DBT_INTERNAL_SOURCE."ANNUAL_PREMIUM","CHURN_FLAG" = DBT_INTERNAL_SOURCE."CHURN_FLAG"
    

    when not matched then insert
        ("INDIVIDUAL_ID", "CHURN_DATE", "CITY", "STATE", "COUNTY", "AGE_IN_YEARS", "DAYS_TENURE", "ANNUAL_PREMIUM", "CHURN_FLAG")
    values
        ("INDIVIDUAL_ID", "CHURN_DATE", "CITY", "STATE", "COUNTY", "AGE_IN_YEARS", "DAYS_TENURE", "ANNUAL_PREMIUM", "CHURN_FLAG")

;
[0m00:53:57.507846 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 1.899 seconds
[0m00:53:57.512958 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:53:57.512958 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
COMMIT
[0m00:53:57.644810 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.137 seconds
[0m00:53:57.662989 [debug] [Thread-3 (]: Applying DROP to: USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
[0m00:53:57.676773 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:53:57.676773 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
drop view if exists USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp cascade
[0m00:53:57.782867 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.102 seconds
[0m00:53:57.793064 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: Close
[0m00:53:57.933017 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77755a65-a589-4677-a8bb-ac8b47b2d45b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FE6F17740>]}
[0m00:53:57.933017 [info ] [Thread-3 (]: 3 of 4 OK created sql incremental model RAW_public.fact_churn .................. [[32mSUCCESS 0[0m in 4.00s]
[0m00:53:57.933017 [debug] [Thread-3 (]: Finished running node model.customer_churn.fact_churn
[0m00:53:57.938208 [debug] [Thread-4 (]: Began running node model.customer_churn.churn_metrics
[0m00:53:57.940279 [info ] [Thread-4 (]: 4 of 4 START sql table model RAW_public.churn_metrics .......................... [RUN]
[0m00:53:57.943003 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.customer_churn.churn_metrics'
[0m00:53:57.943003 [debug] [Thread-4 (]: Began compiling node model.customer_churn.churn_metrics
[0m00:53:57.946640 [debug] [Thread-4 (]: Writing injected SQL for node "model.customer_churn.churn_metrics"
[0m00:53:57.952877 [debug] [Thread-4 (]: Began executing node model.customer_churn.churn_metrics
[0m00:53:57.959608 [debug] [Thread-4 (]: Writing runtime sql for node "model.customer_churn.churn_metrics"
[0m00:53:57.962790 [debug] [Thread-4 (]: Using snowflake connection "model.customer_churn.churn_metrics"
[0m00:53:57.962790 [debug] [Thread-4 (]: On model.customer_churn.churn_metrics: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.churn_metrics"} */
create or replace transient table USER_DB_FALCON.RAW_public.churn_metrics
         as
        (-- models/marts/churn_metrics.sql


with base as (
  select
    churn_date,
    churn_flag,
    state,
    county,
    age_in_years,
    days_tenure,
    annual_premium
  from USER_DB_FALCON.RAW_public.fact_churn
),

monthly as (
  select
    date_trunc('month', churn_date)       as period,
    sum(churn_flag)                       as churn_count
  from base
  group by 1
),

by_state as (
  select
    state                                 as category,
    sum(churn_flag)                       as churn_count
  from base
  group by 1
),

by_age as (
  select
    width_bucket(age_in_years, 20, 80, 6) as category,
    sum(churn_flag)                       as churn_count
  from base
  group by 1
),

by_tenure as (
  select
    width_bucket(days_tenure, 0, 6000, 6) as category,
    sum(churn_flag)                       as churn_count
  from base
  group by 1
),

by_premium as (
  select
    width_bucket(annual_premium, 0, 2000, 5) as category,
    sum(churn_flag)                         as churn_count
  from base
  group by 1
),

map_pts as (
  select
    f.churn_date,
    f.churn_flag,
    e.lat,
    e.lon
  from USER_DB_FALCON.RAW_public.fact_churn        f
  join USER_DB_FALCON.RAW_public.int_customer_enriched e
    using (individual_id)
)

select month, null as state, null as age_bucket, churn_count from monthly
union all
select null as month, state, null as age_bucket, churn_count from by_state
union all
select null as month, null as state, age_bucket, churn_count from by_age
union all
select 'tenure' as metric_type, cast(category as varchar) as metric_value, churn_count from by_tenure
union all
select 'premium' as metric_type, cast(category as varchar) as metric_value, churn_count from by_premium
union all
select * from map_pts
        );
[0m00:53:57.962790 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:53:58.111795 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.174 seconds
[0m00:53:58.123921 [debug] [Thread-1 (]: On model.customer_churn.dim_address: Close
[0m00:53:58.251739 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77755a65-a589-4677-a8bb-ac8b47b2d45b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FE75FEC90>]}
[0m00:53:58.252457 [info ] [Thread-1 (]: 1 of 4 OK created sql table model RAW_public.dim_address ....................... [[32mSUCCESS 1[0m in 4.37s]
[0m00:53:58.254419 [debug] [Thread-1 (]: Finished running node model.customer_churn.dim_address
[0m00:53:58.314382 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 4.351 seconds
[0m00:53:58.323891 [debug] [Thread-2 (]: On model.customer_churn.dim_customer: Close
[0m00:53:58.500810 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77755a65-a589-4677-a8bb-ac8b47b2d45b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FE7753AA0>]}
[0m00:53:58.500810 [info ] [Thread-2 (]: 2 of 4 OK created sql table model RAW_public.dim_customer ...................... [[32mSUCCESS 1[0m in 4.61s]
[0m00:53:58.500810 [debug] [Thread-2 (]: Finished running node model.customer_churn.dim_customer
[0m00:53:58.692828 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01bc1e59-0305-21c8-0004-59ff0039a002
[0m00:53:58.695651 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 69 at position 7
invalid identifier 'MONTH'
[0m00:53:58.695651 [debug] [Thread-4 (]: On model.customer_churn.churn_metrics: Close
[0m00:53:58.851665 [debug] [Thread-4 (]: Database Error in model churn_metrics (models\marts\churn_metrics.sql)
  000904 (42000): SQL compilation error: error line 69 at position 7
  invalid identifier 'MONTH'
  compiled code at target\run\customer_churn\models\marts\churn_metrics.sql
[0m00:53:58.853188 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77755a65-a589-4677-a8bb-ac8b47b2d45b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FE773A180>]}
[0m00:53:58.853188 [error] [Thread-4 (]: 4 of 4 ERROR creating sql table model RAW_public.churn_metrics ................. [[31mERROR[0m in 0.91s]
[0m00:53:58.853188 [debug] [Thread-4 (]: Finished running node model.customer_churn.churn_metrics
[0m00:53:58.853188 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:53:58.863103 [debug] [MainThread]: Connection 'list_USER_DB_FALCON' was properly closed.
[0m00:53:58.863103 [debug] [MainThread]: Connection 'list_USER_DB_FALCON_RAW_public' was properly closed.
[0m00:53:58.863103 [debug] [MainThread]: Connection 'model.customer_churn.dim_address' was properly closed.
[0m00:53:58.863103 [debug] [MainThread]: Connection 'model.customer_churn.dim_customer' was properly closed.
[0m00:53:58.863103 [debug] [MainThread]: Connection 'model.customer_churn.fact_churn' was properly closed.
[0m00:53:58.863103 [debug] [MainThread]: Connection 'model.customer_churn.churn_metrics' was properly closed.
[0m00:53:58.867913 [info ] [MainThread]: 
[0m00:53:58.867913 [info ] [MainThread]: Finished running 1 incremental model, 3 table models in 0 hours 0 minutes and 6.84 seconds (6.84s).
[0m00:53:58.871144 [debug] [MainThread]: Command end result
[0m00:53:58.924118 [info ] [MainThread]: 
[0m00:53:58.928112 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:53:58.928112 [info ] [MainThread]: 
[0m00:53:58.928112 [error] [MainThread]:   Database Error in model churn_metrics (models\marts\churn_metrics.sql)
  000904 (42000): SQL compilation error: error line 69 at position 7
  invalid identifier 'MONTH'
  compiled code at target\run\customer_churn\models\marts\churn_metrics.sql
[0m00:53:58.928112 [info ] [MainThread]: 
[0m00:53:58.928112 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m00:53:58.933022 [debug] [MainThread]: Command `dbt run` failed at 00:53:58.933022 after 8.30 seconds
[0m00:53:58.933022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FE6D6DA00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FE42D8B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FE6F17740>]}
[0m00:53:58.933022 [debug] [MainThread]: Flushing usage events
[0m00:56:49.448552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D65EBE69C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D65EBE5820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D65ED1FA10>]}


============================== 00:56:49.458293 | 91fefaba-d8a3-418a-b2ba-be031a863919 ==============================
[0m00:56:49.458293 [info ] [MainThread]: Running with dbt=1.8.2
[0m00:56:49.460546 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select marts', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:56:50.016910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91fefaba-d8a3-418a-b2ba-be031a863919', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D660D43F80>]}
[0m00:56:50.071896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91fefaba-d8a3-418a-b2ba-be031a863919', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D65ED1FA10>]}
[0m00:56:50.071896 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m00:56:50.340622 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m00:56:50.463965 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:56:50.463965 [debug] [MainThread]: Partial parsing: updated file: customer_churn://models\marts\churn_metrics.sql
[0m00:56:50.811764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91fefaba-d8a3-418a-b2ba-be031a863919', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6612CA420>]}
[0m00:56:50.960865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91fefaba-d8a3-418a-b2ba-be031a863919', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6612B7530>]}
[0m00:56:50.960865 [info ] [MainThread]: Found 11 models, 10 data tests, 7 sources, 459 macros
[0m00:56:50.963397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91fefaba-d8a3-418a-b2ba-be031a863919', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6611C3C50>]}
[0m00:56:50.963397 [info ] [MainThread]: 
[0m00:56:50.963397 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:56:50.967237 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON'
[0m00:56:50.980470 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON"
[0m00:56:50.980470 [debug] [ThreadPool]: On list_USER_DB_FALCON: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON"} */
show terse schemas in database USER_DB_FALCON
    limit 10000
[0m00:56:50.983428 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:56:51.688931 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.705 seconds
[0m00:56:51.690948 [debug] [ThreadPool]: On list_USER_DB_FALCON: Close
[0m00:56:51.826992 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON_RAW_public'
[0m00:56:51.842876 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m00:56:51.842876 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show objects in USER_DB_FALCON.RAW_public limit 10000
[0m00:56:51.842876 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:56:52.304714 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.460 seconds
[0m00:56:52.304714 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m00:56:52.860033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91fefaba-d8a3-418a-b2ba-be031a863919', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D660DE9760>]}
[0m00:56:52.861044 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:56:52.861044 [info ] [MainThread]: 
[0m00:56:52.871195 [debug] [Thread-1 (]: Began running node model.customer_churn.dim_address
[0m00:56:52.871195 [debug] [Thread-2 (]: Began running node model.customer_churn.dim_customer
[0m00:56:52.876057 [debug] [Thread-3 (]: Began running node model.customer_churn.fact_churn
[0m00:56:52.876057 [info ] [Thread-1 (]: 1 of 4 START sql table model RAW_public.dim_address ............................ [RUN]
[0m00:56:52.881769 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.customer_churn.dim_address'
[0m00:56:52.881769 [debug] [Thread-1 (]: Began compiling node model.customer_churn.dim_address
[0m00:56:52.876057 [info ] [Thread-2 (]: 2 of 4 START sql table model RAW_public.dim_customer ........................... [RUN]
[0m00:56:52.900899 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.dim_address"
[0m00:56:52.902035 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.customer_churn.dim_customer'
[0m00:56:52.879159 [info ] [Thread-3 (]: 3 of 4 START sql incremental model RAW_public.fact_churn ....................... [RUN]
[0m00:56:52.903794 [debug] [Thread-2 (]: Began compiling node model.customer_churn.dim_customer
[0m00:56:52.903794 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.customer_churn.fact_churn'
[0m00:56:52.912043 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer_churn.dim_customer"
[0m00:56:52.912043 [debug] [Thread-1 (]: Began executing node model.customer_churn.dim_address
[0m00:56:52.912043 [debug] [Thread-3 (]: Began compiling node model.customer_churn.fact_churn
[0m00:56:52.966145 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.dim_address"
[0m00:56:52.973089 [debug] [Thread-2 (]: Began executing node model.customer_churn.dim_customer
[0m00:56:52.981168 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.fact_churn"
[0m00:56:52.990882 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer_churn.dim_customer"
[0m00:56:52.990882 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.dim_address"
[0m00:56:52.990882 [debug] [Thread-3 (]: Began executing node model.customer_churn.fact_churn
[0m00:56:52.990882 [debug] [Thread-1 (]: On model.customer_churn.dim_address: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.dim_address"} */
create or replace transient table USER_DB_FALCON.RAW_public.dim_address
         as
        (-- models/marts/dim_address.sql


select distinct
  individual_id,
  city,
  state,
  county,
  lat,
  lon
from USER_DB_FALCON.RAW_public.int_customer_enriched
        );
[0m00:56:52.990882 [debug] [Thread-2 (]: Using snowflake connection "model.customer_churn.dim_customer"
[0m00:56:53.040897 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:56:53.060736 [debug] [Thread-2 (]: On model.customer_churn.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.dim_customer"} */
create or replace transient table USER_DB_FALCON.RAW_public.dim_customer
         as
        (-- models/marts/dim_customer.sql


select distinct
  individual_id,
  age_in_years as age,
  marital_status,
  has_children,
  length_of_residence
from USER_DB_FALCON.RAW_public.int_customer_enriched
        );
[0m00:56:53.078677 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:56:53.080773 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:56:53.080773 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
create or replace  temporary view USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
  
   as (
    -- models/marts/fact_churn.sql


select
  t.individual_id,
  t.churn_date,
  e.city,
  e.state,
  e.county,
  e.age_in_years,
  e.days_tenure,
  e.annual_premium,
  c.churn_flag
from USER_DB_FALCON.RAW_public.stg_termination t
join USER_DB_FALCON.RAW_public.int_customer_enriched e
  using (individual_id)
left join USER_DB_FALCON.RAW_public.stg_autoinsurance_churn c
  using (individual_id)


where t.churn_date > (select max(churn_date) from USER_DB_FALCON.RAW_public.fact_churn)

  );
[0m00:56:53.091037 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:56:53.941161 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.855 seconds
[0m00:56:53.960938 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:56:53.960938 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
[0m00:56:54.748698 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 0.785 seconds
[0m00:56:54.762030 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:56:54.763857 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table USER_DB_FALCON.RAW_public.fact_churn
[0m00:56:54.887398 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 0.121 seconds
[0m00:56:54.919471 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:56:54.921686 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table "USER_DB_FALCON"."RAW_PUBLIC"."FACT_CHURN"
[0m00:56:55.452877 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 0.532 seconds
[0m00:56:55.620697 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.fact_churn"
[0m00:56:55.628233 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:56:55.630849 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
-- back compat for old kwarg name
  
  begin;
[0m00:56:55.783891 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.151 seconds
[0m00:56:55.787265 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:56:55.790565 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
merge into USER_DB_FALCON.RAW_public.fact_churn as DBT_INTERNAL_DEST
        using USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.individual_id = DBT_INTERNAL_DEST.individual_id
                ) and (
                    DBT_INTERNAL_SOURCE.churn_date = DBT_INTERNAL_DEST.churn_date
                )

    
    when matched then update set
        "INDIVIDUAL_ID" = DBT_INTERNAL_SOURCE."INDIVIDUAL_ID","CHURN_DATE" = DBT_INTERNAL_SOURCE."CHURN_DATE","CITY" = DBT_INTERNAL_SOURCE."CITY","STATE" = DBT_INTERNAL_SOURCE."STATE","COUNTY" = DBT_INTERNAL_SOURCE."COUNTY","AGE_IN_YEARS" = DBT_INTERNAL_SOURCE."AGE_IN_YEARS","DAYS_TENURE" = DBT_INTERNAL_SOURCE."DAYS_TENURE","ANNUAL_PREMIUM" = DBT_INTERNAL_SOURCE."ANNUAL_PREMIUM","CHURN_FLAG" = DBT_INTERNAL_SOURCE."CHURN_FLAG"
    

    when not matched then insert
        ("INDIVIDUAL_ID", "CHURN_DATE", "CITY", "STATE", "COUNTY", "AGE_IN_YEARS", "DAYS_TENURE", "ANNUAL_PREMIUM", "CHURN_FLAG")
    values
        ("INDIVIDUAL_ID", "CHURN_DATE", "CITY", "STATE", "COUNTY", "AGE_IN_YEARS", "DAYS_TENURE", "ANNUAL_PREMIUM", "CHURN_FLAG")

;
[0m00:56:56.694389 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.609 seconds
[0m00:56:56.791598 [debug] [Thread-2 (]: On model.customer_churn.dim_customer: Close
[0m00:56:56.931081 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91fefaba-d8a3-418a-b2ba-be031a863919', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D660DA7800>]}
[0m00:56:56.933328 [info ] [Thread-2 (]: 2 of 4 OK created sql table model RAW_public.dim_customer ...................... [[32mSUCCESS 1[0m in 4.02s]
[0m00:56:56.937624 [debug] [Thread-2 (]: Finished running node model.customer_churn.dim_customer
[0m00:56:57.137268 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 1.346 seconds
[0m00:56:57.140925 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:56:57.140925 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
COMMIT
[0m00:56:57.291078 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.149 seconds
[0m00:56:57.328951 [debug] [Thread-3 (]: Applying DROP to: USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
[0m00:56:57.362263 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.324 seconds
[0m00:56:57.381193 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:56:57.387246 [debug] [Thread-1 (]: On model.customer_churn.dim_address: Close
[0m00:56:57.390955 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
drop view if exists USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp cascade
[0m00:56:57.541353 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91fefaba-d8a3-418a-b2ba-be031a863919', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6615D9F10>]}
[0m00:56:57.550896 [info ] [Thread-1 (]: 1 of 4 OK created sql table model RAW_public.dim_address ....................... [[32mSUCCESS 1[0m in 4.66s]
[0m00:56:57.550896 [debug] [Thread-1 (]: Finished running node model.customer_churn.dim_address
[0m00:56:57.573841 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.173 seconds
[0m00:56:57.582028 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: Close
[0m00:56:57.712034 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91fefaba-d8a3-418a-b2ba-be031a863919', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6615DAC60>]}
[0m00:56:57.721165 [info ] [Thread-3 (]: 3 of 4 OK created sql incremental model RAW_public.fact_churn .................. [[32mSUCCESS 0[0m in 4.81s]
[0m00:56:57.721165 [debug] [Thread-3 (]: Finished running node model.customer_churn.fact_churn
[0m00:56:57.729158 [debug] [Thread-4 (]: Began running node model.customer_churn.churn_metrics
[0m00:56:57.731469 [info ] [Thread-4 (]: 4 of 4 START sql table model RAW_public.churn_metrics .......................... [RUN]
[0m00:56:57.737269 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.customer_churn.churn_metrics'
[0m00:56:57.737269 [debug] [Thread-4 (]: Began compiling node model.customer_churn.churn_metrics
[0m00:56:57.750717 [debug] [Thread-4 (]: Writing injected SQL for node "model.customer_churn.churn_metrics"
[0m00:56:57.753854 [debug] [Thread-4 (]: Began executing node model.customer_churn.churn_metrics
[0m00:56:57.762448 [debug] [Thread-4 (]: Writing runtime sql for node "model.customer_churn.churn_metrics"
[0m00:56:57.772020 [debug] [Thread-4 (]: Using snowflake connection "model.customer_churn.churn_metrics"
[0m00:56:57.781091 [debug] [Thread-4 (]: On model.customer_churn.churn_metrics: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.churn_metrics"} */
create or replace transient table USER_DB_FALCON.RAW_public.churn_metrics
         as
        (--- models/marts/churn_metrics.sql
+++ models/marts/churn_metrics.sql
@@
-with monthly as (
-  select
-    date_trunc('month', churn_date)   as month,
-    sum(churn_flag)                   as churn_count
-  from base
-  group by 1
-),
+with monthly as (
+  select
+    date_trunc('month', churn_date)   as period,    -- was `month`
+    sum(churn_flag)                   as churn_count
+  from base
+  group by 1
+),
 by_state as (
   select
     state                             as period,    -- rename here too
     sum(churn_flag)                   as churn_count
   from base
   group by 1
 ),

 by_age as (
   select
     width_bucket(age_in_years, 20, 80, 6) as period,
     sum(churn_flag)                       as churn_count
   from base
   group by 1
 ),

 by_tenure as (
   select
     width_bucket(days_tenure, 0, 6000, 6) as period,
     sum(churn_flag)                       as churn_count
   from base
   group by 1
 ),

 by_premium as (
   select
     width_bucket(annual_premium, 0, 2000, 5) as period,
     sum(churn_flag)                         as churn_count
   from base
   group by 1
 ),

 map_pts as (
   select
     to_varchar(churn_date)         as period,    -- cast to match text
     churn_flag                     as churn_count
     -- if you want lat/lon here, you'd need a separate model
   from USER_DB_FALCON.RAW_public.fact_churn f
   join USER_DB_FALCON.RAW_public.int_customer_enriched e using (individual_id)
 )

select * from monthly
union all
select * from by_state
union all
select * from by_age
union all
select * from by_tenure
union all
select * from by_premium
union all
select * from map_pts
;
[0m00:56:57.781091 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:56:58.475448 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01bc1e5c-0305-20d4-0004-59ff0039cdca
[0m00:56:58.480768 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 4 at position 0 unexpected '+'.
syntax error line 8 at position 39 unexpected 'as'.
[0m00:56:58.480768 [debug] [Thread-4 (]: On model.customer_churn.churn_metrics: Close
[0m00:56:58.651018 [debug] [Thread-4 (]: Database Error in model churn_metrics (models\marts\churn_metrics.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 0 unexpected '+'.
  syntax error line 8 at position 39 unexpected 'as'.
  compiled code at target\run\customer_churn\models\marts\churn_metrics.sql
[0m00:56:58.654814 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91fefaba-d8a3-418a-b2ba-be031a863919', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6615E0E30>]}
[0m00:56:58.661982 [error] [Thread-4 (]: 4 of 4 ERROR creating sql table model RAW_public.churn_metrics ................. [[31mERROR[0m in 0.92s]
[0m00:56:58.661982 [debug] [Thread-4 (]: Finished running node model.customer_churn.churn_metrics
[0m00:56:58.671022 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:56:58.671022 [debug] [MainThread]: Connection 'list_USER_DB_FALCON' was properly closed.
[0m00:56:58.671022 [debug] [MainThread]: Connection 'list_USER_DB_FALCON_RAW_public' was properly closed.
[0m00:56:58.671022 [debug] [MainThread]: Connection 'model.customer_churn.dim_address' was properly closed.
[0m00:56:58.671022 [debug] [MainThread]: Connection 'model.customer_churn.dim_customer' was properly closed.
[0m00:56:58.671022 [debug] [MainThread]: Connection 'model.customer_churn.fact_churn' was properly closed.
[0m00:56:58.681110 [debug] [MainThread]: Connection 'model.customer_churn.churn_metrics' was properly closed.
[0m00:56:58.681110 [info ] [MainThread]: 
[0m00:56:58.681110 [info ] [MainThread]: Finished running 3 table models, 1 incremental model in 0 hours 0 minutes and 7.72 seconds (7.72s).
[0m00:56:58.690813 [debug] [MainThread]: Command end result
[0m00:56:58.820969 [info ] [MainThread]: 
[0m00:56:58.820969 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:56:58.820969 [info ] [MainThread]: 
[0m00:56:58.830851 [error] [MainThread]:   Database Error in model churn_metrics (models\marts\churn_metrics.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 0 unexpected '+'.
  syntax error line 8 at position 39 unexpected 'as'.
  compiled code at target\run\customer_churn\models\marts\churn_metrics.sql
[0m00:56:58.832469 [info ] [MainThread]: 
[0m00:56:58.832469 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m00:56:58.832469 [debug] [MainThread]: Command `dbt run` failed at 00:56:58.832469 after 9.69 seconds
[0m00:56:58.840710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D65EBE69C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D65EBC7E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D66136B530>]}
[0m00:56:58.840710 [debug] [MainThread]: Flushing usage events
[0m00:57:08.434606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC30372F30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC30107140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC2FBB8F20>]}


============================== 00:57:08.434606 | 58f7c833-d28e-497c-ac3f-de0d21dfe16b ==============================
[0m00:57:08.434606 [info ] [MainThread]: Running with dbt=1.8.2
[0m00:57:08.434606 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select marts', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:57:08.860948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58f7c833-d28e-497c-ac3f-de0d21dfe16b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC32507050>]}
[0m00:57:08.890772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '58f7c833-d28e-497c-ac3f-de0d21dfe16b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC304BC470>]}
[0m00:57:08.896160 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m00:57:09.101000 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m00:57:09.233046 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:57:09.233046 [debug] [MainThread]: Partial parsing: updated file: customer_churn://models\marts\churn_metrics.sql
[0m00:57:09.480967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '58f7c833-d28e-497c-ac3f-de0d21dfe16b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC329BA540>]}
[0m00:57:09.580644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '58f7c833-d28e-497c-ac3f-de0d21dfe16b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC32993DA0>]}
[0m00:57:09.580644 [info ] [MainThread]: Found 11 models, 10 data tests, 7 sources, 459 macros
[0m00:57:09.581310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58f7c833-d28e-497c-ac3f-de0d21dfe16b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC329BA360>]}
[0m00:57:09.584037 [info ] [MainThread]: 
[0m00:57:09.584037 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:57:09.586443 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON'
[0m00:57:09.599296 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON"
[0m00:57:09.599296 [debug] [ThreadPool]: On list_USER_DB_FALCON: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON"} */
show terse schemas in database USER_DB_FALCON
    limit 10000
[0m00:57:09.600801 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:57:10.350564 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.751 seconds
[0m00:57:10.350564 [debug] [ThreadPool]: On list_USER_DB_FALCON: Close
[0m00:57:10.976506 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON_RAW_public'
[0m00:57:10.992673 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m00:57:10.992673 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show objects in USER_DB_FALCON.RAW_public limit 10000
[0m00:57:11.000897 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:57:11.446159 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.449 seconds
[0m00:57:11.450722 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m00:57:11.580919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58f7c833-d28e-497c-ac3f-de0d21dfe16b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC329BAD50>]}
[0m00:57:11.582173 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:57:11.583341 [info ] [MainThread]: 
[0m00:57:11.590244 [debug] [Thread-1 (]: Began running node model.customer_churn.dim_address
[0m00:57:11.590759 [debug] [Thread-2 (]: Began running node model.customer_churn.dim_customer
[0m00:57:11.591788 [debug] [Thread-3 (]: Began running node model.customer_churn.fact_churn
[0m00:57:11.592291 [info ] [Thread-1 (]: 1 of 4 START sql table model RAW_public.dim_address ............................ [RUN]
[0m00:57:11.592291 [info ] [Thread-2 (]: 2 of 4 START sql table model RAW_public.dim_customer ........................... [RUN]
[0m00:57:11.593771 [info ] [Thread-3 (]: 3 of 4 START sql incremental model RAW_public.fact_churn ....................... [RUN]
[0m00:57:11.593771 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.customer_churn.dim_address'
[0m00:57:11.595826 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.customer_churn.dim_customer'
[0m00:57:11.595826 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.customer_churn.fact_churn'
[0m00:57:11.597280 [debug] [Thread-1 (]: Began compiling node model.customer_churn.dim_address
[0m00:57:11.597280 [debug] [Thread-2 (]: Began compiling node model.customer_churn.dim_customer
[0m00:57:11.597280 [debug] [Thread-3 (]: Began compiling node model.customer_churn.fact_churn
[0m00:57:11.613909 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.dim_address"
[0m00:57:11.617818 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer_churn.dim_customer"
[0m00:57:11.623559 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.fact_churn"
[0m00:57:11.627937 [debug] [Thread-1 (]: Began executing node model.customer_churn.dim_address
[0m00:57:11.627937 [debug] [Thread-3 (]: Began executing node model.customer_churn.fact_churn
[0m00:57:11.647515 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.dim_address"
[0m00:57:11.670849 [debug] [Thread-2 (]: Began executing node model.customer_churn.dim_customer
[0m00:57:11.676695 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:57:11.678699 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer_churn.dim_customer"
[0m00:57:11.678699 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
create or replace  temporary view USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
  
   as (
    -- models/marts/fact_churn.sql


select
  t.individual_id,
  t.churn_date,
  e.city,
  e.state,
  e.county,
  e.age_in_years,
  e.days_tenure,
  e.annual_premium,
  c.churn_flag
from USER_DB_FALCON.RAW_public.stg_termination t
join USER_DB_FALCON.RAW_public.int_customer_enriched e
  using (individual_id)
left join USER_DB_FALCON.RAW_public.stg_autoinsurance_churn c
  using (individual_id)


where t.churn_date > (select max(churn_date) from USER_DB_FALCON.RAW_public.fact_churn)

  );
[0m00:57:11.680703 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.dim_address"
[0m00:57:11.681020 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:57:11.681020 [debug] [Thread-1 (]: On model.customer_churn.dim_address: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.dim_address"} */
create or replace transient table USER_DB_FALCON.RAW_public.dim_address
         as
        (-- models/marts/dim_address.sql


select distinct
  individual_id,
  city,
  state,
  county,
  lat,
  lon
from USER_DB_FALCON.RAW_public.int_customer_enriched
        );
[0m00:57:11.681020 [debug] [Thread-2 (]: Using snowflake connection "model.customer_churn.dim_customer"
[0m00:57:11.684702 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:57:11.684702 [debug] [Thread-2 (]: On model.customer_churn.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.dim_customer"} */
create or replace transient table USER_DB_FALCON.RAW_public.dim_customer
         as
        (-- models/marts/dim_customer.sql


select distinct
  individual_id,
  age_in_years as age,
  marital_status,
  has_children,
  length_of_residence
from USER_DB_FALCON.RAW_public.int_customer_enriched
        );
[0m00:57:11.684702 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:57:12.441098 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.768 seconds
[0m00:57:12.459631 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:57:12.460736 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
[0m00:57:12.570866 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 0.112 seconds
[0m00:57:12.570866 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:57:12.570866 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table USER_DB_FALCON.RAW_public.fact_churn
[0m00:57:12.680950 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 0.109 seconds
[0m00:57:12.700797 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:57:12.700797 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table "USER_DB_FALCON"."RAW_PUBLIC"."FACT_CHURN"
[0m00:57:14.203289 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 1.498 seconds
[0m00:57:14.260980 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.fact_churn"
[0m00:57:14.260980 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:57:14.260980 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
-- back compat for old kwarg name
  
  begin;
[0m00:57:14.401178 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.137 seconds
[0m00:57:14.401178 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:57:14.401178 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
merge into USER_DB_FALCON.RAW_public.fact_churn as DBT_INTERNAL_DEST
        using USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.individual_id = DBT_INTERNAL_DEST.individual_id
                ) and (
                    DBT_INTERNAL_SOURCE.churn_date = DBT_INTERNAL_DEST.churn_date
                )

    
    when matched then update set
        "INDIVIDUAL_ID" = DBT_INTERNAL_SOURCE."INDIVIDUAL_ID","CHURN_DATE" = DBT_INTERNAL_SOURCE."CHURN_DATE","CITY" = DBT_INTERNAL_SOURCE."CITY","STATE" = DBT_INTERNAL_SOURCE."STATE","COUNTY" = DBT_INTERNAL_SOURCE."COUNTY","AGE_IN_YEARS" = DBT_INTERNAL_SOURCE."AGE_IN_YEARS","DAYS_TENURE" = DBT_INTERNAL_SOURCE."DAYS_TENURE","ANNUAL_PREMIUM" = DBT_INTERNAL_SOURCE."ANNUAL_PREMIUM","CHURN_FLAG" = DBT_INTERNAL_SOURCE."CHURN_FLAG"
    

    when not matched then insert
        ("INDIVIDUAL_ID", "CHURN_DATE", "CITY", "STATE", "COUNTY", "AGE_IN_YEARS", "DAYS_TENURE", "ANNUAL_PREMIUM", "CHURN_FLAG")
    values
        ("INDIVIDUAL_ID", "CHURN_DATE", "CITY", "STATE", "COUNTY", "AGE_IN_YEARS", "DAYS_TENURE", "ANNUAL_PREMIUM", "CHURN_FLAG")

;
[0m00:57:14.714227 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 0.315 seconds
[0m00:57:14.714227 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:57:14.718949 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
COMMIT
[0m00:57:14.901075 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.181 seconds
[0m00:57:14.923237 [debug] [Thread-3 (]: Applying DROP to: USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
[0m00:57:14.923237 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.239 seconds
[0m00:57:14.941815 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:57:14.980624 [debug] [Thread-2 (]: On model.customer_churn.dim_customer: Close
[0m00:57:14.980624 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
drop view if exists USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp cascade
[0m00:57:15.110701 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.430 seconds
[0m00:57:15.110701 [debug] [Thread-1 (]: On model.customer_churn.dim_address: Close
[0m00:57:15.168024 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58f7c833-d28e-497c-ac3f-de0d21dfe16b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC324977D0>]}
[0m00:57:15.168024 [info ] [Thread-2 (]: 2 of 4 OK created sql table model RAW_public.dim_customer ...................... [[32mSUCCESS 1[0m in 3.57s]
[0m00:57:15.170530 [debug] [Thread-2 (]: Finished running node model.customer_churn.dim_customer
[0m00:57:15.223892 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.236 seconds
[0m00:57:15.230956 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: Close
[0m00:57:15.257107 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58f7c833-d28e-497c-ac3f-de0d21dfe16b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC32C192E0>]}
[0m00:57:15.257107 [info ] [Thread-1 (]: 1 of 4 OK created sql table model RAW_public.dim_address ....................... [[32mSUCCESS 1[0m in 3.66s]
[0m00:57:15.260806 [debug] [Thread-1 (]: Finished running node model.customer_churn.dim_address
[0m00:57:15.366199 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58f7c833-d28e-497c-ac3f-de0d21dfe16b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC32B95FD0>]}
[0m00:57:15.366199 [info ] [Thread-3 (]: 3 of 4 OK created sql incremental model RAW_public.fact_churn .................. [[32mSUCCESS 0[0m in 3.77s]
[0m00:57:15.370857 [debug] [Thread-3 (]: Finished running node model.customer_churn.fact_churn
[0m00:57:15.373163 [debug] [Thread-4 (]: Began running node model.customer_churn.churn_metrics
[0m00:57:15.373163 [info ] [Thread-4 (]: 4 of 4 START sql table model RAW_public.churn_metrics .......................... [RUN]
[0m00:57:15.373163 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.customer_churn.churn_metrics'
[0m00:57:15.380760 [debug] [Thread-4 (]: Began compiling node model.customer_churn.churn_metrics
[0m00:57:15.383765 [debug] [Thread-4 (]: Writing injected SQL for node "model.customer_churn.churn_metrics"
[0m00:57:15.386102 [debug] [Thread-4 (]: Began executing node model.customer_churn.churn_metrics
[0m00:57:15.390735 [debug] [Thread-4 (]: Writing runtime sql for node "model.customer_churn.churn_metrics"
[0m00:57:15.397737 [debug] [Thread-4 (]: Using snowflake connection "model.customer_churn.churn_metrics"
[0m00:57:15.397737 [debug] [Thread-4 (]: On model.customer_churn.churn_metrics: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.churn_metrics"} */
create or replace transient table USER_DB_FALCON.RAW_public.churn_metrics
         as
        (--- models/marts/churn_metrics.sql
+++ models/marts/churn_metrics.sql
@@
-with monthly as (
-  select
-    date_trunc('month', churn_date)   as month,
-    sum(churn_flag)                   as churn_count
-  from base
-  group by 1
-),
+with monthly as (
+  select
+    date_trunc('month', churn_date)   as period,    -- was `month`
+    sum(churn_flag)                   as churn_count
+  from base
+  group by 1
+),
 by_state as (
   select
     state                             as period,    -- rename here too
     sum(churn_flag)                   as churn_count
   from base
   group by 1
 ),

 by_age as (
   select
     width_bucket(age_in_years, 20, 80, 6) as period,
     sum(churn_flag)                       as churn_count
   from base
   group by 1
 ),

 by_tenure as (
   select
     width_bucket(days_tenure, 0, 6000, 6) as period,
     sum(churn_flag)                       as churn_count
   from base
   group by 1
 ),

 by_premium as (
   select
     width_bucket(annual_premium, 0, 2000, 5) as period,
     sum(churn_flag)                         as churn_count
   from base
   group by 1
 ),

 map_pts as (
   select
     to_varchar(churn_date)         as period,    -- cast to match text
     churn_flag                     as churn_count
     -- if you want lat/lon here, you'd need a separate model
   from USER_DB_FALCON.RAW_public.fact_churn f
   join USER_DB_FALCON.RAW_public.int_customer_enriched e using (individual_id)
 )

select * from monthly
union all
select * from by_state
union all
select * from by_age
union all
select * from by_tenure
union all
select * from by_premium
union all
select * from map_pts
        );
[0m00:57:15.397737 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:57:15.858623 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01bc1e5d-0305-25ed-0004-59ff003b007a
[0m00:57:15.858623 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 4 at position 0 unexpected '+'.
syntax error line 8 at position 39 unexpected 'as'.
[0m00:57:15.861513 [debug] [Thread-4 (]: On model.customer_churn.churn_metrics: Close
[0m00:57:17.283170 [debug] [Thread-4 (]: Database Error in model churn_metrics (models\marts\churn_metrics.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 0 unexpected '+'.
  syntax error line 8 at position 39 unexpected 'as'.
  compiled code at target\run\customer_churn\models\marts\churn_metrics.sql
[0m00:57:17.284178 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58f7c833-d28e-497c-ac3f-de0d21dfe16b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC32DE67B0>]}
[0m00:57:17.285878 [error] [Thread-4 (]: 4 of 4 ERROR creating sql table model RAW_public.churn_metrics ................. [[31mERROR[0m in 1.91s]
[0m00:57:17.287580 [debug] [Thread-4 (]: Finished running node model.customer_churn.churn_metrics
[0m00:57:17.293939 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:57:17.293939 [debug] [MainThread]: Connection 'list_USER_DB_FALCON' was properly closed.
[0m00:57:17.295827 [debug] [MainThread]: Connection 'list_USER_DB_FALCON_RAW_public' was properly closed.
[0m00:57:17.295827 [debug] [MainThread]: Connection 'model.customer_churn.dim_address' was properly closed.
[0m00:57:17.297711 [debug] [MainThread]: Connection 'model.customer_churn.dim_customer' was properly closed.
[0m00:57:17.298014 [debug] [MainThread]: Connection 'model.customer_churn.fact_churn' was properly closed.
[0m00:57:17.299115 [debug] [MainThread]: Connection 'model.customer_churn.churn_metrics' was properly closed.
[0m00:57:17.299115 [info ] [MainThread]: 
[0m00:57:17.300753 [info ] [MainThread]: Finished running 3 table models, 1 incremental model in 0 hours 0 minutes and 7.72 seconds (7.72s).
[0m00:57:17.305926 [debug] [MainThread]: Command end result
[0m00:57:17.354024 [info ] [MainThread]: 
[0m00:57:17.355141 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:57:17.355141 [info ] [MainThread]: 
[0m00:57:17.355141 [error] [MainThread]:   Database Error in model churn_metrics (models\marts\churn_metrics.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 0 unexpected '+'.
  syntax error line 8 at position 39 unexpected 'as'.
  compiled code at target\run\customer_churn\models\marts\churn_metrics.sql
[0m00:57:17.355141 [info ] [MainThread]: 
[0m00:57:17.358003 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m00:57:17.359135 [debug] [MainThread]: Command `dbt run` failed at 00:57:17.359135 after 9.20 seconds
[0m00:57:17.359135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC3039BC20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC304A7140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC30370A70>]}
[0m00:57:17.360784 [debug] [MainThread]: Flushing usage events
[0m00:59:15.353473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206F6686240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206F30338F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206F6F94920>]}


============================== 00:59:15.356028 | ef709f7e-1256-449e-92d4-d85a14bf1f91 ==============================
[0m00:59:15.356028 [info ] [MainThread]: Running with dbt=1.8.2
[0m00:59:15.356028 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select marts', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:59:15.881461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef709f7e-1256-449e-92d4-d85a14bf1f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206F90B3B60>]}
[0m00:59:15.920503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef709f7e-1256-449e-92d4-d85a14bf1f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206F6FB62D0>]}
[0m00:59:15.920503 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m00:59:16.084273 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m00:59:16.215082 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:59:16.215082 [debug] [MainThread]: Partial parsing: updated file: customer_churn://models\marts\churn_metrics.sql
[0m00:59:16.560851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef709f7e-1256-449e-92d4-d85a14bf1f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206F95726F0>]}
[0m00:59:16.635608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef709f7e-1256-449e-92d4-d85a14bf1f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206F93A0860>]}
[0m00:59:16.635608 [info ] [MainThread]: Found 11 models, 10 data tests, 7 sources, 459 macros
[0m00:59:16.639213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef709f7e-1256-449e-92d4-d85a14bf1f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206F90E8410>]}
[0m00:59:16.640805 [info ] [MainThread]: 
[0m00:59:16.640805 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:59:16.640805 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON'
[0m00:59:16.658800 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON"
[0m00:59:16.660556 [debug] [ThreadPool]: On list_USER_DB_FALCON: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON"} */
show terse schemas in database USER_DB_FALCON
    limit 10000
[0m00:59:16.660556 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:59:17.282803 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.623 seconds
[0m00:59:17.282803 [debug] [ThreadPool]: On list_USER_DB_FALCON: Close
[0m00:59:17.425984 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON_RAW_public'
[0m00:59:17.447003 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m00:59:17.447003 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show objects in USER_DB_FALCON.RAW_public limit 10000
[0m00:59:17.447003 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:59:18.585942 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.138 seconds
[0m00:59:18.591052 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m00:59:18.720995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef709f7e-1256-449e-92d4-d85a14bf1f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206F90B0080>]}
[0m00:59:18.720995 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:59:18.720995 [info ] [MainThread]: 
[0m00:59:18.720995 [debug] [Thread-1 (]: Began running node model.customer_churn.dim_address
[0m00:59:18.720995 [debug] [Thread-2 (]: Began running node model.customer_churn.dim_customer
[0m00:59:18.730758 [debug] [Thread-3 (]: Began running node model.customer_churn.fact_churn
[0m00:59:18.720995 [info ] [Thread-1 (]: 1 of 4 START sql table model RAW_public.dim_address ............................ [RUN]
[0m00:59:18.730758 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.customer_churn.dim_address'
[0m00:59:18.730758 [debug] [Thread-1 (]: Began compiling node model.customer_churn.dim_address
[0m00:59:18.733975 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.dim_address"
[0m00:59:18.730758 [info ] [Thread-2 (]: 2 of 4 START sql table model RAW_public.dim_customer ........................... [RUN]
[0m00:59:18.733975 [debug] [Thread-1 (]: Began executing node model.customer_churn.dim_address
[0m00:59:18.730758 [info ] [Thread-3 (]: 3 of 4 START sql incremental model RAW_public.fact_churn ....................... [RUN]
[0m00:59:18.740136 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.customer_churn.dim_customer'
[0m00:59:18.761054 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.dim_address"
[0m00:59:18.761054 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.customer_churn.fact_churn'
[0m00:59:18.761054 [debug] [Thread-2 (]: Began compiling node model.customer_churn.dim_customer
[0m00:59:18.761054 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.dim_address"
[0m00:59:18.761054 [debug] [Thread-3 (]: Began compiling node model.customer_churn.fact_churn
[0m00:59:18.761054 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer_churn.dim_customer"
[0m00:59:18.766579 [debug] [Thread-1 (]: On model.customer_churn.dim_address: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.dim_address"} */
create or replace transient table USER_DB_FALCON.RAW_public.dim_address
         as
        (-- models/marts/dim_address.sql


select distinct
  individual_id,
  city,
  state,
  county,
  lat,
  lon
from USER_DB_FALCON.RAW_public.int_customer_enriched
        );
[0m00:59:18.771228 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.fact_churn"
[0m00:59:18.771228 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:59:18.774748 [debug] [Thread-2 (]: Began executing node model.customer_churn.dim_customer
[0m00:59:18.774748 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer_churn.dim_customer"
[0m00:59:18.779264 [debug] [Thread-3 (]: Began executing node model.customer_churn.fact_churn
[0m00:59:18.779264 [debug] [Thread-2 (]: Using snowflake connection "model.customer_churn.dim_customer"
[0m00:59:18.815798 [debug] [Thread-2 (]: On model.customer_churn.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.dim_customer"} */
create or replace transient table USER_DB_FALCON.RAW_public.dim_customer
         as
        (-- models/marts/dim_customer.sql


select distinct
  individual_id,
  age_in_years as age,
  marital_status,
  has_children,
  length_of_residence
from USER_DB_FALCON.RAW_public.int_customer_enriched
        );
[0m00:59:18.824370 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:59:18.824370 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:59:18.824370 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
create or replace  temporary view USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
  
   as (
    -- models/marts/fact_churn.sql


select
  t.individual_id,
  t.churn_date,
  e.city,
  e.state,
  e.county,
  e.age_in_years,
  e.days_tenure,
  e.annual_premium,
  c.churn_flag
from USER_DB_FALCON.RAW_public.stg_termination t
join USER_DB_FALCON.RAW_public.int_customer_enriched e
  using (individual_id)
left join USER_DB_FALCON.RAW_public.stg_autoinsurance_churn c
  using (individual_id)


where t.churn_date > (select max(churn_date) from USER_DB_FALCON.RAW_public.fact_churn)

  );
[0m00:59:18.824370 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:59:19.540994 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.710 seconds
[0m00:59:19.551097 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:59:19.551097 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
[0m00:59:19.665854 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 0.110 seconds
[0m00:59:19.670106 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:59:19.670612 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table USER_DB_FALCON.RAW_public.fact_churn
[0m00:59:19.770549 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 0.101 seconds
[0m00:59:19.779439 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:59:19.779439 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table "USER_DB_FALCON"."RAW_PUBLIC"."FACT_CHURN"
[0m00:59:19.897142 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 0.117 seconds
[0m00:59:19.923204 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.fact_churn"
[0m00:59:19.924979 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:59:19.925305 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
-- back compat for old kwarg name
  
  begin;
[0m00:59:20.071680 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.146 seconds
[0m00:59:20.071680 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:59:20.071680 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
merge into USER_DB_FALCON.RAW_public.fact_churn as DBT_INTERNAL_DEST
        using USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.individual_id = DBT_INTERNAL_DEST.individual_id
                ) and (
                    DBT_INTERNAL_SOURCE.churn_date = DBT_INTERNAL_DEST.churn_date
                )

    
    when matched then update set
        "INDIVIDUAL_ID" = DBT_INTERNAL_SOURCE."INDIVIDUAL_ID","CHURN_DATE" = DBT_INTERNAL_SOURCE."CHURN_DATE","CITY" = DBT_INTERNAL_SOURCE."CITY","STATE" = DBT_INTERNAL_SOURCE."STATE","COUNTY" = DBT_INTERNAL_SOURCE."COUNTY","AGE_IN_YEARS" = DBT_INTERNAL_SOURCE."AGE_IN_YEARS","DAYS_TENURE" = DBT_INTERNAL_SOURCE."DAYS_TENURE","ANNUAL_PREMIUM" = DBT_INTERNAL_SOURCE."ANNUAL_PREMIUM","CHURN_FLAG" = DBT_INTERNAL_SOURCE."CHURN_FLAG"
    

    when not matched then insert
        ("INDIVIDUAL_ID", "CHURN_DATE", "CITY", "STATE", "COUNTY", "AGE_IN_YEARS", "DAYS_TENURE", "ANNUAL_PREMIUM", "CHURN_FLAG")
    values
        ("INDIVIDUAL_ID", "CHURN_DATE", "CITY", "STATE", "COUNTY", "AGE_IN_YEARS", "DAYS_TENURE", "ANNUAL_PREMIUM", "CHURN_FLAG")

;
[0m00:59:21.901091 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 1.831 seconds
[0m00:59:21.906618 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:59:21.906618 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
COMMIT
[0m00:59:22.037916 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.127 seconds
[0m00:59:22.076845 [debug] [Thread-3 (]: Applying DROP to: USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
[0m00:59:22.110699 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:59:22.110699 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
drop view if exists USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp cascade
[0m00:59:22.307179 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.190 seconds
[0m00:59:22.394246 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: Close
[0m00:59:22.531086 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef709f7e-1256-449e-92d4-d85a14bf1f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206F903FAD0>]}
[0m00:59:22.536802 [info ] [Thread-3 (]: 3 of 4 OK created sql incremental model RAW_public.fact_churn .................. [[32mSUCCESS 0[0m in 3.77s]
[0m00:59:22.541890 [debug] [Thread-3 (]: Finished running node model.customer_churn.fact_churn
[0m00:59:22.544968 [debug] [Thread-4 (]: Began running node model.customer_churn.churn_metrics
[0m00:59:22.544968 [info ] [Thread-4 (]: 4 of 4 START sql table model RAW_public.churn_metrics .......................... [RUN]
[0m00:59:22.553552 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.customer_churn.churn_metrics'
[0m00:59:22.555657 [debug] [Thread-4 (]: Began compiling node model.customer_churn.churn_metrics
[0m00:59:22.576955 [debug] [Thread-4 (]: Writing injected SQL for node "model.customer_churn.churn_metrics"
[0m00:59:22.583320 [debug] [Thread-4 (]: Began executing node model.customer_churn.churn_metrics
[0m00:59:22.590909 [debug] [Thread-4 (]: Writing runtime sql for node "model.customer_churn.churn_metrics"
[0m00:59:22.600106 [debug] [Thread-4 (]: Using snowflake connection "model.customer_churn.churn_metrics"
[0m00:59:22.602076 [debug] [Thread-4 (]: On model.customer_churn.churn_metrics: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.churn_metrics"} */
create or replace transient table USER_DB_FALCON.RAW_public.churn_metrics
         as
        (

with base as (
  select
    churn_date,
    churn_flag
  from USER_DB_FALCON.RAW_public.fact_churn
),

monthly as (
  select
    date_trunc('month', churn_date) as period,
    sum(churn_flag)                 as churn_count
  from base
  group by 1
),

by_state as (
  select
    state   as period,
    sum(churn_flag) as churn_count
  from USER_DB_FALCON.RAW_public.fact_churn
  group by 1
),

by_age as (
  select
    width_bucket(age_in_years, 20, 80, 6) as period,
    sum(churn_flag)                       as churn_count
  from USER_DB_FALCON.RAW_public.fact_churn
  group by 1
),

by_tenure as (
  select
    width_bucket(days_tenure, 0, 6000, 6) as period,
    sum(churn_flag)                       as churn_count
  from USER_DB_FALCON.RAW_public.fact_churn
  group by 1
),

by_premium as (
  select
    width_bucket(annual_premium, 0, 2000, 5) as period,
    sum(churn_flag)                         as churn_count
  from USER_DB_FALCON.RAW_public.fact_churn
  group by 1
)

select * from monthly
union all
select * from by_state
union all
select * from by_age
union all
select * from by_tenure
union all
select * from by_premium
;
[0m00:59:22.604294 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:59:22.686948 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.860 seconds
[0m00:59:22.707145 [debug] [Thread-2 (]: On model.customer_churn.dim_customer: Close
[0m00:59:23.171061 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef709f7e-1256-449e-92d4-d85a14bf1f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206F98819A0>]}
[0m00:59:23.174328 [info ] [Thread-2 (]: 2 of 4 OK created sql table model RAW_public.dim_customer ...................... [[32mSUCCESS 1[0m in 4.44s]
[0m00:59:23.180875 [debug] [Thread-2 (]: Finished running node model.customer_churn.dim_customer
[0m00:59:23.232647 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.460 seconds
[0m00:59:23.245978 [debug] [Thread-1 (]: On model.customer_churn.dim_address: Close
[0m00:59:23.387339 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef709f7e-1256-449e-92d4-d85a14bf1f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206F9883E90>]}
[0m00:59:23.392192 [info ] [Thread-1 (]: 1 of 4 OK created sql table model RAW_public.dim_address ....................... [[32mSUCCESS 1[0m in 4.66s]
[0m00:59:23.392192 [debug] [Thread-1 (]: Finished running node model.customer_churn.dim_address
[0m00:59:23.612798 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01bc1e5f-0305-24f3-0004-59ff003af152
[0m00:59:23.612798 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 61 at position 0 unexpected ';'.
[0m00:59:23.612798 [debug] [Thread-4 (]: On model.customer_churn.churn_metrics: Close
[0m00:59:23.813193 [debug] [Thread-4 (]: Database Error in model churn_metrics (models\marts\churn_metrics.sql)
  001003 (42000): SQL compilation error:
  syntax error line 61 at position 0 unexpected ';'.
  compiled code at target\run\customer_churn\models\marts\churn_metrics.sql
[0m00:59:23.813193 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef709f7e-1256-449e-92d4-d85a14bf1f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206F94EAC90>]}
[0m00:59:23.813193 [error] [Thread-4 (]: 4 of 4 ERROR creating sql table model RAW_public.churn_metrics ................. [[31mERROR[0m in 1.26s]
[0m00:59:23.821255 [debug] [Thread-4 (]: Finished running node model.customer_churn.churn_metrics
[0m00:59:23.831123 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:59:23.831123 [debug] [MainThread]: Connection 'list_USER_DB_FALCON' was properly closed.
[0m00:59:23.835986 [debug] [MainThread]: Connection 'list_USER_DB_FALCON_RAW_public' was properly closed.
[0m00:59:23.837591 [debug] [MainThread]: Connection 'model.customer_churn.dim_address' was properly closed.
[0m00:59:23.840745 [debug] [MainThread]: Connection 'model.customer_churn.dim_customer' was properly closed.
[0m00:59:23.840745 [debug] [MainThread]: Connection 'model.customer_churn.fact_churn' was properly closed.
[0m00:59:23.840745 [debug] [MainThread]: Connection 'model.customer_churn.churn_metrics' was properly closed.
[0m00:59:23.846045 [info ] [MainThread]: 
[0m00:59:23.850754 [info ] [MainThread]: Finished running 1 incremental model, 3 table models in 0 hours 0 minutes and 7.21 seconds (7.21s).
[0m00:59:23.854582 [debug] [MainThread]: Command end result
[0m00:59:23.996199 [info ] [MainThread]: 
[0m00:59:24.000821 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:59:24.004102 [info ] [MainThread]: 
[0m00:59:24.004102 [error] [MainThread]:   Database Error in model churn_metrics (models\marts\churn_metrics.sql)
  001003 (42000): SQL compilation error:
  syntax error line 61 at position 0 unexpected ';'.
  compiled code at target\run\customer_churn\models\marts\churn_metrics.sql
[0m00:59:24.010782 [info ] [MainThread]: 
[0m00:59:24.012631 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m00:59:24.012631 [debug] [MainThread]: Command `dbt run` failed at 00:59:24.012631 after 8.92 seconds
[0m00:59:24.021420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206F6F6BDA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206F6F6BC20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206F97C8CB0>]}
[0m00:59:24.021420 [debug] [MainThread]: Flushing usage events
[0m00:59:37.727232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200DBC8B5C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200DB857B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200DB856000>]}


============================== 00:59:37.730953 | 40c7cb12-0a14-4088-9ada-a6d7ab456400 ==============================
[0m00:59:37.730953 [info ] [MainThread]: Running with dbt=1.8.2
[0m00:59:37.732631 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select marts', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:59:38.034760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '40c7cb12-0a14-4088-9ada-a6d7ab456400', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200DDFB7440>]}
[0m00:59:38.072659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '40c7cb12-0a14-4088-9ada-a6d7ab456400', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200DE129EB0>]}
[0m00:59:38.072659 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m00:59:38.240985 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m00:59:38.347030 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:59:38.347030 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:59:38.373280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '40c7cb12-0a14-4088-9ada-a6d7ab456400', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200DBF67E60>]}
[0m00:59:38.445241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '40c7cb12-0a14-4088-9ada-a6d7ab456400', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200DE443170>]}
[0m00:59:38.445241 [info ] [MainThread]: Found 11 models, 10 data tests, 7 sources, 459 macros
[0m00:59:38.445241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40c7cb12-0a14-4088-9ada-a6d7ab456400', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200DE3F6570>]}
[0m00:59:38.449769 [info ] [MainThread]: 
[0m00:59:38.450943 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:59:38.454007 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON'
[0m00:59:38.462339 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON"
[0m00:59:38.462339 [debug] [ThreadPool]: On list_USER_DB_FALCON: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON"} */
show terse schemas in database USER_DB_FALCON
    limit 10000
[0m00:59:38.462339 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:59:39.026422 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.562 seconds
[0m00:59:39.031677 [debug] [ThreadPool]: On list_USER_DB_FALCON: Close
[0m00:59:39.160613 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON_RAW_public'
[0m00:59:39.170513 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m00:59:39.170513 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show objects in USER_DB_FALCON.RAW_public limit 10000
[0m00:59:39.170513 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:59:39.657642 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.482 seconds
[0m00:59:39.659871 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m00:59:39.775836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40c7cb12-0a14-4088-9ada-a6d7ab456400', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200DE2A1E80>]}
[0m00:59:39.775836 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:59:39.775836 [info ] [MainThread]: 
[0m00:59:39.780848 [debug] [Thread-1 (]: Began running node model.customer_churn.dim_address
[0m00:59:39.780848 [debug] [Thread-2 (]: Began running node model.customer_churn.dim_customer
[0m00:59:39.780848 [debug] [Thread-3 (]: Began running node model.customer_churn.fact_churn
[0m00:59:39.780848 [info ] [Thread-1 (]: 1 of 4 START sql table model RAW_public.dim_address ............................ [RUN]
[0m00:59:39.783382 [info ] [Thread-2 (]: 2 of 4 START sql table model RAW_public.dim_customer ........................... [RUN]
[0m00:59:39.783382 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.customer_churn.dim_address'
[0m00:59:39.783382 [info ] [Thread-3 (]: 3 of 4 START sql incremental model RAW_public.fact_churn ....................... [RUN]
[0m00:59:39.785763 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.customer_churn.dim_customer'
[0m00:59:39.785763 [debug] [Thread-1 (]: Began compiling node model.customer_churn.dim_address
[0m00:59:39.785763 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.customer_churn.fact_churn'
[0m00:59:39.785763 [debug] [Thread-2 (]: Began compiling node model.customer_churn.dim_customer
[0m00:59:39.793679 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.dim_address"
[0m00:59:39.793679 [debug] [Thread-3 (]: Began compiling node model.customer_churn.fact_churn
[0m00:59:39.799085 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer_churn.dim_customer"
[0m00:59:39.805688 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.fact_churn"
[0m00:59:39.808845 [debug] [Thread-1 (]: Began executing node model.customer_churn.dim_address
[0m00:59:39.808845 [debug] [Thread-2 (]: Began executing node model.customer_churn.dim_customer
[0m00:59:39.817470 [debug] [Thread-3 (]: Began executing node model.customer_churn.fact_churn
[0m00:59:39.837669 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.dim_address"
[0m00:59:39.840443 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer_churn.dim_customer"
[0m00:59:39.869230 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:59:39.869859 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
create or replace  temporary view USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
  
   as (
    -- models/marts/fact_churn.sql


select
  t.individual_id,
  t.churn_date,
  e.city,
  e.state,
  e.county,
  e.age_in_years,
  e.days_tenure,
  e.annual_premium,
  c.churn_flag
from USER_DB_FALCON.RAW_public.stg_termination t
join USER_DB_FALCON.RAW_public.int_customer_enriched e
  using (individual_id)
left join USER_DB_FALCON.RAW_public.stg_autoinsurance_churn c
  using (individual_id)


where t.churn_date > (select max(churn_date) from USER_DB_FALCON.RAW_public.fact_churn)

  );
[0m00:59:39.871355 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.dim_address"
[0m00:59:39.871904 [debug] [Thread-2 (]: Using snowflake connection "model.customer_churn.dim_customer"
[0m00:59:39.872483 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:59:39.873123 [debug] [Thread-1 (]: On model.customer_churn.dim_address: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.dim_address"} */
create or replace transient table USER_DB_FALCON.RAW_public.dim_address
         as
        (-- models/marts/dim_address.sql


select distinct
  individual_id,
  city,
  state,
  county,
  lat,
  lon
from USER_DB_FALCON.RAW_public.int_customer_enriched
        );
[0m00:59:39.873752 [debug] [Thread-2 (]: On model.customer_churn.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.dim_customer"} */
create or replace transient table USER_DB_FALCON.RAW_public.dim_customer
         as
        (-- models/marts/dim_customer.sql


select distinct
  individual_id,
  age_in_years as age,
  marital_status,
  has_children,
  length_of_residence
from USER_DB_FALCON.RAW_public.int_customer_enriched
        );
[0m00:59:39.875372 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:59:39.876463 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:59:41.756087 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.888 seconds
[0m00:59:41.764305 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:59:41.764305 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
[0m00:59:41.870874 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 0.104 seconds
[0m00:59:41.872441 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:59:41.872441 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table USER_DB_FALCON.RAW_public.fact_churn
[0m00:59:42.001341 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 0.127 seconds
[0m00:59:42.006285 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:59:42.006285 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table "USER_DB_FALCON"."RAW_PUBLIC"."FACT_CHURN"
[0m00:59:42.126241 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 0.118 seconds
[0m00:59:42.185949 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.fact_churn"
[0m00:59:42.187538 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:59:42.187538 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
-- back compat for old kwarg name
  
  begin;
[0m00:59:42.281031 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.093 seconds
[0m00:59:42.281031 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:59:42.285835 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
merge into USER_DB_FALCON.RAW_public.fact_churn as DBT_INTERNAL_DEST
        using USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.individual_id = DBT_INTERNAL_DEST.individual_id
                ) and (
                    DBT_INTERNAL_SOURCE.churn_date = DBT_INTERNAL_DEST.churn_date
                )

    
    when matched then update set
        "INDIVIDUAL_ID" = DBT_INTERNAL_SOURCE."INDIVIDUAL_ID","CHURN_DATE" = DBT_INTERNAL_SOURCE."CHURN_DATE","CITY" = DBT_INTERNAL_SOURCE."CITY","STATE" = DBT_INTERNAL_SOURCE."STATE","COUNTY" = DBT_INTERNAL_SOURCE."COUNTY","AGE_IN_YEARS" = DBT_INTERNAL_SOURCE."AGE_IN_YEARS","DAYS_TENURE" = DBT_INTERNAL_SOURCE."DAYS_TENURE","ANNUAL_PREMIUM" = DBT_INTERNAL_SOURCE."ANNUAL_PREMIUM","CHURN_FLAG" = DBT_INTERNAL_SOURCE."CHURN_FLAG"
    

    when not matched then insert
        ("INDIVIDUAL_ID", "CHURN_DATE", "CITY", "STATE", "COUNTY", "AGE_IN_YEARS", "DAYS_TENURE", "ANNUAL_PREMIUM", "CHURN_FLAG")
    values
        ("INDIVIDUAL_ID", "CHURN_DATE", "CITY", "STATE", "COUNTY", "AGE_IN_YEARS", "DAYS_TENURE", "ANNUAL_PREMIUM", "CHURN_FLAG")

;
[0m00:59:42.617864 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 0.331 seconds
[0m00:59:42.618531 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:59:42.619312 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
COMMIT
[0m00:59:42.644845 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.774 seconds
[0m00:59:42.677175 [debug] [Thread-2 (]: On model.customer_churn.dim_customer: Close
[0m00:59:42.801482 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40c7cb12-0a14-4088-9ada-a6d7ab456400', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200DE0E7980>]}
[0m00:59:42.806216 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.187 seconds
[0m00:59:42.804699 [info ] [Thread-2 (]: 2 of 4 OK created sql table model RAW_public.dim_customer ...................... [[32mSUCCESS 1[0m in 3.01s]
[0m00:59:42.826705 [debug] [Thread-3 (]: Applying DROP to: USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
[0m00:59:42.827027 [debug] [Thread-2 (]: Finished running node model.customer_churn.dim_customer
[0m00:59:42.845007 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:59:42.846349 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
drop view if exists USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp cascade
[0m00:59:43.092041 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.245 seconds
[0m00:59:43.093473 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: Close
[0m00:59:43.206054 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40c7cb12-0a14-4088-9ada-a6d7ab456400', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200DE8911C0>]}
[0m00:59:43.211146 [info ] [Thread-3 (]: 3 of 4 OK created sql incremental model RAW_public.fact_churn .................. [[32mSUCCESS 0[0m in 3.42s]
[0m00:59:43.213965 [debug] [Thread-3 (]: Finished running node model.customer_churn.fact_churn
[0m00:59:43.213965 [debug] [Thread-4 (]: Began running node model.customer_churn.churn_metrics
[0m00:59:43.213965 [info ] [Thread-4 (]: 4 of 4 START sql table model RAW_public.churn_metrics .......................... [RUN]
[0m00:59:43.213965 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.customer_churn.churn_metrics'
[0m00:59:43.213965 [debug] [Thread-4 (]: Began compiling node model.customer_churn.churn_metrics
[0m00:59:43.223948 [debug] [Thread-4 (]: Writing injected SQL for node "model.customer_churn.churn_metrics"
[0m00:59:43.223948 [debug] [Thread-4 (]: Began executing node model.customer_churn.churn_metrics
[0m00:59:43.231088 [debug] [Thread-4 (]: Writing runtime sql for node "model.customer_churn.churn_metrics"
[0m00:59:43.232499 [debug] [Thread-4 (]: Using snowflake connection "model.customer_churn.churn_metrics"
[0m00:59:43.232499 [debug] [Thread-4 (]: On model.customer_churn.churn_metrics: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.churn_metrics"} */
create or replace transient table USER_DB_FALCON.RAW_public.churn_metrics
         as
        (

with base as (
  select
    churn_date,
    churn_flag
  from USER_DB_FALCON.RAW_public.fact_churn
),

monthly as (
  select
    date_trunc('month', churn_date) as period,
    sum(churn_flag)                 as churn_count
  from base
  group by 1
),

by_state as (
  select
    state   as period,
    sum(churn_flag) as churn_count
  from USER_DB_FALCON.RAW_public.fact_churn
  group by 1
),

by_age as (
  select
    width_bucket(age_in_years, 20, 80, 6) as period,
    sum(churn_flag)                       as churn_count
  from USER_DB_FALCON.RAW_public.fact_churn
  group by 1
),

by_tenure as (
  select
    width_bucket(days_tenure, 0, 6000, 6) as period,
    sum(churn_flag)                       as churn_count
  from USER_DB_FALCON.RAW_public.fact_churn
  group by 1
),

by_premium as (
  select
    width_bucket(annual_premium, 0, 2000, 5) as period,
    sum(churn_flag)                         as churn_count
  from USER_DB_FALCON.RAW_public.fact_churn
  group by 1
)

select * from monthly
union all
select * from by_state
union all
select * from by_age
union all
select * from by_tenure
union all
select * from by_premium
;
[0m00:59:43.232499 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:59:43.846633 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01bc1e5f-0305-20d4-0004-59ff0039cde2
[0m00:59:43.847223 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 61 at position 0 unexpected ';'.
[0m00:59:43.847920 [debug] [Thread-4 (]: On model.customer_churn.churn_metrics: Close
[0m00:59:44.070745 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.202 seconds
[0m00:59:44.070745 [debug] [Thread-1 (]: On model.customer_churn.dim_address: Close
[0m00:59:44.190920 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40c7cb12-0a14-4088-9ada-a6d7ab456400', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200DE890590>]}
[0m00:59:44.190920 [info ] [Thread-1 (]: 1 of 4 OK created sql table model RAW_public.dim_address ....................... [[32mSUCCESS 1[0m in 4.41s]
[0m00:59:44.196267 [debug] [Thread-1 (]: Finished running node model.customer_churn.dim_address
[0m00:59:44.591047 [debug] [Thread-4 (]: Database Error in model churn_metrics (models\marts\churn_metrics.sql)
  001003 (42000): SQL compilation error:
  syntax error line 61 at position 0 unexpected ';'.
  compiled code at target\run\customer_churn\models\marts\churn_metrics.sql
[0m00:59:44.592542 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40c7cb12-0a14-4088-9ada-a6d7ab456400', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200DE705F40>]}
[0m00:59:44.593297 [error] [Thread-4 (]: 4 of 4 ERROR creating sql table model RAW_public.churn_metrics ................. [[31mERROR[0m in 1.38s]
[0m00:59:44.594733 [debug] [Thread-4 (]: Finished running node model.customer_churn.churn_metrics
[0m00:59:44.597727 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:59:44.598342 [debug] [MainThread]: Connection 'list_USER_DB_FALCON' was properly closed.
[0m00:59:44.598342 [debug] [MainThread]: Connection 'list_USER_DB_FALCON_RAW_public' was properly closed.
[0m00:59:44.599013 [debug] [MainThread]: Connection 'model.customer_churn.dim_address' was properly closed.
[0m00:59:44.599622 [debug] [MainThread]: Connection 'model.customer_churn.dim_customer' was properly closed.
[0m00:59:44.599622 [debug] [MainThread]: Connection 'model.customer_churn.fact_churn' was properly closed.
[0m00:59:44.600270 [debug] [MainThread]: Connection 'model.customer_churn.churn_metrics' was properly closed.
[0m00:59:44.600792 [info ] [MainThread]: 
[0m00:59:44.601471 [info ] [MainThread]: Finished running 3 table models, 1 incremental model in 0 hours 0 minutes and 6.15 seconds (6.15s).
[0m00:59:44.603546 [debug] [MainThread]: Command end result
[0m00:59:44.634307 [info ] [MainThread]: 
[0m00:59:44.635458 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:59:44.636523 [info ] [MainThread]: 
[0m00:59:44.637085 [error] [MainThread]:   Database Error in model churn_metrics (models\marts\churn_metrics.sql)
  001003 (42000): SQL compilation error:
  syntax error line 61 at position 0 unexpected ';'.
  compiled code at target\run\customer_churn\models\marts\churn_metrics.sql
[0m00:59:44.638436 [info ] [MainThread]: 
[0m00:59:44.639016 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m00:59:44.639683 [debug] [MainThread]: Command `dbt run` failed at 00:59:44.639683 after 7.18 seconds
[0m00:59:44.641160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200DBC8B5C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200DBCB1940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200DC0E47A0>]}
[0m00:59:44.641742 [debug] [MainThread]: Flushing usage events
[0m00:59:58.300930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D7AF304620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D7AF304DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D7AF305820>]}


============================== 00:59:58.306057 | 4ce4552d-d5cb-4925-ba9c-df9077743dc7 ==============================
[0m00:59:58.306057 [info ] [MainThread]: Running with dbt=1.8.2
[0m00:59:58.306057 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select marts', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:59:58.653867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ce4552d-d5cb-4925-ba9c-df9077743dc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D7AF304DA0>]}
[0m00:59:58.693604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4ce4552d-d5cb-4925-ba9c-df9077743dc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D7B1370B00>]}
[0m00:59:58.693604 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m00:59:58.830847 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m00:59:58.920682 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:59:58.920682 [debug] [MainThread]: Partial parsing: updated file: customer_churn://models\marts\churn_metrics.sql
[0m00:59:59.140628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4ce4552d-d5cb-4925-ba9c-df9077743dc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D7B19038C0>]}
[0m00:59:59.220775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4ce4552d-d5cb-4925-ba9c-df9077743dc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D7B1793260>]}
[0m00:59:59.220775 [info ] [MainThread]: Found 11 models, 10 data tests, 7 sources, 459 macros
[0m00:59:59.220775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ce4552d-d5cb-4925-ba9c-df9077743dc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D7AE875100>]}
[0m00:59:59.228288 [info ] [MainThread]: 
[0m00:59:59.228288 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:59:59.230804 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON'
[0m00:59:59.240581 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON"
[0m00:59:59.240581 [debug] [ThreadPool]: On list_USER_DB_FALCON: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON"} */
show terse schemas in database USER_DB_FALCON
    limit 10000
[0m00:59:59.244242 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:59:59.750667 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.514 seconds
[0m00:59:59.750667 [debug] [ThreadPool]: On list_USER_DB_FALCON: Close
[0m00:59:59.880603 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON_RAW_public'
[0m00:59:59.893238 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m00:59:59.893238 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show objects in USER_DB_FALCON.RAW_public limit 10000
[0m00:59:59.893238 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:00:00.394219 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.505 seconds
[0m01:00:00.400997 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m01:00:00.570845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ce4552d-d5cb-4925-ba9c-df9077743dc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D7B1A1C5C0>]}
[0m01:00:00.580873 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:00:00.580873 [info ] [MainThread]: 
[0m01:00:00.592404 [debug] [Thread-1 (]: Began running node model.customer_churn.dim_address
[0m01:00:00.592404 [debug] [Thread-2 (]: Began running node model.customer_churn.dim_customer
[0m01:00:00.592404 [debug] [Thread-3 (]: Began running node model.customer_churn.fact_churn
[0m01:00:00.596130 [info ] [Thread-1 (]: 1 of 4 START sql table model RAW_public.dim_address ............................ [RUN]
[0m01:00:00.599847 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.customer_churn.dim_address'
[0m01:00:00.596130 [info ] [Thread-2 (]: 2 of 4 START sql table model RAW_public.dim_customer ........................... [RUN]
[0m01:00:00.599847 [debug] [Thread-1 (]: Began compiling node model.customer_churn.dim_address
[0m01:00:00.600857 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.customer_churn.dim_customer'
[0m01:00:00.604586 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.dim_address"
[0m01:00:00.596130 [info ] [Thread-3 (]: 3 of 4 START sql incremental model RAW_public.fact_churn ....................... [RUN]
[0m01:00:00.604586 [debug] [Thread-2 (]: Began compiling node model.customer_churn.dim_customer
[0m01:00:00.610648 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.customer_churn.fact_churn'
[0m01:00:00.612955 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer_churn.dim_customer"
[0m01:00:00.612955 [debug] [Thread-1 (]: Began executing node model.customer_churn.dim_address
[0m01:00:00.612955 [debug] [Thread-3 (]: Began compiling node model.customer_churn.fact_churn
[0m01:00:00.640900 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.fact_churn"
[0m01:00:00.648820 [debug] [Thread-2 (]: Began executing node model.customer_churn.dim_customer
[0m01:00:00.652479 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.dim_address"
[0m01:00:00.652479 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer_churn.dim_customer"
[0m01:00:00.652479 [debug] [Thread-3 (]: Began executing node model.customer_churn.fact_churn
[0m01:00:00.652479 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.dim_address"
[0m01:00:00.681340 [debug] [Thread-2 (]: Using snowflake connection "model.customer_churn.dim_customer"
[0m01:00:00.681340 [debug] [Thread-1 (]: On model.customer_churn.dim_address: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.dim_address"} */
create or replace transient table USER_DB_FALCON.RAW_public.dim_address
         as
        (-- models/marts/dim_address.sql


select distinct
  individual_id,
  city,
  state,
  county,
  lat,
  lon
from USER_DB_FALCON.RAW_public.int_customer_enriched
        );
[0m01:00:00.690944 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m01:00:00.690944 [debug] [Thread-2 (]: On model.customer_churn.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.dim_customer"} */
create or replace transient table USER_DB_FALCON.RAW_public.dim_customer
         as
        (-- models/marts/dim_customer.sql


select distinct
  individual_id,
  age_in_years as age,
  marital_status,
  has_children,
  length_of_residence
from USER_DB_FALCON.RAW_public.int_customer_enriched
        );
[0m01:00:00.690944 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:00:00.690944 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
create or replace  temporary view USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
  
   as (
    -- models/marts/fact_churn.sql


select
  t.individual_id,
  t.churn_date,
  e.city,
  e.state,
  e.county,
  e.age_in_years,
  e.days_tenure,
  e.annual_premium,
  c.churn_flag
from USER_DB_FALCON.RAW_public.stg_termination t
join USER_DB_FALCON.RAW_public.int_customer_enriched e
  using (individual_id)
left join USER_DB_FALCON.RAW_public.stg_autoinsurance_churn c
  using (individual_id)


where t.churn_date > (select max(churn_date) from USER_DB_FALCON.RAW_public.fact_churn)

  );
[0m01:00:00.690944 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:00:00.690944 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:00:01.624891 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.931 seconds
[0m01:00:01.642431 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m01:00:01.645690 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
[0m01:00:01.785929 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 0.144 seconds
[0m01:00:01.792887 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m01:00:01.792887 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table USER_DB_FALCON.RAW_public.fact_churn
[0m01:00:01.881077 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 0.088 seconds
[0m01:00:01.904225 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m01:00:01.904225 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table "USER_DB_FALCON"."RAW_PUBLIC"."FACT_CHURN"
[0m01:00:01.999951 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 0.094 seconds
[0m01:00:02.048853 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.fact_churn"
[0m01:00:02.051711 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m01:00:02.051711 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
-- back compat for old kwarg name
  
  begin;
[0m01:00:02.340913 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.290 seconds
[0m01:00:02.344127 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m01:00:02.344127 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
merge into USER_DB_FALCON.RAW_public.fact_churn as DBT_INTERNAL_DEST
        using USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.individual_id = DBT_INTERNAL_DEST.individual_id
                ) and (
                    DBT_INTERNAL_SOURCE.churn_date = DBT_INTERNAL_DEST.churn_date
                )

    
    when matched then update set
        "INDIVIDUAL_ID" = DBT_INTERNAL_SOURCE."INDIVIDUAL_ID","CHURN_DATE" = DBT_INTERNAL_SOURCE."CHURN_DATE","CITY" = DBT_INTERNAL_SOURCE."CITY","STATE" = DBT_INTERNAL_SOURCE."STATE","COUNTY" = DBT_INTERNAL_SOURCE."COUNTY","AGE_IN_YEARS" = DBT_INTERNAL_SOURCE."AGE_IN_YEARS","DAYS_TENURE" = DBT_INTERNAL_SOURCE."DAYS_TENURE","ANNUAL_PREMIUM" = DBT_INTERNAL_SOURCE."ANNUAL_PREMIUM","CHURN_FLAG" = DBT_INTERNAL_SOURCE."CHURN_FLAG"
    

    when not matched then insert
        ("INDIVIDUAL_ID", "CHURN_DATE", "CITY", "STATE", "COUNTY", "AGE_IN_YEARS", "DAYS_TENURE", "ANNUAL_PREMIUM", "CHURN_FLAG")
    values
        ("INDIVIDUAL_ID", "CHURN_DATE", "CITY", "STATE", "COUNTY", "AGE_IN_YEARS", "DAYS_TENURE", "ANNUAL_PREMIUM", "CHURN_FLAG")

;
[0m01:00:03.160986 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 0.817 seconds
[0m01:00:03.160986 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m01:00:03.160986 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
COMMIT
[0m01:00:03.446071 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.281 seconds
[0m01:00:03.460946 [debug] [Thread-3 (]: Applying DROP to: USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
[0m01:00:03.475809 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m01:00:03.475809 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
drop view if exists USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp cascade
[0m01:00:03.980705 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.502 seconds
[0m01:00:04.001137 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.307 seconds
[0m01:00:04.041104 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: Close
[0m01:00:04.041104 [debug] [Thread-2 (]: On model.customer_churn.dim_customer: Close
[0m01:00:04.050962 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.360 seconds
[0m01:00:04.061130 [debug] [Thread-1 (]: On model.customer_churn.dim_address: Close
[0m01:00:04.201050 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ce4552d-d5cb-4925-ba9c-df9077743dc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D7B1BF6E40>]}
[0m01:00:04.201050 [info ] [Thread-2 (]: 2 of 4 OK created sql table model RAW_public.dim_customer ...................... [[32mSUCCESS 1[0m in 3.59s]
[0m01:00:04.204605 [debug] [Thread-2 (]: Finished running node model.customer_churn.dim_customer
[0m01:00:04.571214 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ce4552d-d5cb-4925-ba9c-df9077743dc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D7B13D7920>]}
[0m01:00:04.571214 [info ] [Thread-3 (]: 3 of 4 OK created sql incremental model RAW_public.fact_churn .................. [[32mSUCCESS 0[0m in 3.97s]
[0m01:00:04.581032 [debug] [Thread-3 (]: Finished running node model.customer_churn.fact_churn
[0m01:00:04.582218 [debug] [Thread-4 (]: Began running node model.customer_churn.churn_metrics
[0m01:00:04.582218 [info ] [Thread-4 (]: 4 of 4 START sql table model RAW_public.churn_metrics .......................... [RUN]
[0m01:00:04.582218 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.customer_churn.churn_metrics'
[0m01:00:04.582218 [debug] [Thread-4 (]: Began compiling node model.customer_churn.churn_metrics
[0m01:00:04.586492 [debug] [Thread-4 (]: Writing injected SQL for node "model.customer_churn.churn_metrics"
[0m01:00:04.586492 [debug] [Thread-4 (]: Began executing node model.customer_churn.churn_metrics
[0m01:00:04.591014 [debug] [Thread-4 (]: Writing runtime sql for node "model.customer_churn.churn_metrics"
[0m01:00:04.591014 [debug] [Thread-4 (]: Using snowflake connection "model.customer_churn.churn_metrics"
[0m01:00:04.591014 [debug] [Thread-4 (]: On model.customer_churn.churn_metrics: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.churn_metrics"} */
create or replace transient table USER_DB_FALCON.RAW_public.churn_metrics
         as
        (

with base as (
  select
    churn_date,
    churn_flag
  from USER_DB_FALCON.RAW_public.fact_churn
),

monthly as (
  select
    date_trunc('month', churn_date) as period,
    sum(churn_flag)                 as churn_count
  from base
  group by 1
),

by_state as (
  select
    state   as period,
    sum(churn_flag) as churn_count
  from USER_DB_FALCON.RAW_public.fact_churn
  group by 1
),

by_age as (
  select
    width_bucket(age_in_years, 20, 80, 6) as period,
    sum(churn_flag)                       as churn_count
  from USER_DB_FALCON.RAW_public.fact_churn
  group by 1
),

by_tenure as (
  select
    width_bucket(days_tenure, 0, 6000, 6) as period,
    sum(churn_flag)                       as churn_count
  from USER_DB_FALCON.RAW_public.fact_churn
  group by 1
),

by_premium as (
  select
    width_bucket(annual_premium, 0, 2000, 5) as period,
    sum(churn_flag)                         as churn_count
  from USER_DB_FALCON.RAW_public.fact_churn
  group by 1
)

select * from monthly
union all
select * from by_state
union all
select * from by_age
union all
select * from by_tenure
union all
select * from by_premium
        );
[0m01:00:04.591014 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:00:04.640514 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ce4552d-d5cb-4925-ba9c-df9077743dc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D7B1ABECF0>]}
[0m01:00:04.641030 [info ] [Thread-1 (]: 1 of 4 OK created sql table model RAW_public.dim_address ....................... [[32mSUCCESS 1[0m in 4.04s]
[0m01:00:04.642317 [debug] [Thread-1 (]: Finished running node model.customer_churn.dim_address
[0m01:00:05.160850 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01bc1e60-0305-2374-0004-59ff0039de1a
[0m01:00:05.164278 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 001790 (42601): SQL compilation error:
inconsistent data type for result columns for set operator input branches, expected NUMBER(2,0), got DATE
[0m01:00:05.164278 [debug] [Thread-4 (]: On model.customer_churn.churn_metrics: Close
[0m01:00:05.338516 [debug] [Thread-4 (]: Database Error in model churn_metrics (models\marts\churn_metrics.sql)
  001790 (42601): SQL compilation error:
  inconsistent data type for result columns for set operator input branches, expected NUMBER(2,0), got DATE
  compiled code at target\run\customer_churn\models\marts\churn_metrics.sql
[0m01:00:05.339227 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ce4552d-d5cb-4925-ba9c-df9077743dc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D7B1C92390>]}
[0m01:00:05.340644 [error] [Thread-4 (]: 4 of 4 ERROR creating sql table model RAW_public.churn_metrics ................. [[31mERROR[0m in 0.76s]
[0m01:00:05.342047 [debug] [Thread-4 (]: Finished running node model.customer_churn.churn_metrics
[0m01:00:05.346353 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:00:05.347130 [debug] [MainThread]: Connection 'list_USER_DB_FALCON' was properly closed.
[0m01:00:05.347130 [debug] [MainThread]: Connection 'list_USER_DB_FALCON_RAW_public' was properly closed.
[0m01:00:05.347847 [debug] [MainThread]: Connection 'model.customer_churn.dim_address' was properly closed.
[0m01:00:05.348634 [debug] [MainThread]: Connection 'model.customer_churn.dim_customer' was properly closed.
[0m01:00:05.348634 [debug] [MainThread]: Connection 'model.customer_churn.fact_churn' was properly closed.
[0m01:00:05.348634 [debug] [MainThread]: Connection 'model.customer_churn.churn_metrics' was properly closed.
[0m01:00:05.348634 [info ] [MainThread]: 
[0m01:00:05.350728 [info ] [MainThread]: Finished running 3 table models, 1 incremental model in 0 hours 0 minutes and 6.12 seconds (6.12s).
[0m01:00:05.350728 [debug] [MainThread]: Command end result
[0m01:00:05.385907 [info ] [MainThread]: 
[0m01:00:05.388235 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:00:05.388235 [info ] [MainThread]: 
[0m01:00:05.389653 [error] [MainThread]:   Database Error in model churn_metrics (models\marts\churn_metrics.sql)
  001790 (42601): SQL compilation error:
  inconsistent data type for result columns for set operator input branches, expected NUMBER(2,0), got DATE
  compiled code at target\run\customer_churn\models\marts\churn_metrics.sql
[0m01:00:05.390676 [info ] [MainThread]: 
[0m01:00:05.390676 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m01:00:05.390676 [debug] [MainThread]: Command `dbt run` failed at 01:00:05.390676 after 7.31 seconds
[0m01:00:05.390676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D7A9001D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D7AF304E60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D7B1973620>]}
[0m01:00:05.390676 [debug] [MainThread]: Flushing usage events
[0m01:01:04.176712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001875E1F7F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001875A4130B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001875A413710>]}


============================== 01:01:04.183729 | c6abd14a-4ea5-4256-bd77-90555f6f9f5f ==============================
[0m01:01:04.183729 [info ] [MainThread]: Running with dbt=1.8.2
[0m01:01:04.186765 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select marts', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:01:04.590489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c6abd14a-4ea5-4256-bd77-90555f6f9f5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001875D327470>]}
[0m01:01:04.649352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c6abd14a-4ea5-4256-bd77-90555f6f9f5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001875A3EEF00>]}
[0m01:01:04.650606 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m01:01:04.884551 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m01:01:05.012840 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:01:05.013381 [debug] [MainThread]: Partial parsing: updated file: customer_churn://models\marts\churn_metrics.sql
[0m01:01:05.416702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c6abd14a-4ea5-4256-bd77-90555f6f9f5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001876054EDE0>]}
[0m01:01:05.510763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c6abd14a-4ea5-4256-bd77-90555f6f9f5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018760930800>]}
[0m01:01:05.510763 [info ] [MainThread]: Found 11 models, 10 data tests, 7 sources, 459 macros
[0m01:01:05.510763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6abd14a-4ea5-4256-bd77-90555f6f9f5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001876093BFE0>]}
[0m01:01:05.510763 [info ] [MainThread]: 
[0m01:01:05.510763 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:01:05.518415 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON'
[0m01:01:05.531021 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON"
[0m01:01:05.536567 [debug] [ThreadPool]: On list_USER_DB_FALCON: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON"} */
show terse schemas in database USER_DB_FALCON
    limit 10000
[0m01:01:05.536567 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:01:07.031973 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.496 seconds
[0m01:01:07.033988 [debug] [ThreadPool]: On list_USER_DB_FALCON: Close
[0m01:01:07.304079 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON_RAW_public'
[0m01:01:07.320103 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m01:01:07.320103 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show objects in USER_DB_FALCON.RAW_public limit 10000
[0m01:01:07.320103 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:01:07.772715 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.449 seconds
[0m01:01:07.776909 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m01:01:07.909571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6abd14a-4ea5-4256-bd77-90555f6f9f5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018760514C20>]}
[0m01:01:07.909571 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:01:07.909571 [info ] [MainThread]: 
[0m01:01:07.922013 [debug] [Thread-1 (]: Began running node model.customer_churn.dim_address
[0m01:01:07.922013 [debug] [Thread-2 (]: Began running node model.customer_churn.dim_customer
[0m01:01:07.922013 [debug] [Thread-3 (]: Began running node model.customer_churn.fact_churn
[0m01:01:07.922013 [info ] [Thread-1 (]: 1 of 4 START sql table model RAW_public.dim_address ............................ [RUN]
[0m01:01:07.926863 [info ] [Thread-2 (]: 2 of 4 START sql table model RAW_public.dim_customer ........................... [RUN]
[0m01:01:07.931686 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.customer_churn.dim_address'
[0m01:01:07.928268 [info ] [Thread-3 (]: 3 of 4 START sql incremental model RAW_public.fact_churn ....................... [RUN]
[0m01:01:07.931686 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.customer_churn.dim_customer'
[0m01:01:07.931686 [debug] [Thread-1 (]: Began compiling node model.customer_churn.dim_address
[0m01:01:07.936889 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.customer_churn.fact_churn'
[0m01:01:07.936889 [debug] [Thread-2 (]: Began compiling node model.customer_churn.dim_customer
[0m01:01:07.956792 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.dim_address"
[0m01:01:07.956792 [debug] [Thread-3 (]: Began compiling node model.customer_churn.fact_churn
[0m01:01:07.968719 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer_churn.dim_customer"
[0m01:01:07.989289 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.fact_churn"
[0m01:01:07.989289 [debug] [Thread-1 (]: Began executing node model.customer_churn.dim_address
[0m01:01:08.028751 [debug] [Thread-2 (]: Began executing node model.customer_churn.dim_customer
[0m01:01:08.028751 [debug] [Thread-3 (]: Began executing node model.customer_churn.fact_churn
[0m01:01:08.046968 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.dim_address"
[0m01:01:08.054405 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer_churn.dim_customer"
[0m01:01:08.093009 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m01:01:08.093009 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
create or replace  temporary view USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
  
   as (
    -- models/marts/fact_churn.sql


select
  t.individual_id,
  t.churn_date,
  e.city,
  e.state,
  e.county,
  e.age_in_years,
  e.days_tenure,
  e.annual_premium,
  c.churn_flag
from USER_DB_FALCON.RAW_public.stg_termination t
join USER_DB_FALCON.RAW_public.int_customer_enriched e
  using (individual_id)
left join USER_DB_FALCON.RAW_public.stg_autoinsurance_churn c
  using (individual_id)


where t.churn_date > (select max(churn_date) from USER_DB_FALCON.RAW_public.fact_churn)

  );
[0m01:01:08.093009 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:01:08.093009 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.dim_address"
[0m01:01:08.097078 [debug] [Thread-2 (]: Using snowflake connection "model.customer_churn.dim_customer"
[0m01:01:08.097078 [debug] [Thread-1 (]: On model.customer_churn.dim_address: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.dim_address"} */
create or replace transient table USER_DB_FALCON.RAW_public.dim_address
         as
        (-- models/marts/dim_address.sql


select distinct
  individual_id,
  city,
  state,
  county,
  lat,
  lon
from USER_DB_FALCON.RAW_public.int_customer_enriched
        );
[0m01:01:08.097078 [debug] [Thread-2 (]: On model.customer_churn.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.dim_customer"} */
create or replace transient table USER_DB_FALCON.RAW_public.dim_customer
         as
        (-- models/marts/dim_customer.sql


select distinct
  individual_id,
  age_in_years as age,
  marital_status,
  has_children,
  length_of_residence
from USER_DB_FALCON.RAW_public.int_customer_enriched
        );
[0m01:01:08.097078 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:01:08.097078 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:01:08.943287 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.847 seconds
[0m01:01:08.950078 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m01:01:08.950643 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
[0m01:01:09.556941 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 0.606 seconds
[0m01:01:09.560632 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m01:01:09.566765 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table USER_DB_FALCON.RAW_public.fact_churn
[0m01:01:09.656685 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 0.094 seconds
[0m01:01:09.677745 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m01:01:09.677745 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table "USER_DB_FALCON"."RAW_PUBLIC"."FACT_CHURN"
[0m01:01:09.772198 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 0.092 seconds
[0m01:01:09.803761 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.fact_churn"
[0m01:01:09.806082 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m01:01:09.806599 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
-- back compat for old kwarg name
  
  begin;
[0m01:01:10.006266 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.199 seconds
[0m01:01:10.007677 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m01:01:10.008365 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
merge into USER_DB_FALCON.RAW_public.fact_churn as DBT_INTERNAL_DEST
        using USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.individual_id = DBT_INTERNAL_DEST.individual_id
                ) and (
                    DBT_INTERNAL_SOURCE.churn_date = DBT_INTERNAL_DEST.churn_date
                )

    
    when matched then update set
        "INDIVIDUAL_ID" = DBT_INTERNAL_SOURCE."INDIVIDUAL_ID","CHURN_DATE" = DBT_INTERNAL_SOURCE."CHURN_DATE","CITY" = DBT_INTERNAL_SOURCE."CITY","STATE" = DBT_INTERNAL_SOURCE."STATE","COUNTY" = DBT_INTERNAL_SOURCE."COUNTY","AGE_IN_YEARS" = DBT_INTERNAL_SOURCE."AGE_IN_YEARS","DAYS_TENURE" = DBT_INTERNAL_SOURCE."DAYS_TENURE","ANNUAL_PREMIUM" = DBT_INTERNAL_SOURCE."ANNUAL_PREMIUM","CHURN_FLAG" = DBT_INTERNAL_SOURCE."CHURN_FLAG"
    

    when not matched then insert
        ("INDIVIDUAL_ID", "CHURN_DATE", "CITY", "STATE", "COUNTY", "AGE_IN_YEARS", "DAYS_TENURE", "ANNUAL_PREMIUM", "CHURN_FLAG")
    values
        ("INDIVIDUAL_ID", "CHURN_DATE", "CITY", "STATE", "COUNTY", "AGE_IN_YEARS", "DAYS_TENURE", "ANNUAL_PREMIUM", "CHURN_FLAG")

;
[0m01:01:11.256625 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 1.249 seconds
[0m01:01:11.256625 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m01:01:11.256625 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
COMMIT
[0m01:01:11.436757 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.183 seconds
[0m01:01:11.462194 [debug] [Thread-3 (]: Applying DROP to: USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
[0m01:01:11.476632 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m01:01:11.479947 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
drop view if exists USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp cascade
[0m01:01:12.131893 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.651 seconds
[0m01:01:12.170345 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: Close
[0m01:01:12.256766 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 4.164 seconds
[0m01:01:12.266825 [debug] [Thread-2 (]: On model.customer_churn.dim_customer: Close
[0m01:01:12.306957 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6abd14a-4ea5-4256-bd77-90555f6f9f5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018760427770>]}
[0m01:01:12.306957 [info ] [Thread-3 (]: 3 of 4 OK created sql incremental model RAW_public.fact_churn .................. [[32mSUCCESS 0[0m in 4.37s]
[0m01:01:12.306957 [debug] [Thread-3 (]: Finished running node model.customer_churn.fact_churn
[0m01:01:12.306957 [debug] [Thread-4 (]: Began running node model.customer_churn.churn_metrics
[0m01:01:12.306957 [info ] [Thread-4 (]: 4 of 4 START sql table model RAW_public.churn_metrics .......................... [RUN]
[0m01:01:12.306957 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.customer_churn.churn_metrics'
[0m01:01:12.306957 [debug] [Thread-4 (]: Began compiling node model.customer_churn.churn_metrics
[0m01:01:12.317020 [debug] [Thread-4 (]: Writing injected SQL for node "model.customer_churn.churn_metrics"
[0m01:01:12.318665 [debug] [Thread-4 (]: Began executing node model.customer_churn.churn_metrics
[0m01:01:12.322023 [debug] [Thread-4 (]: Writing runtime sql for node "model.customer_churn.churn_metrics"
[0m01:01:12.326289 [debug] [Thread-4 (]: Using snowflake connection "model.customer_churn.churn_metrics"
[0m01:01:12.327002 [debug] [Thread-4 (]: On model.customer_churn.churn_metrics: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.churn_metrics"} */
create or replace transient table USER_DB_FALCON.RAW_public.churn_metrics
         as
        (

with base as (
  select
    churn_date,
    churn_flag
  from USER_DB_FALCON.RAW_public.fact_churn
),

monthly as (
  select
    date_trunc('month', churn_date) as period,
    sum(churn_flag)                 as churn_count
  from base
  group by 1
),

by_state as (
  select
    state   as period,
    sum(churn_flag) as churn_count
  from USER_DB_FALCON.RAW_public.fact_churn
  group by 1
),

by_age as (
  select
    width_bucket(age_in_years, 20, 80, 6) as period,
    sum(churn_flag)                       as churn_count
  from USER_DB_FALCON.RAW_public.fact_churn
  group by 1
),

by_tenure as (
  select
    width_bucket(days_tenure, 0, 6000, 6) as period,
    sum(churn_flag)                       as churn_count
  from USER_DB_FALCON.RAW_public.fact_churn
  group by 1
),

by_premium as (
  select
    width_bucket(annual_premium, 0, 2000, 5) as period,
    sum(churn_flag)                         as churn_count
  from USER_DB_FALCON.RAW_public.fact_churn
  group by 1
)

select cast(period as varchar) as period, churn_count from monthly
union all
select cast(period as varchar) as period, churn_count from by_state
union all
select cast(period as varchar) as period, churn_count from by_age
union all
select cast(period as varchar) as period, churn_count from by_tenure
union all
select cast(period as varchar) as period, churn_count from by_premium
        );
[0m01:01:12.327002 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:01:12.360536 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.262 seconds
[0m01:01:12.363466 [debug] [Thread-1 (]: On model.customer_churn.dim_address: Close
[0m01:01:12.396640 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6abd14a-4ea5-4256-bd77-90555f6f9f5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018760CDD490>]}
[0m01:01:12.396640 [info ] [Thread-2 (]: 2 of 4 OK created sql table model RAW_public.dim_customer ...................... [[32mSUCCESS 1[0m in 4.46s]
[0m01:01:12.396640 [debug] [Thread-2 (]: Finished running node model.customer_churn.dim_customer
[0m01:01:12.821902 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6abd14a-4ea5-4256-bd77-90555f6f9f5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018760C62FC0>]}
[0m01:01:12.826677 [info ] [Thread-1 (]: 1 of 4 OK created sql table model RAW_public.dim_address ....................... [[32mSUCCESS 1[0m in 4.89s]
[0m01:01:12.826677 [debug] [Thread-1 (]: Finished running node model.customer_churn.dim_address
[0m01:01:14.003938 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.677 seconds
[0m01:01:14.009116 [debug] [Thread-4 (]: On model.customer_churn.churn_metrics: Close
[0m01:01:14.143195 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6abd14a-4ea5-4256-bd77-90555f6f9f5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018760AF7290>]}
[0m01:01:14.143195 [info ] [Thread-4 (]: 4 of 4 OK created sql table model RAW_public.churn_metrics ..................... [[32mSUCCESS 1[0m in 1.84s]
[0m01:01:14.147004 [debug] [Thread-4 (]: Finished running node model.customer_churn.churn_metrics
[0m01:01:14.147004 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:01:14.147004 [debug] [MainThread]: Connection 'list_USER_DB_FALCON' was properly closed.
[0m01:01:14.147004 [debug] [MainThread]: Connection 'list_USER_DB_FALCON_RAW_public' was properly closed.
[0m01:01:14.147004 [debug] [MainThread]: Connection 'model.customer_churn.dim_address' was properly closed.
[0m01:01:14.147004 [debug] [MainThread]: Connection 'model.customer_churn.dim_customer' was properly closed.
[0m01:01:14.147004 [debug] [MainThread]: Connection 'model.customer_churn.fact_churn' was properly closed.
[0m01:01:14.147004 [debug] [MainThread]: Connection 'model.customer_churn.churn_metrics' was properly closed.
[0m01:01:14.156831 [info ] [MainThread]: 
[0m01:01:14.159131 [info ] [MainThread]: Finished running 1 incremental model, 3 table models in 0 hours 0 minutes and 8.65 seconds (8.65s).
[0m01:01:14.163168 [debug] [MainThread]: Command end result
[0m01:01:14.197067 [info ] [MainThread]: 
[0m01:01:14.203984 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:01:14.203984 [info ] [MainThread]: 
[0m01:01:14.203984 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m01:01:14.206592 [debug] [MainThread]: Command `dbt run` succeeded at 01:01:14.206592 after 10.33 seconds
[0m01:01:14.206592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001875A413710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187604D1520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001875DF41CA0>]}
[0m01:01:14.206592 [debug] [MainThread]: Flushing usage events
[0m01:02:20.789782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D3F3837EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D3EFA538F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D3F2D35760>]}


============================== 01:02:20.792781 | bb8bd03a-5d17-439f-94e1-5304274aa331 ==============================
[0m01:02:20.792781 [info ] [MainThread]: Running with dbt=1.8.2
[0m01:02:20.793782 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt\\logs', 'profiles_dir': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:02:21.100143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb8bd03a-5d17-439f-94e1-5304274aa331', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D3F3A00E00>]}
[0m01:02:21.136568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb8bd03a-5d17-439f-94e1-5304274aa331', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D3F5949D30>]}
[0m01:02:21.137593 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m01:02:21.278182 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m01:02:21.367899 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:02:21.367899 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:02:21.394753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb8bd03a-5d17-439f-94e1-5304274aa331', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D3F5B3C9B0>]}
[0m01:02:21.407376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb8bd03a-5d17-439f-94e1-5304274aa331', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D3F5B620F0>]}
[0m01:02:21.408376 [info ] [MainThread]: Found 11 models, 10 data tests, 7 sources, 459 macros
[0m01:02:21.408376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb8bd03a-5d17-439f-94e1-5304274aa331', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D3F5DA3F20>]}
[0m01:02:21.410377 [info ] [MainThread]: 
[0m01:02:21.411378 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:02:21.414378 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON_RAW_public'
[0m01:02:21.429431 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m01:02:21.429431 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show objects in USER_DB_FALCON.RAW_public limit 10000
[0m01:02:21.430424 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:02:22.121733 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.692 seconds
[0m01:02:22.126777 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m01:02:22.743761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb8bd03a-5d17-439f-94e1-5304274aa331', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D3F5F50AD0>]}
[0m01:02:22.746540 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:02:22.746540 [info ] [MainThread]: 
[0m01:02:22.756777 [debug] [Thread-1 (]: Began running node model.customer_churn.stg_address
[0m01:02:22.756777 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.customer_churn.stg_address'
[0m01:02:22.756777 [debug] [Thread-1 (]: Began compiling node model.customer_churn.stg_address
[0m01:02:22.762696 [debug] [Thread-3 (]: Began running node model.customer_churn.stg_customer
[0m01:02:22.762696 [debug] [Thread-2 (]: Began running node model.customer_churn.stg_autoinsurance_churn
[0m01:02:22.764814 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.customer_churn.stg_customer'
[0m01:02:22.777980 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.stg_address"
[0m01:02:22.779191 [debug] [Thread-4 (]: Began running node model.customer_churn.stg_demographic
[0m01:02:22.780130 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.customer_churn.stg_autoinsurance_churn'
[0m01:02:22.780130 [debug] [Thread-3 (]: Began compiling node model.customer_churn.stg_customer
[0m01:02:22.782140 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.customer_churn.stg_demographic'
[0m01:02:22.782140 [debug] [Thread-2 (]: Began compiling node model.customer_churn.stg_autoinsurance_churn
[0m01:02:22.783129 [debug] [Thread-1 (]: Began executing node model.customer_churn.stg_address
[0m01:02:22.784129 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.stg_customer"
[0m01:02:22.784129 [debug] [Thread-4 (]: Began compiling node model.customer_churn.stg_demographic
[0m01:02:22.786735 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer_churn.stg_autoinsurance_churn"
[0m01:02:22.788905 [debug] [Thread-1 (]: Finished running node model.customer_churn.stg_address
[0m01:02:22.792750 [debug] [Thread-4 (]: Writing injected SQL for node "model.customer_churn.stg_demographic"
[0m01:02:22.795046 [debug] [Thread-1 (]: Began running node model.customer_churn.stg_termination
[0m01:02:22.796550 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer_churn.stg_address, now model.customer_churn.stg_termination)
[0m01:02:22.796550 [debug] [Thread-3 (]: Began executing node model.customer_churn.stg_customer
[0m01:02:22.796550 [debug] [Thread-4 (]: Began executing node model.customer_churn.stg_demographic
[0m01:02:22.796550 [debug] [Thread-1 (]: Began compiling node model.customer_churn.stg_termination
[0m01:02:22.796550 [debug] [Thread-3 (]: Finished running node model.customer_churn.stg_customer
[0m01:02:22.796550 [debug] [Thread-2 (]: Began executing node model.customer_churn.stg_autoinsurance_churn
[0m01:02:22.799060 [debug] [Thread-4 (]: Finished running node model.customer_churn.stg_demographic
[0m01:02:22.801476 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.stg_termination"
[0m01:02:22.801476 [debug] [Thread-3 (]: Began running node model.customer_churn.stg_turning_movement
[0m01:02:22.801476 [debug] [Thread-2 (]: Finished running node model.customer_churn.stg_autoinsurance_churn
[0m01:02:22.801476 [debug] [Thread-4 (]: Began running node test.customer_churn.not_null_stg_address_address_id.a26685b6d5
[0m01:02:22.801476 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer_churn.stg_customer, now model.customer_churn.stg_turning_movement)
[0m01:02:22.801476 [debug] [Thread-2 (]: Began running node test.customer_churn.not_null_stg_customer_individual_id.af262c3e65
[0m01:02:22.801476 [debug] [Thread-1 (]: Began executing node model.customer_churn.stg_termination
[0m01:02:22.801476 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.customer_churn.stg_demographic, now test.customer_churn.not_null_stg_address_address_id.a26685b6d5)
[0m01:02:22.801476 [debug] [Thread-3 (]: Began compiling node model.customer_churn.stg_turning_movement
[0m01:02:22.806433 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer_churn.stg_autoinsurance_churn, now test.customer_churn.not_null_stg_customer_individual_id.af262c3e65)
[0m01:02:22.806433 [debug] [Thread-1 (]: Finished running node model.customer_churn.stg_termination
[0m01:02:22.806433 [debug] [Thread-4 (]: Began compiling node test.customer_churn.not_null_stg_address_address_id.a26685b6d5
[0m01:02:22.806433 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.stg_turning_movement"
[0m01:02:22.806433 [debug] [Thread-2 (]: Began compiling node test.customer_churn.not_null_stg_customer_individual_id.af262c3e65
[0m01:02:22.806433 [debug] [Thread-1 (]: Began running node model.customer_churn.int_customer_enriched
[0m01:02:22.817136 [debug] [Thread-4 (]: Writing injected SQL for node "test.customer_churn.not_null_stg_address_address_id.a26685b6d5"
[0m01:02:22.859973 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer_churn.not_null_stg_customer_individual_id.af262c3e65"
[0m01:02:22.860976 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer_churn.stg_termination, now model.customer_churn.int_customer_enriched)
[0m01:02:22.860976 [debug] [Thread-3 (]: Began executing node model.customer_churn.stg_turning_movement
[0m01:02:22.861972 [debug] [Thread-1 (]: Began compiling node model.customer_churn.int_customer_enriched
[0m01:02:22.862973 [debug] [Thread-3 (]: Finished running node model.customer_churn.stg_turning_movement
[0m01:02:22.862973 [debug] [Thread-2 (]: Began executing node test.customer_churn.not_null_stg_customer_individual_id.af262c3e65
[0m01:02:22.862973 [debug] [Thread-4 (]: Began executing node test.customer_churn.not_null_stg_address_address_id.a26685b6d5
[0m01:02:22.864973 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.int_customer_enriched"
[0m01:02:22.866477 [debug] [Thread-3 (]: Began running node test.customer_churn.not_null_stg_demographic_individual_id.68140728ca
[0m01:02:22.866477 [debug] [Thread-2 (]: Finished running node test.customer_churn.not_null_stg_customer_individual_id.af262c3e65
[0m01:02:22.867481 [debug] [Thread-4 (]: Finished running node test.customer_churn.not_null_stg_address_address_id.a26685b6d5
[0m01:02:22.867481 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer_churn.stg_turning_movement, now test.customer_churn.not_null_stg_demographic_individual_id.68140728ca)
[0m01:02:22.867481 [debug] [Thread-2 (]: Began running node test.customer_churn.not_null_stg_autoinsurance_churn_individual_id.c3c7b154c3
[0m01:02:22.867481 [debug] [Thread-1 (]: Began executing node model.customer_churn.int_customer_enriched
[0m01:02:22.867481 [debug] [Thread-4 (]: Began running node test.customer_churn.not_null_stg_termination_individual_id.b6d8d40bdf
[0m01:02:22.867481 [debug] [Thread-3 (]: Began compiling node test.customer_churn.not_null_stg_demographic_individual_id.68140728ca
[0m01:02:22.867481 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer_churn.not_null_stg_customer_individual_id.af262c3e65, now test.customer_churn.not_null_stg_autoinsurance_churn_individual_id.c3c7b154c3)
[0m01:02:22.867481 [debug] [Thread-1 (]: Finished running node model.customer_churn.int_customer_enriched
[0m01:02:22.867481 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.customer_churn.not_null_stg_address_address_id.a26685b6d5, now test.customer_churn.not_null_stg_termination_individual_id.b6d8d40bdf)
[0m01:02:22.867481 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer_churn.not_null_stg_demographic_individual_id.68140728ca"
[0m01:02:22.867481 [debug] [Thread-2 (]: Began compiling node test.customer_churn.not_null_stg_autoinsurance_churn_individual_id.c3c7b154c3
[0m01:02:22.876761 [debug] [Thread-1 (]: Began running node model.customer_churn.dim_address
[0m01:02:22.876761 [debug] [Thread-4 (]: Began compiling node test.customer_churn.not_null_stg_termination_individual_id.b6d8d40bdf
[0m01:02:22.884213 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer_churn.not_null_stg_autoinsurance_churn_individual_id.c3c7b154c3"
[0m01:02:22.884596 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer_churn.int_customer_enriched, now model.customer_churn.dim_address)
[0m01:02:22.884596 [debug] [Thread-3 (]: Began executing node test.customer_churn.not_null_stg_demographic_individual_id.68140728ca
[0m01:02:22.890849 [debug] [Thread-4 (]: Writing injected SQL for node "test.customer_churn.not_null_stg_termination_individual_id.b6d8d40bdf"
[0m01:02:22.890849 [debug] [Thread-1 (]: Began compiling node model.customer_churn.dim_address
[0m01:02:22.890849 [debug] [Thread-3 (]: Finished running node test.customer_churn.not_null_stg_demographic_individual_id.68140728ca
[0m01:02:22.890849 [debug] [Thread-2 (]: Began executing node test.customer_churn.not_null_stg_autoinsurance_churn_individual_id.c3c7b154c3
[0m01:02:22.896461 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.dim_address"
[0m01:02:22.899979 [debug] [Thread-3 (]: Began running node model.customer_churn.dim_customer
[0m01:02:22.899979 [debug] [Thread-4 (]: Began executing node test.customer_churn.not_null_stg_termination_individual_id.b6d8d40bdf
[0m01:02:22.902103 [debug] [Thread-2 (]: Finished running node test.customer_churn.not_null_stg_autoinsurance_churn_individual_id.c3c7b154c3
[0m01:02:22.903102 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer_churn.not_null_stg_demographic_individual_id.68140728ca, now model.customer_churn.dim_customer)
[0m01:02:22.904104 [debug] [Thread-4 (]: Finished running node test.customer_churn.not_null_stg_termination_individual_id.b6d8d40bdf
[0m01:02:22.905100 [debug] [Thread-1 (]: Began executing node model.customer_churn.dim_address
[0m01:02:22.905100 [debug] [Thread-2 (]: Began running node model.customer_churn.fact_churn
[0m01:02:22.906607 [debug] [Thread-3 (]: Began compiling node model.customer_churn.dim_customer
[0m01:02:22.906607 [debug] [Thread-4 (]: Began running node test.customer_churn.not_null_int_customer_enriched_individual_id.4f23212833
[0m01:02:22.907615 [debug] [Thread-1 (]: Finished running node model.customer_churn.dim_address
[0m01:02:22.908622 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer_churn.not_null_stg_autoinsurance_churn_individual_id.c3c7b154c3, now model.customer_churn.fact_churn)
[0m01:02:22.912619 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.dim_customer"
[0m01:02:22.912619 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.customer_churn.not_null_stg_termination_individual_id.b6d8d40bdf, now test.customer_churn.not_null_int_customer_enriched_individual_id.4f23212833)
[0m01:02:22.913615 [debug] [Thread-2 (]: Began compiling node model.customer_churn.fact_churn
[0m01:02:22.914615 [debug] [Thread-1 (]: Began running node test.customer_churn.not_null_dim_address_individual_id.efa1478d3c
[0m01:02:22.915614 [debug] [Thread-4 (]: Began compiling node test.customer_churn.not_null_int_customer_enriched_individual_id.4f23212833
[0m01:02:22.916616 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer_churn.fact_churn"
[0m01:02:22.916616 [debug] [Thread-3 (]: Began executing node model.customer_churn.dim_customer
[0m01:02:22.916616 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer_churn.dim_address, now test.customer_churn.not_null_dim_address_individual_id.efa1478d3c)
[0m01:02:22.926468 [debug] [Thread-4 (]: Writing injected SQL for node "test.customer_churn.not_null_int_customer_enriched_individual_id.4f23212833"
[0m01:02:22.926468 [debug] [Thread-3 (]: Finished running node model.customer_churn.dim_customer
[0m01:02:22.928481 [debug] [Thread-2 (]: Began executing node model.customer_churn.fact_churn
[0m01:02:22.928481 [debug] [Thread-1 (]: Began compiling node test.customer_churn.not_null_dim_address_individual_id.efa1478d3c
[0m01:02:22.928481 [debug] [Thread-2 (]: Finished running node model.customer_churn.fact_churn
[0m01:02:22.932333 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer_churn.not_null_dim_address_individual_id.efa1478d3c"
[0m01:02:22.934019 [debug] [Thread-3 (]: Began running node test.customer_churn.not_null_dim_customer_individual_id.80bf9c0ee7
[0m01:02:22.934019 [debug] [Thread-4 (]: Began executing node test.customer_churn.not_null_int_customer_enriched_individual_id.4f23212833
[0m01:02:22.934019 [debug] [Thread-2 (]: Began running node model.customer_churn.churn_metrics
[0m01:02:22.934019 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer_churn.dim_customer, now test.customer_churn.not_null_dim_customer_individual_id.80bf9c0ee7)
[0m01:02:22.936719 [debug] [Thread-4 (]: Finished running node test.customer_churn.not_null_int_customer_enriched_individual_id.4f23212833
[0m01:02:22.936719 [debug] [Thread-1 (]: Began executing node test.customer_churn.not_null_dim_address_individual_id.efa1478d3c
[0m01:02:22.936719 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer_churn.fact_churn, now model.customer_churn.churn_metrics)
[0m01:02:22.936719 [debug] [Thread-3 (]: Began compiling node test.customer_churn.not_null_dim_customer_individual_id.80bf9c0ee7
[0m01:02:22.936719 [debug] [Thread-4 (]: Began running node test.customer_churn.not_null_fact_churn_churn_date.c88bd69eeb
[0m01:02:22.936719 [debug] [Thread-1 (]: Finished running node test.customer_churn.not_null_dim_address_individual_id.efa1478d3c
[0m01:02:22.936719 [debug] [Thread-2 (]: Began compiling node model.customer_churn.churn_metrics
[0m01:02:22.943359 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer_churn.not_null_dim_customer_individual_id.80bf9c0ee7"
[0m01:02:22.943359 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.customer_churn.not_null_int_customer_enriched_individual_id.4f23212833, now test.customer_churn.not_null_fact_churn_churn_date.c88bd69eeb)
[0m01:02:22.943359 [debug] [Thread-1 (]: Began running node test.customer_churn.not_null_fact_churn_individual_id.96f069e355
[0m01:02:22.943359 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer_churn.churn_metrics"
[0m01:02:22.946831 [debug] [Thread-4 (]: Began compiling node test.customer_churn.not_null_fact_churn_churn_date.c88bd69eeb
[0m01:02:22.946831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer_churn.not_null_dim_address_individual_id.efa1478d3c, now test.customer_churn.not_null_fact_churn_individual_id.96f069e355)
[0m01:02:22.946831 [debug] [Thread-3 (]: Began executing node test.customer_churn.not_null_dim_customer_individual_id.80bf9c0ee7
[0m01:02:22.948446 [debug] [Thread-4 (]: Writing injected SQL for node "test.customer_churn.not_null_fact_churn_churn_date.c88bd69eeb"
[0m01:02:22.948446 [debug] [Thread-1 (]: Began compiling node test.customer_churn.not_null_fact_churn_individual_id.96f069e355
[0m01:02:22.948446 [debug] [Thread-2 (]: Began executing node model.customer_churn.churn_metrics
[0m01:02:22.948446 [debug] [Thread-3 (]: Finished running node test.customer_churn.not_null_dim_customer_individual_id.80bf9c0ee7
[0m01:02:22.954013 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer_churn.not_null_fact_churn_individual_id.96f069e355"
[0m01:02:22.954013 [debug] [Thread-2 (]: Finished running node model.customer_churn.churn_metrics
[0m01:02:22.954013 [debug] [Thread-4 (]: Began executing node test.customer_churn.not_null_fact_churn_churn_date.c88bd69eeb
[0m01:02:22.954013 [debug] [Thread-4 (]: Finished running node test.customer_churn.not_null_fact_churn_churn_date.c88bd69eeb
[0m01:02:22.956788 [debug] [Thread-1 (]: Began executing node test.customer_churn.not_null_fact_churn_individual_id.96f069e355
[0m01:02:22.956788 [debug] [Thread-1 (]: Finished running node test.customer_churn.not_null_fact_churn_individual_id.96f069e355
[0m01:02:22.956788 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:02:22.956788 [debug] [MainThread]: Connection 'list_USER_DB_FALCON_RAW_public' was properly closed.
[0m01:02:22.956788 [debug] [MainThread]: Connection 'test.customer_churn.not_null_fact_churn_individual_id.96f069e355' was properly closed.
[0m01:02:22.956788 [debug] [MainThread]: Connection 'test.customer_churn.not_null_dim_customer_individual_id.80bf9c0ee7' was properly closed.
[0m01:02:22.956788 [debug] [MainThread]: Connection 'model.customer_churn.churn_metrics' was properly closed.
[0m01:02:22.956788 [debug] [MainThread]: Connection 'test.customer_churn.not_null_fact_churn_churn_date.c88bd69eeb' was properly closed.
[0m01:02:22.959891 [debug] [MainThread]: Command end result
[0m01:02:23.016601 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m01:02:23.016601 [info ] [MainThread]: Building catalog
[0m01:02:23.032181 [debug] [ThreadPool]: Acquiring new snowflake connection 'USER_DB_FALCON.information_schema'
[0m01:02:23.053417 [debug] [ThreadPool]: Using snowflake connection "USER_DB_FALCON.information_schema"
[0m01:02:23.054333 [debug] [ThreadPool]: On USER_DB_FALCON.information_schema: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "USER_DB_FALCON.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from USER_DB_FALCON.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'RAW_public' and upper("table_schema") = upper('RAW_public')

                    and 
    "table_name" ilike 'stg_termination' and upper("table_name") = upper('stg_termination')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW_public' and upper("table_schema") = upper('RAW_public')

                    and 
    "table_name" ilike 'stg_address' and upper("table_name") = upper('stg_address')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW_public' and upper("table_schema") = upper('RAW_public')

                    and 
    "table_name" ilike 'stg_autoinsurance_churn' and upper("table_name") = upper('stg_autoinsurance_churn')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW_public' and upper("table_schema") = upper('RAW_public')

                    and 
    "table_name" ilike 'dim_customer' and upper("table_name") = upper('dim_customer')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW_public' and upper("table_schema") = upper('RAW_public')

                    and 
    "table_name" ilike 'fact_churn' and upper("table_name") = upper('fact_churn')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW_public' and upper("table_schema") = upper('RAW_public')

                    and 
    "table_name" ilike 'stg_customer' and upper("table_name") = upper('stg_customer')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'AUTOINSURANCE_CHURN_STAGING' and upper("table_name") = upper('AUTOINSURANCE_CHURN_STAGING')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW_public' and upper("table_schema") = upper('RAW_public')

                    and 
    "table_name" ilike 'stg_turning_movement' and upper("table_name") = upper('stg_turning_movement')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'CUSTOMER_STAGING' and upper("table_name") = upper('CUSTOMER_STAGING')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'DEMOGRAPHIC_STAGING' and upper("table_name") = upper('DEMOGRAPHIC_STAGING')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW_public' and upper("table_schema") = upper('RAW_public')

                    and 
    "table_name" ilike 'dim_address' and upper("table_name") = upper('dim_address')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'TERMINATION_STAGING' and upper("table_name") = upper('TERMINATION_STAGING')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'ADDRESS_STAGING' and upper("table_name") = upper('ADDRESS_STAGING')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'customer_churn' and upper("table_name") = upper('customer_churn')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'TURNING_MOVEMENT' and upper("table_name") = upper('TURNING_MOVEMENT')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW_public' and upper("table_schema") = upper('RAW_public')

                    and 
    "table_name" ilike 'churn_metrics' and upper("table_name") = upper('churn_metrics')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW_public' and upper("table_schema") = upper('RAW_public')

                    and 
    "table_name" ilike 'stg_demographic' and upper("table_name") = upper('stg_demographic')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW_public' and upper("table_schema") = upper('RAW_public')

                    and 
    "table_name" ilike 'int_customer_enriched' and upper("table_name") = upper('int_customer_enriched')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from USER_DB_FALCON.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'RAW_public' and upper("table_schema") = upper('RAW_public')

                    and 
    "table_name" ilike 'stg_termination' and upper("table_name") = upper('stg_termination')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW_public' and upper("table_schema") = upper('RAW_public')

                    and 
    "table_name" ilike 'stg_address' and upper("table_name") = upper('stg_address')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW_public' and upper("table_schema") = upper('RAW_public')

                    and 
    "table_name" ilike 'stg_autoinsurance_churn' and upper("table_name") = upper('stg_autoinsurance_churn')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW_public' and upper("table_schema") = upper('RAW_public')

                    and 
    "table_name" ilike 'dim_customer' and upper("table_name") = upper('dim_customer')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW_public' and upper("table_schema") = upper('RAW_public')

                    and 
    "table_name" ilike 'fact_churn' and upper("table_name") = upper('fact_churn')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW_public' and upper("table_schema") = upper('RAW_public')

                    and 
    "table_name" ilike 'stg_customer' and upper("table_name") = upper('stg_customer')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'AUTOINSURANCE_CHURN_STAGING' and upper("table_name") = upper('AUTOINSURANCE_CHURN_STAGING')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW_public' and upper("table_schema") = upper('RAW_public')

                    and 
    "table_name" ilike 'stg_turning_movement' and upper("table_name") = upper('stg_turning_movement')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'CUSTOMER_STAGING' and upper("table_name") = upper('CUSTOMER_STAGING')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'DEMOGRAPHIC_STAGING' and upper("table_name") = upper('DEMOGRAPHIC_STAGING')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW_public' and upper("table_schema") = upper('RAW_public')

                    and 
    "table_name" ilike 'dim_address' and upper("table_name") = upper('dim_address')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'TERMINATION_STAGING' and upper("table_name") = upper('TERMINATION_STAGING')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'ADDRESS_STAGING' and upper("table_name") = upper('ADDRESS_STAGING')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'customer_churn' and upper("table_name") = upper('customer_churn')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'TURNING_MOVEMENT' and upper("table_name") = upper('TURNING_MOVEMENT')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW_public' and upper("table_schema") = upper('RAW_public')

                    and 
    "table_name" ilike 'churn_metrics' and upper("table_name") = upper('churn_metrics')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW_public' and upper("table_schema") = upper('RAW_public')

                    and 
    "table_name" ilike 'stg_demographic' and upper("table_name") = upper('stg_demographic')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW_public' and upper("table_schema") = upper('RAW_public')

                    and 
    "table_name" ilike 'int_customer_enriched' and upper("table_name") = upper('int_customer_enriched')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m01:02:23.055421 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:02:31.805320 [debug] [ThreadPool]: SQL status: SUCCESS 168 in 8.751 seconds
[0m01:02:32.046530 [debug] [ThreadPool]: On USER_DB_FALCON.information_schema: Close
[0m01:02:32.246716 [info ] [MainThread]: Catalog written to C:\Users\vimal\Desktop\Github\sjsu-data226-SP25\dbt\target\catalog.json
[0m01:02:32.246716 [debug] [MainThread]: Command `dbt docs generate` succeeded at 01:02:32.246716 after 11.65 seconds
[0m01:02:32.246716 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m01:02:32.246716 [debug] [MainThread]: Connection 'USER_DB_FALCON.information_schema' was properly closed.
[0m01:02:32.246716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D3F30F6CC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D3F5F50AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D3F5B62390>]}
[0m01:02:32.246716 [debug] [MainThread]: Flushing usage events
[0m01:03:16.365307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B564AB95B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B56743F9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B566E5FBF0>]}


============================== 01:03:16.368645 | a00a81a3-80e3-4ef5-a5d7-011913687d1d ==============================
[0m01:03:16.368645 [info ] [MainThread]: Running with dbt=1.8.2
[0m01:03:16.369653 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt\\logs', 'profiles_dir': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:03:16.668918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a00a81a3-80e3-4ef5-a5d7-011913687d1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B569876720>]}
[0m01:03:16.706459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a00a81a3-80e3-4ef5-a5d7-011913687d1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B56964D070>]}
[0m01:03:19.549213 [error] [MainThread]: Encountered an error:
[Errno 11001] getaddrinfo failed
[0m01:03:19.549213 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\vimal\Desktop\Github\sjsu-data226-SP25\dbt\.venv\Lib\site-packages\dbt\cli\requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\vimal\Desktop\Github\sjsu-data226-SP25\dbt\.venv\Lib\site-packages\dbt\cli\requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\vimal\Desktop\Github\sjsu-data226-SP25\dbt\.venv\Lib\site-packages\dbt\cli\requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\vimal\Desktop\Github\sjsu-data226-SP25\dbt\.venv\Lib\site-packages\dbt\cli\requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\vimal\Desktop\Github\sjsu-data226-SP25\dbt\.venv\Lib\site-packages\dbt\cli\requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\vimal\Desktop\Github\sjsu-data226-SP25\dbt\.venv\Lib\site-packages\dbt\cli\main.py", line 303, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\vimal\Desktop\Github\sjsu-data226-SP25\dbt\.venv\Lib\site-packages\dbt\task\docs\serve.py", line 24, in run
    with socketserver.TCPServer((host, port), SimpleHTTPRequestHandler) as httpd:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\vimal\Anaconda\Lib\socketserver.py", line 457, in __init__
    self.server_bind()
  File "C:\Users\vimal\Anaconda\Lib\socketserver.py", line 473, in server_bind
    self.socket.bind(self.server_address)
socket.gaierror: [Errno 11001] getaddrinfo failed

[0m01:03:19.549213 [debug] [MainThread]: Command `dbt docs serve` failed at 01:03:19.549213 after 3.35 seconds
[0m01:03:19.549213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B566E5CB60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B569717530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B5692A9E80>]}
[0m01:03:19.549213 [debug] [MainThread]: Flushing usage events
[0m01:04:49.536534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240E62289E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240E622B7A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240E69B7F80>]}


============================== 01:04:49.540073 | b6702b50-fc43-4b74-abd9-777b791c651f ==============================
[0m01:04:49.540073 [info ] [MainThread]: Running with dbt=1.8.2
[0m01:04:49.541072 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:04:49.960308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6702b50-fc43-4b74-abd9-777b791c651f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240E8BFFAA0>]}
[0m01:04:49.997769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6702b50-fc43-4b74-abd9-777b791c651f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240E8C5B050>]}
[0m01:04:49.998758 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m01:04:50.169250 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m01:04:50.298916 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:04:50.300383 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:04:50.335352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6702b50-fc43-4b74-abd9-777b791c651f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240E8A8E1B0>]}
[0m01:04:50.362569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6702b50-fc43-4b74-abd9-777b791c651f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240E8EB7E00>]}
[0m01:04:50.362569 [info ] [MainThread]: Found 11 models, 10 data tests, 7 sources, 459 macros
[0m01:04:50.363570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6702b50-fc43-4b74-abd9-777b791c651f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240E8E6EEA0>]}
[0m01:04:50.365578 [info ] [MainThread]: 
[0m01:04:50.365578 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:04:50.369656 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON_RAW_public'
[0m01:04:50.383577 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m01:04:50.383577 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show objects in USER_DB_FALCON.RAW_public limit 10000
[0m01:04:50.384567 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:04:51.340849 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.957 seconds
[0m01:04:51.342845 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m01:04:51.472651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6702b50-fc43-4b74-abd9-777b791c651f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240E8D10500>]}
[0m01:04:51.474652 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:04:51.475661 [info ] [MainThread]: 
[0m01:04:51.483638 [debug] [Thread-1 (]: Began running node model.customer_churn.stg_address
[0m01:04:51.484641 [debug] [Thread-2 (]: Began running node model.customer_churn.stg_autoinsurance_churn
[0m01:04:51.485637 [debug] [Thread-3 (]: Began running node model.customer_churn.stg_customer
[0m01:04:51.485637 [debug] [Thread-4 (]: Began running node model.customer_churn.stg_demographic
[0m01:04:51.485637 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.customer_churn.stg_address'
[0m01:04:51.486635 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.customer_churn.stg_autoinsurance_churn'
[0m01:04:51.487147 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.customer_churn.stg_customer'
[0m01:04:51.488160 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.customer_churn.stg_demographic'
[0m01:04:51.488160 [debug] [Thread-1 (]: Began compiling node model.customer_churn.stg_address
[0m01:04:51.488160 [debug] [Thread-2 (]: Began compiling node model.customer_churn.stg_autoinsurance_churn
[0m01:04:51.489174 [debug] [Thread-3 (]: Began compiling node model.customer_churn.stg_customer
[0m01:04:51.489174 [debug] [Thread-4 (]: Began compiling node model.customer_churn.stg_demographic
[0m01:04:51.495173 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.stg_address"
[0m01:04:51.498726 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer_churn.stg_autoinsurance_churn"
[0m01:04:51.500730 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.stg_customer"
[0m01:04:51.502724 [debug] [Thread-4 (]: Writing injected SQL for node "model.customer_churn.stg_demographic"
[0m01:04:51.503728 [debug] [Thread-1 (]: Began executing node model.customer_churn.stg_address
[0m01:04:51.504727 [debug] [Thread-1 (]: Finished running node model.customer_churn.stg_address
[0m01:04:51.505729 [debug] [Thread-3 (]: Began executing node model.customer_churn.stg_customer
[0m01:04:51.505729 [debug] [Thread-1 (]: Began running node model.customer_churn.stg_termination
[0m01:04:51.506732 [debug] [Thread-4 (]: Began executing node model.customer_churn.stg_demographic
[0m01:04:51.506732 [debug] [Thread-2 (]: Began executing node model.customer_churn.stg_autoinsurance_churn
[0m01:04:51.507249 [debug] [Thread-3 (]: Finished running node model.customer_churn.stg_customer
[0m01:04:51.507249 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer_churn.stg_address, now model.customer_churn.stg_termination)
[0m01:04:51.508264 [debug] [Thread-4 (]: Finished running node model.customer_churn.stg_demographic
[0m01:04:51.509272 [debug] [Thread-2 (]: Finished running node model.customer_churn.stg_autoinsurance_churn
[0m01:04:51.509272 [debug] [Thread-3 (]: Began running node model.customer_churn.stg_turning_movement
[0m01:04:51.509272 [debug] [Thread-1 (]: Began compiling node model.customer_churn.stg_termination
[0m01:04:51.510275 [debug] [Thread-4 (]: Began running node test.customer_churn.not_null_stg_address_address_id.a26685b6d5
[0m01:04:51.510275 [debug] [Thread-2 (]: Began running node test.customer_churn.not_null_stg_customer_individual_id.af262c3e65
[0m01:04:51.510275 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer_churn.stg_customer, now model.customer_churn.stg_turning_movement)
[0m01:04:51.512807 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.stg_termination"
[0m01:04:51.513805 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.customer_churn.stg_demographic, now test.customer_churn.not_null_stg_address_address_id.a26685b6d5)
[0m01:04:51.513805 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer_churn.stg_autoinsurance_churn, now test.customer_churn.not_null_stg_customer_individual_id.af262c3e65)
[0m01:04:51.513805 [debug] [Thread-3 (]: Began compiling node model.customer_churn.stg_turning_movement
[0m01:04:51.514807 [debug] [Thread-4 (]: Began compiling node test.customer_churn.not_null_stg_address_address_id.a26685b6d5
[0m01:04:51.514807 [debug] [Thread-2 (]: Began compiling node test.customer_churn.not_null_stg_customer_individual_id.af262c3e65
[0m01:04:51.515805 [debug] [Thread-1 (]: Began executing node model.customer_churn.stg_termination
[0m01:04:51.517307 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.stg_turning_movement"
[0m01:04:51.526337 [debug] [Thread-4 (]: Writing injected SQL for node "test.customer_churn.not_null_stg_address_address_id.a26685b6d5"
[0m01:04:51.566975 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer_churn.not_null_stg_customer_individual_id.af262c3e65"
[0m01:04:51.567985 [debug] [Thread-1 (]: Finished running node model.customer_churn.stg_termination
[0m01:04:51.569002 [debug] [Thread-1 (]: Began running node model.customer_churn.int_customer_enriched
[0m01:04:51.570102 [debug] [Thread-3 (]: Began executing node model.customer_churn.stg_turning_movement
[0m01:04:51.570102 [debug] [Thread-4 (]: Began executing node test.customer_churn.not_null_stg_address_address_id.a26685b6d5
[0m01:04:51.571112 [debug] [Thread-2 (]: Began executing node test.customer_churn.not_null_stg_customer_individual_id.af262c3e65
[0m01:04:51.571112 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer_churn.stg_termination, now model.customer_churn.int_customer_enriched)
[0m01:04:51.572110 [debug] [Thread-3 (]: Finished running node model.customer_churn.stg_turning_movement
[0m01:04:51.573006 [debug] [Thread-4 (]: Finished running node test.customer_churn.not_null_stg_address_address_id.a26685b6d5
[0m01:04:51.573996 [debug] [Thread-2 (]: Finished running node test.customer_churn.not_null_stg_customer_individual_id.af262c3e65
[0m01:04:51.573996 [debug] [Thread-1 (]: Began compiling node model.customer_churn.int_customer_enriched
[0m01:04:51.574994 [debug] [Thread-3 (]: Began running node test.customer_churn.not_null_stg_demographic_individual_id.68140728ca
[0m01:04:51.574994 [debug] [Thread-4 (]: Began running node test.customer_churn.not_null_stg_autoinsurance_churn_individual_id.c3c7b154c3
[0m01:04:51.574994 [debug] [Thread-2 (]: Began running node test.customer_churn.not_null_stg_termination_individual_id.b6d8d40bdf
[0m01:04:51.578528 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.int_customer_enriched"
[0m01:04:51.579540 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer_churn.stg_turning_movement, now test.customer_churn.not_null_stg_demographic_individual_id.68140728ca)
[0m01:04:51.579540 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.customer_churn.not_null_stg_address_address_id.a26685b6d5, now test.customer_churn.not_null_stg_autoinsurance_churn_individual_id.c3c7b154c3)
[0m01:04:51.579540 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer_churn.not_null_stg_customer_individual_id.af262c3e65, now test.customer_churn.not_null_stg_termination_individual_id.b6d8d40bdf)
[0m01:04:51.580540 [debug] [Thread-3 (]: Began compiling node test.customer_churn.not_null_stg_demographic_individual_id.68140728ca
[0m01:04:51.580540 [debug] [Thread-4 (]: Began compiling node test.customer_churn.not_null_stg_autoinsurance_churn_individual_id.c3c7b154c3
[0m01:04:51.581545 [debug] [Thread-2 (]: Began compiling node test.customer_churn.not_null_stg_termination_individual_id.b6d8d40bdf
[0m01:04:51.581545 [debug] [Thread-1 (]: Began executing node model.customer_churn.int_customer_enriched
[0m01:04:51.585547 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer_churn.not_null_stg_demographic_individual_id.68140728ca"
[0m01:04:51.588325 [debug] [Thread-4 (]: Writing injected SQL for node "test.customer_churn.not_null_stg_autoinsurance_churn_individual_id.c3c7b154c3"
[0m01:04:51.591346 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer_churn.not_null_stg_termination_individual_id.b6d8d40bdf"
[0m01:04:51.592341 [debug] [Thread-1 (]: Finished running node model.customer_churn.int_customer_enriched
[0m01:04:51.593481 [debug] [Thread-3 (]: Began executing node test.customer_churn.not_null_stg_demographic_individual_id.68140728ca
[0m01:04:51.593481 [debug] [Thread-4 (]: Began executing node test.customer_churn.not_null_stg_autoinsurance_churn_individual_id.c3c7b154c3
[0m01:04:51.594368 [debug] [Thread-2 (]: Began executing node test.customer_churn.not_null_stg_termination_individual_id.b6d8d40bdf
[0m01:04:51.594368 [debug] [Thread-1 (]: Began running node model.customer_churn.dim_address
[0m01:04:51.595459 [debug] [Thread-3 (]: Finished running node test.customer_churn.not_null_stg_demographic_individual_id.68140728ca
[0m01:04:51.595459 [debug] [Thread-4 (]: Finished running node test.customer_churn.not_null_stg_autoinsurance_churn_individual_id.c3c7b154c3
[0m01:04:51.596433 [debug] [Thread-2 (]: Finished running node test.customer_churn.not_null_stg_termination_individual_id.b6d8d40bdf
[0m01:04:51.596433 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer_churn.int_customer_enriched, now model.customer_churn.dim_address)
[0m01:04:51.596433 [debug] [Thread-3 (]: Began running node model.customer_churn.dim_customer
[0m01:04:51.596433 [debug] [Thread-4 (]: Began running node model.customer_churn.fact_churn
[0m01:04:51.597875 [debug] [Thread-2 (]: Began running node test.customer_churn.not_null_int_customer_enriched_individual_id.4f23212833
[0m01:04:51.597875 [debug] [Thread-1 (]: Began compiling node model.customer_churn.dim_address
[0m01:04:51.598762 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer_churn.not_null_stg_demographic_individual_id.68140728ca, now model.customer_churn.dim_customer)
[0m01:04:51.598762 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.customer_churn.not_null_stg_autoinsurance_churn_individual_id.c3c7b154c3, now model.customer_churn.fact_churn)
[0m01:04:51.599761 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer_churn.not_null_stg_termination_individual_id.b6d8d40bdf, now test.customer_churn.not_null_int_customer_enriched_individual_id.4f23212833)
[0m01:04:51.601762 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.dim_address"
[0m01:04:51.601762 [debug] [Thread-3 (]: Began compiling node model.customer_churn.dim_customer
[0m01:04:51.601762 [debug] [Thread-4 (]: Began compiling node model.customer_churn.fact_churn
[0m01:04:51.601762 [debug] [Thread-2 (]: Began compiling node test.customer_churn.not_null_int_customer_enriched_individual_id.4f23212833
[0m01:04:51.602866 [debug] [Thread-1 (]: Began executing node model.customer_churn.dim_address
[0m01:04:51.604868 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.dim_customer"
[0m01:04:51.610620 [debug] [Thread-4 (]: Writing injected SQL for node "model.customer_churn.fact_churn"
[0m01:04:51.613053 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer_churn.not_null_int_customer_enriched_individual_id.4f23212833"
[0m01:04:51.613053 [debug] [Thread-1 (]: Finished running node model.customer_churn.dim_address
[0m01:04:51.614057 [debug] [Thread-3 (]: Began executing node model.customer_churn.dim_customer
[0m01:04:51.615055 [debug] [Thread-2 (]: Began executing node test.customer_churn.not_null_int_customer_enriched_individual_id.4f23212833
[0m01:04:51.615055 [debug] [Thread-1 (]: Began running node test.customer_churn.not_null_dim_address_individual_id.efa1478d3c
[0m01:04:51.615055 [debug] [Thread-3 (]: Finished running node model.customer_churn.dim_customer
[0m01:04:51.615055 [debug] [Thread-4 (]: Began executing node model.customer_churn.fact_churn
[0m01:04:51.616574 [debug] [Thread-2 (]: Finished running node test.customer_churn.not_null_int_customer_enriched_individual_id.4f23212833
[0m01:04:51.616574 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer_churn.dim_address, now test.customer_churn.not_null_dim_address_individual_id.efa1478d3c)
[0m01:04:51.616574 [debug] [Thread-3 (]: Began running node test.customer_churn.not_null_dim_customer_individual_id.80bf9c0ee7
[0m01:04:51.617597 [debug] [Thread-4 (]: Finished running node model.customer_churn.fact_churn
[0m01:04:51.617597 [debug] [Thread-1 (]: Began compiling node test.customer_churn.not_null_dim_address_individual_id.efa1478d3c
[0m01:04:51.618598 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer_churn.dim_customer, now test.customer_churn.not_null_dim_customer_individual_id.80bf9c0ee7)
[0m01:04:51.618598 [debug] [Thread-2 (]: Began running node model.customer_churn.churn_metrics
[0m01:04:51.619617 [debug] [Thread-4 (]: Began running node test.customer_churn.not_null_fact_churn_churn_date.c88bd69eeb
[0m01:04:51.621617 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer_churn.not_null_dim_address_individual_id.efa1478d3c"
[0m01:04:51.621617 [debug] [Thread-3 (]: Began compiling node test.customer_churn.not_null_dim_customer_individual_id.80bf9c0ee7
[0m01:04:51.622616 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer_churn.not_null_int_customer_enriched_individual_id.4f23212833, now model.customer_churn.churn_metrics)
[0m01:04:51.622616 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.customer_churn.fact_churn, now test.customer_churn.not_null_fact_churn_churn_date.c88bd69eeb)
[0m01:04:51.626767 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer_churn.not_null_dim_customer_individual_id.80bf9c0ee7"
[0m01:04:51.627414 [debug] [Thread-2 (]: Began compiling node model.customer_churn.churn_metrics
[0m01:04:51.627414 [debug] [Thread-1 (]: Began executing node test.customer_churn.not_null_dim_address_individual_id.efa1478d3c
[0m01:04:51.628500 [debug] [Thread-4 (]: Began compiling node test.customer_churn.not_null_fact_churn_churn_date.c88bd69eeb
[0m01:04:51.630501 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer_churn.churn_metrics"
[0m01:04:51.631475 [debug] [Thread-3 (]: Began executing node test.customer_churn.not_null_dim_customer_individual_id.80bf9c0ee7
[0m01:04:51.631475 [debug] [Thread-1 (]: Finished running node test.customer_churn.not_null_dim_address_individual_id.efa1478d3c
[0m01:04:51.634511 [debug] [Thread-4 (]: Writing injected SQL for node "test.customer_churn.not_null_fact_churn_churn_date.c88bd69eeb"
[0m01:04:51.635518 [debug] [Thread-3 (]: Finished running node test.customer_churn.not_null_dim_customer_individual_id.80bf9c0ee7
[0m01:04:51.635518 [debug] [Thread-1 (]: Began running node test.customer_churn.not_null_fact_churn_individual_id.96f069e355
[0m01:04:51.636458 [debug] [Thread-2 (]: Began executing node model.customer_churn.churn_metrics
[0m01:04:51.637098 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer_churn.not_null_dim_address_individual_id.efa1478d3c, now test.customer_churn.not_null_fact_churn_individual_id.96f069e355)
[0m01:04:51.638103 [debug] [Thread-2 (]: Finished running node model.customer_churn.churn_metrics
[0m01:04:51.638103 [debug] [Thread-1 (]: Began compiling node test.customer_churn.not_null_fact_churn_individual_id.96f069e355
[0m01:04:51.639115 [debug] [Thread-4 (]: Began executing node test.customer_churn.not_null_fact_churn_churn_date.c88bd69eeb
[0m01:04:51.641294 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer_churn.not_null_fact_churn_individual_id.96f069e355"
[0m01:04:51.642290 [debug] [Thread-4 (]: Finished running node test.customer_churn.not_null_fact_churn_churn_date.c88bd69eeb
[0m01:04:51.642290 [debug] [Thread-1 (]: Began executing node test.customer_churn.not_null_fact_churn_individual_id.96f069e355
[0m01:04:51.643767 [debug] [Thread-1 (]: Finished running node test.customer_churn.not_null_fact_churn_individual_id.96f069e355
[0m01:04:51.644785 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:04:51.644785 [debug] [MainThread]: Connection 'list_USER_DB_FALCON_RAW_public' was properly closed.
[0m01:04:51.644785 [debug] [MainThread]: Connection 'test.customer_churn.not_null_fact_churn_individual_id.96f069e355' was properly closed.
[0m01:04:51.644785 [debug] [MainThread]: Connection 'model.customer_churn.churn_metrics' was properly closed.
[0m01:04:51.645786 [debug] [MainThread]: Connection 'test.customer_churn.not_null_dim_customer_individual_id.80bf9c0ee7' was properly closed.
[0m01:04:51.645786 [debug] [MainThread]: Connection 'test.customer_churn.not_null_fact_churn_churn_date.c88bd69eeb' was properly closed.
[0m01:04:51.647295 [debug] [MainThread]: Command end result
[0m01:04:51.713782 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m01:04:51.713782 [info ] [MainThread]: Building catalog
[0m01:04:51.721590 [debug] [ThreadPool]: Acquiring new snowflake connection 'USER_DB_FALCON.information_schema'
[0m01:04:51.734335 [debug] [ThreadPool]: Using snowflake connection "USER_DB_FALCON.information_schema"
[0m01:04:51.735344 [debug] [ThreadPool]: On USER_DB_FALCON.information_schema: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "USER_DB_FALCON.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from USER_DB_FALCON.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'RAW_public' and upper("table_schema") = upper('RAW_public')

                    and 
    "table_name" ilike 'int_customer_enriched' and upper("table_name") = upper('int_customer_enriched')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'AUTOINSURANCE_CHURN_STAGING' and upper("table_name") = upper('AUTOINSURANCE_CHURN_STAGING')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'TURNING_MOVEMENT' and upper("table_name") = upper('TURNING_MOVEMENT')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'CUSTOMER_STAGING' and upper("table_name") = upper('CUSTOMER_STAGING')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'DEMOGRAPHIC_STAGING' and upper("table_name") = upper('DEMOGRAPHIC_STAGING')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW_public' and upper("table_schema") = upper('RAW_public')

                    and 
    "table_name" ilike 'dim_customer' and upper("table_name") = upper('dim_customer')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW_public' and upper("table_schema") = upper('RAW_public')

                    and 
    "table_name" ilike 'fact_churn' and upper("table_name") = upper('fact_churn')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW_public' and upper("table_schema") = upper('RAW_public')

                    and 
    "table_name" ilike 'stg_autoinsurance_churn' and upper("table_name") = upper('stg_autoinsurance_churn')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW_public' and upper("table_schema") = upper('RAW_public')

                    and 
    "table_name" ilike 'churn_metrics' and upper("table_name") = upper('churn_metrics')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW_public' and upper("table_schema") = upper('RAW_public')

                    and 
    "table_name" ilike 'stg_address' and upper("table_name") = upper('stg_address')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW_public' and upper("table_schema") = upper('RAW_public')

                    and 
    "table_name" ilike 'stg_customer' and upper("table_name") = upper('stg_customer')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'ADDRESS_STAGING' and upper("table_name") = upper('ADDRESS_STAGING')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW_public' and upper("table_schema") = upper('RAW_public')

                    and 
    "table_name" ilike 'stg_termination' and upper("table_name") = upper('stg_termination')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW_public' and upper("table_schema") = upper('RAW_public')

                    and 
    "table_name" ilike 'stg_turning_movement' and upper("table_name") = upper('stg_turning_movement')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'customer_churn' and upper("table_name") = upper('customer_churn')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW_public' and upper("table_schema") = upper('RAW_public')

                    and 
    "table_name" ilike 'dim_address' and upper("table_name") = upper('dim_address')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'TERMINATION_STAGING' and upper("table_name") = upper('TERMINATION_STAGING')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW_public' and upper("table_schema") = upper('RAW_public')

                    and 
    "table_name" ilike 'stg_demographic' and upper("table_name") = upper('stg_demographic')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from USER_DB_FALCON.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'RAW_public' and upper("table_schema") = upper('RAW_public')

                    and 
    "table_name" ilike 'int_customer_enriched' and upper("table_name") = upper('int_customer_enriched')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'AUTOINSURANCE_CHURN_STAGING' and upper("table_name") = upper('AUTOINSURANCE_CHURN_STAGING')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'TURNING_MOVEMENT' and upper("table_name") = upper('TURNING_MOVEMENT')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'CUSTOMER_STAGING' and upper("table_name") = upper('CUSTOMER_STAGING')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'DEMOGRAPHIC_STAGING' and upper("table_name") = upper('DEMOGRAPHIC_STAGING')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW_public' and upper("table_schema") = upper('RAW_public')

                    and 
    "table_name" ilike 'dim_customer' and upper("table_name") = upper('dim_customer')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW_public' and upper("table_schema") = upper('RAW_public')

                    and 
    "table_name" ilike 'fact_churn' and upper("table_name") = upper('fact_churn')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW_public' and upper("table_schema") = upper('RAW_public')

                    and 
    "table_name" ilike 'stg_autoinsurance_churn' and upper("table_name") = upper('stg_autoinsurance_churn')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW_public' and upper("table_schema") = upper('RAW_public')

                    and 
    "table_name" ilike 'churn_metrics' and upper("table_name") = upper('churn_metrics')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW_public' and upper("table_schema") = upper('RAW_public')

                    and 
    "table_name" ilike 'stg_address' and upper("table_name") = upper('stg_address')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW_public' and upper("table_schema") = upper('RAW_public')

                    and 
    "table_name" ilike 'stg_customer' and upper("table_name") = upper('stg_customer')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'ADDRESS_STAGING' and upper("table_name") = upper('ADDRESS_STAGING')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW_public' and upper("table_schema") = upper('RAW_public')

                    and 
    "table_name" ilike 'stg_termination' and upper("table_name") = upper('stg_termination')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW_public' and upper("table_schema") = upper('RAW_public')

                    and 
    "table_name" ilike 'stg_turning_movement' and upper("table_name") = upper('stg_turning_movement')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'customer_churn' and upper("table_name") = upper('customer_churn')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW_public' and upper("table_schema") = upper('RAW_public')

                    and 
    "table_name" ilike 'dim_address' and upper("table_name") = upper('dim_address')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'TERMINATION_STAGING' and upper("table_name") = upper('TERMINATION_STAGING')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW_public' and upper("table_schema") = upper('RAW_public')

                    and 
    "table_name" ilike 'stg_demographic' and upper("table_name") = upper('stg_demographic')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m01:04:51.736313 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:05:00.831203 [debug] [ThreadPool]: SQL status: SUCCESS 168 in 9.095 seconds
[0m01:05:01.066524 [debug] [ThreadPool]: On USER_DB_FALCON.information_schema: Close
[0m01:05:01.302608 [info ] [MainThread]: Catalog written to C:\Users\vimal\Desktop\Github\sjsu-data226-SP25\dbt\target\catalog.json
[0m01:05:01.304614 [debug] [MainThread]: Command `dbt docs generate` succeeded at 01:05:01.304614 after 11.98 seconds
[0m01:05:01.304614 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m01:05:01.305609 [debug] [MainThread]: Connection 'USER_DB_FALCON.information_schema' was properly closed.
[0m01:05:01.305609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240E67836E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240E928A5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240E928ACF0>]}
[0m01:05:01.306612 [debug] [MainThread]: Flushing usage events
[0m01:05:32.397843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD5A646360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD5A709C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD5A645B50>]}


============================== 01:05:32.403857 | 67113b66-096d-47d6-89e9-a7f8d5b384ef ==============================
[0m01:05:32.403857 [info ] [MainThread]: Running with dbt=1.8.2
[0m01:05:32.404754 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\vimal\\Desktop\\Github\\sjsu-data226-SP25\\dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt docs serve --host 127.0.0.1 --port 8080', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:05:32.756584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '67113b66-096d-47d6-89e9-a7f8d5b384ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD5A498BF0>]}
[0m01:05:32.793368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '67113b66-096d-47d6-89e9-a7f8d5b384ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD5AD46E70>]}
