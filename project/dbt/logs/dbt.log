[0m23:26:51.190007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f047b02dc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f047b02d010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f047b02cf80>]}


============================== 23:26:51.199261 | 3e166d4c-8ef8-454d-b947-dc3c47da46fa ==============================
[0m23:26:51.199261 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:26:51.200244 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:26:51.546264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e166d4c-8ef8-454d-b947-dc3c47da46fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f047b70e840>]}
[0m23:26:51.570163 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:26:51.576215 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:26:51.577760 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4883858, "process_user_time": 1.906881, "process_kernel_time": 0.365147, "process_mem_max_rss": "171080", "process_in_blocks": "8776", "process_out_blocks": "0"}
[0m23:26:51.579228 [debug] [MainThread]: Command `dbt deps` succeeded at 23:26:51.579114 after 0.49 seconds
[0m23:26:51.580987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f047b569220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f047b02dc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f047b02cf80>]}
[0m23:26:51.581831 [debug] [MainThread]: Flushing usage events
[0m23:26:55.114645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb22e715b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb22e9a330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb25af20c0>]}


============================== 23:26:55.129399 | 56e9c381-046c-4fac-8eb3-2eec9248166c ==============================
[0m23:26:55.129399 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:26:55.131191 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt --select staging', 'send_anonymous_usage_stats': 'True'}
[0m23:26:56.530333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '56e9c381-046c-4fac-8eb3-2eec9248166c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdac90bc4a0>]}
[0m23:26:56.568991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '56e9c381-046c-4fac-8eb3-2eec9248166c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdac89e8440>]}
[0m23:26:56.570230 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m23:26:56.663575 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:26:56.820233 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m23:26:56.821127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '56e9c381-046c-4fac-8eb3-2eec9248166c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdacafc6150>]}
[0m23:26:58.661200 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m23:26:58.662928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '56e9c381-046c-4fac-8eb3-2eec9248166c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdac8870a10>]}
[0m23:26:58.690909 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stock_indicators' in the 'models' section of file 'models/schema.yml'
[0m23:26:58.692832 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stock_input' in the 'models' section of file 'models/schema.yml'
[0m23:26:58.959993 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.customer_churn.unique_stock_indicators_symbol_date_key.0073da1eba' (models/schema.yml) depends on a node named 'stock_indicators' in package '' which was not found
[0m23:26:58.961588 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.customer_churn.not_null_stock_indicators_symbol_date_key.99c1f3f22c' (models/schema.yml) depends on a node named 'stock_indicators' in package '' which was not found
[0m23:26:58.962690 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.customer_churn.not_null_stock_input_symbol_date_key.e2a84c6e48' (models/schema.yml) depends on a node named 'stock_input' in package '' which was not found
[0m23:26:59.079733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '56e9c381-046c-4fac-8eb3-2eec9248166c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdac0f1bc50>]}
[0m23:26:59.331435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '56e9c381-046c-4fac-8eb3-2eec9248166c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdac8558350>]}
[0m23:26:59.333475 [info ] [MainThread]: Found 12 models, 10 data tests, 7 sources, 459 macros
[0m23:26:59.335531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56e9c381-046c-4fac-8eb3-2eec9248166c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb2279dfa0>]}
[0m23:26:59.339030 [info ] [MainThread]: 
[0m23:26:59.340499 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:26:59.350345 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON'
[0m23:26:59.380927 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON"
[0m23:26:59.382003 [debug] [ThreadPool]: On list_USER_DB_FALCON: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON"} */
show terse schemas in database USER_DB_FALCON
    limit 10000
[0m23:26:59.383100 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:27:01.468923 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.086 seconds
[0m23:27:01.474953 [debug] [ThreadPool]: On list_USER_DB_FALCON: Close
[0m23:27:01.656928 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON, now list_USER_DB_FALCON_RAW_public)
[0m23:27:01.680100 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m23:27:01.683041 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show terse objects in USER_DB_FALCON.RAW_public limit 10000
[0m23:27:01.684594 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:27:02.294662 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.610 seconds
[0m23:27:02.298310 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m23:27:02.481178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56e9c381-046c-4fac-8eb3-2eec9248166c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdac8929b20>]}
[0m23:27:02.482641 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:27:02.483538 [info ] [MainThread]: 
[0m23:27:02.498307 [debug] [Thread-1 (]: Began running node model.customer_churn.stg_address
[0m23:27:02.499364 [debug] [Thread-2 (]: Began running node model.customer_churn.stg_autoinsurance_churn
[0m23:27:02.500591 [debug] [Thread-3 (]: Began running node model.customer_churn.stg_customer
[0m23:27:02.502886 [debug] [Thread-4 (]: Began running node model.customer_churn.stg_demographic
[0m23:27:02.501738 [info ] [Thread-1 (]: 1 of 6 START sql view model RAW_public.stg_address ............................. [RUN]
[0m23:27:02.505944 [info ] [Thread-2 (]: 2 of 6 START sql view model RAW_public.stg_autoinsurance_churn ................. [RUN]
[0m23:27:02.507756 [info ] [Thread-3 (]: 3 of 6 START sql view model RAW_public.stg_customer ............................ [RUN]
[0m23:27:02.510225 [info ] [Thread-4 (]: 4 of 6 START sql view model RAW_public.stg_demographic ......................... [RUN]
[0m23:27:02.512832 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON_RAW_public, now model.customer_churn.stg_address)
[0m23:27:02.513994 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.customer_churn.stg_autoinsurance_churn'
[0m23:27:02.514755 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.customer_churn.stg_customer'
[0m23:27:02.515446 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.customer_churn.stg_demographic'
[0m23:27:02.516487 [debug] [Thread-1 (]: Began compiling node model.customer_churn.stg_address
[0m23:27:02.518866 [debug] [Thread-2 (]: Began compiling node model.customer_churn.stg_autoinsurance_churn
[0m23:27:02.520769 [debug] [Thread-3 (]: Began compiling node model.customer_churn.stg_customer
[0m23:27:02.521892 [debug] [Thread-4 (]: Began compiling node model.customer_churn.stg_demographic
[0m23:27:02.530367 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.stg_address"
[0m23:27:02.535362 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer_churn.stg_autoinsurance_churn"
[0m23:27:02.538876 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.stg_customer"
[0m23:27:02.543425 [debug] [Thread-4 (]: Writing injected SQL for node "model.customer_churn.stg_demographic"
[0m23:27:02.562282 [debug] [Thread-4 (]: Began executing node model.customer_churn.stg_demographic
[0m23:27:02.563289 [debug] [Thread-2 (]: Began executing node model.customer_churn.stg_autoinsurance_churn
[0m23:27:02.586185 [debug] [Thread-1 (]: Began executing node model.customer_churn.stg_address
[0m23:27:02.660045 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.stg_address"
[0m23:27:02.661143 [debug] [Thread-4 (]: Writing runtime sql for node "model.customer_churn.stg_demographic"
[0m23:27:02.668242 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer_churn.stg_autoinsurance_churn"
[0m23:27:02.674704 [debug] [Thread-3 (]: Began executing node model.customer_churn.stg_customer
[0m23:27:02.680870 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.stg_customer"
[0m23:27:02.695594 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.stg_address"
[0m23:27:02.697147 [debug] [Thread-1 (]: On model.customer_churn.stg_address: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_address"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_address
  
   as (
    -- models/staging/stg_address.sql

select
  address_id,
  street_address,
  city,
  state,
  county,
  latitude::float as lat,
  longitude::float as lon
from USER_DB_FALCON.RAW.ADDRESS_STAGING
  );
[0m23:27:02.698743 [debug] [Thread-2 (]: Using snowflake connection "model.customer_churn.stg_autoinsurance_churn"
[0m23:27:02.699866 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:27:02.701483 [debug] [Thread-4 (]: Using snowflake connection "model.customer_churn.stg_demographic"
[0m23:27:02.703373 [debug] [Thread-2 (]: On model.customer_churn.stg_autoinsurance_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_autoinsurance_churn"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_autoinsurance_churn
  
   as (
    

select
  individual_id,
  churn              as churn_flag
from USER_DB_FALCON.RAW.AUTOINSURANCE_CHURN_STAGING
  );
[0m23:27:02.704975 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.stg_customer"
[0m23:27:02.715554 [debug] [Thread-4 (]: On model.customer_churn.stg_demographic: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_demographic"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_demographic
  
   as (
    

select
  individual_id,
  income,
  has_children,
  length_of_residence    as length_of_residence,  -- exact match
  marital_status,
  home_owner,
  home_market_value      as home_market_value,
  college_degree,
  good_credit
from USER_DB_FALCON.RAW.DEMOGRAPHIC_STAGING
  );
[0m23:27:02.718394 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:27:02.721093 [debug] [Thread-3 (]: On model.customer_churn.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_customer"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_customer
  
   as (
    

select
  individual_id,
  address_id,
  curr_ann_amt    as annual_premium,
  days_tenure,
  cust_orig_date,
  age_in_years,            -- bring this in
  date_of_birth            -- and this
from USER_DB_FALCON.RAW.CUSTOMER_STAGING
where individual_id is not null
  );
[0m23:27:02.722739 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:27:02.728551 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:27:03.360364 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.642 seconds
[0m23:27:03.406820 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.707 seconds
[0m23:27:03.426623 [debug] [Thread-2 (]: On model.customer_churn.stg_autoinsurance_churn: Close
[0m23:27:03.435452 [debug] [Thread-1 (]: On model.customer_churn.stg_address: Close
[0m23:27:03.446989 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.719 seconds
[0m23:27:03.450123 [debug] [Thread-3 (]: On model.customer_churn.stg_customer: Close
[0m23:27:03.588508 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56e9c381-046c-4fac-8eb3-2eec9248166c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdac89eb470>]}
[0m23:27:03.593564 [info ] [Thread-2 (]: 2 of 6 OK created sql view model RAW_public.stg_autoinsurance_churn ............ [[32mSUCCESS 1[0m in 1.07s]
[0m23:27:03.596366 [debug] [Thread-2 (]: Finished running node model.customer_churn.stg_autoinsurance_churn
[0m23:27:03.598019 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56e9c381-046c-4fac-8eb3-2eec9248166c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdac84ab3e0>]}
[0m23:27:03.600089 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56e9c381-046c-4fac-8eb3-2eec9248166c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdac84a9670>]}
[0m23:27:03.601440 [debug] [Thread-2 (]: Began running node model.customer_churn.stg_termination
[0m23:27:03.604119 [info ] [Thread-3 (]: 3 of 6 OK created sql view model RAW_public.stg_customer ....................... [[32mSUCCESS 1[0m in 1.08s]
[0m23:27:03.606692 [info ] [Thread-1 (]: 1 of 6 OK created sql view model RAW_public.stg_address ........................ [[32mSUCCESS 1[0m in 1.09s]
[0m23:27:03.608984 [info ] [Thread-2 (]: 5 of 6 START sql view model RAW_public.stg_termination ......................... [RUN]
[0m23:27:03.611382 [debug] [Thread-3 (]: Finished running node model.customer_churn.stg_customer
[0m23:27:03.613548 [debug] [Thread-1 (]: Finished running node model.customer_churn.stg_address
[0m23:27:03.615469 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer_churn.stg_autoinsurance_churn, now model.customer_churn.stg_termination)
[0m23:27:03.617758 [debug] [Thread-3 (]: Began running node model.customer_churn.stg_turning_movement
[0m23:27:03.619988 [debug] [Thread-2 (]: Began compiling node model.customer_churn.stg_termination
[0m23:27:03.621785 [info ] [Thread-3 (]: 6 of 6 START sql view model RAW_public.stg_turning_movement .................... [RUN]
[0m23:27:03.628863 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer_churn.stg_termination"
[0m23:27:03.629751 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer_churn.stg_customer, now model.customer_churn.stg_turning_movement)
[0m23:27:03.632230 [debug] [Thread-3 (]: Began compiling node model.customer_churn.stg_turning_movement
[0m23:27:03.638219 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.stg_turning_movement"
[0m23:27:03.651847 [debug] [Thread-2 (]: Began executing node model.customer_churn.stg_termination
[0m23:27:03.660370 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer_churn.stg_termination"
[0m23:27:03.666515 [debug] [Thread-3 (]: Began executing node model.customer_churn.stg_turning_movement
[0m23:27:03.675268 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.stg_turning_movement"
[0m23:27:03.698705 [debug] [Thread-2 (]: Using snowflake connection "model.customer_churn.stg_termination"
[0m23:27:03.700517 [debug] [Thread-2 (]: On model.customer_churn.stg_termination: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_termination"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_termination
  
   as (
    

select
  individual_id,
  acct_suspd_date    as churn_date
from USER_DB_FALCON.RAW.TERMINATION_STAGING
  );
[0m23:27:03.702255 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:27:03.707250 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.stg_turning_movement"
[0m23:27:03.709060 [debug] [Thread-3 (]: On model.customer_churn.stg_turning_movement: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_turning_movement"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_turning_movement
  
   as (
    -- models/staging/stg_turning_movement.sql

select
  objectid,
  facilityid,
  intid,
  intname,
  nodeno,
  longitude::float as tm_lon,
  latitude::float  as tm_lat
from USER_DB_FALCON.RAW.TURNING_MOVEMENT
  );
[0m23:27:03.709888 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:27:04.221454 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.519 seconds
[0m23:27:04.225847 [debug] [Thread-2 (]: On model.customer_churn.stg_termination: Close
[0m23:27:04.358395 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56e9c381-046c-4fac-8eb3-2eec9248166c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdac049d0a0>]}
[0m23:27:04.360061 [info ] [Thread-2 (]: 5 of 6 OK created sql view model RAW_public.stg_termination .................... [[32mSUCCESS 1[0m in 0.74s]
[0m23:27:04.361779 [debug] [Thread-2 (]: Finished running node model.customer_churn.stg_termination
[0m23:27:04.426234 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.716 seconds
[0m23:27:04.431039 [debug] [Thread-3 (]: On model.customer_churn.stg_turning_movement: Close
[0m23:27:04.503879 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.781 seconds
[0m23:27:04.508297 [debug] [Thread-4 (]: On model.customer_churn.stg_demographic: Close
[0m23:27:04.574414 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56e9c381-046c-4fac-8eb3-2eec9248166c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdac0f4fc80>]}
[0m23:27:04.575665 [info ] [Thread-3 (]: 6 of 6 OK created sql view model RAW_public.stg_turning_movement ............... [[32mSUCCESS 1[0m in 0.94s]
[0m23:27:04.576755 [debug] [Thread-3 (]: Finished running node model.customer_churn.stg_turning_movement
[0m23:27:04.629615 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56e9c381-046c-4fac-8eb3-2eec9248166c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdac0480a70>]}
[0m23:27:04.631487 [info ] [Thread-4 (]: 4 of 6 OK created sql view model RAW_public.stg_demographic .................... [[32mSUCCESS 1[0m in 2.11s]
[0m23:27:04.633029 [debug] [Thread-4 (]: Finished running node model.customer_churn.stg_demographic
[0m23:27:04.637587 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:27:04.639450 [debug] [MainThread]: Connection 'model.customer_churn.stg_address' was properly closed.
[0m23:27:04.640393 [debug] [MainThread]: Connection 'model.customer_churn.stg_termination' was properly closed.
[0m23:27:04.641452 [debug] [MainThread]: Connection 'model.customer_churn.stg_turning_movement' was properly closed.
[0m23:27:04.642345 [debug] [MainThread]: Connection 'model.customer_churn.stg_demographic' was properly closed.
[0m23:27:04.643382 [info ] [MainThread]: 
[0m23:27:04.644261 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 5.30 seconds (5.30s).
[0m23:27:04.646403 [debug] [MainThread]: Command end result
[0m23:27:04.789982 [info ] [MainThread]: 
[0m23:27:04.791579 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:27:04.792635 [info ] [MainThread]: 
[0m23:27:04.793817 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m23:27:04.795604 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.837829, "process_user_time": 6.176081, "process_kernel_time": 3.892057, "process_mem_max_rss": "290416", "process_in_blocks": "5584", "process_out_blocks": "2584"}
[0m23:27:04.796431 [debug] [MainThread]: Command `dbt run` succeeded at 23:27:04.796352 after 9.84 seconds
[0m23:27:04.797686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb233b2570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb236cb380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdac860b1d0>]}
[0m23:27:04.798801 [debug] [MainThread]: Flushing usage events
[0m23:27:08.395627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e45e8320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e5711490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e4bf5e20>]}


============================== 23:27:08.410669 | 80325360-dd34-4d90-8545-c4fb8375583b ==============================
[0m23:27:08.410669 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:27:08.416965 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt --select intermediate', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:27:09.411329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '80325360-dd34-4d90-8545-c4fb8375583b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e58c66f0>]}
[0m23:27:09.450254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '80325360-dd34-4d90-8545-c4fb8375583b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd086d015b0>]}
[0m23:27:09.451794 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m23:27:09.587882 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:27:10.644432 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:27:10.646293 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:27:10.746995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80325360-dd34-4d90-8545-c4fb8375583b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd086b9caa0>]}
[0m23:27:10.976024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80325360-dd34-4d90-8545-c4fb8375583b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd08675ad80>]}
[0m23:27:10.977795 [info ] [MainThread]: Found 12 models, 10 data tests, 7 sources, 459 macros
[0m23:27:10.979875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80325360-dd34-4d90-8545-c4fb8375583b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd086797290>]}
[0m23:27:10.984076 [info ] [MainThread]: 
[0m23:27:10.985765 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:27:10.989954 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON'
[0m23:27:11.016161 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON"
[0m23:27:11.017177 [debug] [ThreadPool]: On list_USER_DB_FALCON: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON"} */
show terse schemas in database USER_DB_FALCON
    limit 10000
[0m23:27:11.018056 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:27:11.745623 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.727 seconds
[0m23:27:11.748602 [debug] [ThreadPool]: On list_USER_DB_FALCON: Close
[0m23:27:12.205284 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON, now list_USER_DB_FALCON_RAW_public)
[0m23:27:12.220348 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m23:27:12.222052 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show terse objects in USER_DB_FALCON.RAW_public limit 10000
[0m23:27:12.223496 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:27:12.671663 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.448 seconds
[0m23:27:12.676160 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m23:27:12.817625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80325360-dd34-4d90-8545-c4fb8375583b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd086752030>]}
[0m23:27:12.819230 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:27:12.821114 [info ] [MainThread]: 
[0m23:27:12.836097 [debug] [Thread-1 (]: Began running node model.customer_churn.int_customer_enriched
[0m23:27:12.838476 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW_public.int_customer_enriched ................... [RUN]
[0m23:27:12.840661 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON_RAW_public, now model.customer_churn.int_customer_enriched)
[0m23:27:12.841733 [debug] [Thread-1 (]: Began compiling node model.customer_churn.int_customer_enriched
[0m23:27:12.852597 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.int_customer_enriched"
[0m23:27:12.873554 [debug] [Thread-1 (]: Began executing node model.customer_churn.int_customer_enriched
[0m23:27:12.901359 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.int_customer_enriched"
[0m23:27:12.929949 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.int_customer_enriched"
[0m23:27:12.931764 [debug] [Thread-1 (]: On model.customer_churn.int_customer_enriched: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.int_customer_enriched"} */
create or replace   view USER_DB_FALCON.RAW_public.int_customer_enriched
  
   as (
    

with cust as (
    select
        individual_id,
        annual_premium,
        days_tenure,
        cust_orig_date,
        age_in_years,
        date_of_birth,
        address_id
    from USER_DB_FALCON.RAW_public.stg_customer
),

demo as (
    select
        individual_id,
        has_children,
        length_of_residence,
        marital_status,
        home_owner,
        home_market_value,
        college_degree,
        good_credit
    from USER_DB_FALCON.RAW_public.stg_demographic
),

addr as (
    select
        address_id,
        city,
        state,
        county,
        lat,
        lon
    from USER_DB_FALCON.RAW_public.stg_address
)

select
    cust.individual_id,
    cust.annual_premium,
    cust.days_tenure,
    cust.cust_orig_date,
    cust.age_in_years,
    cust.date_of_birth,
    demo.has_children,
    demo.length_of_residence,
    demo.marital_status,
    demo.home_owner,
    demo.home_market_value,
    addr.city,
    addr.state,
    addr.county,
    addr.lat,
    addr.lon
from cust
left join demo using (individual_id)
left join addr using (address_id)
  );
[0m23:27:12.934116 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:27:14.451382 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.517 seconds
[0m23:27:14.483183 [debug] [Thread-1 (]: On model.customer_churn.int_customer_enriched: Close
[0m23:27:14.650086 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80325360-dd34-4d90-8545-c4fb8375583b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd085da6f30>]}
[0m23:27:14.651770 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW_public.int_customer_enriched .............. [[32mSUCCESS 1[0m in 1.81s]
[0m23:27:14.653030 [debug] [Thread-1 (]: Finished running node model.customer_churn.int_customer_enriched
[0m23:27:14.656627 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:27:14.657701 [debug] [MainThread]: Connection 'model.customer_churn.int_customer_enriched' was properly closed.
[0m23:27:14.658290 [info ] [MainThread]: 
[0m23:27:14.658865 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.67 seconds (3.67s).
[0m23:27:14.659942 [debug] [MainThread]: Command end result
[0m23:27:14.778331 [info ] [MainThread]: 
[0m23:27:14.779969 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:27:14.781168 [info ] [MainThread]: 
[0m23:27:14.782161 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:27:14.784591 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.4984226, "process_user_time": 4.601973, "process_kernel_time": 2.890581, "process_mem_max_rss": "255024", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m23:27:14.786059 [debug] [MainThread]: Command `dbt run` succeeded at 23:27:14.785853 after 6.50 seconds
[0m23:27:14.786990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e55dcb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e49ba240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd08675a630>]}
[0m23:27:14.787894 [debug] [MainThread]: Flushing usage events
[0m23:27:18.777586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b75b650a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b75b65640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b75b65eb0>]}


============================== 23:27:18.784969 | 9f4aa147-368d-4735-8861-3def1ef82272 ==============================
[0m23:27:18.784969 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:27:18.786482 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt --select marts', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:27:20.315964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f4aa147-368d-4735-8861-3def1ef82272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b23f75550>]}
[0m23:27:20.366290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9f4aa147-368d-4735-8861-3def1ef82272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b17e578f0>]}
[0m23:27:20.372128 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m23:27:20.501730 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:27:21.621900 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:27:21.625900 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:27:21.727665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9f4aa147-368d-4735-8861-3def1ef82272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b17bc4fe0>]}
[0m23:27:21.966482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9f4aa147-368d-4735-8861-3def1ef82272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b178e8c80>]}
[0m23:27:21.968194 [info ] [MainThread]: Found 12 models, 10 data tests, 7 sources, 459 macros
[0m23:27:21.969572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f4aa147-368d-4735-8861-3def1ef82272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b178fcaa0>]}
[0m23:27:21.973872 [info ] [MainThread]: 
[0m23:27:21.975855 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:27:21.984502 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON'
[0m23:27:22.014368 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON"
[0m23:27:22.015913 [debug] [ThreadPool]: On list_USER_DB_FALCON: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON"} */
show terse schemas in database USER_DB_FALCON
    limit 10000
[0m23:27:22.017095 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:27:22.824725 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.807 seconds
[0m23:27:22.829461 [debug] [ThreadPool]: On list_USER_DB_FALCON: Close
[0m23:27:23.021747 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON, now list_USER_DB_FALCON_RAW_public)
[0m23:27:23.030639 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m23:27:23.032095 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show terse objects in USER_DB_FALCON.RAW_public limit 10000
[0m23:27:23.033711 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:27:23.513871 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.480 seconds
[0m23:27:23.518703 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m23:27:23.660669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f4aa147-368d-4735-8861-3def1ef82272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b1f4ed970>]}
[0m23:27:23.667427 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:27:23.668381 [info ] [MainThread]: 
[0m23:27:23.680165 [debug] [Thread-1 (]: Began running node model.customer_churn.dim_address
[0m23:27:23.680694 [debug] [Thread-2 (]: Began running node model.customer_churn.dim_customer
[0m23:27:23.681266 [info ] [Thread-1 (]: 1 of 5 START sql table model RAW_public.dim_address ............................ [RUN]
[0m23:27:23.682176 [debug] [Thread-3 (]: Began running node model.customer_churn.fact_churn
[0m23:27:23.684099 [info ] [Thread-2 (]: 2 of 5 START sql table model RAW_public.dim_customer ........................... [RUN]
[0m23:27:23.685763 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON_RAW_public, now model.customer_churn.dim_address)
[0m23:27:23.686723 [info ] [Thread-3 (]: 3 of 5 START sql incremental model RAW_public.fact_churn ....................... [RUN]
[0m23:27:23.688382 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.customer_churn.dim_customer'
[0m23:27:23.688746 [debug] [Thread-1 (]: Began compiling node model.customer_churn.dim_address
[0m23:27:23.689684 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.customer_churn.fact_churn'
[0m23:27:23.690544 [debug] [Thread-2 (]: Began compiling node model.customer_churn.dim_customer
[0m23:27:23.697638 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.dim_address"
[0m23:27:23.697997 [debug] [Thread-3 (]: Began compiling node model.customer_churn.fact_churn
[0m23:27:23.703386 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer_churn.dim_customer"
[0m23:27:23.713158 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.fact_churn"
[0m23:27:23.732996 [debug] [Thread-2 (]: Began executing node model.customer_churn.dim_customer
[0m23:27:23.733585 [debug] [Thread-1 (]: Began executing node model.customer_churn.dim_address
[0m23:27:23.739370 [debug] [Thread-3 (]: Began executing node model.customer_churn.fact_churn
[0m23:27:23.777395 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.dim_address"
[0m23:27:23.789085 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer_churn.dim_customer"
[0m23:27:23.815752 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:27:23.816881 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
create or replace  temporary view USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
  
   as (
    -- models/marts/fact_churn.sql


select
  t.individual_id,
  t.churn_date,
  e.city,
  e.state,
  e.county,
  e.age_in_years,
  e.days_tenure,
  e.annual_premium,
  c.churn_flag
from USER_DB_FALCON.RAW_public.stg_termination t
join USER_DB_FALCON.RAW_public.int_customer_enriched e
  using (individual_id)
left join USER_DB_FALCON.RAW_public.stg_autoinsurance_churn c
  using (individual_id)


where t.churn_date > (select max(churn_date) from USER_DB_FALCON.RAW_public.fact_churn)

  );
[0m23:27:23.817961 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:27:23.827436 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.dim_address"
[0m23:27:23.828231 [debug] [Thread-1 (]: On model.customer_churn.dim_address: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.dim_address"} */
create or replace transient table USER_DB_FALCON.RAW_public.dim_address
         as
        (-- models/marts/dim_address.sql


select distinct
  individual_id,
  city,
  state,
  county,
  lat,
  lon
from USER_DB_FALCON.RAW_public.int_customer_enriched
        );
[0m23:27:23.829232 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:27:23.833030 [debug] [Thread-2 (]: Using snowflake connection "model.customer_churn.dim_customer"
[0m23:27:23.834193 [debug] [Thread-2 (]: On model.customer_churn.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.dim_customer"} */
create or replace transient table USER_DB_FALCON.RAW_public.dim_customer
         as
        (-- models/marts/dim_customer.sql


select distinct
  individual_id,
  age_in_years as age,
  marital_status,
  has_children,
  length_of_residence
from USER_DB_FALCON.RAW_public.int_customer_enriched
        );
[0m23:27:23.835075 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:27:25.258113 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.440 seconds
[0m23:27:25.269543 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:27:25.271233 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
[0m23:27:25.376192 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 0.104 seconds
[0m23:27:25.381007 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:27:25.381961 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table USER_DB_FALCON.RAW_public.fact_churn
[0m23:27:25.487955 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 0.105 seconds
[0m23:27:25.497173 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:27:25.498199 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table "USER_DB_FALCON"."RAW_PUBLIC"."FACT_CHURN"
[0m23:27:25.633631 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 0.135 seconds
[0m23:27:25.672275 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.fact_churn"
[0m23:27:25.689224 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:27:25.690141 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
-- back compat for old kwarg name
  
  begin;
[0m23:27:25.846372 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.155 seconds
[0m23:27:25.847800 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:27:25.848792 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
merge into USER_DB_FALCON.RAW_public.fact_churn as DBT_INTERNAL_DEST
        using USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.individual_id = DBT_INTERNAL_DEST.individual_id
                ) and (
                    DBT_INTERNAL_SOURCE.churn_date = DBT_INTERNAL_DEST.churn_date
                )

    
    when matched then update set
        "INDIVIDUAL_ID" = DBT_INTERNAL_SOURCE."INDIVIDUAL_ID","CHURN_DATE" = DBT_INTERNAL_SOURCE."CHURN_DATE","CITY" = DBT_INTERNAL_SOURCE."CITY","STATE" = DBT_INTERNAL_SOURCE."STATE","COUNTY" = DBT_INTERNAL_SOURCE."COUNTY","AGE_IN_YEARS" = DBT_INTERNAL_SOURCE."AGE_IN_YEARS","DAYS_TENURE" = DBT_INTERNAL_SOURCE."DAYS_TENURE","ANNUAL_PREMIUM" = DBT_INTERNAL_SOURCE."ANNUAL_PREMIUM","CHURN_FLAG" = DBT_INTERNAL_SOURCE."CHURN_FLAG"
    

    when not matched then insert
        ("INDIVIDUAL_ID", "CHURN_DATE", "CITY", "STATE", "COUNTY", "AGE_IN_YEARS", "DAYS_TENURE", "ANNUAL_PREMIUM", "CHURN_FLAG")
    values
        ("INDIVIDUAL_ID", "CHURN_DATE", "CITY", "STATE", "COUNTY", "AGE_IN_YEARS", "DAYS_TENURE", "ANNUAL_PREMIUM", "CHURN_FLAG")

;
[0m23:27:27.381284 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 1.532 seconds
[0m23:27:27.382932 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:27:27.384166 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
COMMIT
[0m23:27:27.554973 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.169 seconds
[0m23:27:27.565329 [debug] [Thread-3 (]: Applying DROP to: USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
[0m23:27:27.574730 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:27:27.576198 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
drop view if exists USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp cascade
[0m23:27:27.754528 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.177 seconds
[0m23:27:27.787600 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: Close
[0m23:27:27.938177 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f4aa147-368d-4735-8861-3def1ef82272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b17e8a930>]}
[0m23:27:27.939830 [info ] [Thread-3 (]: 3 of 5 OK created sql incremental model RAW_public.fact_churn .................. [[32mSUCCESS 0[0m in 4.25s]
[0m23:27:27.941039 [debug] [Thread-3 (]: Finished running node model.customer_churn.fact_churn
[0m23:27:27.942806 [debug] [Thread-4 (]: Began running node model.customer_churn.churn_metrics
[0m23:27:27.943746 [info ] [Thread-4 (]: 4 of 5 START sql table model RAW_public.churn_metrics .......................... [RUN]
[0m23:27:27.944945 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.customer_churn.churn_metrics'
[0m23:27:27.947040 [debug] [Thread-4 (]: Began compiling node model.customer_churn.churn_metrics
[0m23:27:27.954473 [debug] [Thread-4 (]: Writing injected SQL for node "model.customer_churn.churn_metrics"
[0m23:27:27.973951 [debug] [Thread-4 (]: Began executing node model.customer_churn.churn_metrics
[0m23:27:27.979063 [debug] [Thread-4 (]: Writing runtime sql for node "model.customer_churn.churn_metrics"
[0m23:27:27.995039 [debug] [Thread-4 (]: Using snowflake connection "model.customer_churn.churn_metrics"
[0m23:27:27.996579 [debug] [Thread-4 (]: On model.customer_churn.churn_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.churn_metrics"} */
create or replace transient table USER_DB_FALCON.RAW_public.churn_metrics
         as
        (select 
  cast(period as varchar) as period, 
  churn_count,
  'monthly' as category
from monthly

union all

select 
  cast(period as varchar) as period, 
  churn_count,
  'by_state' as category
from by_state

union all

select 
  cast(period as varchar) as period, 
  churn_count,
  'by_age' as category
from by_age

union all

by_tenure as (
    select
        width_bucket(days_tenure, 0, 6000, 6) as period,
        sum(churn_flag) as churn_count,
        width_bucket(days_tenure, 0, 6000, 6) as tenure_bucket_index,
        case
            when days_tenure <= 90 then '0-3 months'
            when days_tenure <= 180 then '4-6 months'
            when days_tenure <= 365 then '7-12 months'
            when days_tenure <= 730 then '13-24 months'
            else '25+ months'
        end as tenure_bucket_label
    from USER_DB_FALCON.RAW_public.fact_churn
    group by 1, 3, 4
)

union all

select 
  cast(period as varchar) as period, 
  churn_count,
  'by_premium' as category
from by_premium
        );
[0m23:27:27.997923 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:27:28.166266 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 4.331 seconds
[0m23:27:28.172923 [debug] [Thread-2 (]: On model.customer_churn.dim_customer: Close
[0m23:27:28.333713 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f4aa147-368d-4735-8861-3def1ef82272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b16e128a0>]}
[0m23:27:28.335144 [info ] [Thread-2 (]: 2 of 5 OK created sql table model RAW_public.dim_customer ...................... [[32mSUCCESS 1[0m in 4.65s]
[0m23:27:28.336436 [debug] [Thread-2 (]: Finished running node model.customer_churn.dim_customer
[0m23:27:28.544249 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.715 seconds
[0m23:27:28.548343 [debug] [Thread-1 (]: On model.customer_churn.dim_address: Close
[0m23:27:28.691270 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f4aa147-368d-4735-8861-3def1ef82272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b16e0d8b0>]}
[0m23:27:28.692360 [info ] [Thread-1 (]: 1 of 5 OK created sql table model RAW_public.dim_address ....................... [[32mSUCCESS 1[0m in 5.01s]
[0m23:27:28.693358 [debug] [Thread-1 (]: Finished running node model.customer_churn.dim_address
[0m23:27:28.694730 [debug] [Thread-3 (]: Began running node model.customer_churn.churn_map
[0m23:27:28.695397 [info ] [Thread-3 (]: 5 of 5 START sql table model RAW_public.churn_map .............................. [RUN]
[0m23:27:28.696014 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer_churn.fact_churn, now model.customer_churn.churn_map)
[0m23:27:28.696578 [debug] [Thread-3 (]: Began compiling node model.customer_churn.churn_map
[0m23:27:28.700075 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.churn_map"
[0m23:27:28.710854 [debug] [Thread-3 (]: Began executing node model.customer_churn.churn_map
[0m23:27:28.713928 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.churn_map"
[0m23:27:28.729708 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.churn_map"
[0m23:27:28.734360 [debug] [Thread-3 (]: On model.customer_churn.churn_map: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.churn_map"} */
create or replace transient table USER_DB_FALCON.RAW_public.churn_map
         as
        (-- models/marts/churn_map.sql


select
  f.individual_id,
  f.churn_date,
  f.churn_flag,
  a.lon,
  a.lat
from USER_DB_FALCON.RAW_public.fact_churn      as f
join USER_DB_FALCON.RAW_public.dim_address    as a
  using (individual_id)
        );
[0m23:27:28.736659 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:27:28.835183 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01bc279f-0305-29ae-0004-59ff003c901e
[0m23:27:28.836613 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 27 at position 0 unexpected 'by_tenure'.
syntax error line 29 at position 46 unexpected 'as'.
[0m23:27:28.837771 [debug] [Thread-4 (]: On model.customer_churn.churn_metrics: Close
[0m23:27:28.981082 [debug] [Thread-4 (]: Database Error in model churn_metrics (models/marts/churn_metrics.sql)
  001003 (42000): SQL compilation error:
  syntax error line 27 at position 0 unexpected 'by_tenure'.
  syntax error line 29 at position 46 unexpected 'as'.
  compiled code at target/run/customer_churn/models/marts/churn_metrics.sql
[0m23:27:28.985288 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f4aa147-368d-4735-8861-3def1ef82272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b16e10470>]}
[0m23:27:28.987843 [error] [Thread-4 (]: 4 of 5 ERROR creating sql table model RAW_public.churn_metrics ................. [[31mERROR[0m in 1.04s]
[0m23:27:28.990398 [debug] [Thread-4 (]: Finished running node model.customer_churn.churn_metrics
[0m23:27:30.290669 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.554 seconds
[0m23:27:30.295784 [debug] [Thread-3 (]: On model.customer_churn.churn_map: Close
[0m23:27:30.467974 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f4aa147-368d-4735-8861-3def1ef82272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b16d82060>]}
[0m23:27:30.470678 [info ] [Thread-3 (]: 5 of 5 OK created sql table model RAW_public.churn_map ......................... [[32mSUCCESS 1[0m in 1.77s]
[0m23:27:30.473368 [debug] [Thread-3 (]: Finished running node model.customer_churn.churn_map
[0m23:27:30.479043 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:27:30.481208 [debug] [MainThread]: Connection 'model.customer_churn.dim_address' was properly closed.
[0m23:27:30.482668 [debug] [MainThread]: Connection 'model.customer_churn.dim_customer' was properly closed.
[0m23:27:30.484163 [debug] [MainThread]: Connection 'model.customer_churn.churn_map' was properly closed.
[0m23:27:30.485615 [debug] [MainThread]: Connection 'model.customer_churn.churn_metrics' was properly closed.
[0m23:27:30.487313 [info ] [MainThread]: 
[0m23:27:30.488993 [info ] [MainThread]: Finished running 1 incremental model, 4 table models in 0 hours 0 minutes and 8.51 seconds (8.51s).
[0m23:27:30.492910 [debug] [MainThread]: Command end result
[0m23:27:30.649078 [info ] [MainThread]: 
[0m23:27:30.650415 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:27:30.651676 [info ] [MainThread]: 
[0m23:27:30.653063 [error] [MainThread]:   Database Error in model churn_metrics (models/marts/churn_metrics.sql)
  001003 (42000): SQL compilation error:
  syntax error line 27 at position 0 unexpected 'by_tenure'.
  syntax error line 29 at position 46 unexpected 'as'.
  compiled code at target/run/customer_churn/models/marts/churn_metrics.sql
[0m23:27:30.654167 [info ] [MainThread]: 
[0m23:27:30.655479 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m23:27:30.657881 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 11.595279, "process_user_time": 4.821804, "process_kernel_time": 3.145996, "process_mem_max_rss": "282740", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m23:27:30.659777 [debug] [MainThread]: Command `dbt run` failed at 23:27:30.659553 after 11.60 seconds
[0m23:27:30.661041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b7687a090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b75ab3b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b1cb2f950>]}
[0m23:27:30.662381 [debug] [MainThread]: Flushing usage events
[0m23:37:48.544037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde3c148170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde3c1484d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde3c148230>]}


============================== 23:37:48.563357 | 69fd6251-9f60-40c7-9cad-4c8436b7342e ==============================
[0m23:37:48.563357 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:37:48.565867 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt --select marts', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:37:51.586710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '69fd6251-9f60-40c7-9cad-4c8436b7342e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdddeae4f80>]}
[0m23:37:51.690602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '69fd6251-9f60-40c7-9cad-4c8436b7342e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddde8d3aa0>]}
[0m23:37:51.693412 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m23:37:51.887246 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:37:52.908200 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:37:52.910958 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:37:53.071647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '69fd6251-9f60-40c7-9cad-4c8436b7342e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddde5d8470>]}
[0m23:37:53.750149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '69fd6251-9f60-40c7-9cad-4c8436b7342e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddde2f4b60>]}
[0m23:37:53.752406 [info ] [MainThread]: Found 12 models, 10 data tests, 7 sources, 459 macros
[0m23:37:53.755046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69fd6251-9f60-40c7-9cad-4c8436b7342e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddde2cddf0>]}
[0m23:37:53.768498 [info ] [MainThread]: 
[0m23:37:53.771786 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:37:53.791916 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON'
[0m23:37:53.902241 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON"
[0m23:37:53.905419 [debug] [ThreadPool]: On list_USER_DB_FALCON: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON"} */
show terse schemas in database USER_DB_FALCON
    limit 10000
[0m23:37:53.908116 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:37:54.820133 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.912 seconds
[0m23:37:54.826070 [debug] [ThreadPool]: On list_USER_DB_FALCON: Close
[0m23:37:54.999217 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON, now list_USER_DB_FALCON_RAW_public)
[0m23:37:55.031038 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m23:37:55.033023 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show terse objects in USER_DB_FALCON.RAW_public limit 10000
[0m23:37:55.034821 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:37:55.587689 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.553 seconds
[0m23:37:55.595433 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m23:37:55.743514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69fd6251-9f60-40c7-9cad-4c8436b7342e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddde2f46e0>]}
[0m23:37:55.746272 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:37:55.748699 [info ] [MainThread]: 
[0m23:37:55.779569 [debug] [Thread-1 (]: Began running node model.customer_churn.dim_address
[0m23:37:55.781614 [debug] [Thread-2 (]: Began running node model.customer_churn.dim_customer
[0m23:37:55.782856 [debug] [Thread-3 (]: Began running node model.customer_churn.fact_churn
[0m23:37:55.784526 [info ] [Thread-1 (]: 1 of 5 START sql table model RAW_public.dim_address ............................ [RUN]
[0m23:37:55.787359 [info ] [Thread-2 (]: 2 of 5 START sql table model RAW_public.dim_customer ........................... [RUN]
[0m23:37:55.789469 [info ] [Thread-3 (]: 3 of 5 START sql incremental model RAW_public.fact_churn ....................... [RUN]
[0m23:37:55.791620 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON_RAW_public, now model.customer_churn.dim_address)
[0m23:37:55.794033 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.customer_churn.dim_customer'
[0m23:37:55.796176 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.customer_churn.fact_churn'
[0m23:37:55.797809 [debug] [Thread-1 (]: Began compiling node model.customer_churn.dim_address
[0m23:37:55.799327 [debug] [Thread-2 (]: Began compiling node model.customer_churn.dim_customer
[0m23:37:55.800899 [debug] [Thread-3 (]: Began compiling node model.customer_churn.fact_churn
[0m23:37:55.823785 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.dim_address"
[0m23:37:55.839097 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer_churn.dim_customer"
[0m23:37:55.863398 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.fact_churn"
[0m23:37:55.871525 [debug] [Thread-2 (]: Began executing node model.customer_churn.dim_customer
[0m23:37:55.873215 [debug] [Thread-1 (]: Began executing node model.customer_churn.dim_address
[0m23:37:55.885761 [debug] [Thread-3 (]: Began executing node model.customer_churn.fact_churn
[0m23:37:56.054215 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.dim_address"
[0m23:37:56.088857 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer_churn.dim_customer"
[0m23:37:56.119267 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.dim_address"
[0m23:37:56.127605 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:37:56.128974 [debug] [Thread-1 (]: On model.customer_churn.dim_address: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.dim_address"} */
create or replace transient table USER_DB_FALCON.RAW_public.dim_address
         as
        (-- models/marts/dim_address.sql


select distinct
  individual_id,
  city,
  state,
  county,
  lat,
  lon
from USER_DB_FALCON.RAW_public.int_customer_enriched
        );
[0m23:37:56.130802 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
create or replace  temporary view USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
  
   as (
    -- models/marts/fact_churn.sql


select
  t.individual_id,
  t.churn_date,
  e.city,
  e.state,
  e.county,
  e.age_in_years,
  e.days_tenure,
  e.annual_premium,
  c.churn_flag
from USER_DB_FALCON.RAW_public.stg_termination t
join USER_DB_FALCON.RAW_public.int_customer_enriched e
  using (individual_id)
left join USER_DB_FALCON.RAW_public.stg_autoinsurance_churn c
  using (individual_id)


where t.churn_date > (select max(churn_date) from USER_DB_FALCON.RAW_public.fact_churn)

  );
[0m23:37:56.132462 [debug] [Thread-2 (]: Using snowflake connection "model.customer_churn.dim_customer"
[0m23:37:56.134081 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:37:56.135652 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:37:56.137349 [debug] [Thread-2 (]: On model.customer_churn.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.dim_customer"} */
create or replace transient table USER_DB_FALCON.RAW_public.dim_customer
         as
        (-- models/marts/dim_customer.sql


select distinct
  individual_id,
  age_in_years as age,
  marital_status,
  has_children,
  length_of_residence
from USER_DB_FALCON.RAW_public.int_customer_enriched
        );
[0m23:37:56.145365 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:37:56.773527 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.638 seconds
[0m23:37:56.787820 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:37:56.789227 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
[0m23:37:56.901209 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 0.111 seconds
[0m23:37:56.908668 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:37:56.909961 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table USER_DB_FALCON.RAW_public.fact_churn
[0m23:37:57.050328 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 0.139 seconds
[0m23:37:57.065861 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:37:57.067386 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table "USER_DB_FALCON"."RAW_PUBLIC"."FACT_CHURN"
[0m23:37:57.156329 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 0.088 seconds
[0m23:37:57.206978 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.fact_churn"
[0m23:37:57.226556 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:37:57.227583 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
-- back compat for old kwarg name
  
  begin;
[0m23:37:57.338882 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.110 seconds
[0m23:37:57.340063 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:37:57.341076 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
merge into USER_DB_FALCON.RAW_public.fact_churn as DBT_INTERNAL_DEST
        using USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.individual_id = DBT_INTERNAL_DEST.individual_id
                ) and (
                    DBT_INTERNAL_SOURCE.churn_date = DBT_INTERNAL_DEST.churn_date
                )

    
    when matched then update set
        "INDIVIDUAL_ID" = DBT_INTERNAL_SOURCE."INDIVIDUAL_ID","CHURN_DATE" = DBT_INTERNAL_SOURCE."CHURN_DATE","CITY" = DBT_INTERNAL_SOURCE."CITY","STATE" = DBT_INTERNAL_SOURCE."STATE","COUNTY" = DBT_INTERNAL_SOURCE."COUNTY","AGE_IN_YEARS" = DBT_INTERNAL_SOURCE."AGE_IN_YEARS","DAYS_TENURE" = DBT_INTERNAL_SOURCE."DAYS_TENURE","ANNUAL_PREMIUM" = DBT_INTERNAL_SOURCE."ANNUAL_PREMIUM","CHURN_FLAG" = DBT_INTERNAL_SOURCE."CHURN_FLAG"
    

    when not matched then insert
        ("INDIVIDUAL_ID", "CHURN_DATE", "CITY", "STATE", "COUNTY", "AGE_IN_YEARS", "DAYS_TENURE", "ANNUAL_PREMIUM", "CHURN_FLAG")
    values
        ("INDIVIDUAL_ID", "CHURN_DATE", "CITY", "STATE", "COUNTY", "AGE_IN_YEARS", "DAYS_TENURE", "ANNUAL_PREMIUM", "CHURN_FLAG")

;
[0m23:37:58.004031 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 0.662 seconds
[0m23:37:58.006086 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:37:58.007879 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
COMMIT
[0m23:37:58.175262 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.165 seconds
[0m23:37:58.193762 [debug] [Thread-3 (]: Applying DROP to: USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
[0m23:37:58.208958 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:37:58.210440 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
drop view if exists USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp cascade
[0m23:37:58.546348 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.334 seconds
[0m23:37:58.583071 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: Close
[0m23:37:58.701866 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69fd6251-9f60-40c7-9cad-4c8436b7342e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddde892a20>]}
[0m23:37:58.703702 [info ] [Thread-3 (]: 3 of 5 OK created sql incremental model RAW_public.fact_churn .................. [[32mSUCCESS 0[0m in 2.90s]
[0m23:37:58.705451 [debug] [Thread-3 (]: Finished running node model.customer_churn.fact_churn
[0m23:37:58.707488 [debug] [Thread-4 (]: Began running node model.customer_churn.churn_metrics
[0m23:37:58.708917 [info ] [Thread-4 (]: 4 of 5 START sql table model RAW_public.churn_metrics .......................... [RUN]
[0m23:37:58.710428 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.customer_churn.churn_metrics'
[0m23:37:58.711516 [debug] [Thread-4 (]: Began compiling node model.customer_churn.churn_metrics
[0m23:37:58.718448 [debug] [Thread-4 (]: Writing injected SQL for node "model.customer_churn.churn_metrics"
[0m23:37:58.736719 [debug] [Thread-4 (]: Began executing node model.customer_churn.churn_metrics
[0m23:37:58.743720 [debug] [Thread-4 (]: Writing runtime sql for node "model.customer_churn.churn_metrics"
[0m23:37:58.762224 [debug] [Thread-4 (]: Using snowflake connection "model.customer_churn.churn_metrics"
[0m23:37:58.763538 [debug] [Thread-4 (]: On model.customer_churn.churn_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.churn_metrics"} */
create or replace transient table USER_DB_FALCON.RAW_public.churn_metrics
         as
        (select 
  cast(period as varchar) as period, 
  churn_count,
  'monthly' as category
from monthly

union all

select 
  cast(period as varchar) as period, 
  churn_count,
  'by_state' as category
from by_state

union all

select 
  cast(period as varchar) as period, 
  churn_count,
  'by_age' as category
from by_age

union all

by_tenure as (
    select
        width_bucket(days_tenure, 0, 6000, 6) as period,
        sum(churn_flag) as churn_count,
        width_bucket(days_tenure, 0, 6000, 6) as tenure_bucket_index,
        case
            when days_tenure <= 90 then '0-3 months'
            when days_tenure <= 180 then '4-6 months'
            when days_tenure <= 365 then '7-12 months'
            when days_tenure <= 730 then '13-24 months'
            else '25+ months'
        end as tenure_bucket_label
    from USER_DB_FALCON.RAW_public.fact_churn
    group by 1, 3, 4
)

union all

select 
  cast(period as varchar) as period, 
  churn_count,
  'by_premium' as category
from by_premium
        );
[0m23:37:58.764655 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:37:59.207615 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01bc27a9-0305-29ae-0004-59ff003c9026
[0m23:37:59.209106 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 27 at position 0 unexpected 'by_tenure'.
syntax error line 29 at position 46 unexpected 'as'.
[0m23:37:59.210496 [debug] [Thread-4 (]: On model.customer_churn.churn_metrics: Close
[0m23:37:59.337838 [debug] [Thread-4 (]: Database Error in model churn_metrics (models/marts/churn_metrics.sql)
  001003 (42000): SQL compilation error:
  syntax error line 27 at position 0 unexpected 'by_tenure'.
  syntax error line 29 at position 46 unexpected 'as'.
  compiled code at target/run/customer_churn/models/marts/churn_metrics.sql
[0m23:37:59.339076 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69fd6251-9f60-40c7-9cad-4c8436b7342e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdddd80dc70>]}
[0m23:37:59.340557 [error] [Thread-4 (]: 4 of 5 ERROR creating sql table model RAW_public.churn_metrics ................. [[31mERROR[0m in 0.63s]
[0m23:37:59.342273 [debug] [Thread-4 (]: Finished running node model.customer_churn.churn_metrics
[0m23:38:00.270377 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 4.125 seconds
[0m23:38:00.282709 [debug] [Thread-2 (]: On model.customer_churn.dim_customer: Close
[0m23:38:00.588367 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.454 seconds
[0m23:38:00.595146 [debug] [Thread-1 (]: On model.customer_churn.dim_address: Close
[0m23:38:00.723058 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69fd6251-9f60-40c7-9cad-4c8436b7342e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdddd8b5820>]}
[0m23:38:00.725436 [info ] [Thread-1 (]: 1 of 5 OK created sql table model RAW_public.dim_address ....................... [[32mSUCCESS 1[0m in 4.93s]
[0m23:38:00.727450 [debug] [Thread-1 (]: Finished running node model.customer_churn.dim_address
[0m23:38:00.730567 [debug] [Thread-3 (]: Began running node model.customer_churn.churn_map
[0m23:38:00.732994 [info ] [Thread-3 (]: 5 of 5 START sql table model RAW_public.churn_map .............................. [RUN]
[0m23:38:00.734764 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer_churn.fact_churn, now model.customer_churn.churn_map)
[0m23:38:00.736134 [debug] [Thread-3 (]: Began compiling node model.customer_churn.churn_map
[0m23:38:00.745578 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.churn_map"
[0m23:38:00.765361 [debug] [Thread-3 (]: Began executing node model.customer_churn.churn_map
[0m23:38:00.772164 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.churn_map"
[0m23:38:00.776478 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69fd6251-9f60-40c7-9cad-4c8436b7342e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdddd8e8b60>]}
[0m23:38:00.778506 [info ] [Thread-2 (]: 2 of 5 OK created sql table model RAW_public.dim_customer ...................... [[32mSUCCESS 1[0m in 4.98s]
[0m23:38:00.780413 [debug] [Thread-2 (]: Finished running node model.customer_churn.dim_customer
[0m23:38:00.793487 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.churn_map"
[0m23:38:00.795016 [debug] [Thread-3 (]: On model.customer_churn.churn_map: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.churn_map"} */
create or replace transient table USER_DB_FALCON.RAW_public.churn_map
         as
        (-- models/marts/churn_map.sql


select
  f.individual_id,
  f.churn_date,
  f.churn_flag,
  a.lon,
  a.lat
from USER_DB_FALCON.RAW_public.fact_churn      as f
join USER_DB_FALCON.RAW_public.dim_address    as a
  using (individual_id)
        );
[0m23:38:00.796603 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:38:02.510115 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.714 seconds
[0m23:38:02.514906 [debug] [Thread-3 (]: On model.customer_churn.churn_map: Close
[0m23:38:02.661977 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69fd6251-9f60-40c7-9cad-4c8436b7342e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddde710740>]}
[0m23:38:02.664221 [info ] [Thread-3 (]: 5 of 5 OK created sql table model RAW_public.churn_map ......................... [[32mSUCCESS 1[0m in 1.93s]
[0m23:38:02.666227 [debug] [Thread-3 (]: Finished running node model.customer_churn.churn_map
[0m23:38:02.671093 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:38:02.672293 [debug] [MainThread]: Connection 'model.customer_churn.dim_address' was properly closed.
[0m23:38:02.673516 [debug] [MainThread]: Connection 'model.customer_churn.dim_customer' was properly closed.
[0m23:38:02.674720 [debug] [MainThread]: Connection 'model.customer_churn.churn_map' was properly closed.
[0m23:38:02.675722 [debug] [MainThread]: Connection 'model.customer_churn.churn_metrics' was properly closed.
[0m23:38:02.677486 [info ] [MainThread]: 
[0m23:38:02.679402 [info ] [MainThread]: Finished running 1 incremental model, 4 table models in 0 hours 0 minutes and 8.91 seconds (8.91s).
[0m23:38:02.682317 [debug] [MainThread]: Command end result
[0m23:38:02.815891 [info ] [MainThread]: 
[0m23:38:02.817307 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:38:02.818375 [info ] [MainThread]: 
[0m23:38:02.819829 [error] [MainThread]:   Database Error in model churn_metrics (models/marts/churn_metrics.sql)
  001003 (42000): SQL compilation error:
  syntax error line 27 at position 0 unexpected 'by_tenure'.
  syntax error line 29 at position 46 unexpected 'as'.
  compiled code at target/run/customer_churn/models/marts/churn_metrics.sql
[0m23:38:02.820999 [info ] [MainThread]: 
[0m23:38:02.822991 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m23:38:02.824856 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 14.481989, "process_user_time": 9.550826, "process_kernel_time": 3.629767, "process_mem_max_rss": "284968", "process_in_blocks": "166904", "process_out_blocks": "8", "command_success": false}
[0m23:38:02.826298 [debug] [MainThread]: Command `dbt run` failed at 23:38:02.826040 after 14.48 seconds
[0m23:38:02.827454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde3c5139b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdddfc5d5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdddfd24b90>]}
[0m23:38:02.828594 [debug] [MainThread]: Flushing usage events
[0m23:39:39.955380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde314c4860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde314c4a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde314c4620>]}
[0m23:39:39.955828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc765bd7710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7653ad670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc76679c0e0>]}


============================== 23:39:39.964556 | daf12feb-e32b-437b-a85e-d8ac9cacdd98 ==============================
[0m23:39:39.964556 [info ] [MainThread]: Running with dbt=1.8.7


============================== 23:39:39.964631 | 3e710cfe-fa83-425f-96c9-44a21f219876 ==============================
[0m23:39:39.964631 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:39:39.966696 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:39:39.966819 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m23:39:40.097790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e710cfe-fa83-425f-96c9-44a21f219876', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc765bf6930>]}
[0m23:39:40.098396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'daf12feb-e32b-437b-a85e-d8ac9cacdd98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde327d8c80>]}
[0m23:39:40.132418 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:39:40.133643 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:39:40.147734 [error] [MainThread]: Encountered an error:
[Errno 2] No such file or directory: 'dbt_packages'
[0m23:39:40.151488 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:39:40.152888 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.36711887, "process_user_time": 2.443386, "process_kernel_time": 0.17751, "process_mem_max_rss": "165556", "process_in_blocks": "56", "process_out_blocks": "0"}
[0m23:39:40.152757 [error] [MainThread]: Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 201, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/main.py", line 447, in deps
    results = task.run()
              ^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/task/deps.py", line 233, in run
    system.rmtree(self.project.packages_install_path)
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt_common/clients/system.py", line 715, in rmtree
    return shutil.rmtree(path, onerror=chmod_and_retry)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/shutil.py", line 759, in rmtree
    _rmtree_safe_fd(stack, onexc)
  File "/usr/local/lib/python3.12/shutil.py", line 703, in _rmtree_safe_fd
    onexc(func, path, err)
  File "/usr/local/lib/python3.12/shutil.py", line 750, in onexc
    return onerror(func, path, exc_info)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/shutil.py", line 662, in _rmtree_safe_fd
    os.rmdir(name, dir_fd=dirfd)
FileNotFoundError: [Errno 2] No such file or directory: 'dbt_packages'

[0m23:39:40.154650 [debug] [MainThread]: Command `dbt deps` succeeded at 23:39:40.154342 after 0.37 seconds
[0m23:39:40.155072 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_wall_clock_time": 0.3692632, "process_user_time": 2.440352, "process_kernel_time": 0.198998, "process_mem_max_rss": "165552", "process_in_blocks": "192", "command_success": false, "process_out_blocks": "0"}
[0m23:39:40.156427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde31657dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde319cdeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde319cd700>]}
[0m23:39:40.156888 [debug] [MainThread]: Command `dbt deps` failed at 23:39:40.156595 after 0.37 seconds
[0m23:39:40.157661 [debug] [MainThread]: Flushing usage events
[0m23:39:40.158256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc764cac2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc764990380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc76554e7b0>]}
[0m23:39:40.160165 [debug] [MainThread]: Flushing usage events
[0m23:39:44.221577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c45316540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c45551a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c4599d490>]}


============================== 23:39:44.228406 | 1524d9aa-66af-409d-bcc2-96f91eff798d ==============================
[0m23:39:44.228406 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:39:44.229453 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt --select staging', 'send_anonymous_usage_stats': 'True'}
[0m23:39:45.427240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1524d9aa-66af-409d-bcc2-96f91eff798d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c46225160>]}
[0m23:39:45.496611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1524d9aa-66af-409d-bcc2-96f91eff798d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8beed259d0>]}
[0m23:39:45.498208 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m23:39:45.639752 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:39:46.721456 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:39:46.723070 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:39:46.759712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1524d9aa-66af-409d-bcc2-96f91eff798d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8beeccd8e0>]}
[0m23:39:46.944694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1524d9aa-66af-409d-bcc2-96f91eff798d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8be7154bf0>]}
[0m23:39:46.946021 [info ] [MainThread]: Found 12 models, 10 data tests, 7 sources, 459 macros
[0m23:39:46.947053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1524d9aa-66af-409d-bcc2-96f91eff798d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8be7189880>]}
[0m23:39:46.950572 [info ] [MainThread]: 
[0m23:39:46.951964 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:39:46.960058 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON'
[0m23:39:46.987750 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON"
[0m23:39:46.989098 [debug] [ThreadPool]: On list_USER_DB_FALCON: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON"} */
show terse schemas in database USER_DB_FALCON
    limit 10000
[0m23:39:46.990324 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:39:47.603810 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.613 seconds
[0m23:39:47.607338 [debug] [ThreadPool]: On list_USER_DB_FALCON: Close
[0m23:39:47.749457 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON, now list_USER_DB_FALCON_RAW_public)
[0m23:39:47.759848 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m23:39:47.760943 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show terse objects in USER_DB_FALCON.RAW_public limit 10000
[0m23:39:47.761673 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:39:48.122193 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.360 seconds
[0m23:39:48.128135 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m23:39:48.300934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1524d9aa-66af-409d-bcc2-96f91eff798d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c4694bf20>]}
[0m23:39:48.302356 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:39:48.303581 [info ] [MainThread]: 
[0m23:39:48.318700 [debug] [Thread-1 (]: Began running node model.customer_churn.stg_address
[0m23:39:48.319955 [debug] [Thread-2 (]: Began running node model.customer_churn.stg_autoinsurance_churn
[0m23:39:48.320422 [debug] [Thread-3 (]: Began running node model.customer_churn.stg_customer
[0m23:39:48.321009 [info ] [Thread-1 (]: 1 of 6 START sql view model RAW_public.stg_address ............................. [RUN]
[0m23:39:48.321900 [debug] [Thread-4 (]: Began running node model.customer_churn.stg_demographic
[0m23:39:48.323865 [info ] [Thread-2 (]: 2 of 6 START sql view model RAW_public.stg_autoinsurance_churn ................. [RUN]
[0m23:39:48.325520 [info ] [Thread-3 (]: 3 of 6 START sql view model RAW_public.stg_customer ............................ [RUN]
[0m23:39:48.327083 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON_RAW_public, now model.customer_churn.stg_address)
[0m23:39:48.328188 [info ] [Thread-4 (]: 4 of 6 START sql view model RAW_public.stg_demographic ......................... [RUN]
[0m23:39:48.329502 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.customer_churn.stg_autoinsurance_churn'
[0m23:39:48.330630 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.customer_churn.stg_customer'
[0m23:39:48.331564 [debug] [Thread-1 (]: Began compiling node model.customer_churn.stg_address
[0m23:39:48.332602 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.customer_churn.stg_demographic'
[0m23:39:48.333519 [debug] [Thread-2 (]: Began compiling node model.customer_churn.stg_autoinsurance_churn
[0m23:39:48.334349 [debug] [Thread-3 (]: Began compiling node model.customer_churn.stg_customer
[0m23:39:48.343952 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.stg_address"
[0m23:39:48.345094 [debug] [Thread-4 (]: Began compiling node model.customer_churn.stg_demographic
[0m23:39:48.349569 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer_churn.stg_autoinsurance_churn"
[0m23:39:48.354564 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.stg_customer"
[0m23:39:48.361200 [debug] [Thread-4 (]: Writing injected SQL for node "model.customer_churn.stg_demographic"
[0m23:39:48.370222 [debug] [Thread-1 (]: Began executing node model.customer_churn.stg_address
[0m23:39:48.371133 [debug] [Thread-2 (]: Began executing node model.customer_churn.stg_autoinsurance_churn
[0m23:39:48.387745 [debug] [Thread-3 (]: Began executing node model.customer_churn.stg_customer
[0m23:39:48.388344 [debug] [Thread-4 (]: Began executing node model.customer_churn.stg_demographic
[0m23:39:48.441147 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer_churn.stg_autoinsurance_churn"
[0m23:39:48.444552 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.stg_customer"
[0m23:39:48.440431 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.stg_address"
[0m23:39:48.448902 [debug] [Thread-4 (]: Writing runtime sql for node "model.customer_churn.stg_demographic"
[0m23:39:48.465865 [debug] [Thread-4 (]: Using snowflake connection "model.customer_churn.stg_demographic"
[0m23:39:48.467064 [debug] [Thread-4 (]: On model.customer_churn.stg_demographic: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_demographic"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_demographic
  
   as (
    

select
  individual_id,
  income,
  has_children,
  length_of_residence    as length_of_residence,  -- exact match
  marital_status,
  home_owner,
  home_market_value      as home_market_value,
  college_degree,
  good_credit
from USER_DB_FALCON.RAW.DEMOGRAPHIC_STAGING
  );
[0m23:39:48.467946 [debug] [Thread-2 (]: Using snowflake connection "model.customer_churn.stg_autoinsurance_churn"
[0m23:39:48.468561 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:39:48.469453 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.stg_customer"
[0m23:39:48.470051 [debug] [Thread-2 (]: On model.customer_churn.stg_autoinsurance_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_autoinsurance_churn"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_autoinsurance_churn
  
   as (
    

select
  individual_id,
  churn              as churn_flag
from USER_DB_FALCON.RAW.AUTOINSURANCE_CHURN_STAGING
  );
[0m23:39:48.472546 [debug] [Thread-3 (]: On model.customer_churn.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_customer"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_customer
  
   as (
    

select
  individual_id,
  address_id,
  curr_ann_amt    as annual_premium,
  days_tenure,
  cust_orig_date,
  age_in_years,            -- bring this in
  date_of_birth            -- and this
from USER_DB_FALCON.RAW.CUSTOMER_STAGING
where individual_id is not null
  );
[0m23:39:48.474602 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.stg_address"
[0m23:39:48.477058 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:39:48.477726 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:39:48.479864 [debug] [Thread-1 (]: On model.customer_churn.stg_address: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_address"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_address
  
   as (
    -- models/staging/stg_address.sql

select
  address_id,
  street_address,
  city,
  state,
  county,
  latitude::float as lat,
  longitude::float as lon
from USER_DB_FALCON.RAW.ADDRESS_STAGING
  );
[0m23:39:48.485448 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:39:48.978698 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.501 seconds
[0m23:39:49.003148 [debug] [Thread-2 (]: On model.customer_churn.stg_autoinsurance_churn: Close
[0m23:39:49.128974 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.644 seconds
[0m23:39:49.132541 [debug] [Thread-1 (]: On model.customer_churn.stg_address: Close
[0m23:39:49.153406 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1524d9aa-66af-409d-bcc2-96f91eff798d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8be76fb6b0>]}
[0m23:39:49.154450 [info ] [Thread-2 (]: 2 of 6 OK created sql view model RAW_public.stg_autoinsurance_churn ............ [[32mSUCCESS 1[0m in 0.82s]
[0m23:39:49.155377 [debug] [Thread-2 (]: Finished running node model.customer_churn.stg_autoinsurance_churn
[0m23:39:49.156234 [debug] [Thread-2 (]: Began running node model.customer_churn.stg_termination
[0m23:39:49.157031 [info ] [Thread-2 (]: 5 of 6 START sql view model RAW_public.stg_termination ......................... [RUN]
[0m23:39:49.158368 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer_churn.stg_autoinsurance_churn, now model.customer_churn.stg_termination)
[0m23:39:49.159825 [debug] [Thread-2 (]: Began compiling node model.customer_churn.stg_termination
[0m23:39:49.166564 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer_churn.stg_termination"
[0m23:39:49.196749 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.728 seconds
[0m23:39:49.199565 [debug] [Thread-4 (]: On model.customer_churn.stg_demographic: Close
[0m23:39:49.203442 [debug] [Thread-2 (]: Began executing node model.customer_churn.stg_termination
[0m23:39:49.206643 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer_churn.stg_termination"
[0m23:39:49.219881 [debug] [Thread-2 (]: Using snowflake connection "model.customer_churn.stg_termination"
[0m23:39:49.220647 [debug] [Thread-2 (]: On model.customer_churn.stg_termination: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_termination"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_termination
  
   as (
    

select
  individual_id,
  acct_suspd_date    as churn_date
from USER_DB_FALCON.RAW.TERMINATION_STAGING
  );
[0m23:39:49.221298 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:39:49.265682 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1524d9aa-66af-409d-bcc2-96f91eff798d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8be6607bc0>]}
[0m23:39:49.267170 [info ] [Thread-1 (]: 1 of 6 OK created sql view model RAW_public.stg_address ........................ [[32mSUCCESS 1[0m in 0.94s]
[0m23:39:49.269972 [debug] [Thread-1 (]: Finished running node model.customer_churn.stg_address
[0m23:39:49.271983 [debug] [Thread-1 (]: Began running node model.customer_churn.stg_turning_movement
[0m23:39:49.274291 [info ] [Thread-1 (]: 6 of 6 START sql view model RAW_public.stg_turning_movement .................... [RUN]
[0m23:39:49.276266 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer_churn.stg_address, now model.customer_churn.stg_turning_movement)
[0m23:39:49.278314 [debug] [Thread-1 (]: Began compiling node model.customer_churn.stg_turning_movement
[0m23:39:49.287216 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.stg_turning_movement"
[0m23:39:49.344138 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.866 seconds
[0m23:39:49.354512 [debug] [Thread-3 (]: On model.customer_churn.stg_customer: Close
[0m23:39:49.365638 [debug] [Thread-1 (]: Began executing node model.customer_churn.stg_turning_movement
[0m23:39:49.373583 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.stg_turning_movement"
[0m23:39:49.399255 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.stg_turning_movement"
[0m23:39:49.400905 [debug] [Thread-1 (]: On model.customer_churn.stg_turning_movement: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_turning_movement"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_turning_movement
  
   as (
    -- models/staging/stg_turning_movement.sql

select
  objectid,
  facilityid,
  intid,
  intname,
  nodeno,
  longitude::float as tm_lon,
  latitude::float  as tm_lat
from USER_DB_FALCON.RAW.TURNING_MOVEMENT
  );
[0m23:39:49.402454 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:39:49.493170 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1524d9aa-66af-409d-bcc2-96f91eff798d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8be6669070>]}
[0m23:39:49.495685 [info ] [Thread-3 (]: 3 of 6 OK created sql view model RAW_public.stg_customer ....................... [[32mSUCCESS 1[0m in 1.16s]
[0m23:39:49.498242 [debug] [Thread-3 (]: Finished running node model.customer_churn.stg_customer
[0m23:39:49.843555 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.622 seconds
[0m23:39:49.846884 [debug] [Thread-2 (]: On model.customer_churn.stg_termination: Close
[0m23:39:50.005988 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.604 seconds
[0m23:39:50.010087 [debug] [Thread-1 (]: On model.customer_churn.stg_turning_movement: Close
[0m23:39:50.103906 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1524d9aa-66af-409d-bcc2-96f91eff798d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8be70df890>]}
[0m23:39:50.105419 [info ] [Thread-2 (]: 5 of 6 OK created sql view model RAW_public.stg_termination .................... [[32mSUCCESS 1[0m in 0.95s]
[0m23:39:50.107066 [debug] [Thread-2 (]: Finished running node model.customer_churn.stg_termination
[0m23:39:50.132786 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1524d9aa-66af-409d-bcc2-96f91eff798d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8be7514da0>]}
[0m23:39:50.134102 [info ] [Thread-1 (]: 6 of 6 OK created sql view model RAW_public.stg_turning_movement ............... [[32mSUCCESS 1[0m in 0.86s]
[0m23:39:50.135323 [debug] [Thread-1 (]: Finished running node model.customer_churn.stg_turning_movement
[0m23:39:50.169583 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1524d9aa-66af-409d-bcc2-96f91eff798d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8be6677770>]}
[0m23:39:50.170874 [info ] [Thread-4 (]: 4 of 6 OK created sql view model RAW_public.stg_demographic .................... [[32mSUCCESS 1[0m in 1.84s]
[0m23:39:50.171921 [debug] [Thread-4 (]: Finished running node model.customer_churn.stg_demographic
[0m23:39:50.174279 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:39:50.174946 [debug] [MainThread]: Connection 'model.customer_churn.stg_turning_movement' was properly closed.
[0m23:39:50.175646 [debug] [MainThread]: Connection 'model.customer_churn.stg_termination' was properly closed.
[0m23:39:50.176351 [debug] [MainThread]: Connection 'model.customer_churn.stg_customer' was properly closed.
[0m23:39:50.176912 [debug] [MainThread]: Connection 'model.customer_churn.stg_demographic' was properly closed.
[0m23:39:50.177820 [info ] [MainThread]: 
[0m23:39:50.178751 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 3.23 seconds (3.23s).
[0m23:39:50.180632 [debug] [MainThread]: Command end result
[0m23:39:50.274053 [info ] [MainThread]: 
[0m23:39:50.274930 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:39:50.275689 [info ] [MainThread]: 
[0m23:39:50.276405 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m23:39:50.278067 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.1450844, "process_user_time": 5.500271, "process_kernel_time": 2.885558, "process_mem_max_rss": "275340", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m23:39:50.279274 [debug] [MainThread]: Command `dbt run` succeeded at 23:39:50.279119 after 6.15 seconds
[0m23:39:50.280450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c45b45100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c44f49400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8be6741ee0>]}
[0m23:39:50.281498 [debug] [MainThread]: Flushing usage events
[0m23:39:55.322379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90f3eb0770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90f4c3c410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90f4fddf70>]}


============================== 23:39:55.332012 | 5574c4be-055c-4092-b7ec-1b43a5b55929 ==============================
[0m23:39:55.332012 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:39:55.333548 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt --select intermediate', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:39:56.518421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5574c4be-055c-4092-b7ec-1b43a5b55929', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90964eaab0>]}
[0m23:39:56.588348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5574c4be-055c-4092-b7ec-1b43a5b55929', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90f4692e70>]}
[0m23:39:56.589940 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m23:39:56.707975 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:39:57.700725 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:39:57.701967 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:39:57.774070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5574c4be-055c-4092-b7ec-1b43a5b55929', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90963751f0>]}
[0m23:39:57.997630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5574c4be-055c-4092-b7ec-1b43a5b55929', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90960f1820>]}
[0m23:39:57.999625 [info ] [MainThread]: Found 12 models, 10 data tests, 7 sources, 459 macros
[0m23:39:58.001423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5574c4be-055c-4092-b7ec-1b43a5b55929', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f909cbe7c20>]}
[0m23:39:58.005064 [info ] [MainThread]: 
[0m23:39:58.006611 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:39:58.009008 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON'
[0m23:39:58.026666 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON"
[0m23:39:58.028068 [debug] [ThreadPool]: On list_USER_DB_FALCON: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON"} */
show terse schemas in database USER_DB_FALCON
    limit 10000
[0m23:39:58.029389 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:39:58.978051 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.948 seconds
[0m23:39:58.983024 [debug] [ThreadPool]: On list_USER_DB_FALCON: Close
[0m23:39:59.142520 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON, now list_USER_DB_FALCON_RAW_public)
[0m23:39:59.157985 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m23:39:59.159664 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show terse objects in USER_DB_FALCON.RAW_public limit 10000
[0m23:39:59.161045 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:39:59.805769 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.645 seconds
[0m23:39:59.810198 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m23:39:59.951256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5574c4be-055c-4092-b7ec-1b43a5b55929', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f909666f440>]}
[0m23:39:59.953797 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:39:59.955637 [info ] [MainThread]: 
[0m23:39:59.975269 [debug] [Thread-1 (]: Began running node model.customer_churn.int_customer_enriched
[0m23:39:59.976558 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW_public.int_customer_enriched ................... [RUN]
[0m23:39:59.978282 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON_RAW_public, now model.customer_churn.int_customer_enriched)
[0m23:39:59.980149 [debug] [Thread-1 (]: Began compiling node model.customer_churn.int_customer_enriched
[0m23:39:59.988887 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.int_customer_enriched"
[0m23:40:00.004312 [debug] [Thread-1 (]: Began executing node model.customer_churn.int_customer_enriched
[0m23:40:00.029400 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.int_customer_enriched"
[0m23:40:00.043700 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.int_customer_enriched"
[0m23:40:00.044537 [debug] [Thread-1 (]: On model.customer_churn.int_customer_enriched: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.int_customer_enriched"} */
create or replace   view USER_DB_FALCON.RAW_public.int_customer_enriched
  
   as (
    

with cust as (
    select
        individual_id,
        annual_premium,
        days_tenure,
        cust_orig_date,
        age_in_years,
        date_of_birth,
        address_id
    from USER_DB_FALCON.RAW_public.stg_customer
),

demo as (
    select
        individual_id,
        has_children,
        length_of_residence,
        marital_status,
        home_owner,
        home_market_value,
        college_degree,
        good_credit
    from USER_DB_FALCON.RAW_public.stg_demographic
),

addr as (
    select
        address_id,
        city,
        state,
        county,
        lat,
        lon
    from USER_DB_FALCON.RAW_public.stg_address
)

select
    cust.individual_id,
    cust.annual_premium,
    cust.days_tenure,
    cust.cust_orig_date,
    cust.age_in_years,
    cust.date_of_birth,
    demo.has_children,
    demo.length_of_residence,
    demo.marital_status,
    demo.home_owner,
    demo.home_market_value,
    addr.city,
    addr.state,
    addr.county,
    addr.lat,
    addr.lon
from cust
left join demo using (individual_id)
left join addr using (address_id)
  );
[0m23:40:00.045506 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:40:00.827468 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.782 seconds
[0m23:40:00.867252 [debug] [Thread-1 (]: On model.customer_churn.int_customer_enriched: Close
[0m23:40:00.993119 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5574c4be-055c-4092-b7ec-1b43a5b55929', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f909666efc0>]}
[0m23:40:00.999527 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW_public.int_customer_enriched .............. [[32mSUCCESS 1[0m in 1.01s]
[0m23:40:01.003075 [debug] [Thread-1 (]: Finished running node model.customer_churn.int_customer_enriched
[0m23:40:01.008876 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:40:01.010247 [debug] [MainThread]: Connection 'model.customer_churn.int_customer_enriched' was properly closed.
[0m23:40:01.012156 [info ] [MainThread]: 
[0m23:40:01.013371 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.01 seconds (3.01s).
[0m23:40:01.014568 [debug] [MainThread]: Command end result
[0m23:40:01.203474 [info ] [MainThread]: 
[0m23:40:01.205732 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:40:01.207862 [info ] [MainThread]: 
[0m23:40:01.212046 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:40:01.214323 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.006152, "process_user_time": 5.006602, "process_kernel_time": 3.004647, "process_mem_max_rss": "281728", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m23:40:01.215470 [debug] [MainThread]: Command `dbt run` succeeded at 23:40:01.215374 after 6.01 seconds
[0m23:40:01.216481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90f46beb40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90f4512ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90f45121b0>]}
[0m23:40:01.217643 [debug] [MainThread]: Flushing usage events
[0m23:40:05.562120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe234218c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe234219160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe234218b00>]}


============================== 23:40:05.568629 | 086f4598-4763-4902-8084-0c4b59b9f45b ==============================
[0m23:40:05.568629 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:40:05.569470 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt --select marts', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:40:06.684708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '086f4598-4763-4902-8084-0c4b59b9f45b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe23421bad0>]}
[0m23:40:06.751027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '086f4598-4763-4902-8084-0c4b59b9f45b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1d684b410>]}
[0m23:40:06.752617 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m23:40:06.863882 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:40:07.525684 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:40:07.526660 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:40:07.579131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '086f4598-4763-4902-8084-0c4b59b9f45b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1d6f41970>]}
[0m23:40:07.791609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '086f4598-4763-4902-8084-0c4b59b9f45b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1d641cda0>]}
[0m23:40:07.792842 [info ] [MainThread]: Found 12 models, 10 data tests, 7 sources, 459 macros
[0m23:40:07.793593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '086f4598-4763-4902-8084-0c4b59b9f45b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1d6431400>]}
[0m23:40:07.795842 [info ] [MainThread]: 
[0m23:40:07.796894 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:40:07.802495 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON'
[0m23:40:07.820559 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON"
[0m23:40:07.822277 [debug] [ThreadPool]: On list_USER_DB_FALCON: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON"} */
show terse schemas in database USER_DB_FALCON
    limit 10000
[0m23:40:07.824327 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:40:08.382435 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.558 seconds
[0m23:40:08.384888 [debug] [ThreadPool]: On list_USER_DB_FALCON: Close
[0m23:40:08.512952 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON, now list_USER_DB_FALCON_RAW_public)
[0m23:40:08.524842 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m23:40:08.525634 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show terse objects in USER_DB_FALCON.RAW_public limit 10000
[0m23:40:08.527369 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:40:08.904058 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.376 seconds
[0m23:40:08.910853 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m23:40:09.043019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '086f4598-4763-4902-8084-0c4b59b9f45b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1d6a0eed0>]}
[0m23:40:09.044763 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:40:09.045624 [info ] [MainThread]: 
[0m23:40:09.056402 [debug] [Thread-1 (]: Began running node model.customer_churn.dim_address
[0m23:40:09.057287 [debug] [Thread-2 (]: Began running node model.customer_churn.dim_customer
[0m23:40:09.057797 [debug] [Thread-3 (]: Began running node model.customer_churn.fact_churn
[0m23:40:09.058454 [info ] [Thread-1 (]: 1 of 5 START sql table model RAW_public.dim_address ............................ [RUN]
[0m23:40:09.059925 [info ] [Thread-2 (]: 2 of 5 START sql table model RAW_public.dim_customer ........................... [RUN]
[0m23:40:09.061081 [info ] [Thread-3 (]: 3 of 5 START sql incremental model RAW_public.fact_churn ....................... [RUN]
[0m23:40:09.062277 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON_RAW_public, now model.customer_churn.dim_address)
[0m23:40:09.063982 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.customer_churn.dim_customer'
[0m23:40:09.065263 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.customer_churn.fact_churn'
[0m23:40:09.066230 [debug] [Thread-1 (]: Began compiling node model.customer_churn.dim_address
[0m23:40:09.067187 [debug] [Thread-2 (]: Began compiling node model.customer_churn.dim_customer
[0m23:40:09.068162 [debug] [Thread-3 (]: Began compiling node model.customer_churn.fact_churn
[0m23:40:09.077472 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.dim_address"
[0m23:40:09.081210 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer_churn.dim_customer"
[0m23:40:09.091352 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.fact_churn"
[0m23:40:09.108993 [debug] [Thread-3 (]: Began executing node model.customer_churn.fact_churn
[0m23:40:09.121393 [debug] [Thread-2 (]: Began executing node model.customer_churn.dim_customer
[0m23:40:09.140033 [debug] [Thread-1 (]: Began executing node model.customer_churn.dim_address
[0m23:40:09.201284 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:40:09.205547 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer_churn.dim_customer"
[0m23:40:09.212171 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
create or replace  temporary view USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
  
   as (
    -- models/marts/fact_churn.sql


select
  t.individual_id,
  t.churn_date,
  e.city,
  e.state,
  e.county,
  e.age_in_years,
  e.days_tenure,
  e.annual_premium,
  c.churn_flag
from USER_DB_FALCON.RAW_public.stg_termination t
join USER_DB_FALCON.RAW_public.int_customer_enriched e
  using (individual_id)
left join USER_DB_FALCON.RAW_public.stg_autoinsurance_churn c
  using (individual_id)


where t.churn_date > (select max(churn_date) from USER_DB_FALCON.RAW_public.fact_churn)

  );
[0m23:40:09.215013 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.dim_address"
[0m23:40:09.217179 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:40:09.230643 [debug] [Thread-2 (]: Using snowflake connection "model.customer_churn.dim_customer"
[0m23:40:09.231672 [debug] [Thread-2 (]: On model.customer_churn.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.dim_customer"} */
create or replace transient table USER_DB_FALCON.RAW_public.dim_customer
         as
        (-- models/marts/dim_customer.sql


select distinct
  individual_id,
  age_in_years as age,
  marital_status,
  has_children,
  length_of_residence
from USER_DB_FALCON.RAW_public.int_customer_enriched
        );
[0m23:40:09.232851 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.dim_address"
[0m23:40:09.233348 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:40:09.234272 [debug] [Thread-1 (]: On model.customer_churn.dim_address: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.dim_address"} */
create or replace transient table USER_DB_FALCON.RAW_public.dim_address
         as
        (-- models/marts/dim_address.sql


select distinct
  individual_id,
  city,
  state,
  county,
  lat,
  lon
from USER_DB_FALCON.RAW_public.int_customer_enriched
        );
[0m23:40:09.236064 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:40:10.144369 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.927 seconds
[0m23:40:10.157345 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:40:10.158622 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
[0m23:40:10.248836 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 0.089 seconds
[0m23:40:10.256290 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:40:10.258339 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table USER_DB_FALCON.RAW_public.fact_churn
[0m23:40:10.414398 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 0.155 seconds
[0m23:40:10.429336 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:40:10.430313 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table "USER_DB_FALCON"."RAW_PUBLIC"."FACT_CHURN"
[0m23:40:10.596700 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 0.165 seconds
[0m23:40:10.636603 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.fact_churn"
[0m23:40:10.654311 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:40:10.655384 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
-- back compat for old kwarg name
  
  begin;
[0m23:40:10.875954 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.220 seconds
[0m23:40:10.877065 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:40:10.877906 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
merge into USER_DB_FALCON.RAW_public.fact_churn as DBT_INTERNAL_DEST
        using USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.individual_id = DBT_INTERNAL_DEST.individual_id
                ) and (
                    DBT_INTERNAL_SOURCE.churn_date = DBT_INTERNAL_DEST.churn_date
                )

    
    when matched then update set
        "INDIVIDUAL_ID" = DBT_INTERNAL_SOURCE."INDIVIDUAL_ID","CHURN_DATE" = DBT_INTERNAL_SOURCE."CHURN_DATE","CITY" = DBT_INTERNAL_SOURCE."CITY","STATE" = DBT_INTERNAL_SOURCE."STATE","COUNTY" = DBT_INTERNAL_SOURCE."COUNTY","AGE_IN_YEARS" = DBT_INTERNAL_SOURCE."AGE_IN_YEARS","DAYS_TENURE" = DBT_INTERNAL_SOURCE."DAYS_TENURE","ANNUAL_PREMIUM" = DBT_INTERNAL_SOURCE."ANNUAL_PREMIUM","CHURN_FLAG" = DBT_INTERNAL_SOURCE."CHURN_FLAG"
    

    when not matched then insert
        ("INDIVIDUAL_ID", "CHURN_DATE", "CITY", "STATE", "COUNTY", "AGE_IN_YEARS", "DAYS_TENURE", "ANNUAL_PREMIUM", "CHURN_FLAG")
    values
        ("INDIVIDUAL_ID", "CHURN_DATE", "CITY", "STATE", "COUNTY", "AGE_IN_YEARS", "DAYS_TENURE", "ANNUAL_PREMIUM", "CHURN_FLAG")

;
[0m23:40:12.036355 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 1.158 seconds
[0m23:40:12.038047 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:40:12.040147 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
COMMIT
[0m23:40:12.195115 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.152 seconds
[0m23:40:12.214421 [debug] [Thread-3 (]: Applying DROP to: USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
[0m23:40:12.223877 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:40:12.224784 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
drop view if exists USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp cascade
[0m23:40:12.383380 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.143 seconds
[0m23:40:12.413562 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: Close
[0m23:40:12.535335 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '086f4598-4763-4902-8084-0c4b59b9f45b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe234e15b50>]}
[0m23:40:12.536573 [info ] [Thread-3 (]: 3 of 5 OK created sql incremental model RAW_public.fact_churn .................. [[32mSUCCESS 0[0m in 3.47s]
[0m23:40:12.537501 [debug] [Thread-3 (]: Finished running node model.customer_churn.fact_churn
[0m23:40:12.544474 [debug] [Thread-4 (]: Began running node model.customer_churn.churn_metrics
[0m23:40:12.546151 [info ] [Thread-4 (]: 4 of 5 START sql table model RAW_public.churn_metrics .......................... [RUN]
[0m23:40:12.548535 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.customer_churn.churn_metrics'
[0m23:40:12.550277 [debug] [Thread-4 (]: Began compiling node model.customer_churn.churn_metrics
[0m23:40:12.556042 [debug] [Thread-4 (]: Writing injected SQL for node "model.customer_churn.churn_metrics"
[0m23:40:12.588774 [debug] [Thread-4 (]: Began executing node model.customer_churn.churn_metrics
[0m23:40:12.593948 [debug] [Thread-4 (]: Writing runtime sql for node "model.customer_churn.churn_metrics"
[0m23:40:12.626613 [debug] [Thread-4 (]: Using snowflake connection "model.customer_churn.churn_metrics"
[0m23:40:12.627538 [debug] [Thread-4 (]: On model.customer_churn.churn_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.churn_metrics"} */
create or replace transient table USER_DB_FALCON.RAW_public.churn_metrics
         as
        (select 
  cast(period as varchar) as period, 
  churn_count,
  'monthly' as category
from monthly

union all

select 
  cast(period as varchar) as period, 
  churn_count,
  'by_state' as category
from by_state

union all

select 
  cast(period as varchar) as period, 
  churn_count,
  'by_age' as category
from by_age

union all

by_tenure as (
    select
        width_bucket(days_tenure, 0, 6000, 6) as period,
        sum(churn_flag) as churn_count,
        width_bucket(days_tenure, 0, 6000, 6) as tenure_bucket_index,
        case
            when days_tenure <= 90 then '0-3 months'
            when days_tenure <= 180 then '4-6 months'
            when days_tenure <= 365 then '7-12 months'
            when days_tenure <= 730 then '13-24 months'
            else '25+ months'
        end as tenure_bucket_label
    from USER_DB_FALCON.RAW_public.fact_churn
    group by 1, 3, 4
)

union all

select 
  cast(period as varchar) as period, 
  churn_count,
  'by_premium' as category
from by_premium
        );
[0m23:40:12.628186 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:40:13.106897 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01bc27ac-0305-24f3-0004-59ff003c5382
[0m23:40:13.108084 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 27 at position 0 unexpected 'by_tenure'.
syntax error line 29 at position 46 unexpected 'as'.
[0m23:40:13.109153 [debug] [Thread-4 (]: On model.customer_churn.churn_metrics: Close
[0m23:40:13.195799 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.962 seconds
[0m23:40:13.201447 [debug] [Thread-2 (]: On model.customer_churn.dim_customer: Close
[0m23:40:13.254610 [debug] [Thread-4 (]: Database Error in model churn_metrics (models/marts/churn_metrics.sql)
  001003 (42000): SQL compilation error:
  syntax error line 27 at position 0 unexpected 'by_tenure'.
  syntax error line 29 at position 46 unexpected 'as'.
  compiled code at target/run/customer_churn/models/marts/churn_metrics.sql
[0m23:40:13.256225 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '086f4598-4763-4902-8084-0c4b59b9f45b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1d59371d0>]}
[0m23:40:13.257928 [error] [Thread-4 (]: 4 of 5 ERROR creating sql table model RAW_public.churn_metrics ................. [[31mERROR[0m in 0.71s]
[0m23:40:13.260560 [debug] [Thread-4 (]: Finished running node model.customer_churn.churn_metrics
[0m23:40:13.325468 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '086f4598-4763-4902-8084-0c4b59b9f45b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1dc25d370>]}
[0m23:40:13.328790 [info ] [Thread-2 (]: 2 of 5 OK created sql table model RAW_public.dim_customer ...................... [[32mSUCCESS 1[0m in 4.26s]
[0m23:40:13.329857 [debug] [Thread-2 (]: Finished running node model.customer_churn.dim_customer
[0m23:40:13.899010 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.663 seconds
[0m23:40:13.904617 [debug] [Thread-1 (]: On model.customer_churn.dim_address: Close
[0m23:40:14.040290 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '086f4598-4763-4902-8084-0c4b59b9f45b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1d5a59fd0>]}
[0m23:40:14.043316 [info ] [Thread-1 (]: 1 of 5 OK created sql table model RAW_public.dim_address ....................... [[32mSUCCESS 1[0m in 4.98s]
[0m23:40:14.045893 [debug] [Thread-1 (]: Finished running node model.customer_churn.dim_address
[0m23:40:14.048992 [debug] [Thread-3 (]: Began running node model.customer_churn.churn_map
[0m23:40:14.050256 [info ] [Thread-3 (]: 5 of 5 START sql table model RAW_public.churn_map .............................. [RUN]
[0m23:40:14.051504 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer_churn.fact_churn, now model.customer_churn.churn_map)
[0m23:40:14.052390 [debug] [Thread-3 (]: Began compiling node model.customer_churn.churn_map
[0m23:40:14.061950 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.churn_map"
[0m23:40:14.085905 [debug] [Thread-3 (]: Began executing node model.customer_churn.churn_map
[0m23:40:14.092113 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.churn_map"
[0m23:40:14.112350 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.churn_map"
[0m23:40:14.113928 [debug] [Thread-3 (]: On model.customer_churn.churn_map: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.churn_map"} */
create or replace transient table USER_DB_FALCON.RAW_public.churn_map
         as
        (-- models/marts/churn_map.sql


select
  f.individual_id,
  f.churn_date,
  f.churn_flag,
  a.lon,
  a.lat
from USER_DB_FALCON.RAW_public.fact_churn      as f
join USER_DB_FALCON.RAW_public.dim_address    as a
  using (individual_id)
        );
[0m23:40:14.114737 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:40:15.915435 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.801 seconds
[0m23:40:15.918033 [debug] [Thread-3 (]: On model.customer_churn.churn_map: Close
[0m23:40:16.053359 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '086f4598-4763-4902-8084-0c4b59b9f45b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe237d9ee40>]}
[0m23:40:16.054545 [info ] [Thread-3 (]: 5 of 5 OK created sql table model RAW_public.churn_map ......................... [[32mSUCCESS 1[0m in 2.00s]
[0m23:40:16.055693 [debug] [Thread-3 (]: Finished running node model.customer_churn.churn_map
[0m23:40:16.058322 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:40:16.059226 [debug] [MainThread]: Connection 'model.customer_churn.dim_address' was properly closed.
[0m23:40:16.059932 [debug] [MainThread]: Connection 'model.customer_churn.dim_customer' was properly closed.
[0m23:40:16.060615 [debug] [MainThread]: Connection 'model.customer_churn.churn_map' was properly closed.
[0m23:40:16.061301 [debug] [MainThread]: Connection 'model.customer_churn.churn_metrics' was properly closed.
[0m23:40:16.062209 [info ] [MainThread]: 
[0m23:40:16.063163 [info ] [MainThread]: Finished running 1 incremental model, 4 table models in 0 hours 0 minutes and 8.27 seconds (8.27s).
[0m23:40:16.064805 [debug] [MainThread]: Command end result
[0m23:40:16.162045 [info ] [MainThread]: 
[0m23:40:16.163248 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:40:16.164359 [info ] [MainThread]: 
[0m23:40:16.165890 [error] [MainThread]:   Database Error in model churn_metrics (models/marts/churn_metrics.sql)
  001003 (42000): SQL compilation error:
  syntax error line 27 at position 0 unexpected 'by_tenure'.
  syntax error line 29 at position 46 unexpected 'as'.
  compiled code at target/run/customer_churn/models/marts/churn_metrics.sql
[0m23:40:16.167192 [info ] [MainThread]: 
[0m23:40:16.168388 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m23:40:16.170242 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 10.7092705, "process_user_time": 5.548031, "process_kernel_time": 2.808981, "process_mem_max_rss": "274268", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m23:40:16.172139 [debug] [MainThread]: Command `dbt run` failed at 23:40:16.171791 after 10.71 seconds
[0m23:40:16.173657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2384daa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe238324dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe237d9ee40>]}
[0m23:40:16.175017 [debug] [MainThread]: Flushing usage events
[0m23:43:57.302027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f127eac00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f133b9be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f127eb410>]}


============================== 23:43:57.316387 | 2516ddea-96bd-44a1-8147-af5e64260b80 ==============================
[0m23:43:57.316387 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:43:57.317796 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:43:57.463460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2516ddea-96bd-44a1-8147-af5e64260b80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f136b5790>]}
[0m23:43:57.486599 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:43:57.502318 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:43:57.504270 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.30516082, "process_user_time": 2.98961, "process_kernel_time": 0.18685, "process_mem_max_rss": "165556", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:43:57.505673 [debug] [MainThread]: Command `dbt deps` succeeded at 23:43:57.505458 after 0.31 seconds
[0m23:43:57.506650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f127a2150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f136b6a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f12422b10>]}
[0m23:43:57.507673 [debug] [MainThread]: Flushing usage events
[0m23:44:02.512750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4682d1e3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4682c2da30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4685d57950>]}


============================== 23:44:02.524140 | c4b9304e-f0b9-475e-9aba-b1cc75a76aad ==============================
[0m23:44:02.524140 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:44:02.551088 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt --select staging', 'send_anonymous_usage_stats': 'True'}
[0m23:44:03.951688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4b9304e-f0b9-475e-9aba-b1cc75a76aad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46821c2900>]}
[0m23:44:04.052720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c4b9304e-f0b9-475e-9aba-b1cc75a76aad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4628787b30>]}
[0m23:44:04.054378 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m23:44:04.205022 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:44:04.988818 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:44:04.990256 [debug] [MainThread]: Partial parsing: updated file: customer_churn://models/marts/churn_metrics.sql
[0m23:44:05.431726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4b9304e-f0b9-475e-9aba-b1cc75a76aad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4623ddffb0>]}
[0m23:44:05.752393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4b9304e-f0b9-475e-9aba-b1cc75a76aad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4623c6fc50>]}
[0m23:44:05.753887 [info ] [MainThread]: Found 12 models, 10 data tests, 7 sources, 459 macros
[0m23:44:05.755462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4b9304e-f0b9-475e-9aba-b1cc75a76aad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46281f8500>]}
[0m23:44:05.759185 [info ] [MainThread]: 
[0m23:44:05.760636 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:44:05.767897 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON'
[0m23:44:05.780914 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON"
[0m23:44:05.782008 [debug] [ThreadPool]: On list_USER_DB_FALCON: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON"} */
show terse schemas in database USER_DB_FALCON
    limit 10000
[0m23:44:05.782937 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:44:06.492912 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.710 seconds
[0m23:44:06.497055 [debug] [ThreadPool]: On list_USER_DB_FALCON: Close
[0m23:44:07.202811 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON, now list_USER_DB_FALCON_RAW_public)
[0m23:44:07.217604 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m23:44:07.219131 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show terse objects in USER_DB_FALCON.RAW_public limit 10000
[0m23:44:07.220519 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:44:07.668075 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.448 seconds
[0m23:44:07.671953 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m23:44:07.839248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4b9304e-f0b9-475e-9aba-b1cc75a76aad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4681c4eff0>]}
[0m23:44:07.840495 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:44:07.841566 [info ] [MainThread]: 
[0m23:44:07.854647 [debug] [Thread-1 (]: Began running node model.customer_churn.stg_address
[0m23:44:07.855442 [debug] [Thread-2 (]: Began running node model.customer_churn.stg_autoinsurance_churn
[0m23:44:07.856164 [debug] [Thread-3 (]: Began running node model.customer_churn.stg_customer
[0m23:44:07.857041 [info ] [Thread-1 (]: 1 of 6 START sql view model RAW_public.stg_address ............................. [RUN]
[0m23:44:07.858233 [debug] [Thread-4 (]: Began running node model.customer_churn.stg_demographic
[0m23:44:07.858872 [info ] [Thread-2 (]: 2 of 6 START sql view model RAW_public.stg_autoinsurance_churn ................. [RUN]
[0m23:44:07.859920 [info ] [Thread-3 (]: 3 of 6 START sql view model RAW_public.stg_customer ............................ [RUN]
[0m23:44:07.860884 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON_RAW_public, now model.customer_churn.stg_address)
[0m23:44:07.862075 [info ] [Thread-4 (]: 4 of 6 START sql view model RAW_public.stg_demographic ......................... [RUN]
[0m23:44:07.863225 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.customer_churn.stg_autoinsurance_churn'
[0m23:44:07.864391 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.customer_churn.stg_customer'
[0m23:44:07.865264 [debug] [Thread-1 (]: Began compiling node model.customer_churn.stg_address
[0m23:44:07.866343 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.customer_churn.stg_demographic'
[0m23:44:07.867255 [debug] [Thread-2 (]: Began compiling node model.customer_churn.stg_autoinsurance_churn
[0m23:44:07.868050 [debug] [Thread-3 (]: Began compiling node model.customer_churn.stg_customer
[0m23:44:07.878894 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.stg_address"
[0m23:44:07.879528 [debug] [Thread-4 (]: Began compiling node model.customer_churn.stg_demographic
[0m23:44:07.885641 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer_churn.stg_autoinsurance_churn"
[0m23:44:07.894487 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.stg_customer"
[0m23:44:07.901114 [debug] [Thread-4 (]: Writing injected SQL for node "model.customer_churn.stg_demographic"
[0m23:44:07.919056 [debug] [Thread-3 (]: Began executing node model.customer_churn.stg_customer
[0m23:44:07.925323 [debug] [Thread-2 (]: Began executing node model.customer_churn.stg_autoinsurance_churn
[0m23:44:07.975553 [debug] [Thread-4 (]: Began executing node model.customer_churn.stg_demographic
[0m23:44:07.991309 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.stg_customer"
[0m23:44:07.995118 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer_churn.stg_autoinsurance_churn"
[0m23:44:07.998501 [debug] [Thread-4 (]: Writing runtime sql for node "model.customer_churn.stg_demographic"
[0m23:44:08.001518 [debug] [Thread-1 (]: Began executing node model.customer_churn.stg_address
[0m23:44:08.004909 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.stg_address"
[0m23:44:08.014050 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.stg_customer"
[0m23:44:08.015350 [debug] [Thread-2 (]: Using snowflake connection "model.customer_churn.stg_autoinsurance_churn"
[0m23:44:08.015859 [debug] [Thread-3 (]: On model.customer_churn.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_customer"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_customer
  
   as (
    

select
  individual_id,
  address_id,
  curr_ann_amt    as annual_premium,
  days_tenure,
  cust_orig_date,
  age_in_years,            -- bring this in
  date_of_birth            -- and this
from USER_DB_FALCON.RAW.CUSTOMER_STAGING
where individual_id is not null
  );
[0m23:44:08.018128 [debug] [Thread-2 (]: On model.customer_churn.stg_autoinsurance_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_autoinsurance_churn"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_autoinsurance_churn
  
   as (
    

select
  individual_id,
  churn              as churn_flag
from USER_DB_FALCON.RAW.AUTOINSURANCE_CHURN_STAGING
  );
[0m23:44:08.022030 [debug] [Thread-4 (]: Using snowflake connection "model.customer_churn.stg_demographic"
[0m23:44:08.026461 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:44:08.029775 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:44:08.031069 [debug] [Thread-4 (]: On model.customer_churn.stg_demographic: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_demographic"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_demographic
  
   as (
    

select
  individual_id,
  income,
  has_children,
  length_of_residence    as length_of_residence,  -- exact match
  marital_status,
  home_owner,
  home_market_value      as home_market_value,
  college_degree,
  good_credit
from USER_DB_FALCON.RAW.DEMOGRAPHIC_STAGING
  );
[0m23:44:08.034740 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.stg_address"
[0m23:44:08.040979 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:44:08.042589 [debug] [Thread-1 (]: On model.customer_churn.stg_address: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_address"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_address
  
   as (
    -- models/staging/stg_address.sql

select
  address_id,
  street_address,
  city,
  state,
  county,
  latitude::float as lat,
  longitude::float as lon
from USER_DB_FALCON.RAW.ADDRESS_STAGING
  );
[0m23:44:08.047051 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:44:08.642653 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.613 seconds
[0m23:44:08.671319 [debug] [Thread-2 (]: On model.customer_churn.stg_autoinsurance_churn: Close
[0m23:44:08.672136 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.625 seconds
[0m23:44:08.675786 [debug] [Thread-1 (]: On model.customer_churn.stg_address: Close
[0m23:44:08.752596 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.726 seconds
[0m23:44:08.757300 [debug] [Thread-3 (]: On model.customer_churn.stg_customer: Close
[0m23:44:08.796599 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.756 seconds
[0m23:44:08.800440 [debug] [Thread-4 (]: On model.customer_churn.stg_demographic: Close
[0m23:44:08.815883 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4b9304e-f0b9-475e-9aba-b1cc75a76aad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4628416ae0>]}
[0m23:44:08.817537 [info ] [Thread-2 (]: 2 of 6 OK created sql view model RAW_public.stg_autoinsurance_churn ............ [[32mSUCCESS 1[0m in 0.95s]
[0m23:44:08.832911 [debug] [Thread-2 (]: Finished running node model.customer_churn.stg_autoinsurance_churn
[0m23:44:08.835512 [debug] [Thread-2 (]: Began running node model.customer_churn.stg_termination
[0m23:44:08.838442 [info ] [Thread-2 (]: 5 of 6 START sql view model RAW_public.stg_termination ......................... [RUN]
[0m23:44:08.839525 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer_churn.stg_autoinsurance_churn, now model.customer_churn.stg_termination)
[0m23:44:08.840262 [debug] [Thread-2 (]: Began compiling node model.customer_churn.stg_termination
[0m23:44:08.844864 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer_churn.stg_termination"
[0m23:44:08.884204 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4b9304e-f0b9-475e-9aba-b1cc75a76aad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4602f40560>]}
[0m23:44:08.887302 [info ] [Thread-1 (]: 1 of 6 OK created sql view model RAW_public.stg_address ........................ [[32mSUCCESS 1[0m in 1.02s]
[0m23:44:08.888803 [debug] [Thread-1 (]: Finished running node model.customer_churn.stg_address
[0m23:44:08.889582 [debug] [Thread-1 (]: Began running node model.customer_churn.stg_turning_movement
[0m23:44:08.890765 [info ] [Thread-1 (]: 6 of 6 START sql view model RAW_public.stg_turning_movement .................... [RUN]
[0m23:44:08.892490 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer_churn.stg_address, now model.customer_churn.stg_turning_movement)
[0m23:44:08.893359 [debug] [Thread-1 (]: Began compiling node model.customer_churn.stg_turning_movement
[0m23:44:08.907869 [debug] [Thread-2 (]: Began executing node model.customer_churn.stg_termination
[0m23:44:08.907072 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.stg_turning_movement"
[0m23:44:08.915739 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer_churn.stg_termination"
[0m23:44:08.938234 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4b9304e-f0b9-475e-9aba-b1cc75a76aad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46200ef170>]}
[0m23:44:08.938893 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4b9304e-f0b9-475e-9aba-b1cc75a76aad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4602f2dcd0>]}
[0m23:44:08.939554 [info ] [Thread-4 (]: 4 of 6 OK created sql view model RAW_public.stg_demographic .................... [[32mSUCCESS 1[0m in 1.07s]
[0m23:44:08.940434 [info ] [Thread-3 (]: 3 of 6 OK created sql view model RAW_public.stg_customer ....................... [[32mSUCCESS 1[0m in 1.07s]
[0m23:44:08.944129 [debug] [Thread-4 (]: Finished running node model.customer_churn.stg_demographic
[0m23:44:08.945092 [debug] [Thread-3 (]: Finished running node model.customer_churn.stg_customer
[0m23:44:08.945712 [debug] [Thread-1 (]: Began executing node model.customer_churn.stg_turning_movement
[0m23:44:08.947033 [debug] [Thread-2 (]: Using snowflake connection "model.customer_churn.stg_termination"
[0m23:44:08.950083 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.stg_turning_movement"
[0m23:44:08.951546 [debug] [Thread-2 (]: On model.customer_churn.stg_termination: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_termination"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_termination
  
   as (
    

select
  individual_id,
  acct_suspd_date    as churn_date
from USER_DB_FALCON.RAW.TERMINATION_STAGING
  );
[0m23:44:08.955168 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:44:08.972428 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.stg_turning_movement"
[0m23:44:08.973704 [debug] [Thread-1 (]: On model.customer_churn.stg_turning_movement: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_turning_movement"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_turning_movement
  
   as (
    -- models/staging/stg_turning_movement.sql

select
  objectid,
  facilityid,
  intid,
  intname,
  nodeno,
  longitude::float as tm_lon,
  latitude::float  as tm_lat
from USER_DB_FALCON.RAW.TURNING_MOVEMENT
  );
[0m23:44:08.974806 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:44:09.542682 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.588 seconds
[0m23:44:09.545507 [debug] [Thread-2 (]: On model.customer_churn.stg_termination: Close
[0m23:44:09.665032 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.690 seconds
[0m23:44:09.670343 [debug] [Thread-1 (]: On model.customer_churn.stg_turning_movement: Close
[0m23:44:09.682188 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4b9304e-f0b9-475e-9aba-b1cc75a76aad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4602faa4b0>]}
[0m23:44:09.683421 [info ] [Thread-2 (]: 5 of 6 OK created sql view model RAW_public.stg_termination .................... [[32mSUCCESS 1[0m in 0.84s]
[0m23:44:09.685297 [debug] [Thread-2 (]: Finished running node model.customer_churn.stg_termination
[0m23:44:09.823280 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4b9304e-f0b9-475e-9aba-b1cc75a76aad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46030bcec0>]}
[0m23:44:09.825301 [info ] [Thread-1 (]: 6 of 6 OK created sql view model RAW_public.stg_turning_movement ............... [[32mSUCCESS 1[0m in 0.93s]
[0m23:44:09.827195 [debug] [Thread-1 (]: Finished running node model.customer_churn.stg_turning_movement
[0m23:44:09.831053 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:44:09.832785 [debug] [MainThread]: Connection 'model.customer_churn.stg_turning_movement' was properly closed.
[0m23:44:09.837342 [debug] [MainThread]: Connection 'model.customer_churn.stg_termination' was properly closed.
[0m23:44:09.838268 [debug] [MainThread]: Connection 'model.customer_churn.stg_customer' was properly closed.
[0m23:44:09.838918 [debug] [MainThread]: Connection 'model.customer_churn.stg_demographic' was properly closed.
[0m23:44:09.839685 [info ] [MainThread]: 
[0m23:44:09.840512 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 4.08 seconds (4.08s).
[0m23:44:09.842022 [debug] [MainThread]: Command end result
[0m23:44:10.070359 [info ] [MainThread]: 
[0m23:44:10.071267 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:44:10.072020 [info ] [MainThread]: 
[0m23:44:10.072815 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m23:44:10.073984 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.7165713, "process_user_time": 5.803719, "process_kernel_time": 3.142401, "process_mem_max_rss": "287580", "process_in_blocks": "416", "process_out_blocks": "8"}
[0m23:44:10.074906 [debug] [MainThread]: Command `dbt run` succeeded at 23:44:10.074789 after 7.72 seconds
[0m23:44:10.075633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4682433470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4684a8f0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f462874f680>]}
[0m23:44:10.077061 [debug] [MainThread]: Flushing usage events
[0m23:44:14.611429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fc1e2a0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fc3d3a600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fc2fab140>]}


============================== 23:44:14.620571 | 2b501509-16b4-4f1b-9bf6-e5884b7d7e39 ==============================
[0m23:44:14.620571 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:44:14.623260 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt --select intermediate', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:44:15.798087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b501509-16b4-4f1b-9bf6-e5884b7d7e39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f68797020>]}
[0m23:44:15.866173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b501509-16b4-4f1b-9bf6-e5884b7d7e39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f63a7c380>]}
[0m23:44:15.867684 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m23:44:16.041599 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:44:16.671388 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:44:16.672594 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:44:16.723231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b501509-16b4-4f1b-9bf6-e5884b7d7e39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fc223b3b0>]}
[0m23:44:17.072946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b501509-16b4-4f1b-9bf6-e5884b7d7e39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f637886b0>]}
[0m23:44:17.073962 [info ] [MainThread]: Found 12 models, 10 data tests, 7 sources, 459 macros
[0m23:44:17.074887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b501509-16b4-4f1b-9bf6-e5884b7d7e39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f63551be0>]}
[0m23:44:17.076832 [info ] [MainThread]: 
[0m23:44:17.077688 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:44:17.079329 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON'
[0m23:44:17.093043 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON"
[0m23:44:17.093886 [debug] [ThreadPool]: On list_USER_DB_FALCON: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON"} */
show terse schemas in database USER_DB_FALCON
    limit 10000
[0m23:44:17.096752 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:44:17.699134 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.602 seconds
[0m23:44:17.701777 [debug] [ThreadPool]: On list_USER_DB_FALCON: Close
[0m23:44:17.823687 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON, now list_USER_DB_FALCON_RAW_public)
[0m23:44:17.836330 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m23:44:17.838978 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show terse objects in USER_DB_FALCON.RAW_public limit 10000
[0m23:44:17.840129 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:44:18.212232 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.372 seconds
[0m23:44:18.215084 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m23:44:18.338978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b501509-16b4-4f1b-9bf6-e5884b7d7e39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fc1b43380>]}
[0m23:44:18.341049 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:44:18.343372 [info ] [MainThread]: 
[0m23:44:18.353660 [debug] [Thread-1 (]: Began running node model.customer_churn.int_customer_enriched
[0m23:44:18.355235 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW_public.int_customer_enriched ................... [RUN]
[0m23:44:18.357352 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON_RAW_public, now model.customer_churn.int_customer_enriched)
[0m23:44:18.358188 [debug] [Thread-1 (]: Began compiling node model.customer_churn.int_customer_enriched
[0m23:44:18.364721 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.int_customer_enriched"
[0m23:44:18.378713 [debug] [Thread-1 (]: Began executing node model.customer_churn.int_customer_enriched
[0m23:44:18.399724 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.int_customer_enriched"
[0m23:44:18.439374 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.int_customer_enriched"
[0m23:44:18.441043 [debug] [Thread-1 (]: On model.customer_churn.int_customer_enriched: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.int_customer_enriched"} */
create or replace   view USER_DB_FALCON.RAW_public.int_customer_enriched
  
   as (
    

with cust as (
    select
        individual_id,
        annual_premium,
        days_tenure,
        cust_orig_date,
        age_in_years,
        date_of_birth,
        address_id
    from USER_DB_FALCON.RAW_public.stg_customer
),

demo as (
    select
        individual_id,
        has_children,
        length_of_residence,
        marital_status,
        home_owner,
        home_market_value,
        college_degree,
        good_credit
    from USER_DB_FALCON.RAW_public.stg_demographic
),

addr as (
    select
        address_id,
        city,
        state,
        county,
        lat,
        lon
    from USER_DB_FALCON.RAW_public.stg_address
)

select
    cust.individual_id,
    cust.annual_premium,
    cust.days_tenure,
    cust.cust_orig_date,
    cust.age_in_years,
    cust.date_of_birth,
    demo.has_children,
    demo.length_of_residence,
    demo.marital_status,
    demo.home_owner,
    demo.home_market_value,
    addr.city,
    addr.state,
    addr.county,
    addr.lat,
    addr.lon
from cust
left join demo using (individual_id)
left join addr using (address_id)
  );
[0m23:44:18.442827 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:44:19.863768 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.421 seconds
[0m23:44:19.893069 [debug] [Thread-1 (]: On model.customer_churn.int_customer_enriched: Close
[0m23:44:20.016853 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b501509-16b4-4f1b-9bf6-e5884b7d7e39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f63a7f080>]}
[0m23:44:20.018000 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW_public.int_customer_enriched .............. [[32mSUCCESS 1[0m in 1.66s]
[0m23:44:20.019500 [debug] [Thread-1 (]: Finished running node model.customer_churn.int_customer_enriched
[0m23:44:20.021897 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:44:20.024542 [debug] [MainThread]: Connection 'model.customer_churn.int_customer_enriched' was properly closed.
[0m23:44:20.026103 [info ] [MainThread]: 
[0m23:44:20.027266 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.95 seconds (2.95s).
[0m23:44:20.029115 [debug] [MainThread]: Command end result
[0m23:44:20.140688 [info ] [MainThread]: 
[0m23:44:20.141912 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:44:20.142510 [info ] [MainThread]: 
[0m23:44:20.143079 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:44:20.145229 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.6243277, "process_user_time": 5.342702, "process_kernel_time": 2.653505, "process_mem_max_rss": "254924", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m23:44:20.148861 [debug] [MainThread]: Command `dbt run` succeeded at 23:44:20.148560 after 5.63 seconds
[0m23:44:20.150173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fc2317170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fc44c61e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fc1f3afc0>]}
[0m23:44:20.151642 [debug] [MainThread]: Flushing usage events
[0m23:44:23.773587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75902894f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7590985eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7590984b60>]}


============================== 23:44:23.784744 | fb413140-06f8-4fda-b83c-0877cb91ae28 ==============================
[0m23:44:23.784744 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:44:23.785921 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt --select marts', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:44:24.978645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb413140-06f8-4fda-b83c-0877cb91ae28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75909d1a30>]}
[0m23:44:25.050859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb413140-06f8-4fda-b83c-0877cb91ae28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f758f73a4e0>]}
[0m23:44:25.052487 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m23:44:25.237846 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:44:26.119877 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:44:26.121393 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:44:26.195067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb413140-06f8-4fda-b83c-0877cb91ae28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7538347fe0>]}
[0m23:44:26.421933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb413140-06f8-4fda-b83c-0877cb91ae28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75319957f0>]}
[0m23:44:26.423870 [info ] [MainThread]: Found 12 models, 10 data tests, 7 sources, 459 macros
[0m23:44:26.425336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb413140-06f8-4fda-b83c-0877cb91ae28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75318ab950>]}
[0m23:44:26.429510 [info ] [MainThread]: 
[0m23:44:26.431423 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:44:26.441208 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON'
[0m23:44:26.473801 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON"
[0m23:44:26.475504 [debug] [ThreadPool]: On list_USER_DB_FALCON: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON"} */
show terse schemas in database USER_DB_FALCON
    limit 10000
[0m23:44:26.476749 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:44:27.601468 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.125 seconds
[0m23:44:27.603819 [debug] [ThreadPool]: On list_USER_DB_FALCON: Close
[0m23:44:27.726635 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON, now list_USER_DB_FALCON_RAW_public)
[0m23:44:27.742751 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m23:44:27.752090 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show terse objects in USER_DB_FALCON.RAW_public limit 10000
[0m23:44:27.755309 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:44:28.171472 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.416 seconds
[0m23:44:28.177699 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m23:44:28.320996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb413140-06f8-4fda-b83c-0877cb91ae28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f759107bfe0>]}
[0m23:44:28.322386 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:44:28.328492 [info ] [MainThread]: 
[0m23:44:28.340572 [debug] [Thread-1 (]: Began running node model.customer_churn.dim_address
[0m23:44:28.340917 [debug] [Thread-2 (]: Began running node model.customer_churn.dim_customer
[0m23:44:28.341168 [debug] [Thread-3 (]: Began running node model.customer_churn.fact_churn
[0m23:44:28.343257 [info ] [Thread-1 (]: 1 of 5 START sql table model RAW_public.dim_address ............................ [RUN]
[0m23:44:28.345399 [info ] [Thread-2 (]: 2 of 5 START sql table model RAW_public.dim_customer ........................... [RUN]
[0m23:44:28.348065 [info ] [Thread-3 (]: 3 of 5 START sql incremental model RAW_public.fact_churn ....................... [RUN]
[0m23:44:28.349914 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON_RAW_public, now model.customer_churn.dim_address)
[0m23:44:28.354361 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.customer_churn.dim_customer'
[0m23:44:28.355452 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.customer_churn.fact_churn'
[0m23:44:28.360986 [debug] [Thread-1 (]: Began compiling node model.customer_churn.dim_address
[0m23:44:28.363064 [debug] [Thread-2 (]: Began compiling node model.customer_churn.dim_customer
[0m23:44:28.367114 [debug] [Thread-3 (]: Began compiling node model.customer_churn.fact_churn
[0m23:44:28.385888 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer_churn.dim_customer"
[0m23:44:28.381282 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.dim_address"
[0m23:44:28.406525 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.fact_churn"
[0m23:44:28.428143 [debug] [Thread-2 (]: Began executing node model.customer_churn.dim_customer
[0m23:44:28.435167 [debug] [Thread-3 (]: Began executing node model.customer_churn.fact_churn
[0m23:44:28.468898 [debug] [Thread-1 (]: Began executing node model.customer_churn.dim_address
[0m23:44:28.487824 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer_churn.dim_customer"
[0m23:44:28.490250 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.dim_address"
[0m23:44:28.501000 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:44:28.506819 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
create or replace  temporary view USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
  
   as (
    -- models/marts/fact_churn.sql


select
  t.individual_id,
  t.churn_date,
  e.city,
  e.state,
  e.county,
  e.age_in_years,
  e.days_tenure,
  e.annual_premium,
  c.churn_flag
from USER_DB_FALCON.RAW_public.stg_termination t
join USER_DB_FALCON.RAW_public.int_customer_enriched e
  using (individual_id)
left join USER_DB_FALCON.RAW_public.stg_autoinsurance_churn c
  using (individual_id)


where t.churn_date > (select max(churn_date) from USER_DB_FALCON.RAW_public.fact_churn)

  );
[0m23:44:28.507648 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:44:28.516666 [debug] [Thread-2 (]: Using snowflake connection "model.customer_churn.dim_customer"
[0m23:44:28.517470 [debug] [Thread-2 (]: On model.customer_churn.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.dim_customer"} */
create or replace transient table USER_DB_FALCON.RAW_public.dim_customer
         as
        (-- models/marts/dim_customer.sql


select distinct
  individual_id,
  age_in_years as age,
  marital_status,
  has_children,
  length_of_residence
from USER_DB_FALCON.RAW_public.int_customer_enriched
        );
[0m23:44:28.518075 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:44:28.518573 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.dim_address"
[0m23:44:28.519883 [debug] [Thread-1 (]: On model.customer_churn.dim_address: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.dim_address"} */
create or replace transient table USER_DB_FALCON.RAW_public.dim_address
         as
        (-- models/marts/dim_address.sql


select distinct
  individual_id,
  city,
  state,
  county,
  lat,
  lon
from USER_DB_FALCON.RAW_public.int_customer_enriched
        );
[0m23:44:28.520500 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:44:29.311713 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.804 seconds
[0m23:44:29.324602 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:44:29.326452 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
[0m23:44:29.467016 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 0.136 seconds
[0m23:44:29.476548 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:44:29.478468 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table USER_DB_FALCON.RAW_public.fact_churn
[0m23:44:29.591252 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 0.111 seconds
[0m23:44:29.606843 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:44:29.608953 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table "USER_DB_FALCON"."RAW_PUBLIC"."FACT_CHURN"
[0m23:44:29.727849 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 0.117 seconds
[0m23:44:29.768486 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.fact_churn"
[0m23:44:29.829494 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:44:29.831810 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
-- back compat for old kwarg name
  
  begin;
[0m23:44:29.986087 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.152 seconds
[0m23:44:29.987226 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:44:29.988660 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
merge into USER_DB_FALCON.RAW_public.fact_churn as DBT_INTERNAL_DEST
        using USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.individual_id = DBT_INTERNAL_DEST.individual_id
                ) and (
                    DBT_INTERNAL_SOURCE.churn_date = DBT_INTERNAL_DEST.churn_date
                )

    
    when matched then update set
        "INDIVIDUAL_ID" = DBT_INTERNAL_SOURCE."INDIVIDUAL_ID","CHURN_DATE" = DBT_INTERNAL_SOURCE."CHURN_DATE","CITY" = DBT_INTERNAL_SOURCE."CITY","STATE" = DBT_INTERNAL_SOURCE."STATE","COUNTY" = DBT_INTERNAL_SOURCE."COUNTY","AGE_IN_YEARS" = DBT_INTERNAL_SOURCE."AGE_IN_YEARS","DAYS_TENURE" = DBT_INTERNAL_SOURCE."DAYS_TENURE","ANNUAL_PREMIUM" = DBT_INTERNAL_SOURCE."ANNUAL_PREMIUM","CHURN_FLAG" = DBT_INTERNAL_SOURCE."CHURN_FLAG"
    

    when not matched then insert
        ("INDIVIDUAL_ID", "CHURN_DATE", "CITY", "STATE", "COUNTY", "AGE_IN_YEARS", "DAYS_TENURE", "ANNUAL_PREMIUM", "CHURN_FLAG")
    values
        ("INDIVIDUAL_ID", "CHURN_DATE", "CITY", "STATE", "COUNTY", "AGE_IN_YEARS", "DAYS_TENURE", "ANNUAL_PREMIUM", "CHURN_FLAG")

;
[0m23:44:30.403163 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 0.411 seconds
[0m23:44:30.407696 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:44:30.411860 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
COMMIT
[0m23:44:30.601015 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.185 seconds
[0m23:44:30.612297 [debug] [Thread-3 (]: Applying DROP to: USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
[0m23:44:30.620510 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:44:30.621481 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
drop view if exists USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp cascade
[0m23:44:30.755548 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.133 seconds
[0m23:44:30.775409 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: Close
[0m23:44:30.921148 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb413140-06f8-4fda-b83c-0877cb91ae28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75902f1af0>]}
[0m23:44:30.924832 [info ] [Thread-3 (]: 3 of 5 OK created sql incremental model RAW_public.fact_churn .................. [[32mSUCCESS 0[0m in 2.56s]
[0m23:44:30.942636 [debug] [Thread-3 (]: Finished running node model.customer_churn.fact_churn
[0m23:44:30.944895 [debug] [Thread-4 (]: Began running node model.customer_churn.churn_metrics
[0m23:44:30.949190 [info ] [Thread-4 (]: 4 of 5 START sql table model RAW_public.churn_metrics .......................... [RUN]
[0m23:44:30.950506 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.customer_churn.churn_metrics'
[0m23:44:30.951535 [debug] [Thread-4 (]: Began compiling node model.customer_churn.churn_metrics
[0m23:44:30.958579 [debug] [Thread-4 (]: Writing injected SQL for node "model.customer_churn.churn_metrics"
[0m23:44:31.000619 [debug] [Thread-4 (]: Began executing node model.customer_churn.churn_metrics
[0m23:44:31.003543 [debug] [Thread-4 (]: Writing runtime sql for node "model.customer_churn.churn_metrics"
[0m23:44:31.030164 [debug] [Thread-4 (]: Using snowflake connection "model.customer_churn.churn_metrics"
[0m23:44:31.031614 [debug] [Thread-4 (]: On model.customer_churn.churn_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.churn_metrics"} */
create or replace transient table USER_DB_FALCON.RAW_public.churn_metrics
         as
        (with by_tenure as (
    select
        width_bucket(days_tenure, 0, 6000, 6) as period,
        sum(churn_flag) as churn_count,
        width_bucket(days_tenure, 0, 6000, 6) as tenure_bucket_index,
        case
            when days_tenure <= 90 then '0-3 months'
            when days_tenure <= 180 then '4-6 months'
            when days_tenure <= 365 then '7-12 months'
            when days_tenure <= 730 then '13-24 months'
            else '25+ months'
        end as tenure_bucket_label
    from USER_DB_FALCON.RAW_public.fact_churn
    group by 1, 3, 4
)

select 
  cast(period as varchar) as period, 
  churn_count,
  'monthly' as category
from monthly

union all

select 
  cast(period as varchar) as period, 
  churn_count,
  'by_state' as category
from by_state

union all

select 
  cast(period as varchar) as period, 
  churn_count,
  'by_age' as category
from by_age

union all

select 
  cast(period as varchar) as period, 
  churn_count,
  'by_tenure' as category
from by_tenure

union all

select 
  cast(period as varchar) as period, 
  churn_count,
  'by_premium' as category
from by_premium
        );
[0m23:44:31.033685 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:44:31.651977 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01bc27b0-0305-2720-0004-59ff003c7142
[0m23:44:31.655533 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'MONTHLY' does not exist or not authorized.
[0m23:44:31.657464 [debug] [Thread-4 (]: On model.customer_churn.churn_metrics: Close
[0m23:44:32.804729 [debug] [Thread-4 (]: Database Error in model churn_metrics (models/marts/churn_metrics.sql)
  002003 (42S02): SQL compilation error:
  Object 'MONTHLY' does not exist or not authorized.
  compiled code at target/run/customer_churn/models/marts/churn_metrics.sql
[0m23:44:32.806644 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb413140-06f8-4fda-b83c-0877cb91ae28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7530d8e5d0>]}
[0m23:44:32.808931 [error] [Thread-4 (]: 4 of 5 ERROR creating sql table model RAW_public.churn_metrics ................. [[31mERROR[0m in 1.86s]
[0m23:44:32.811057 [debug] [Thread-4 (]: Finished running node model.customer_churn.churn_metrics
[0m23:44:33.675758 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.122 seconds
[0m23:44:33.679739 [debug] [Thread-1 (]: On model.customer_churn.dim_address: Close
[0m23:44:33.695365 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 4.144 seconds
[0m23:44:33.697459 [debug] [Thread-2 (]: On model.customer_churn.dim_customer: Close
[0m23:44:33.811043 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb413140-06f8-4fda-b83c-0877cb91ae28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7530d8b830>]}
[0m23:44:33.812349 [info ] [Thread-1 (]: 1 of 5 OK created sql table model RAW_public.dim_address ....................... [[32mSUCCESS 1[0m in 5.46s]
[0m23:44:33.813281 [debug] [Thread-1 (]: Finished running node model.customer_churn.dim_address
[0m23:44:33.814465 [debug] [Thread-3 (]: Began running node model.customer_churn.churn_map
[0m23:44:33.815419 [info ] [Thread-3 (]: 5 of 5 START sql table model RAW_public.churn_map .............................. [RUN]
[0m23:44:33.816513 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer_churn.fact_churn, now model.customer_churn.churn_map)
[0m23:44:33.817191 [debug] [Thread-3 (]: Began compiling node model.customer_churn.churn_map
[0m23:44:33.818014 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb413140-06f8-4fda-b83c-0877cb91ae28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7530d4be90>]}
[0m23:44:33.821971 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.churn_map"
[0m23:44:33.823150 [info ] [Thread-2 (]: 2 of 5 OK created sql table model RAW_public.dim_customer ...................... [[32mSUCCESS 1[0m in 5.46s]
[0m23:44:33.824705 [debug] [Thread-2 (]: Finished running node model.customer_churn.dim_customer
[0m23:44:33.837511 [debug] [Thread-3 (]: Began executing node model.customer_churn.churn_map
[0m23:44:33.841054 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.churn_map"
[0m23:44:33.854415 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.churn_map"
[0m23:44:33.855289 [debug] [Thread-3 (]: On model.customer_churn.churn_map: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.churn_map"} */
create or replace transient table USER_DB_FALCON.RAW_public.churn_map
         as
        (-- models/marts/churn_map.sql


select
  f.individual_id,
  f.churn_date,
  f.churn_flag,
  a.lon,
  a.lat
from USER_DB_FALCON.RAW_public.fact_churn      as f
join USER_DB_FALCON.RAW_public.dim_address    as a
  using (individual_id)
        );
[0m23:44:33.856137 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:44:35.626620 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.770 seconds
[0m23:44:35.633333 [debug] [Thread-3 (]: On model.customer_churn.churn_map: Close
[0m23:44:35.819314 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb413140-06f8-4fda-b83c-0877cb91ae28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7530d89ee0>]}
[0m23:44:35.821245 [info ] [Thread-3 (]: 5 of 5 OK created sql table model RAW_public.churn_map ......................... [[32mSUCCESS 1[0m in 2.00s]
[0m23:44:35.822563 [debug] [Thread-3 (]: Finished running node model.customer_churn.churn_map
[0m23:44:35.827129 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:44:35.830248 [debug] [MainThread]: Connection 'model.customer_churn.dim_address' was properly closed.
[0m23:44:35.831551 [debug] [MainThread]: Connection 'model.customer_churn.dim_customer' was properly closed.
[0m23:44:35.833539 [debug] [MainThread]: Connection 'model.customer_churn.churn_map' was properly closed.
[0m23:44:35.835870 [debug] [MainThread]: Connection 'model.customer_churn.churn_metrics' was properly closed.
[0m23:44:35.837979 [info ] [MainThread]: 
[0m23:44:35.841826 [info ] [MainThread]: Finished running 1 incremental model, 4 table models in 0 hours 0 minutes and 9.41 seconds (9.41s).
[0m23:44:35.851428 [debug] [MainThread]: Command end result
[0m23:44:36.062195 [info ] [MainThread]: 
[0m23:44:36.063363 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:44:36.064191 [info ] [MainThread]: 
[0m23:44:36.065160 [error] [MainThread]:   Database Error in model churn_metrics (models/marts/churn_metrics.sql)
  002003 (42S02): SQL compilation error:
  Object 'MONTHLY' does not exist or not authorized.
  compiled code at target/run/customer_churn/models/marts/churn_metrics.sql
[0m23:44:36.066420 [info ] [MainThread]: 
[0m23:44:36.067952 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m23:44:36.069769 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 11.345394, "process_user_time": 5.637715, "process_kernel_time": 2.844624, "process_mem_max_rss": "265068", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m23:44:36.070784 [debug] [MainThread]: Command `dbt run` failed at 23:44:36.070687 after 11.35 seconds
[0m23:44:36.071780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f753265d430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f753231d100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7590984b60>]}
[0m23:44:36.072601 [debug] [MainThread]: Flushing usage events
[0m23:44:43.415632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe48254b380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe484b45c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4821c5010>]}


============================== 23:44:43.425625 | fa2ec9d2-6656-4633-9591-a05c80713fd6 ==============================
[0m23:44:43.425625 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:44:43.427008 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m23:44:43.648537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fa2ec9d2-6656-4633-9591-a05c80713fd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe481d129f0>]}
[0m23:44:43.675314 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:44:43.693400 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:44:43.695514 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.38074496, "process_user_time": 2.207008, "process_kernel_time": 0.123644, "process_mem_max_rss": "165560", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:44:43.697501 [debug] [MainThread]: Command `dbt deps` succeeded at 23:44:43.697111 after 0.38 seconds
[0m23:44:43.698768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe48120c470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe480a4f140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe480a23bf0>]}
[0m23:44:43.700061 [debug] [MainThread]: Flushing usage events
[0m23:44:47.804236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf29799340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf28ebf440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf2af89cd0>]}


============================== 23:44:47.813350 | 7f77f0d8-f577-44db-b5d1-8516977e2743 ==============================
[0m23:44:47.813350 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:44:47.814433 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt --select staging', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:44:48.983967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f77f0d8-f577-44db-b5d1-8516977e2743', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf291288c0>]}
[0m23:44:49.059184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7f77f0d8-f577-44db-b5d1-8516977e2743', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf29129190>]}
[0m23:44:49.061291 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m23:44:49.209781 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:44:50.044986 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:44:50.046519 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:44:50.100683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f77f0d8-f577-44db-b5d1-8516977e2743', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faecab52e70>]}
[0m23:44:50.304609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f77f0d8-f577-44db-b5d1-8516977e2743', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faeca0f9a90>]}
[0m23:44:50.305540 [info ] [MainThread]: Found 12 models, 10 data tests, 7 sources, 459 macros
[0m23:44:50.306405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f77f0d8-f577-44db-b5d1-8516977e2743', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf27e6f650>]}
[0m23:44:50.308681 [info ] [MainThread]: 
[0m23:44:50.309924 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:44:50.314552 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON'
[0m23:44:50.333211 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON"
[0m23:44:50.334369 [debug] [ThreadPool]: On list_USER_DB_FALCON: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON"} */
show terse schemas in database USER_DB_FALCON
    limit 10000
[0m23:44:50.335338 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:44:50.971163 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.636 seconds
[0m23:44:50.976315 [debug] [ThreadPool]: On list_USER_DB_FALCON: Close
[0m23:44:51.132693 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON, now list_USER_DB_FALCON_RAW_public)
[0m23:44:51.150030 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m23:44:51.151675 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show terse objects in USER_DB_FALCON.RAW_public limit 10000
[0m23:44:51.153473 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:44:52.164433 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 1.011 seconds
[0m23:44:52.168191 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m23:44:52.323948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f77f0d8-f577-44db-b5d1-8516977e2743', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faeca470710>]}
[0m23:44:52.325123 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:44:52.326001 [info ] [MainThread]: 
[0m23:44:52.339652 [debug] [Thread-1 (]: Began running node model.customer_churn.stg_address
[0m23:44:52.340043 [debug] [Thread-2 (]: Began running node model.customer_churn.stg_autoinsurance_churn
[0m23:44:52.340432 [debug] [Thread-3 (]: Began running node model.customer_churn.stg_customer
[0m23:44:52.340852 [debug] [Thread-4 (]: Began running node model.customer_churn.stg_demographic
[0m23:44:52.341317 [info ] [Thread-1 (]: 1 of 6 START sql view model RAW_public.stg_address ............................. [RUN]
[0m23:44:52.343525 [info ] [Thread-2 (]: 2 of 6 START sql view model RAW_public.stg_autoinsurance_churn ................. [RUN]
[0m23:44:52.345612 [info ] [Thread-3 (]: 3 of 6 START sql view model RAW_public.stg_customer ............................ [RUN]
[0m23:44:52.346719 [info ] [Thread-4 (]: 4 of 6 START sql view model RAW_public.stg_demographic ......................... [RUN]
[0m23:44:52.347882 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON_RAW_public, now model.customer_churn.stg_address)
[0m23:44:52.348676 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.customer_churn.stg_autoinsurance_churn'
[0m23:44:52.349781 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.customer_churn.stg_customer'
[0m23:44:52.350732 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.customer_churn.stg_demographic'
[0m23:44:52.351341 [debug] [Thread-1 (]: Began compiling node model.customer_churn.stg_address
[0m23:44:52.355020 [debug] [Thread-2 (]: Began compiling node model.customer_churn.stg_autoinsurance_churn
[0m23:44:52.356674 [debug] [Thread-3 (]: Began compiling node model.customer_churn.stg_customer
[0m23:44:52.357646 [debug] [Thread-4 (]: Began compiling node model.customer_churn.stg_demographic
[0m23:44:52.367792 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.stg_address"
[0m23:44:52.369930 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer_churn.stg_autoinsurance_churn"
[0m23:44:52.373469 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.stg_customer"
[0m23:44:52.376124 [debug] [Thread-4 (]: Writing injected SQL for node "model.customer_churn.stg_demographic"
[0m23:44:52.400588 [debug] [Thread-3 (]: Began executing node model.customer_churn.stg_customer
[0m23:44:52.408563 [debug] [Thread-1 (]: Began executing node model.customer_churn.stg_address
[0m23:44:52.438311 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.stg_address"
[0m23:44:52.438815 [debug] [Thread-4 (]: Began executing node model.customer_churn.stg_demographic
[0m23:44:52.443926 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.stg_customer"
[0m23:44:52.444550 [debug] [Thread-2 (]: Began executing node model.customer_churn.stg_autoinsurance_churn
[0m23:44:52.449155 [debug] [Thread-4 (]: Writing runtime sql for node "model.customer_churn.stg_demographic"
[0m23:44:52.453611 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer_churn.stg_autoinsurance_churn"
[0m23:44:52.469867 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.stg_address"
[0m23:44:52.471471 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.stg_customer"
[0m23:44:52.471888 [debug] [Thread-1 (]: On model.customer_churn.stg_address: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_address"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_address
  
   as (
    -- models/staging/stg_address.sql

select
  address_id,
  street_address,
  city,
  state,
  county,
  latitude::float as lat,
  longitude::float as lon
from USER_DB_FALCON.RAW.ADDRESS_STAGING
  );
[0m23:44:52.472696 [debug] [Thread-3 (]: On model.customer_churn.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_customer"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_customer
  
   as (
    

select
  individual_id,
  address_id,
  curr_ann_amt    as annual_premium,
  days_tenure,
  cust_orig_date,
  age_in_years,            -- bring this in
  date_of_birth            -- and this
from USER_DB_FALCON.RAW.CUSTOMER_STAGING
where individual_id is not null
  );
[0m23:44:52.473279 [debug] [Thread-4 (]: Using snowflake connection "model.customer_churn.stg_demographic"
[0m23:44:52.473556 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:44:52.474165 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:44:52.474883 [debug] [Thread-2 (]: Using snowflake connection "model.customer_churn.stg_autoinsurance_churn"
[0m23:44:52.475163 [debug] [Thread-4 (]: On model.customer_churn.stg_demographic: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_demographic"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_demographic
  
   as (
    

select
  individual_id,
  income,
  has_children,
  length_of_residence    as length_of_residence,  -- exact match
  marital_status,
  home_owner,
  home_market_value      as home_market_value,
  college_degree,
  good_credit
from USER_DB_FALCON.RAW.DEMOGRAPHIC_STAGING
  );
[0m23:44:52.477772 [debug] [Thread-2 (]: On model.customer_churn.stg_autoinsurance_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_autoinsurance_churn"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_autoinsurance_churn
  
   as (
    

select
  individual_id,
  churn              as churn_flag
from USER_DB_FALCON.RAW.AUTOINSURANCE_CHURN_STAGING
  );
[0m23:44:52.480318 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:44:52.483378 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:44:53.037164 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.563 seconds
[0m23:44:53.076362 [debug] [Thread-1 (]: On model.customer_churn.stg_address: Close
[0m23:44:53.082664 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.602 seconds
[0m23:44:53.086352 [debug] [Thread-4 (]: On model.customer_churn.stg_demographic: Close
[0m23:44:53.090824 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.617 seconds
[0m23:44:53.094798 [debug] [Thread-3 (]: On model.customer_churn.stg_customer: Close
[0m23:44:53.226818 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f77f0d8-f577-44db-b5d1-8516977e2743', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faeca0bf2c0>]}
[0m23:44:53.229061 [info ] [Thread-3 (]: 3 of 6 OK created sql view model RAW_public.stg_customer ....................... [[32mSUCCESS 1[0m in 0.88s]
[0m23:44:53.231122 [debug] [Thread-3 (]: Finished running node model.customer_churn.stg_customer
[0m23:44:53.232647 [debug] [Thread-3 (]: Began running node model.customer_churn.stg_termination
[0m23:44:53.234239 [info ] [Thread-3 (]: 5 of 6 START sql view model RAW_public.stg_termination ......................... [RUN]
[0m23:44:53.235716 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer_churn.stg_customer, now model.customer_churn.stg_termination)
[0m23:44:53.237180 [debug] [Thread-3 (]: Began compiling node model.customer_churn.stg_termination
[0m23:44:53.244140 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.stg_termination"
[0m23:44:53.268106 [debug] [Thread-3 (]: Began executing node model.customer_churn.stg_termination
[0m23:44:53.277085 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.stg_termination"
[0m23:44:53.295759 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.stg_termination"
[0m23:44:53.297176 [debug] [Thread-3 (]: On model.customer_churn.stg_termination: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_termination"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_termination
  
   as (
    

select
  individual_id,
  acct_suspd_date    as churn_date
from USER_DB_FALCON.RAW.TERMINATION_STAGING
  );
[0m23:44:53.298956 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:44:53.608455 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.125 seconds
[0m23:44:53.611880 [debug] [Thread-2 (]: On model.customer_churn.stg_autoinsurance_churn: Close
[0m23:44:53.857647 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.559 seconds
[0m23:44:53.862543 [debug] [Thread-3 (]: On model.customer_churn.stg_termination: Close
[0m23:44:53.905158 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f77f0d8-f577-44db-b5d1-8516977e2743', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faec9501a30>]}
[0m23:44:53.908889 [info ] [Thread-4 (]: 4 of 6 OK created sql view model RAW_public.stg_demographic .................... [[32mSUCCESS 1[0m in 1.55s]
[0m23:44:53.911019 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f77f0d8-f577-44db-b5d1-8516977e2743', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faeca5f6d80>]}
[0m23:44:53.911651 [debug] [Thread-4 (]: Finished running node model.customer_churn.stg_demographic
[0m23:44:53.914372 [info ] [Thread-1 (]: 1 of 6 OK created sql view model RAW_public.stg_address ........................ [[32mSUCCESS 1[0m in 1.56s]
[0m23:44:53.919442 [debug] [Thread-4 (]: Began running node model.customer_churn.stg_turning_movement
[0m23:44:53.924755 [debug] [Thread-1 (]: Finished running node model.customer_churn.stg_address
[0m23:44:53.926039 [info ] [Thread-4 (]: 6 of 6 START sql view model RAW_public.stg_turning_movement .................... [RUN]
[0m23:44:53.929127 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.customer_churn.stg_demographic, now model.customer_churn.stg_turning_movement)
[0m23:44:53.930068 [debug] [Thread-4 (]: Began compiling node model.customer_churn.stg_turning_movement
[0m23:44:53.935833 [debug] [Thread-4 (]: Writing injected SQL for node "model.customer_churn.stg_turning_movement"
[0m23:44:53.949359 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f77f0d8-f577-44db-b5d1-8516977e2743', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faec96aa210>]}
[0m23:44:53.951211 [info ] [Thread-2 (]: 2 of 6 OK created sql view model RAW_public.stg_autoinsurance_churn ............ [[32mSUCCESS 1[0m in 1.60s]
[0m23:44:53.954814 [debug] [Thread-2 (]: Finished running node model.customer_churn.stg_autoinsurance_churn
[0m23:44:53.965920 [debug] [Thread-4 (]: Began executing node model.customer_churn.stg_turning_movement
[0m23:44:53.969681 [debug] [Thread-4 (]: Writing runtime sql for node "model.customer_churn.stg_turning_movement"
[0m23:44:53.993972 [debug] [Thread-4 (]: Using snowflake connection "model.customer_churn.stg_turning_movement"
[0m23:44:53.994940 [debug] [Thread-4 (]: On model.customer_churn.stg_turning_movement: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_turning_movement"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_turning_movement
  
   as (
    -- models/staging/stg_turning_movement.sql

select
  objectid,
  facilityid,
  intid,
  intname,
  nodeno,
  longitude::float as tm_lon,
  latitude::float  as tm_lat
from USER_DB_FALCON.RAW.TURNING_MOVEMENT
  );
[0m23:44:53.995776 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:44:54.004114 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f77f0d8-f577-44db-b5d1-8516977e2743', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faec95771a0>]}
[0m23:44:54.005197 [info ] [Thread-3 (]: 5 of 6 OK created sql view model RAW_public.stg_termination .................... [[32mSUCCESS 1[0m in 0.77s]
[0m23:44:54.006664 [debug] [Thread-3 (]: Finished running node model.customer_churn.stg_termination
[0m23:44:54.693231 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.697 seconds
[0m23:44:54.696112 [debug] [Thread-4 (]: On model.customer_churn.stg_turning_movement: Close
[0m23:44:54.819935 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f77f0d8-f577-44db-b5d1-8516977e2743', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faec957f0b0>]}
[0m23:44:54.821770 [info ] [Thread-4 (]: 6 of 6 OK created sql view model RAW_public.stg_turning_movement ............... [[32mSUCCESS 1[0m in 0.89s]
[0m23:44:54.823375 [debug] [Thread-4 (]: Finished running node model.customer_churn.stg_turning_movement
[0m23:44:54.829162 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:44:54.836438 [debug] [MainThread]: Connection 'model.customer_churn.stg_address' was properly closed.
[0m23:44:54.842854 [debug] [MainThread]: Connection 'model.customer_churn.stg_autoinsurance_churn' was properly closed.
[0m23:44:54.845779 [debug] [MainThread]: Connection 'model.customer_churn.stg_termination' was properly closed.
[0m23:44:54.847214 [debug] [MainThread]: Connection 'model.customer_churn.stg_turning_movement' was properly closed.
[0m23:44:54.847872 [info ] [MainThread]: 
[0m23:44:54.849884 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 4.54 seconds (4.54s).
[0m23:44:54.851742 [debug] [MainThread]: Command end result
[0m23:44:54.993532 [info ] [MainThread]: 
[0m23:44:54.994560 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:44:54.996242 [info ] [MainThread]: 
[0m23:44:54.998010 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m23:44:55.001963 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.3005757, "process_user_time": 5.563312, "process_kernel_time": 2.843752, "process_mem_max_rss": "242968", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m23:44:55.003645 [debug] [MainThread]: Command `dbt run` succeeded at 23:44:55.003509 after 7.30 seconds
[0m23:44:55.004464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf29799340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf2861dca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf2a7bb1a0>]}
[0m23:44:55.005265 [debug] [MainThread]: Flushing usage events
[0m23:44:59.498216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f3135f560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f312f2b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f3135d370>]}


============================== 23:44:59.507222 | d481c1c7-f490-4c6c-8890-93b662da133a ==============================
[0m23:44:59.507222 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:44:59.508913 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt --select intermediate', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:45:00.683492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd481c1c7-f490-4c6c-8890-93b662da133a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed34470e0>]}
[0m23:45:00.754692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd481c1c7-f490-4c6c-8890-93b662da133a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed33dfad0>]}
[0m23:45:00.756083 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m23:45:00.890004 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:45:01.929169 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:45:01.930214 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:45:01.965420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd481c1c7-f490-4c6c-8890-93b662da133a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed2c1a120>]}
[0m23:45:02.114958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd481c1c7-f490-4c6c-8890-93b662da133a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed2a15a90>]}
[0m23:45:02.117066 [info ] [MainThread]: Found 12 models, 10 data tests, 7 sources, 459 macros
[0m23:45:02.122930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd481c1c7-f490-4c6c-8890-93b662da133a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed844de20>]}
[0m23:45:02.129429 [info ] [MainThread]: 
[0m23:45:02.135259 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:45:02.142058 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON'
[0m23:45:02.173540 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON"
[0m23:45:02.177808 [debug] [ThreadPool]: On list_USER_DB_FALCON: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON"} */
show terse schemas in database USER_DB_FALCON
    limit 10000
[0m23:45:02.185332 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:45:03.740248 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.527 seconds
[0m23:45:03.742366 [debug] [ThreadPool]: On list_USER_DB_FALCON: Close
[0m23:45:03.881181 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON, now list_USER_DB_FALCON_RAW_public)
[0m23:45:03.897292 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m23:45:03.898424 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show terse objects in USER_DB_FALCON.RAW_public limit 10000
[0m23:45:03.899567 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:45:04.290184 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.391 seconds
[0m23:45:04.303553 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m23:45:04.445946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd481c1c7-f490-4c6c-8890-93b662da133a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed2c26360>]}
[0m23:45:04.447831 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:45:04.449690 [info ] [MainThread]: 
[0m23:45:04.470890 [debug] [Thread-1 (]: Began running node model.customer_churn.int_customer_enriched
[0m23:45:04.472833 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW_public.int_customer_enriched ................... [RUN]
[0m23:45:04.474450 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON_RAW_public, now model.customer_churn.int_customer_enriched)
[0m23:45:04.477614 [debug] [Thread-1 (]: Began compiling node model.customer_churn.int_customer_enriched
[0m23:45:04.496948 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.int_customer_enriched"
[0m23:45:04.575742 [debug] [Thread-1 (]: Began executing node model.customer_churn.int_customer_enriched
[0m23:45:04.621589 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.int_customer_enriched"
[0m23:45:04.659467 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.int_customer_enriched"
[0m23:45:04.660668 [debug] [Thread-1 (]: On model.customer_churn.int_customer_enriched: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.int_customer_enriched"} */
create or replace   view USER_DB_FALCON.RAW_public.int_customer_enriched
  
   as (
    

with cust as (
    select
        individual_id,
        annual_premium,
        days_tenure,
        cust_orig_date,
        age_in_years,
        date_of_birth,
        address_id
    from USER_DB_FALCON.RAW_public.stg_customer
),

demo as (
    select
        individual_id,
        has_children,
        length_of_residence,
        marital_status,
        home_owner,
        home_market_value,
        college_degree,
        good_credit
    from USER_DB_FALCON.RAW_public.stg_demographic
),

addr as (
    select
        address_id,
        city,
        state,
        county,
        lat,
        lon
    from USER_DB_FALCON.RAW_public.stg_address
)

select
    cust.individual_id,
    cust.annual_premium,
    cust.days_tenure,
    cust.cust_orig_date,
    cust.age_in_years,
    cust.date_of_birth,
    demo.has_children,
    demo.length_of_residence,
    demo.marital_status,
    demo.home_owner,
    demo.home_market_value,
    addr.city,
    addr.state,
    addr.county,
    addr.lat,
    addr.lon
from cust
left join demo using (individual_id)
left join addr using (address_id)
  );
[0m23:45:04.661739 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:45:06.057908 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.396 seconds
[0m23:45:06.084078 [debug] [Thread-1 (]: On model.customer_churn.int_customer_enriched: Close
[0m23:45:06.267665 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd481c1c7-f490-4c6c-8890-93b662da133a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed2c27da0>]}
[0m23:45:06.269007 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW_public.int_customer_enriched .............. [[32mSUCCESS 1[0m in 1.79s]
[0m23:45:06.270235 [debug] [Thread-1 (]: Finished running node model.customer_churn.int_customer_enriched
[0m23:45:06.272960 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:45:06.274335 [debug] [MainThread]: Connection 'model.customer_churn.int_customer_enriched' was properly closed.
[0m23:45:06.275163 [info ] [MainThread]: 
[0m23:45:06.276140 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.14 seconds (4.14s).
[0m23:45:06.277087 [debug] [MainThread]: Command end result
[0m23:45:06.401647 [info ] [MainThread]: 
[0m23:45:06.402444 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:45:06.403191 [info ] [MainThread]: 
[0m23:45:06.403740 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:45:06.404786 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.111371, "process_user_time": 5.06109, "process_kernel_time": 2.865162, "process_mem_max_rss": "263216", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m23:45:06.405723 [debug] [MainThread]: Command `dbt run` succeeded at 23:45:06.405624 after 6.11 seconds
[0m23:45:06.408503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed2874440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed2875e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed1fe2570>]}
[0m23:45:06.409195 [debug] [MainThread]: Flushing usage events
[0m23:45:10.250098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f827c897fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f827c897aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f827c897860>]}


============================== 23:45:10.258485 | fa84a093-3ad1-4a03-a5cb-42faff15e74c ==============================
[0m23:45:10.258485 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:45:10.259881 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt --select marts', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:45:11.461200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fa84a093-3ad1-4a03-a5cb-42faff15e74c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f821ecd8980>]}
[0m23:45:11.528352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fa84a093-3ad1-4a03-a5cb-42faff15e74c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f821eca58b0>]}
[0m23:45:11.529602 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m23:45:11.633067 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:45:12.669630 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:45:12.670646 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:45:12.708992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa84a093-3ad1-4a03-a5cb-42faff15e74c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f821f41cbf0>]}
[0m23:45:12.984161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fa84a093-3ad1-4a03-a5cb-42faff15e74c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f821e933f50>]}
[0m23:45:12.985381 [info ] [MainThread]: Found 12 models, 10 data tests, 7 sources, 459 macros
[0m23:45:12.986373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa84a093-3ad1-4a03-a5cb-42faff15e74c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f821eabcf50>]}
[0m23:45:12.988910 [info ] [MainThread]: 
[0m23:45:12.990104 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:45:12.994997 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON'
[0m23:45:13.008787 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON"
[0m23:45:13.009853 [debug] [ThreadPool]: On list_USER_DB_FALCON: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON"} */
show terse schemas in database USER_DB_FALCON
    limit 10000
[0m23:45:13.010753 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:45:13.506051 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.495 seconds
[0m23:45:13.509822 [debug] [ThreadPool]: On list_USER_DB_FALCON: Close
[0m23:45:13.636507 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON, now list_USER_DB_FALCON_RAW_public)
[0m23:45:13.653022 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m23:45:13.654488 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show terse objects in USER_DB_FALCON.RAW_public limit 10000
[0m23:45:13.656254 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:45:14.065152 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.409 seconds
[0m23:45:14.068612 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m23:45:14.204686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa84a093-3ad1-4a03-a5cb-42faff15e74c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f821e6fd190>]}
[0m23:45:14.206188 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:45:14.213190 [info ] [MainThread]: 
[0m23:45:14.230922 [debug] [Thread-1 (]: Began running node model.customer_churn.dim_address
[0m23:45:14.231797 [debug] [Thread-2 (]: Began running node model.customer_churn.dim_customer
[0m23:45:14.232591 [debug] [Thread-3 (]: Began running node model.customer_churn.fact_churn
[0m23:45:14.234424 [info ] [Thread-1 (]: 1 of 5 START sql table model RAW_public.dim_address ............................ [RUN]
[0m23:45:14.238504 [info ] [Thread-2 (]: 2 of 5 START sql table model RAW_public.dim_customer ........................... [RUN]
[0m23:45:14.243179 [info ] [Thread-3 (]: 3 of 5 START sql incremental model RAW_public.fact_churn ....................... [RUN]
[0m23:45:14.246345 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON_RAW_public, now model.customer_churn.dim_address)
[0m23:45:14.247759 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.customer_churn.dim_customer'
[0m23:45:14.251505 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.customer_churn.fact_churn'
[0m23:45:14.255202 [debug] [Thread-1 (]: Began compiling node model.customer_churn.dim_address
[0m23:45:14.259164 [debug] [Thread-2 (]: Began compiling node model.customer_churn.dim_customer
[0m23:45:14.263124 [debug] [Thread-3 (]: Began compiling node model.customer_churn.fact_churn
[0m23:45:14.282326 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer_churn.dim_customer"
[0m23:45:14.278779 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.dim_address"
[0m23:45:14.299603 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.fact_churn"
[0m23:45:14.343414 [debug] [Thread-2 (]: Began executing node model.customer_churn.dim_customer
[0m23:45:14.351867 [debug] [Thread-1 (]: Began executing node model.customer_churn.dim_address
[0m23:45:14.360255 [debug] [Thread-3 (]: Began executing node model.customer_churn.fact_churn
[0m23:45:14.440409 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer_churn.dim_customer"
[0m23:45:14.447218 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.dim_address"
[0m23:45:14.463755 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:45:14.464571 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
create or replace  temporary view USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
  
   as (
    -- models/marts/fact_churn.sql


select
  t.individual_id,
  t.churn_date,
  e.city,
  e.state,
  e.county,
  e.age_in_years,
  e.days_tenure,
  e.annual_premium,
  c.churn_flag
from USER_DB_FALCON.RAW_public.stg_termination t
join USER_DB_FALCON.RAW_public.int_customer_enriched e
  using (individual_id)
left join USER_DB_FALCON.RAW_public.stg_autoinsurance_churn c
  using (individual_id)


where t.churn_date > (select max(churn_date) from USER_DB_FALCON.RAW_public.fact_churn)

  );
[0m23:45:14.465230 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:45:14.469621 [debug] [Thread-2 (]: Using snowflake connection "model.customer_churn.dim_customer"
[0m23:45:14.470327 [debug] [Thread-2 (]: On model.customer_churn.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.dim_customer"} */
create or replace transient table USER_DB_FALCON.RAW_public.dim_customer
         as
        (-- models/marts/dim_customer.sql


select distinct
  individual_id,
  age_in_years as age,
  marital_status,
  has_children,
  length_of_residence
from USER_DB_FALCON.RAW_public.int_customer_enriched
        );
[0m23:45:14.470789 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:45:14.472179 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.dim_address"
[0m23:45:14.472959 [debug] [Thread-1 (]: On model.customer_churn.dim_address: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.dim_address"} */
create or replace transient table USER_DB_FALCON.RAW_public.dim_address
         as
        (-- models/marts/dim_address.sql


select distinct
  individual_id,
  city,
  state,
  county,
  lat,
  lon
from USER_DB_FALCON.RAW_public.int_customer_enriched
        );
[0m23:45:14.473266 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:45:15.780979 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.316 seconds
[0m23:45:15.800510 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:45:15.808300 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
[0m23:45:15.904395 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 0.095 seconds
[0m23:45:15.913709 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:45:15.915333 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table USER_DB_FALCON.RAW_public.fact_churn
[0m23:45:16.000454 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 0.084 seconds
[0m23:45:16.009714 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:45:16.011979 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table "USER_DB_FALCON"."RAW_PUBLIC"."FACT_CHURN"
[0m23:45:16.100946 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 0.088 seconds
[0m23:45:16.148607 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.fact_churn"
[0m23:45:16.166708 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:45:16.167860 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
-- back compat for old kwarg name
  
  begin;
[0m23:45:16.382154 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.213 seconds
[0m23:45:16.383369 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:45:16.384596 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
merge into USER_DB_FALCON.RAW_public.fact_churn as DBT_INTERNAL_DEST
        using USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.individual_id = DBT_INTERNAL_DEST.individual_id
                ) and (
                    DBT_INTERNAL_SOURCE.churn_date = DBT_INTERNAL_DEST.churn_date
                )

    
    when matched then update set
        "INDIVIDUAL_ID" = DBT_INTERNAL_SOURCE."INDIVIDUAL_ID","CHURN_DATE" = DBT_INTERNAL_SOURCE."CHURN_DATE","CITY" = DBT_INTERNAL_SOURCE."CITY","STATE" = DBT_INTERNAL_SOURCE."STATE","COUNTY" = DBT_INTERNAL_SOURCE."COUNTY","AGE_IN_YEARS" = DBT_INTERNAL_SOURCE."AGE_IN_YEARS","DAYS_TENURE" = DBT_INTERNAL_SOURCE."DAYS_TENURE","ANNUAL_PREMIUM" = DBT_INTERNAL_SOURCE."ANNUAL_PREMIUM","CHURN_FLAG" = DBT_INTERNAL_SOURCE."CHURN_FLAG"
    

    when not matched then insert
        ("INDIVIDUAL_ID", "CHURN_DATE", "CITY", "STATE", "COUNTY", "AGE_IN_YEARS", "DAYS_TENURE", "ANNUAL_PREMIUM", "CHURN_FLAG")
    values
        ("INDIVIDUAL_ID", "CHURN_DATE", "CITY", "STATE", "COUNTY", "AGE_IN_YEARS", "DAYS_TENURE", "ANNUAL_PREMIUM", "CHURN_FLAG")

;
[0m23:45:17.244842 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 0.859 seconds
[0m23:45:17.249527 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:45:17.250535 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
COMMIT
[0m23:45:17.372703 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.902 seconds
[0m23:45:17.401438 [debug] [Thread-2 (]: On model.customer_churn.dim_customer: Close
[0m23:45:17.431824 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.179 seconds
[0m23:45:17.446189 [debug] [Thread-3 (]: Applying DROP to: USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
[0m23:45:17.457721 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:45:17.458902 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
drop view if exists USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp cascade
[0m23:45:17.544322 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa84a093-3ad1-4a03-a5cb-42faff15e74c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f821ec66ed0>]}
[0m23:45:17.546129 [info ] [Thread-2 (]: 2 of 5 OK created sql table model RAW_public.dim_customer ...................... [[32mSUCCESS 1[0m in 3.29s]
[0m23:45:17.547666 [debug] [Thread-2 (]: Finished running node model.customer_churn.dim_customer
[0m23:45:17.598170 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.138 seconds
[0m23:45:17.602564 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: Close
[0m23:45:17.770739 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa84a093-3ad1-4a03-a5cb-42faff15e74c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f821dbdb8c0>]}
[0m23:45:17.773273 [info ] [Thread-3 (]: 3 of 5 OK created sql incremental model RAW_public.fact_churn .................. [[32mSUCCESS 0[0m in 3.52s]
[0m23:45:17.774983 [debug] [Thread-3 (]: Finished running node model.customer_churn.fact_churn
[0m23:45:17.777154 [debug] [Thread-4 (]: Began running node model.customer_churn.churn_metrics
[0m23:45:17.779730 [info ] [Thread-4 (]: 4 of 5 START sql table model RAW_public.churn_metrics .......................... [RUN]
[0m23:45:17.785938 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.customer_churn.churn_metrics'
[0m23:45:17.787366 [debug] [Thread-4 (]: Began compiling node model.customer_churn.churn_metrics
[0m23:45:17.793458 [debug] [Thread-4 (]: Writing injected SQL for node "model.customer_churn.churn_metrics"
[0m23:45:17.817994 [debug] [Thread-4 (]: Began executing node model.customer_churn.churn_metrics
[0m23:45:17.823367 [debug] [Thread-4 (]: Writing runtime sql for node "model.customer_churn.churn_metrics"
[0m23:45:17.839905 [debug] [Thread-4 (]: Using snowflake connection "model.customer_churn.churn_metrics"
[0m23:45:17.841268 [debug] [Thread-4 (]: On model.customer_churn.churn_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.churn_metrics"} */
create or replace transient table USER_DB_FALCON.RAW_public.churn_metrics
         as
        (with by_tenure as (
    select
        width_bucket(days_tenure, 0, 6000, 6) as period,
        sum(churn_flag) as churn_count,
        width_bucket(days_tenure, 0, 6000, 6) as tenure_bucket_index,
        case
            when days_tenure <= 90 then '0-3 months'
            when days_tenure <= 180 then '4-6 months'
            when days_tenure <= 365 then '7-12 months'
            when days_tenure <= 730 then '13-24 months'
            else '25+ months'
        end as tenure_bucket_label
    from USER_DB_FALCON.RAW_public.fact_churn
    group by 1, 3, 4
)

select 
  cast(period as varchar) as period, 
  churn_count,
  'monthly' as category
from monthly

union all

select 
  cast(period as varchar) as period, 
  churn_count,
  'by_state' as category
from by_state

union all

select 
  cast(period as varchar) as period, 
  churn_count,
  'by_age' as category
from by_age

union all

select 
  cast(period as varchar) as period, 
  churn_count,
  'by_tenure' as category
from by_tenure

union all

select 
  cast(period as varchar) as period, 
  churn_count,
  'by_premium' as category
from by_premium
        );
[0m23:45:17.842998 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:45:18.624392 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.151 seconds
[0m23:45:18.627348 [debug] [Thread-1 (]: On model.customer_churn.dim_address: Close
[0m23:45:18.772943 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa84a093-3ad1-4a03-a5cb-42faff15e74c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f821dd09e20>]}
[0m23:45:18.775379 [info ] [Thread-1 (]: 1 of 5 OK created sql table model RAW_public.dim_address ....................... [[32mSUCCESS 1[0m in 4.53s]
[0m23:45:18.777209 [debug] [Thread-1 (]: Finished running node model.customer_churn.dim_address
[0m23:45:18.779496 [debug] [Thread-3 (]: Began running node model.customer_churn.churn_map
[0m23:45:18.780882 [info ] [Thread-3 (]: 5 of 5 START sql table model RAW_public.churn_map .............................. [RUN]
[0m23:45:18.782247 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer_churn.fact_churn, now model.customer_churn.churn_map)
[0m23:45:18.783303 [debug] [Thread-3 (]: Began compiling node model.customer_churn.churn_map
[0m23:45:18.791264 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.churn_map"
[0m23:45:18.814283 [debug] [Thread-3 (]: Began executing node model.customer_churn.churn_map
[0m23:45:18.821405 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.churn_map"
[0m23:45:18.847041 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.churn_map"
[0m23:45:18.849195 [debug] [Thread-3 (]: On model.customer_churn.churn_map: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.churn_map"} */
create or replace transient table USER_DB_FALCON.RAW_public.churn_map
         as
        (-- models/marts/churn_map.sql


select
  f.individual_id,
  f.churn_date,
  f.churn_flag,
  a.lon,
  a.lat
from USER_DB_FALCON.RAW_public.fact_churn      as f
join USER_DB_FALCON.RAW_public.dim_address    as a
  using (individual_id)
        );
[0m23:45:18.850898 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:45:18.946041 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01bc27b1-0305-27c4-0004-59ff003c8066
[0m23:45:18.949723 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'MONTHLY' does not exist or not authorized.
[0m23:45:18.952432 [debug] [Thread-4 (]: On model.customer_churn.churn_metrics: Close
[0m23:45:19.140928 [debug] [Thread-4 (]: Database Error in model churn_metrics (models/marts/churn_metrics.sql)
  002003 (42S02): SQL compilation error:
  Object 'MONTHLY' does not exist or not authorized.
  compiled code at target/run/customer_churn/models/marts/churn_metrics.sql
[0m23:45:19.142711 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa84a093-3ad1-4a03-a5cb-42faff15e74c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f821e976510>]}
[0m23:45:19.144614 [error] [Thread-4 (]: 4 of 5 ERROR creating sql table model RAW_public.churn_metrics ................. [[31mERROR[0m in 1.36s]
[0m23:45:19.146413 [debug] [Thread-4 (]: Finished running node model.customer_churn.churn_metrics
[0m23:45:20.316508 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.466 seconds
[0m23:45:20.320462 [debug] [Thread-3 (]: On model.customer_churn.churn_map: Close
[0m23:45:20.464654 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa84a093-3ad1-4a03-a5cb-42faff15e74c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f821dc82120>]}
[0m23:45:20.466501 [info ] [Thread-3 (]: 5 of 5 OK created sql table model RAW_public.churn_map ......................... [[32mSUCCESS 1[0m in 1.68s]
[0m23:45:20.470186 [debug] [Thread-3 (]: Finished running node model.customer_churn.churn_map
[0m23:45:20.474476 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:45:20.476121 [debug] [MainThread]: Connection 'model.customer_churn.dim_address' was properly closed.
[0m23:45:20.479985 [debug] [MainThread]: Connection 'model.customer_churn.dim_customer' was properly closed.
[0m23:45:20.481863 [debug] [MainThread]: Connection 'model.customer_churn.churn_map' was properly closed.
[0m23:45:20.483807 [debug] [MainThread]: Connection 'model.customer_churn.churn_metrics' was properly closed.
[0m23:45:20.486166 [info ] [MainThread]: 
[0m23:45:20.489421 [info ] [MainThread]: Finished running 4 table models, 1 incremental model in 0 hours 0 minutes and 7.50 seconds (7.50s).
[0m23:45:20.493567 [debug] [MainThread]: Command end result
[0m23:45:20.637993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04d414e4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04d6b80050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04d4b9da30>]}


============================== 23:45:20.646116 | caa76c6c-d396-424c-a7f7-075a76c6ffdf ==============================
[0m23:45:20.646116 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:45:20.650368 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt --select marts', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:45:20.685376 [info ] [MainThread]: 
[0m23:45:20.686575 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:45:20.687710 [info ] [MainThread]: 
[0m23:45:20.688784 [error] [MainThread]:   Database Error in model churn_metrics (models/marts/churn_metrics.sql)
  002003 (42S02): SQL compilation error:
  Object 'MONTHLY' does not exist or not authorized.
  compiled code at target/run/customer_churn/models/marts/churn_metrics.sql
[0m23:45:20.689785 [info ] [MainThread]: 
[0m23:45:20.690806 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m23:45:20.692161 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 10.528385, "process_user_time": 5.262864, "process_kernel_time": 2.845073, "process_mem_max_rss": "274628", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m23:45:20.693298 [debug] [MainThread]: Command `dbt run` failed at 23:45:20.693152 after 10.53 seconds
[0m23:45:20.694223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f821eca70b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f827ffdc710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f827cb72b70>]}
[0m23:45:20.695208 [debug] [MainThread]: Flushing usage events
[0m23:45:21.908131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'caa76c6c-d396-424c-a7f7-075a76c6ffdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04d5672870>]}
[0m23:45:21.977380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'caa76c6c-d396-424c-a7f7-075a76c6ffdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04d43486b0>]}
[0m23:45:21.979774 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m23:45:22.099640 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:45:23.145592 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:45:23.146771 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:45:23.218819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'caa76c6c-d396-424c-a7f7-075a76c6ffdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04761cd100>]}
[0m23:45:23.479656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'caa76c6c-d396-424c-a7f7-075a76c6ffdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0475ef0f20>]}
[0m23:45:23.480788 [info ] [MainThread]: Found 12 models, 10 data tests, 7 sources, 459 macros
[0m23:45:23.481823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'caa76c6c-d396-424c-a7f7-075a76c6ffdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04765bf740>]}
[0m23:45:23.488319 [info ] [MainThread]: 
[0m23:45:23.489439 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:45:23.495953 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON'
[0m23:45:23.524002 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON"
[0m23:45:23.525311 [debug] [ThreadPool]: On list_USER_DB_FALCON: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON"} */
show terse schemas in database USER_DB_FALCON
    limit 10000
[0m23:45:23.526466 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:45:24.336086 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.809 seconds
[0m23:45:24.338772 [debug] [ThreadPool]: On list_USER_DB_FALCON: Close
[0m23:45:24.460665 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON, now list_USER_DB_FALCON_RAW_public)
[0m23:45:24.477212 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m23:45:24.478745 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show terse objects in USER_DB_FALCON.RAW_public limit 10000
[0m23:45:24.479937 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:45:24.882594 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.403 seconds
[0m23:45:24.886220 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m23:45:25.027537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'caa76c6c-d396-424c-a7f7-075a76c6ffdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f047c278830>]}
[0m23:45:25.029145 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:45:25.033159 [info ] [MainThread]: 
[0m23:45:25.048122 [debug] [Thread-1 (]: Began running node model.customer_churn.dim_address
[0m23:45:25.048674 [debug] [Thread-2 (]: Began running node model.customer_churn.dim_customer
[0m23:45:25.049220 [debug] [Thread-3 (]: Began running node model.customer_churn.fact_churn
[0m23:45:25.052846 [info ] [Thread-1 (]: 1 of 5 START sql table model RAW_public.dim_address ............................ [RUN]
[0m23:45:25.056233 [info ] [Thread-2 (]: 2 of 5 START sql table model RAW_public.dim_customer ........................... [RUN]
[0m23:45:25.062331 [info ] [Thread-3 (]: 3 of 5 START sql incremental model RAW_public.fact_churn ....................... [RUN]
[0m23:45:25.065150 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON_RAW_public, now model.customer_churn.dim_address)
[0m23:45:25.070331 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.customer_churn.dim_customer'
[0m23:45:25.072657 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.customer_churn.fact_churn'
[0m23:45:25.075754 [debug] [Thread-1 (]: Began compiling node model.customer_churn.dim_address
[0m23:45:25.077158 [debug] [Thread-2 (]: Began compiling node model.customer_churn.dim_customer
[0m23:45:25.080655 [debug] [Thread-3 (]: Began compiling node model.customer_churn.fact_churn
[0m23:45:25.097742 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.dim_address"
[0m23:45:25.101975 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer_churn.dim_customer"
[0m23:45:25.125278 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.fact_churn"
[0m23:45:25.144869 [debug] [Thread-3 (]: Began executing node model.customer_churn.fact_churn
[0m23:45:25.151302 [debug] [Thread-2 (]: Began executing node model.customer_churn.dim_customer
[0m23:45:25.178577 [debug] [Thread-1 (]: Began executing node model.customer_churn.dim_address
[0m23:45:25.193942 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer_churn.dim_customer"
[0m23:45:25.196443 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.dim_address"
[0m23:45:25.204416 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:45:25.205925 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
create or replace  temporary view USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
  
   as (
    -- models/marts/fact_churn.sql


select
  t.individual_id,
  t.churn_date,
  e.city,
  e.state,
  e.county,
  e.age_in_years,
  e.days_tenure,
  e.annual_premium,
  c.churn_flag
from USER_DB_FALCON.RAW_public.stg_termination t
join USER_DB_FALCON.RAW_public.int_customer_enriched e
  using (individual_id)
left join USER_DB_FALCON.RAW_public.stg_autoinsurance_churn c
  using (individual_id)


where t.churn_date > (select max(churn_date) from USER_DB_FALCON.RAW_public.fact_churn)

  );
[0m23:45:25.206439 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:45:25.210724 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.dim_address"
[0m23:45:25.211652 [debug] [Thread-1 (]: On model.customer_churn.dim_address: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.dim_address"} */
create or replace transient table USER_DB_FALCON.RAW_public.dim_address
         as
        (-- models/marts/dim_address.sql


select distinct
  individual_id,
  city,
  state,
  county,
  lat,
  lon
from USER_DB_FALCON.RAW_public.int_customer_enriched
        );
[0m23:45:25.212334 [debug] [Thread-2 (]: Using snowflake connection "model.customer_churn.dim_customer"
[0m23:45:25.212979 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:45:25.213587 [debug] [Thread-2 (]: On model.customer_churn.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.dim_customer"} */
create or replace transient table USER_DB_FALCON.RAW_public.dim_customer
         as
        (-- models/marts/dim_customer.sql


select distinct
  individual_id,
  age_in_years as age,
  marital_status,
  has_children,
  length_of_residence
from USER_DB_FALCON.RAW_public.int_customer_enriched
        );
[0m23:45:25.215570 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:45:26.031106 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.824 seconds
[0m23:45:26.042583 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:45:26.046580 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
[0m23:45:26.167893 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 0.120 seconds
[0m23:45:26.172727 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:45:26.174590 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table USER_DB_FALCON.RAW_public.fact_churn
[0m23:45:26.276698 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 0.101 seconds
[0m23:45:26.292552 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:45:26.295463 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table "USER_DB_FALCON"."RAW_PUBLIC"."FACT_CHURN"
[0m23:45:26.407511 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 0.110 seconds
[0m23:45:26.438248 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.fact_churn"
[0m23:45:26.488316 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:45:26.490238 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
-- back compat for old kwarg name
  
  begin;
[0m23:45:26.611207 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.120 seconds
[0m23:45:26.613233 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:45:26.614985 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
merge into USER_DB_FALCON.RAW_public.fact_churn as DBT_INTERNAL_DEST
        using USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.individual_id = DBT_INTERNAL_DEST.individual_id
                ) and (
                    DBT_INTERNAL_SOURCE.churn_date = DBT_INTERNAL_DEST.churn_date
                )

    
    when matched then update set
        "INDIVIDUAL_ID" = DBT_INTERNAL_SOURCE."INDIVIDUAL_ID","CHURN_DATE" = DBT_INTERNAL_SOURCE."CHURN_DATE","CITY" = DBT_INTERNAL_SOURCE."CITY","STATE" = DBT_INTERNAL_SOURCE."STATE","COUNTY" = DBT_INTERNAL_SOURCE."COUNTY","AGE_IN_YEARS" = DBT_INTERNAL_SOURCE."AGE_IN_YEARS","DAYS_TENURE" = DBT_INTERNAL_SOURCE."DAYS_TENURE","ANNUAL_PREMIUM" = DBT_INTERNAL_SOURCE."ANNUAL_PREMIUM","CHURN_FLAG" = DBT_INTERNAL_SOURCE."CHURN_FLAG"
    

    when not matched then insert
        ("INDIVIDUAL_ID", "CHURN_DATE", "CITY", "STATE", "COUNTY", "AGE_IN_YEARS", "DAYS_TENURE", "ANNUAL_PREMIUM", "CHURN_FLAG")
    values
        ("INDIVIDUAL_ID", "CHURN_DATE", "CITY", "STATE", "COUNTY", "AGE_IN_YEARS", "DAYS_TENURE", "ANNUAL_PREMIUM", "CHURN_FLAG")

;
[0m23:45:27.353566 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 0.736 seconds
[0m23:45:27.355407 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:45:27.356621 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
COMMIT
[0m23:45:27.534979 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.177 seconds
[0m23:45:27.545741 [debug] [Thread-3 (]: Applying DROP to: USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
[0m23:45:27.553141 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:45:27.554191 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
drop view if exists USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp cascade
[0m23:45:27.668324 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.113 seconds
[0m23:45:27.706479 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: Close
[0m23:45:28.237399 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.022 seconds
[0m23:45:28.247093 [debug] [Thread-2 (]: On model.customer_churn.dim_customer: Close
[0m23:45:28.386179 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'caa76c6c-d396-424c-a7f7-075a76c6ffdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04d497daf0>]}
[0m23:45:28.387795 [info ] [Thread-2 (]: 2 of 5 OK created sql table model RAW_public.dim_customer ...................... [[32mSUCCESS 1[0m in 3.32s]
[0m23:45:28.389338 [debug] [Thread-2 (]: Finished running node model.customer_churn.dim_customer
[0m23:45:28.451365 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'caa76c6c-d396-424c-a7f7-075a76c6ffdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0475421af0>]}
[0m23:45:28.453154 [info ] [Thread-3 (]: 3 of 5 OK created sql incremental model RAW_public.fact_churn .................. [[32mSUCCESS 0[0m in 3.38s]
[0m23:45:28.454807 [debug] [Thread-3 (]: Finished running node model.customer_churn.fact_churn
[0m23:45:28.457330 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.244 seconds
[0m23:45:28.458347 [debug] [Thread-4 (]: Began running node model.customer_churn.churn_metrics
[0m23:45:28.461539 [debug] [Thread-1 (]: On model.customer_churn.dim_address: Close
[0m23:45:28.462770 [info ] [Thread-4 (]: 4 of 5 START sql table model RAW_public.churn_metrics .......................... [RUN]
[0m23:45:28.465555 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.customer_churn.churn_metrics'
[0m23:45:28.466758 [debug] [Thread-4 (]: Began compiling node model.customer_churn.churn_metrics
[0m23:45:28.471045 [debug] [Thread-4 (]: Writing injected SQL for node "model.customer_churn.churn_metrics"
[0m23:45:28.489974 [debug] [Thread-4 (]: Began executing node model.customer_churn.churn_metrics
[0m23:45:28.494985 [debug] [Thread-4 (]: Writing runtime sql for node "model.customer_churn.churn_metrics"
[0m23:45:28.514266 [debug] [Thread-4 (]: Using snowflake connection "model.customer_churn.churn_metrics"
[0m23:45:28.515248 [debug] [Thread-4 (]: On model.customer_churn.churn_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.churn_metrics"} */
create or replace transient table USER_DB_FALCON.RAW_public.churn_metrics
         as
        (with by_tenure as (
    select
        width_bucket(days_tenure, 0, 6000, 6) as period,
        sum(churn_flag) as churn_count,
        width_bucket(days_tenure, 0, 6000, 6) as tenure_bucket_index,
        case
            when days_tenure <= 90 then '0-3 months'
            when days_tenure <= 180 then '4-6 months'
            when days_tenure <= 365 then '7-12 months'
            when days_tenure <= 730 then '13-24 months'
            else '25+ months'
        end as tenure_bucket_label
    from USER_DB_FALCON.RAW_public.fact_churn
    group by 1, 3, 4
)

select 
  cast(period as varchar) as period, 
  churn_count,
  'monthly' as category
from monthly

union all

select 
  cast(period as varchar) as period, 
  churn_count,
  'by_state' as category
from by_state

union all

select 
  cast(period as varchar) as period, 
  churn_count,
  'by_age' as category
from by_age

union all

select 
  cast(period as varchar) as period, 
  churn_count,
  'by_tenure' as category
from by_tenure

union all

select 
  cast(period as varchar) as period, 
  churn_count,
  'by_premium' as category
from by_premium
        );
[0m23:45:28.516177 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:45:28.598594 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'caa76c6c-d396-424c-a7f7-075a76c6ffdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0475420aa0>]}
[0m23:45:28.600135 [info ] [Thread-1 (]: 1 of 5 OK created sql table model RAW_public.dim_address ....................... [[32mSUCCESS 1[0m in 3.53s]
[0m23:45:28.600895 [debug] [Thread-1 (]: Finished running node model.customer_churn.dim_address
[0m23:45:28.601843 [debug] [Thread-3 (]: Began running node model.customer_churn.churn_map
[0m23:45:28.613487 [info ] [Thread-3 (]: 5 of 5 START sql table model RAW_public.churn_map .............................. [RUN]
[0m23:45:28.616190 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer_churn.fact_churn, now model.customer_churn.churn_map)
[0m23:45:28.617345 [debug] [Thread-3 (]: Began compiling node model.customer_churn.churn_map
[0m23:45:28.623713 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.churn_map"
[0m23:45:28.670654 [debug] [Thread-3 (]: Began executing node model.customer_churn.churn_map
[0m23:45:28.675465 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.churn_map"
[0m23:45:28.738092 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.churn_map"
[0m23:45:28.745181 [debug] [Thread-3 (]: On model.customer_churn.churn_map: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.churn_map"} */
create or replace transient table USER_DB_FALCON.RAW_public.churn_map
         as
        (-- models/marts/churn_map.sql


select
  f.individual_id,
  f.churn_date,
  f.churn_flag,
  a.lon,
  a.lat
from USER_DB_FALCON.RAW_public.fact_churn      as f
join USER_DB_FALCON.RAW_public.dim_address    as a
  using (individual_id)
        );
[0m23:45:28.750577 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:45:29.076750 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01bc27b1-0305-1c2f-0004-59ff003c165e
[0m23:45:29.078482 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'MONTHLY' does not exist or not authorized.
[0m23:45:29.080540 [debug] [Thread-4 (]: On model.customer_churn.churn_metrics: Close
[0m23:45:29.195934 [debug] [Thread-4 (]: Database Error in model churn_metrics (models/marts/churn_metrics.sql)
  002003 (42S02): SQL compilation error:
  Object 'MONTHLY' does not exist or not authorized.
  compiled code at target/run/customer_churn/models/marts/churn_metrics.sql
[0m23:45:29.200512 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'caa76c6c-d396-424c-a7f7-075a76c6ffdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04753d6d20>]}
[0m23:45:29.204784 [error] [Thread-4 (]: 4 of 5 ERROR creating sql table model RAW_public.churn_metrics ................. [[31mERROR[0m in 0.74s]
[0m23:45:29.210544 [debug] [Thread-4 (]: Finished running node model.customer_churn.churn_metrics
[0m23:45:30.281368 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.531 seconds
[0m23:45:30.289801 [debug] [Thread-3 (]: On model.customer_churn.churn_map: Close
[0m23:45:30.442044 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'caa76c6c-d396-424c-a7f7-075a76c6ffdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0475440530>]}
[0m23:45:30.466429 [info ] [Thread-3 (]: 5 of 5 OK created sql table model RAW_public.churn_map ......................... [[32mSUCCESS 1[0m in 1.83s]
[0m23:45:30.476549 [debug] [Thread-3 (]: Finished running node model.customer_churn.churn_map
[0m23:45:30.479360 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:45:30.481891 [debug] [MainThread]: Connection 'model.customer_churn.dim_address' was properly closed.
[0m23:45:30.482635 [debug] [MainThread]: Connection 'model.customer_churn.dim_customer' was properly closed.
[0m23:45:30.484449 [debug] [MainThread]: Connection 'model.customer_churn.churn_map' was properly closed.
[0m23:45:30.485854 [debug] [MainThread]: Connection 'model.customer_churn.churn_metrics' was properly closed.
[0m23:45:30.488368 [info ] [MainThread]: 
[0m23:45:30.490264 [info ] [MainThread]: Finished running 4 table models, 1 incremental model in 0 hours 0 minutes and 7.00 seconds (7.00s).
[0m23:45:30.495389 [debug] [MainThread]: Command end result
[0m23:45:30.674767 [info ] [MainThread]: 
[0m23:45:30.676739 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:45:30.680442 [info ] [MainThread]: 
[0m23:45:30.684000 [error] [MainThread]:   Database Error in model churn_metrics (models/marts/churn_metrics.sql)
  002003 (42S02): SQL compilation error:
  Object 'MONTHLY' does not exist or not authorized.
  compiled code at target/run/customer_churn/models/marts/churn_metrics.sql
[0m23:45:30.689768 [info ] [MainThread]: 
[0m23:45:30.693902 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m23:45:30.698886 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 10.209043, "process_user_time": 6.223081, "process_kernel_time": 2.831501, "process_mem_max_rss": "276932", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m23:45:30.700384 [debug] [MainThread]: Command `dbt run` failed at 23:45:30.700128 after 10.21 seconds
[0m23:45:30.702569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04d6b80050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0475e6f200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0475e6fbc0>]}
[0m23:45:30.705687 [debug] [MainThread]: Flushing usage events
[0m23:47:04.830965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb30a20680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb30debcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb30a20500>]}


============================== 23:47:04.861074 | 54385360-eb8d-42ea-a0b5-e299c0d7fe57 ==============================
[0m23:47:04.861074 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:47:04.862092 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt --select marts', 'send_anonymous_usage_stats': 'True'}
[0m23:47:06.093724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '54385360-eb8d-42ea-a0b5-e299c0d7fe57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbad2ff1d30>]}
[0m23:47:06.156637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '54385360-eb8d-42ea-a0b5-e299c0d7fe57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb30a47ec0>]}
[0m23:47:06.158304 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m23:47:06.280540 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:47:07.164657 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:47:07.165983 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:47:07.367477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '54385360-eb8d-42ea-a0b5-e299c0d7fe57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb30a20bc0>]}
[0m23:47:08.730244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '54385360-eb8d-42ea-a0b5-e299c0d7fe57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbad2ea0110>]}
[0m23:47:08.732162 [info ] [MainThread]: Found 12 models, 10 data tests, 7 sources, 459 macros
[0m23:47:08.733243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54385360-eb8d-42ea-a0b5-e299c0d7fe57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbad3970cb0>]}
[0m23:47:08.737054 [info ] [MainThread]: 
[0m23:47:08.738473 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:47:08.744965 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON'
[0m23:47:08.778880 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON"
[0m23:47:08.780607 [debug] [ThreadPool]: On list_USER_DB_FALCON: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON"} */
show terse schemas in database USER_DB_FALCON
    limit 10000
[0m23:47:08.781682 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:47:09.379493 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.598 seconds
[0m23:47:09.387932 [debug] [ThreadPool]: On list_USER_DB_FALCON: Close
[0m23:47:09.548390 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON, now list_USER_DB_FALCON_RAW_public)
[0m23:47:09.556553 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m23:47:09.557657 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show terse objects in USER_DB_FALCON.RAW_public limit 10000
[0m23:47:09.558637 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:47:10.020738 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.462 seconds
[0m23:47:10.023532 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m23:47:10.175380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54385360-eb8d-42ea-a0b5-e299c0d7fe57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbad321f080>]}
[0m23:47:10.177857 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:47:10.180183 [info ] [MainThread]: 
[0m23:47:10.196318 [debug] [Thread-1 (]: Began running node model.customer_churn.dim_address
[0m23:47:10.197205 [debug] [Thread-2 (]: Began running node model.customer_churn.dim_customer
[0m23:47:10.197666 [debug] [Thread-3 (]: Began running node model.customer_churn.fact_churn
[0m23:47:10.199612 [info ] [Thread-1 (]: 1 of 5 START sql table model RAW_public.dim_address ............................ [RUN]
[0m23:47:10.201458 [info ] [Thread-2 (]: 2 of 5 START sql table model RAW_public.dim_customer ........................... [RUN]
[0m23:47:10.207098 [info ] [Thread-3 (]: 3 of 5 START sql incremental model RAW_public.fact_churn ....................... [RUN]
[0m23:47:10.208857 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON_RAW_public, now model.customer_churn.dim_address)
[0m23:47:10.209874 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.customer_churn.dim_customer'
[0m23:47:10.210674 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.customer_churn.fact_churn'
[0m23:47:10.211519 [debug] [Thread-1 (]: Began compiling node model.customer_churn.dim_address
[0m23:47:10.212522 [debug] [Thread-2 (]: Began compiling node model.customer_churn.dim_customer
[0m23:47:10.213292 [debug] [Thread-3 (]: Began compiling node model.customer_churn.fact_churn
[0m23:47:10.222059 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.dim_address"
[0m23:47:10.224833 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer_churn.dim_customer"
[0m23:47:10.236351 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.fact_churn"
[0m23:47:10.246395 [debug] [Thread-3 (]: Began executing node model.customer_churn.fact_churn
[0m23:47:10.253176 [debug] [Thread-2 (]: Began executing node model.customer_churn.dim_customer
[0m23:47:10.264857 [debug] [Thread-1 (]: Began executing node model.customer_churn.dim_address
[0m23:47:10.338809 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.dim_address"
[0m23:47:10.350171 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer_churn.dim_customer"
[0m23:47:10.362409 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:47:10.363394 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
create or replace  temporary view USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
  
   as (
    -- models/marts/fact_churn.sql


select
  t.individual_id,
  t.churn_date,
  e.city,
  e.state,
  e.county,
  e.age_in_years,
  e.days_tenure,
  e.annual_premium,
  c.churn_flag
from USER_DB_FALCON.RAW_public.stg_termination t
join USER_DB_FALCON.RAW_public.int_customer_enriched e
  using (individual_id)
left join USER_DB_FALCON.RAW_public.stg_autoinsurance_churn c
  using (individual_id)


where t.churn_date > (select max(churn_date) from USER_DB_FALCON.RAW_public.fact_churn)

  );
[0m23:47:10.364598 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.dim_address"
[0m23:47:10.365198 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:47:10.365921 [debug] [Thread-1 (]: On model.customer_churn.dim_address: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.dim_address"} */
create or replace transient table USER_DB_FALCON.RAW_public.dim_address
         as
        (-- models/marts/dim_address.sql


select distinct
  individual_id,
  city,
  state,
  county,
  lat,
  lon
from USER_DB_FALCON.RAW_public.int_customer_enriched
        );
[0m23:47:10.368611 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:47:10.369482 [debug] [Thread-2 (]: Using snowflake connection "model.customer_churn.dim_customer"
[0m23:47:10.371502 [debug] [Thread-2 (]: On model.customer_churn.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.dim_customer"} */
create or replace transient table USER_DB_FALCON.RAW_public.dim_customer
         as
        (-- models/marts/dim_customer.sql


select distinct
  individual_id,
  age_in_years as age,
  marital_status,
  has_children,
  length_of_residence
from USER_DB_FALCON.RAW_public.int_customer_enriched
        );
[0m23:47:10.372071 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:47:11.224048 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.859 seconds
[0m23:47:11.239879 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:47:11.242124 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
[0m23:47:11.354593 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 0.111 seconds
[0m23:47:11.363448 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:47:11.365654 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table USER_DB_FALCON.RAW_public.fact_churn
[0m23:47:11.479505 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 0.112 seconds
[0m23:47:11.495952 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:47:11.498449 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table "USER_DB_FALCON"."RAW_PUBLIC"."FACT_CHURN"
[0m23:47:11.578364 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 0.078 seconds
[0m23:47:11.618839 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.fact_churn"
[0m23:47:11.641766 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:47:11.642680 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
-- back compat for old kwarg name
  
  begin;
[0m23:47:11.747429 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.104 seconds
[0m23:47:11.748195 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:47:11.748928 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
merge into USER_DB_FALCON.RAW_public.fact_churn as DBT_INTERNAL_DEST
        using USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.individual_id = DBT_INTERNAL_DEST.individual_id
                ) and (
                    DBT_INTERNAL_SOURCE.churn_date = DBT_INTERNAL_DEST.churn_date
                )

    
    when matched then update set
        "INDIVIDUAL_ID" = DBT_INTERNAL_SOURCE."INDIVIDUAL_ID","CHURN_DATE" = DBT_INTERNAL_SOURCE."CHURN_DATE","CITY" = DBT_INTERNAL_SOURCE."CITY","STATE" = DBT_INTERNAL_SOURCE."STATE","COUNTY" = DBT_INTERNAL_SOURCE."COUNTY","AGE_IN_YEARS" = DBT_INTERNAL_SOURCE."AGE_IN_YEARS","DAYS_TENURE" = DBT_INTERNAL_SOURCE."DAYS_TENURE","ANNUAL_PREMIUM" = DBT_INTERNAL_SOURCE."ANNUAL_PREMIUM","CHURN_FLAG" = DBT_INTERNAL_SOURCE."CHURN_FLAG"
    

    when not matched then insert
        ("INDIVIDUAL_ID", "CHURN_DATE", "CITY", "STATE", "COUNTY", "AGE_IN_YEARS", "DAYS_TENURE", "ANNUAL_PREMIUM", "CHURN_FLAG")
    values
        ("INDIVIDUAL_ID", "CHURN_DATE", "CITY", "STATE", "COUNTY", "AGE_IN_YEARS", "DAYS_TENURE", "ANNUAL_PREMIUM", "CHURN_FLAG")

;
[0m23:47:12.747828 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 0.997 seconds
[0m23:47:12.749922 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:47:12.751429 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
COMMIT
[0m23:47:12.875539 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.123 seconds
[0m23:47:12.886263 [debug] [Thread-3 (]: Applying DROP to: USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
[0m23:47:12.894404 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:47:12.899016 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
drop view if exists USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp cascade
[0m23:47:13.037416 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.137 seconds
[0m23:47:13.059917 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: Close
[0m23:47:13.196293 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54385360-eb8d-42ea-a0b5-e299c0d7fe57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb3161dbe0>]}
[0m23:47:13.198103 [info ] [Thread-3 (]: 3 of 5 OK created sql incremental model RAW_public.fact_churn .................. [[32mSUCCESS 0[0m in 2.98s]
[0m23:47:13.199965 [debug] [Thread-3 (]: Finished running node model.customer_churn.fact_churn
[0m23:47:13.201972 [debug] [Thread-4 (]: Began running node model.customer_churn.churn_metrics
[0m23:47:13.203313 [info ] [Thread-4 (]: 4 of 5 START sql table model RAW_public.churn_metrics .......................... [RUN]
[0m23:47:13.204732 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.customer_churn.churn_metrics'
[0m23:47:13.205920 [debug] [Thread-4 (]: Began compiling node model.customer_churn.churn_metrics
[0m23:47:13.213622 [debug] [Thread-4 (]: Writing injected SQL for node "model.customer_churn.churn_metrics"
[0m23:47:13.231013 [debug] [Thread-4 (]: Began executing node model.customer_churn.churn_metrics
[0m23:47:13.236626 [debug] [Thread-4 (]: Writing runtime sql for node "model.customer_churn.churn_metrics"
[0m23:47:13.290679 [debug] [Thread-4 (]: Using snowflake connection "model.customer_churn.churn_metrics"
[0m23:47:13.292337 [debug] [Thread-4 (]: On model.customer_churn.churn_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.churn_metrics"} */
create or replace transient table USER_DB_FALCON.RAW_public.churn_metrics
         as
        (with by_tenure as (
    select
        width_bucket(days_tenure, 0, 6000, 6) as period,
        sum(churn_flag) as churn_count,
        width_bucket(days_tenure, 0, 6000, 6) as tenure_bucket_index,
        case
            when days_tenure <= 90 then '0-3 months'
            when days_tenure <= 180 then '4-6 months'
            when days_tenure <= 365 then '7-12 months'
            when days_tenure <= 730 then '13-24 months'
            else '25+ months'
        end as tenure_bucket_label
    from USER_DB_FALCON.RAW_public.fact_churn
    group by 1, 3, 4
)

select 
  cast(period as varchar) as period, 
  churn_count,
  'monthly' as category
from monthly

union all

select 
  cast(period as varchar) as period, 
  churn_count,
  'by_state' as category
from by_state

union all

select 
  cast(period as varchar) as period, 
  churn_count,
  'by_age' as category
from by_age

union all

select 
  cast(period as varchar) as period, 
  churn_count,
  'by_tenure' as category
from by_tenure

union all

select 
  cast(period as varchar) as period, 
  churn_count,
  'by_premium' as category
from by_premium
        );
[0m23:47:13.293840 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:47:13.672051 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01bc27b3-0305-27bc-0004-59ff003c260e
[0m23:47:13.673186 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'MONTHLY' does not exist or not authorized.
[0m23:47:13.674532 [debug] [Thread-4 (]: On model.customer_churn.churn_metrics: Close
[0m23:47:13.808056 [debug] [Thread-4 (]: Database Error in model churn_metrics (models/marts/churn_metrics.sql)
  002003 (42S02): SQL compilation error:
  Object 'MONTHLY' does not exist or not authorized.
  compiled code at target/run/customer_churn/models/marts/churn_metrics.sql
[0m23:47:13.809566 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54385360-eb8d-42ea-a0b5-e299c0d7fe57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbad21713a0>]}
[0m23:47:13.811464 [error] [Thread-4 (]: 4 of 5 ERROR creating sql table model RAW_public.churn_metrics ................. [[31mERROR[0m in 0.60s]
[0m23:47:13.813627 [debug] [Thread-4 (]: Finished running node model.customer_churn.churn_metrics
[0m23:47:13.846832 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.475 seconds
[0m23:47:13.857160 [debug] [Thread-2 (]: On model.customer_churn.dim_customer: Close
[0m23:47:14.021136 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54385360-eb8d-42ea-a0b5-e299c0d7fe57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbad210f1d0>]}
[0m23:47:14.022857 [info ] [Thread-2 (]: 2 of 5 OK created sql table model RAW_public.dim_customer ...................... [[32mSUCCESS 1[0m in 3.81s]
[0m23:47:14.024459 [debug] [Thread-2 (]: Finished running node model.customer_churn.dim_customer
[0m23:47:14.107624 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.739 seconds
[0m23:47:14.112871 [debug] [Thread-1 (]: On model.customer_churn.dim_address: Close
[0m23:47:14.629742 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54385360-eb8d-42ea-a0b5-e299c0d7fe57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbad210e180>]}
[0m23:47:14.631036 [info ] [Thread-1 (]: 1 of 5 OK created sql table model RAW_public.dim_address ....................... [[32mSUCCESS 1[0m in 4.42s]
[0m23:47:14.632380 [debug] [Thread-1 (]: Finished running node model.customer_churn.dim_address
[0m23:47:14.635690 [debug] [Thread-3 (]: Began running node model.customer_churn.churn_map
[0m23:47:14.636628 [info ] [Thread-3 (]: 5 of 5 START sql table model RAW_public.churn_map .............................. [RUN]
[0m23:47:14.637620 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer_churn.fact_churn, now model.customer_churn.churn_map)
[0m23:47:14.638401 [debug] [Thread-3 (]: Began compiling node model.customer_churn.churn_map
[0m23:47:14.642030 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.churn_map"
[0m23:47:14.656008 [debug] [Thread-3 (]: Began executing node model.customer_churn.churn_map
[0m23:47:14.659409 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.churn_map"
[0m23:47:14.675719 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.churn_map"
[0m23:47:14.676691 [debug] [Thread-3 (]: On model.customer_churn.churn_map: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.churn_map"} */
create or replace transient table USER_DB_FALCON.RAW_public.churn_map
         as
        (-- models/marts/churn_map.sql


select
  f.individual_id,
  f.churn_date,
  f.churn_flag,
  a.lon,
  a.lat
from USER_DB_FALCON.RAW_public.fact_churn      as f
join USER_DB_FALCON.RAW_public.dim_address    as a
  using (individual_id)
        );
[0m23:47:14.677548 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:47:16.299023 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.621 seconds
[0m23:47:16.301826 [debug] [Thread-3 (]: On model.customer_churn.churn_map: Close
[0m23:47:16.417913 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54385360-eb8d-42ea-a0b5-e299c0d7fe57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbad20da060>]}
[0m23:47:16.426369 [info ] [Thread-3 (]: 5 of 5 OK created sql table model RAW_public.churn_map ......................... [[32mSUCCESS 1[0m in 1.78s]
[0m23:47:16.430713 [debug] [Thread-3 (]: Finished running node model.customer_churn.churn_map
[0m23:47:16.435328 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:47:16.438192 [debug] [MainThread]: Connection 'model.customer_churn.dim_address' was properly closed.
[0m23:47:16.439988 [debug] [MainThread]: Connection 'model.customer_churn.dim_customer' was properly closed.
[0m23:47:16.441340 [debug] [MainThread]: Connection 'model.customer_churn.churn_map' was properly closed.
[0m23:47:16.446828 [debug] [MainThread]: Connection 'model.customer_churn.churn_metrics' was properly closed.
[0m23:47:16.447953 [info ] [MainThread]: 
[0m23:47:16.448812 [info ] [MainThread]: Finished running 1 incremental model, 4 table models in 0 hours 0 minutes and 7.71 seconds (7.71s).
[0m23:47:16.450219 [debug] [MainThread]: Command end result
[0m23:47:16.570430 [info ] [MainThread]: 
[0m23:47:16.571568 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:47:16.572785 [info ] [MainThread]: 
[0m23:47:16.574157 [error] [MainThread]:   Database Error in model churn_metrics (models/marts/churn_metrics.sql)
  002003 (42S02): SQL compilation error:
  Object 'MONTHLY' does not exist or not authorized.
  compiled code at target/run/customer_churn/models/marts/churn_metrics.sql
[0m23:47:16.575308 [info ] [MainThread]: 
[0m23:47:16.576610 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m23:47:16.579446 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 10.873698, "process_user_time": 6.051532, "process_kernel_time": 3.005326, "process_mem_max_rss": "276440", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m23:47:16.580631 [debug] [MainThread]: Command `dbt run` failed at 23:47:16.580465 after 10.87 seconds
[0m23:47:16.581495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb30ff1af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbad380d100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb3386b200>]}
[0m23:47:16.582568 [debug] [MainThread]: Flushing usage events
[0m23:48:49.437069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45140c9010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45140656a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45140c92e0>]}


============================== 23:48:49.451581 | 8a731a95-2a02-4d68-bc46-afa3c151b06e ==============================
[0m23:48:49.451581 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:48:49.453646 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:48:49.486977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8eb259670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8eabb1670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8eab933b0>]}


============================== 23:48:49.501469 | 15e33947-f1c9-4f62-9b72-109452ca154e ==============================
[0m23:48:49.501469 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:48:49.503473 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:48:49.706298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a731a95-2a02-4d68-bc46-afa3c151b06e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45147a8e00>]}
[0m23:48:49.738001 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:48:49.753529 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:48:49.756112 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.45446485, "process_user_time": 4.184553, "process_kernel_time": 0.290738, "process_mem_max_rss": "165564", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:48:49.757794 [debug] [MainThread]: Command `dbt deps` succeeded at 23:48:49.757490 after 0.46 seconds
[0m23:48:49.759410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45140656a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45133bf0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4513cda9c0>]}
[0m23:48:49.759301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '15e33947-f1c9-4f62-9b72-109452ca154e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8eb9be960>]}
[0m23:48:49.760835 [debug] [MainThread]: Flushing usage events
[0m23:48:49.786475 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:48:49.802354 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:48:49.804831 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.45940658, "process_user_time": 4.262149, "process_kernel_time": 0.261802, "process_mem_max_rss": "165556", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:48:49.806626 [debug] [MainThread]: Command `dbt deps` succeeded at 23:48:49.806371 after 0.46 seconds
[0m23:48:49.807772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8ea6a8950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8ee7a2e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8eb655f70>]}
[0m23:48:49.808948 [debug] [MainThread]: Flushing usage events
[0m23:48:54.536984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd821cf8350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd82295bf80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd825d4ccb0>]}
[0m23:48:54.537084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f53d5ce30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f534bdca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f534bd6a0>]}


============================== 23:48:54.545000 | ee3e6753-9c65-4e73-917a-0aad1d7ebf71 ==============================
[0m23:48:54.545000 [info ] [MainThread]: Running with dbt=1.8.7


============================== 23:48:54.545209 | 647a1926-689d-481b-882d-c71d2a8ea932 ==============================
[0m23:48:54.545209 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:48:54.546234 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt --select staging', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:48:54.546286 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt --select staging', 'send_anonymous_usage_stats': 'True'}
[0m23:48:55.867434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee3e6753-9c65-4e73-917a-0aad1d7ebf71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7ca9c8560>]}
[0m23:48:55.878625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '647a1926-689d-481b-882d-c71d2a8ea932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ef98a0560>]}
[0m23:48:55.943663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee3e6753-9c65-4e73-917a-0aad1d7ebf71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7c8a60710>]}
[0m23:48:55.945682 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m23:48:55.954581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '647a1926-689d-481b-882d-c71d2a8ea932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ef9a84110>]}
[0m23:48:55.956092 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m23:48:56.103833 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:48:56.104280 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:48:56.605737 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:48:56.607397 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:48:56.607556 [debug] [MainThread]: Partial parsing: updated file: customer_churn://models/marts/churn_metrics.sql
[0m23:48:56.609080 [debug] [MainThread]: Partial parsing: updated file: customer_churn://models/marts/churn_metrics.sql
[0m23:48:57.102602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '647a1926-689d-481b-882d-c71d2a8ea932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ef95bacf0>]}
[0m23:48:57.105329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee3e6753-9c65-4e73-917a-0aad1d7ebf71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd763b03980>]}
[0m23:48:57.371878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '647a1926-689d-481b-882d-c71d2a8ea932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ef91fe5a0>]}
[0m23:48:57.373371 [info ] [MainThread]: Found 12 models, 10 data tests, 7 sources, 459 macros
[0m23:48:57.374858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '647a1926-689d-481b-882d-c71d2a8ea932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ef9207530>]}
[0m23:48:57.376211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee3e6753-9c65-4e73-917a-0aad1d7ebf71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7c3d70740>]}
[0m23:48:57.377675 [info ] [MainThread]: Found 12 models, 10 data tests, 7 sources, 459 macros
[0m23:48:57.379256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee3e6753-9c65-4e73-917a-0aad1d7ebf71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd763b2dbb0>]}
[0m23:48:57.379558 [info ] [MainThread]: 
[0m23:48:57.381127 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:48:57.383479 [info ] [MainThread]: 
[0m23:48:57.385142 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:48:57.390618 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON'
[0m23:48:57.396908 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON'
[0m23:48:57.416966 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON"
[0m23:48:57.418153 [debug] [ThreadPool]: On list_USER_DB_FALCON: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON"} */
show terse schemas in database USER_DB_FALCON
    limit 10000
[0m23:48:57.419363 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:48:57.424309 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON"
[0m23:48:57.425476 [debug] [ThreadPool]: On list_USER_DB_FALCON: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON"} */
show terse schemas in database USER_DB_FALCON
    limit 10000
[0m23:48:57.426901 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:48:59.329756 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.903 seconds
[0m23:48:59.332683 [debug] [ThreadPool]: On list_USER_DB_FALCON: Close
[0m23:48:59.366439 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.947 seconds
[0m23:48:59.370611 [debug] [ThreadPool]: On list_USER_DB_FALCON: Close
[0m23:48:59.610933 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON, now list_USER_DB_FALCON_RAW_public)
[0m23:48:59.611024 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON, now list_USER_DB_FALCON_RAW_public)
[0m23:48:59.619360 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m23:48:59.619365 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m23:48:59.620082 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show terse objects in USER_DB_FALCON.RAW_public limit 10000
[0m23:48:59.620152 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show terse objects in USER_DB_FALCON.RAW_public limit 10000
[0m23:48:59.620817 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:48:59.620851 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:49:01.215929 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 1.595 seconds
[0m23:49:01.218260 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m23:49:01.238358 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 1.617 seconds
[0m23:49:01.244225 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m23:49:04.299556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee3e6753-9c65-4e73-917a-0aad1d7ebf71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7c3d72630>]}
[0m23:49:04.301565 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:49:04.304054 [info ] [MainThread]: 
[0m23:49:04.324561 [debug] [Thread-1 (]: Began running node model.customer_churn.stg_address
[0m23:49:04.325225 [debug] [Thread-2 (]: Began running node model.customer_churn.stg_autoinsurance_churn
[0m23:49:04.325812 [debug] [Thread-3 (]: Began running node model.customer_churn.stg_customer
[0m23:49:04.327031 [debug] [Thread-4 (]: Began running node model.customer_churn.stg_demographic
[0m23:49:04.328959 [info ] [Thread-1 (]: 1 of 6 START sql view model RAW_public.stg_address ............................. [RUN]
[0m23:49:04.331705 [info ] [Thread-2 (]: 2 of 6 START sql view model RAW_public.stg_autoinsurance_churn ................. [RUN]
[0m23:49:04.333309 [info ] [Thread-3 (]: 3 of 6 START sql view model RAW_public.stg_customer ............................ [RUN]
[0m23:49:04.334445 [info ] [Thread-4 (]: 4 of 6 START sql view model RAW_public.stg_demographic ......................... [RUN]
[0m23:49:04.346955 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON_RAW_public, now model.customer_churn.stg_address)
[0m23:49:04.347860 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.customer_churn.stg_autoinsurance_churn'
[0m23:49:04.348815 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.customer_churn.stg_customer'
[0m23:49:04.349762 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.customer_churn.stg_demographic'
[0m23:49:04.350436 [debug] [Thread-1 (]: Began compiling node model.customer_churn.stg_address
[0m23:49:04.351015 [debug] [Thread-2 (]: Began compiling node model.customer_churn.stg_autoinsurance_churn
[0m23:49:04.351702 [debug] [Thread-3 (]: Began compiling node model.customer_churn.stg_customer
[0m23:49:04.352661 [debug] [Thread-4 (]: Began compiling node model.customer_churn.stg_demographic
[0m23:49:04.360838 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.stg_address"
[0m23:49:04.364967 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer_churn.stg_autoinsurance_churn"
[0m23:49:04.368876 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.stg_customer"
[0m23:49:04.372295 [debug] [Thread-4 (]: Writing injected SQL for node "model.customer_churn.stg_demographic"
[0m23:49:04.387563 [debug] [Thread-1 (]: Began executing node model.customer_churn.stg_address
[0m23:49:04.388413 [debug] [Thread-2 (]: Began executing node model.customer_churn.stg_autoinsurance_churn
[0m23:49:04.399235 [debug] [Thread-3 (]: Began executing node model.customer_churn.stg_customer
[0m23:49:04.405488 [debug] [Thread-4 (]: Began executing node model.customer_churn.stg_demographic
[0m23:49:04.437349 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.stg_customer"
[0m23:49:04.441477 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer_churn.stg_autoinsurance_churn"
[0m23:49:04.443556 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.stg_address"
[0m23:49:04.446946 [debug] [Thread-4 (]: Writing runtime sql for node "model.customer_churn.stg_demographic"
[0m23:49:04.472753 [debug] [Thread-2 (]: Using snowflake connection "model.customer_churn.stg_autoinsurance_churn"
[0m23:49:04.475156 [debug] [Thread-2 (]: On model.customer_churn.stg_autoinsurance_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_autoinsurance_churn"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_autoinsurance_churn
  
   as (
    

select
  individual_id,
  churn              as churn_flag
from USER_DB_FALCON.RAW.AUTOINSURANCE_CHURN_STAGING
  );
[0m23:49:04.475765 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.stg_address"
[0m23:49:04.477631 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:49:04.481554 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.stg_customer"
[0m23:49:04.482403 [debug] [Thread-1 (]: On model.customer_churn.stg_address: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_address"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_address
  
   as (
    -- models/staging/stg_address.sql

select
  address_id,
  street_address,
  city,
  state,
  county,
  latitude::float as lat,
  longitude::float as lon
from USER_DB_FALCON.RAW.ADDRESS_STAGING
  );
[0m23:49:04.487925 [debug] [Thread-4 (]: Using snowflake connection "model.customer_churn.stg_demographic"
[0m23:49:04.488781 [debug] [Thread-3 (]: On model.customer_churn.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_customer"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_customer
  
   as (
    

select
  individual_id,
  address_id,
  curr_ann_amt    as annual_premium,
  days_tenure,
  cust_orig_date,
  age_in_years,            -- bring this in
  date_of_birth            -- and this
from USER_DB_FALCON.RAW.CUSTOMER_STAGING
where individual_id is not null
  );
[0m23:49:04.490547 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:04.492451 [debug] [Thread-4 (]: On model.customer_churn.stg_demographic: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_demographic"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_demographic
  
   as (
    

select
  individual_id,
  income,
  has_children,
  length_of_residence    as length_of_residence,  -- exact match
  marital_status,
  home_owner,
  home_market_value      as home_market_value,
  college_degree,
  good_credit
from USER_DB_FALCON.RAW.DEMOGRAPHIC_STAGING
  );
[0m23:49:04.495571 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:49:04.499567 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:49:05.496471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '647a1926-689d-481b-882d-c71d2a8ea932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ef80d4860>]}
[0m23:49:05.497572 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:49:05.498474 [info ] [MainThread]: 
[0m23:49:05.523313 [debug] [Thread-1 (]: Began running node model.customer_churn.stg_address
[0m23:49:05.523818 [debug] [Thread-2 (]: Began running node model.customer_churn.stg_autoinsurance_churn
[0m23:49:05.524129 [debug] [Thread-3 (]: Began running node model.customer_churn.stg_customer
[0m23:49:05.524709 [info ] [Thread-1 (]: 1 of 6 START sql view model RAW_public.stg_address ............................. [RUN]
[0m23:49:05.525049 [debug] [Thread-4 (]: Began running node model.customer_churn.stg_demographic
[0m23:49:05.526433 [info ] [Thread-2 (]: 2 of 6 START sql view model RAW_public.stg_autoinsurance_churn ................. [RUN]
[0m23:49:05.528983 [info ] [Thread-3 (]: 3 of 6 START sql view model RAW_public.stg_customer ............................ [RUN]
[0m23:49:05.532838 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON_RAW_public, now model.customer_churn.stg_address)
[0m23:49:05.535223 [info ] [Thread-4 (]: 4 of 6 START sql view model RAW_public.stg_demographic ......................... [RUN]
[0m23:49:05.538598 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.customer_churn.stg_autoinsurance_churn'
[0m23:49:05.540894 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.customer_churn.stg_customer'
[0m23:49:05.543682 [debug] [Thread-1 (]: Began compiling node model.customer_churn.stg_address
[0m23:49:05.547033 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.customer_churn.stg_demographic'
[0m23:49:05.549011 [debug] [Thread-2 (]: Began compiling node model.customer_churn.stg_autoinsurance_churn
[0m23:49:05.550776 [debug] [Thread-3 (]: Began compiling node model.customer_churn.stg_customer
[0m23:49:05.566291 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.stg_address"
[0m23:49:05.566704 [debug] [Thread-4 (]: Began compiling node model.customer_churn.stg_demographic
[0m23:49:05.572196 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer_churn.stg_autoinsurance_churn"
[0m23:49:05.575562 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.stg_customer"
[0m23:49:05.578953 [debug] [Thread-4 (]: Writing injected SQL for node "model.customer_churn.stg_demographic"
[0m23:49:05.585188 [debug] [Thread-1 (]: Began executing node model.customer_churn.stg_address
[0m23:49:05.586007 [debug] [Thread-2 (]: Began executing node model.customer_churn.stg_autoinsurance_churn
[0m23:49:05.591896 [debug] [Thread-3 (]: Began executing node model.customer_churn.stg_customer
[0m23:49:05.631757 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.stg_address"
[0m23:49:05.633380 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer_churn.stg_autoinsurance_churn"
[0m23:49:05.636612 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.stg_customer"
[0m23:49:05.637219 [debug] [Thread-4 (]: Began executing node model.customer_churn.stg_demographic
[0m23:49:05.642057 [debug] [Thread-4 (]: Writing runtime sql for node "model.customer_churn.stg_demographic"
[0m23:49:05.648854 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.stg_customer"
[0m23:49:05.649584 [debug] [Thread-2 (]: Using snowflake connection "model.customer_churn.stg_autoinsurance_churn"
[0m23:49:05.650778 [debug] [Thread-3 (]: On model.customer_churn.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_customer"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_customer
  
   as (
    

select
  individual_id,
  address_id,
  curr_ann_amt    as annual_premium,
  days_tenure,
  cust_orig_date,
  age_in_years,            -- bring this in
  date_of_birth            -- and this
from USER_DB_FALCON.RAW.CUSTOMER_STAGING
where individual_id is not null
  );
[0m23:49:05.651647 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.stg_address"
[0m23:49:05.652049 [debug] [Thread-2 (]: On model.customer_churn.stg_autoinsurance_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_autoinsurance_churn"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_autoinsurance_churn
  
   as (
    

select
  individual_id,
  churn              as churn_flag
from USER_DB_FALCON.RAW.AUTOINSURANCE_CHURN_STAGING
  );
[0m23:49:05.652797 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:49:05.653631 [debug] [Thread-1 (]: On model.customer_churn.stg_address: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_address"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_address
  
   as (
    -- models/staging/stg_address.sql

select
  address_id,
  street_address,
  city,
  state,
  county,
  latitude::float as lat,
  longitude::float as lon
from USER_DB_FALCON.RAW.ADDRESS_STAGING
  );
[0m23:49:05.654422 [debug] [Thread-4 (]: Using snowflake connection "model.customer_churn.stg_demographic"
[0m23:49:05.654765 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:49:05.657035 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:05.657846 [debug] [Thread-4 (]: On model.customer_churn.stg_demographic: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_demographic"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_demographic
  
   as (
    

select
  individual_id,
  income,
  has_children,
  length_of_residence    as length_of_residence,  -- exact match
  marital_status,
  home_owner,
  home_market_value      as home_market_value,
  college_degree,
  good_credit
from USER_DB_FALCON.RAW.DEMOGRAPHIC_STAGING
  );
[0m23:49:05.662116 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:49:07.065202 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.587 seconds
[0m23:49:07.109277 [debug] [Thread-2 (]: On model.customer_churn.stg_autoinsurance_churn: Close
[0m23:49:07.110429 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.611 seconds
[0m23:49:07.115094 [debug] [Thread-4 (]: On model.customer_churn.stg_demographic: Close
[0m23:49:07.168196 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.513 seconds
[0m23:49:07.168404 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.678 seconds
[0m23:49:07.174963 [debug] [Thread-1 (]: On model.customer_churn.stg_address: Close
[0m23:49:07.186530 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.691 seconds
[0m23:49:07.191300 [debug] [Thread-3 (]: On model.customer_churn.stg_customer: Close
[0m23:49:07.215161 [debug] [Thread-2 (]: On model.customer_churn.stg_autoinsurance_churn: Close
[0m23:49:07.222895 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.561 seconds
[0m23:49:07.225921 [debug] [Thread-4 (]: On model.customer_churn.stg_demographic: Close
[0m23:49:07.259327 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee3e6753-9c65-4e73-917a-0aad1d7ebf71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd76302fd40>]}
[0m23:49:07.260954 [info ] [Thread-4 (]: 4 of 6 OK created sql view model RAW_public.stg_demographic .................... [[32mSUCCESS 1[0m in 2.91s]
[0m23:49:07.262362 [debug] [Thread-4 (]: Finished running node model.customer_churn.stg_demographic
[0m23:49:07.263358 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee3e6753-9c65-4e73-917a-0aad1d7ebf71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7c84b6f30>]}
[0m23:49:07.264003 [debug] [Thread-4 (]: Began running node model.customer_churn.stg_termination
[0m23:49:07.265068 [info ] [Thread-2 (]: 2 of 6 OK created sql view model RAW_public.stg_autoinsurance_churn ............ [[32mSUCCESS 1[0m in 2.92s]
[0m23:49:07.266061 [info ] [Thread-4 (]: 5 of 6 START sql view model RAW_public.stg_termination ......................... [RUN]
[0m23:49:07.267189 [debug] [Thread-2 (]: Finished running node model.customer_churn.stg_autoinsurance_churn
[0m23:49:07.269128 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.customer_churn.stg_demographic, now model.customer_churn.stg_termination)
[0m23:49:07.270605 [debug] [Thread-2 (]: Began running node model.customer_churn.stg_turning_movement
[0m23:49:07.271387 [debug] [Thread-4 (]: Began compiling node model.customer_churn.stg_termination
[0m23:49:07.272217 [info ] [Thread-2 (]: 6 of 6 START sql view model RAW_public.stg_turning_movement .................... [RUN]
[0m23:49:07.277159 [debug] [Thread-4 (]: Writing injected SQL for node "model.customer_churn.stg_termination"
[0m23:49:07.278666 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer_churn.stg_autoinsurance_churn, now model.customer_churn.stg_turning_movement)
[0m23:49:07.280584 [debug] [Thread-2 (]: Began compiling node model.customer_churn.stg_turning_movement
[0m23:49:07.285949 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer_churn.stg_turning_movement"
[0m23:49:07.293520 [debug] [Thread-4 (]: Began executing node model.customer_churn.stg_termination
[0m23:49:07.298028 [debug] [Thread-4 (]: Writing runtime sql for node "model.customer_churn.stg_termination"
[0m23:49:07.298649 [debug] [Thread-2 (]: Began executing node model.customer_churn.stg_turning_movement
[0m23:49:07.302928 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer_churn.stg_turning_movement"
[0m23:49:07.311077 [debug] [Thread-4 (]: Using snowflake connection "model.customer_churn.stg_termination"
[0m23:49:07.312105 [debug] [Thread-4 (]: On model.customer_churn.stg_termination: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_termination"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_termination
  
   as (
    

select
  individual_id,
  acct_suspd_date    as churn_date
from USER_DB_FALCON.RAW.TERMINATION_STAGING
  );
[0m23:49:07.312937 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:49:07.313847 [debug] [Thread-2 (]: Using snowflake connection "model.customer_churn.stg_turning_movement"
[0m23:49:07.316168 [debug] [Thread-2 (]: On model.customer_churn.stg_turning_movement: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_turning_movement"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_turning_movement
  
   as (
    -- models/staging/stg_turning_movement.sql

select
  objectid,
  facilityid,
  intid,
  intname,
  nodeno,
  longitude::float as tm_lon,
  latitude::float  as tm_lat
from USER_DB_FALCON.RAW.TURNING_MOVEMENT
  );
[0m23:49:07.317123 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:49:07.321925 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee3e6753-9c65-4e73-917a-0aad1d7ebf71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7630627b0>]}
[0m23:49:07.323628 [info ] [Thread-1 (]: 1 of 6 OK created sql view model RAW_public.stg_address ........................ [[32mSUCCESS 1[0m in 2.97s]
[0m23:49:07.325229 [debug] [Thread-1 (]: Finished running node model.customer_churn.stg_address
[0m23:49:07.330803 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee3e6753-9c65-4e73-917a-0aad1d7ebf71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd763084470>]}
[0m23:49:07.331960 [info ] [Thread-3 (]: 3 of 6 OK created sql view model RAW_public.stg_customer ....................... [[32mSUCCESS 1[0m in 2.98s]
[0m23:49:07.333178 [debug] [Thread-3 (]: Finished running node model.customer_churn.stg_customer
[0m23:49:07.351801 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '647a1926-689d-481b-882d-c71d2a8ea932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ef98a3500>]}
[0m23:49:07.355103 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '647a1926-689d-481b-882d-c71d2a8ea932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ee0523b90>]}
[0m23:49:07.353744 [info ] [Thread-2 (]: 2 of 6 OK created sql view model RAW_public.stg_autoinsurance_churn ............ [[32mSUCCESS 1[0m in 1.81s]
[0m23:49:07.356537 [info ] [Thread-4 (]: 4 of 6 OK created sql view model RAW_public.stg_demographic .................... [[32mSUCCESS 1[0m in 1.81s]
[0m23:49:07.357977 [debug] [Thread-2 (]: Finished running node model.customer_churn.stg_autoinsurance_churn
[0m23:49:07.359806 [debug] [Thread-4 (]: Finished running node model.customer_churn.stg_demographic
[0m23:49:07.360763 [debug] [Thread-2 (]: Began running node model.customer_churn.stg_termination
[0m23:49:07.361708 [debug] [Thread-4 (]: Began running node model.customer_churn.stg_turning_movement
[0m23:49:07.362825 [info ] [Thread-2 (]: 5 of 6 START sql view model RAW_public.stg_termination ......................... [RUN]
[0m23:49:07.363865 [info ] [Thread-4 (]: 6 of 6 START sql view model RAW_public.stg_turning_movement .................... [RUN]
[0m23:49:07.364809 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer_churn.stg_autoinsurance_churn, now model.customer_churn.stg_termination)
[0m23:49:07.365722 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.customer_churn.stg_demographic, now model.customer_churn.stg_turning_movement)
[0m23:49:07.366641 [debug] [Thread-2 (]: Began compiling node model.customer_churn.stg_termination
[0m23:49:07.367470 [debug] [Thread-4 (]: Began compiling node model.customer_churn.stg_turning_movement
[0m23:49:07.374385 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer_churn.stg_termination"
[0m23:49:07.378629 [debug] [Thread-4 (]: Writing injected SQL for node "model.customer_churn.stg_turning_movement"
[0m23:49:07.389734 [debug] [Thread-2 (]: Began executing node model.customer_churn.stg_termination
[0m23:49:07.394348 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer_churn.stg_termination"
[0m23:49:07.394954 [debug] [Thread-4 (]: Began executing node model.customer_churn.stg_turning_movement
[0m23:49:07.399299 [debug] [Thread-4 (]: Writing runtime sql for node "model.customer_churn.stg_turning_movement"
[0m23:49:07.406157 [debug] [Thread-2 (]: Using snowflake connection "model.customer_churn.stg_termination"
[0m23:49:07.407181 [debug] [Thread-2 (]: On model.customer_churn.stg_termination: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_termination"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_termination
  
   as (
    

select
  individual_id,
  acct_suspd_date    as churn_date
from USER_DB_FALCON.RAW.TERMINATION_STAGING
  );
[0m23:49:07.408101 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:49:07.408982 [debug] [Thread-4 (]: Using snowflake connection "model.customer_churn.stg_turning_movement"
[0m23:49:07.412154 [debug] [Thread-4 (]: On model.customer_churn.stg_turning_movement: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_turning_movement"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_turning_movement
  
   as (
    -- models/staging/stg_turning_movement.sql

select
  objectid,
  facilityid,
  intid,
  intname,
  nodeno,
  longitude::float as tm_lon,
  latitude::float  as tm_lat
from USER_DB_FALCON.RAW.TURNING_MOVEMENT
  );
[0m23:49:07.412934 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:49:07.476664 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.824 seconds
[0m23:49:07.480930 [debug] [Thread-3 (]: On model.customer_churn.stg_customer: Close
[0m23:49:08.356384 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '647a1926-689d-481b-882d-c71d2a8ea932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ee0517fe0>]}
[0m23:49:08.357527 [info ] [Thread-3 (]: 3 of 6 OK created sql view model RAW_public.stg_customer ....................... [[32mSUCCESS 1[0m in 2.82s]
[0m23:49:08.358823 [debug] [Thread-3 (]: Finished running node model.customer_churn.stg_customer
[0m23:49:08.485860 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.078 seconds
[0m23:49:08.488808 [debug] [Thread-2 (]: On model.customer_churn.stg_termination: Close
[0m23:49:08.542048 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.129 seconds
[0m23:49:08.543063 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.886 seconds
[0m23:49:08.545236 [debug] [Thread-4 (]: On model.customer_churn.stg_turning_movement: Close
[0m23:49:08.547653 [debug] [Thread-1 (]: On model.customer_churn.stg_address: Close
[0m23:49:08.597417 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.284 seconds
[0m23:49:08.600712 [debug] [Thread-4 (]: On model.customer_churn.stg_termination: Close
[0m23:49:08.617645 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '647a1926-689d-481b-882d-c71d2a8ea932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ee0fa9190>]}
[0m23:49:08.619060 [info ] [Thread-2 (]: 5 of 6 OK created sql view model RAW_public.stg_termination .................... [[32mSUCCESS 1[0m in 1.25s]
[0m23:49:08.620769 [debug] [Thread-2 (]: Finished running node model.customer_churn.stg_termination
[0m23:49:08.681392 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.364 seconds
[0m23:49:08.686309 [debug] [Thread-2 (]: On model.customer_churn.stg_turning_movement: Close
[0m23:49:08.687580 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '647a1926-689d-481b-882d-c71d2a8ea932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ee054cf80>]}
[0m23:49:08.689099 [info ] [Thread-1 (]: 1 of 6 OK created sql view model RAW_public.stg_address ........................ [[32mSUCCESS 1[0m in 3.15s]
[0m23:49:08.690211 [debug] [Thread-1 (]: Finished running node model.customer_churn.stg_address
[0m23:49:08.716987 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee3e6753-9c65-4e73-917a-0aad1d7ebf71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd763061220>]}
[0m23:49:08.718393 [info ] [Thread-4 (]: 5 of 6 OK created sql view model RAW_public.stg_termination .................... [[32mSUCCESS 1[0m in 1.45s]
[0m23:49:08.720572 [debug] [Thread-4 (]: Finished running node model.customer_churn.stg_termination
[0m23:49:08.826030 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee3e6753-9c65-4e73-917a-0aad1d7ebf71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd76318dd30>]}
[0m23:49:08.827066 [info ] [Thread-2 (]: 6 of 6 OK created sql view model RAW_public.stg_turning_movement ............... [[32mSUCCESS 1[0m in 1.55s]
[0m23:49:08.827976 [debug] [Thread-2 (]: Finished running node model.customer_churn.stg_turning_movement
[0m23:49:08.830136 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:49:08.831285 [debug] [MainThread]: Connection 'model.customer_churn.stg_address' was properly closed.
[0m23:49:08.832357 [debug] [MainThread]: Connection 'model.customer_churn.stg_turning_movement' was properly closed.
[0m23:49:08.833117 [debug] [MainThread]: Connection 'model.customer_churn.stg_customer' was properly closed.
[0m23:49:08.834988 [debug] [MainThread]: Connection 'model.customer_churn.stg_termination' was properly closed.
[0m23:49:08.837053 [info ] [MainThread]: 
[0m23:49:08.838755 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 11.45 seconds (11.45s).
[0m23:49:08.842355 [debug] [MainThread]: Command end result
[0m23:49:09.035774 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '647a1926-689d-481b-882d-c71d2a8ea932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ee06bc650>]}
[0m23:49:09.037767 [info ] [Thread-4 (]: 6 of 6 OK created sql view model RAW_public.stg_turning_movement ............... [[32mSUCCESS 1[0m in 1.67s]
[0m23:49:09.039203 [debug] [Thread-4 (]: Finished running node model.customer_churn.stg_turning_movement
[0m23:49:09.042147 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:49:09.046071 [debug] [MainThread]: Connection 'model.customer_churn.stg_address' was properly closed.
[0m23:49:09.047387 [debug] [MainThread]: Connection 'model.customer_churn.stg_termination' was properly closed.
[0m23:49:09.049005 [debug] [MainThread]: Connection 'model.customer_churn.stg_customer' was properly closed.
[0m23:49:09.048938 [info ] [MainThread]: 
[0m23:49:09.050615 [debug] [MainThread]: Connection 'model.customer_churn.stg_turning_movement' was properly closed.
[0m23:49:09.050689 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:49:09.051507 [info ] [MainThread]: 
[0m23:49:09.051531 [info ] [MainThread]: 
[0m23:49:09.053240 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m23:49:09.053342 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 11.67 seconds (11.67s).
[0m23:49:09.054592 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.609522, "process_user_time": 6.922216, "process_kernel_time": 1.965297, "process_mem_max_rss": "268036", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m23:49:09.054766 [debug] [MainThread]: Command end result
[0m23:49:09.055869 [debug] [MainThread]: Command `dbt run` succeeded at 23:49:09.055762 after 14.61 seconds
[0m23:49:09.056807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd822a23470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd763a32ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7c99b0ad0>]}
[0m23:49:09.058359 [debug] [MainThread]: Flushing usage events
[0m23:49:09.352698 [info ] [MainThread]: 
[0m23:49:09.355078 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:49:09.358531 [info ] [MainThread]: 
[0m23:49:09.360454 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m23:49:09.364379 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.917935, "process_user_time": 6.648477, "process_kernel_time": 2.205295, "process_mem_max_rss": "253628", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m23:49:09.367369 [debug] [MainThread]: Command `dbt run` succeeded at 23:49:09.367139 after 14.92 seconds
[0m23:49:09.368719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f571fcd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4efadb7a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ef9da30e0>]}
[0m23:49:09.371015 [debug] [MainThread]: Flushing usage events
[0m23:49:14.518914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c2e44fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c2c7ba240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c2c923830>]}


============================== 23:49:14.530147 | c2f59965-75a3-46f7-89af-10de89c680af ==============================
[0m23:49:14.530147 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:49:14.531529 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt --select intermediate', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:49:15.883819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c2f59965-75a3-46f7-89af-10de89c680af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c2b6e0290>]}
[0m23:49:15.968974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c2f59965-75a3-46f7-89af-10de89c680af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bce854770>]}
[0m23:49:15.975463 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m23:49:16.123832 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:49:16.148201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f726ead9100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f727097d9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7270b73e90>]}


============================== 23:49:16.157796 | 67adcc1a-f9a3-4459-ba8d-ce90c8bc4003 ==============================
[0m23:49:16.157796 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:49:16.159600 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt --select intermediate', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:49:17.156340 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:49:17.157603 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:49:17.226555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c2f59965-75a3-46f7-89af-10de89c680af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bcde13ec0>]}
[0m23:49:17.463655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '67adcc1a-f9a3-4459-ba8d-ce90c8bc4003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f726f0068d0>]}
[0m23:49:17.500163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c2f59965-75a3-46f7-89af-10de89c680af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bcda5b800>]}
[0m23:49:17.501454 [info ] [MainThread]: Found 12 models, 10 data tests, 7 sources, 459 macros
[0m23:49:17.502693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2f59965-75a3-46f7-89af-10de89c680af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bcd821b20>]}
[0m23:49:17.506042 [info ] [MainThread]: 
[0m23:49:17.507331 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:49:17.509067 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON'
[0m23:49:17.533023 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON"
[0m23:49:17.534157 [debug] [ThreadPool]: On list_USER_DB_FALCON: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON"} */
show terse schemas in database USER_DB_FALCON
    limit 10000
[0m23:49:17.535349 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:49:17.541859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '67adcc1a-f9a3-4459-ba8d-ce90c8bc4003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72146fad50>]}
[0m23:49:17.543562 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m23:49:17.678799 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:49:18.285692 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.750 seconds
[0m23:49:18.289502 [debug] [ThreadPool]: On list_USER_DB_FALCON: Close
[0m23:49:18.311258 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:49:18.312752 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:49:18.387360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '67adcc1a-f9a3-4459-ba8d-ce90c8bc4003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72162ad790>]}
[0m23:49:18.455711 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON, now list_USER_DB_FALCON_RAW_public)
[0m23:49:18.468836 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m23:49:18.470070 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show terse objects in USER_DB_FALCON.RAW_public limit 10000
[0m23:49:18.471155 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:49:18.826792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '67adcc1a-f9a3-4459-ba8d-ce90c8bc4003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7215d3eab0>]}
[0m23:49:18.832298 [info ] [MainThread]: Found 12 models, 10 data tests, 7 sources, 459 macros
[0m23:49:18.837800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67adcc1a-f9a3-4459-ba8d-ce90c8bc4003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72141f5520>]}
[0m23:49:18.844759 [info ] [MainThread]: 
[0m23:49:18.846211 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:49:18.847863 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON'
[0m23:49:18.891815 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON"
[0m23:49:18.899480 [debug] [ThreadPool]: On list_USER_DB_FALCON: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON"} */
show terse schemas in database USER_DB_FALCON
    limit 10000
[0m23:49:18.912654 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:49:19.490920 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 1.020 seconds
[0m23:49:19.502065 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m23:49:19.634468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2f59965-75a3-46f7-89af-10de89c680af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bce3752b0>]}
[0m23:49:19.635440 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:49:19.638571 [info ] [MainThread]: 
[0m23:49:19.651538 [debug] [Thread-1 (]: Began running node model.customer_churn.int_customer_enriched
[0m23:49:19.653675 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW_public.int_customer_enriched ................... [RUN]
[0m23:49:19.656381 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON_RAW_public, now model.customer_churn.int_customer_enriched)
[0m23:49:19.657586 [debug] [Thread-1 (]: Began compiling node model.customer_churn.int_customer_enriched
[0m23:49:19.662909 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.750 seconds
[0m23:49:19.669200 [debug] [ThreadPool]: On list_USER_DB_FALCON: Close
[0m23:49:19.670240 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.int_customer_enriched"
[0m23:49:19.701969 [debug] [Thread-1 (]: Began executing node model.customer_churn.int_customer_enriched
[0m23:49:19.731917 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.int_customer_enriched"
[0m23:49:19.775604 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.int_customer_enriched"
[0m23:49:19.777088 [debug] [Thread-1 (]: On model.customer_churn.int_customer_enriched: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.int_customer_enriched"} */
create or replace   view USER_DB_FALCON.RAW_public.int_customer_enriched
  
   as (
    

with cust as (
    select
        individual_id,
        annual_premium,
        days_tenure,
        cust_orig_date,
        age_in_years,
        date_of_birth,
        address_id
    from USER_DB_FALCON.RAW_public.stg_customer
),

demo as (
    select
        individual_id,
        has_children,
        length_of_residence,
        marital_status,
        home_owner,
        home_market_value,
        college_degree,
        good_credit
    from USER_DB_FALCON.RAW_public.stg_demographic
),

addr as (
    select
        address_id,
        city,
        state,
        county,
        lat,
        lon
    from USER_DB_FALCON.RAW_public.stg_address
)

select
    cust.individual_id,
    cust.annual_premium,
    cust.days_tenure,
    cust.cust_orig_date,
    cust.age_in_years,
    cust.date_of_birth,
    demo.has_children,
    demo.length_of_residence,
    demo.marital_status,
    demo.home_owner,
    demo.home_market_value,
    addr.city,
    addr.state,
    addr.county,
    addr.lat,
    addr.lon
from cust
left join demo using (individual_id)
left join addr using (address_id)
  );
[0m23:49:19.778427 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:19.808826 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON, now list_USER_DB_FALCON_RAW_public)
[0m23:49:19.820663 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m23:49:19.821605 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show terse objects in USER_DB_FALCON.RAW_public limit 10000
[0m23:49:19.822451 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:49:20.161214 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.339 seconds
[0m23:49:20.164688 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m23:49:20.304498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67adcc1a-f9a3-4459-ba8d-ce90c8bc4003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f726a7ca8a0>]}
[0m23:49:20.308646 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:49:20.311126 [info ] [MainThread]: 
[0m23:49:20.322031 [debug] [Thread-1 (]: Began running node model.customer_churn.int_customer_enriched
[0m23:49:20.323168 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW_public.int_customer_enriched ................... [RUN]
[0m23:49:20.324257 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON_RAW_public, now model.customer_churn.int_customer_enriched)
[0m23:49:20.325292 [debug] [Thread-1 (]: Began compiling node model.customer_churn.int_customer_enriched
[0m23:49:20.336652 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.int_customer_enriched"
[0m23:49:20.355890 [debug] [Thread-1 (]: Began executing node model.customer_churn.int_customer_enriched
[0m23:49:20.403393 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.int_customer_enriched"
[0m23:49:20.429681 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.int_customer_enriched"
[0m23:49:20.431489 [debug] [Thread-1 (]: On model.customer_churn.int_customer_enriched: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.int_customer_enriched"} */
create or replace   view USER_DB_FALCON.RAW_public.int_customer_enriched
  
   as (
    

with cust as (
    select
        individual_id,
        annual_premium,
        days_tenure,
        cust_orig_date,
        age_in_years,
        date_of_birth,
        address_id
    from USER_DB_FALCON.RAW_public.stg_customer
),

demo as (
    select
        individual_id,
        has_children,
        length_of_residence,
        marital_status,
        home_owner,
        home_market_value,
        college_degree,
        good_credit
    from USER_DB_FALCON.RAW_public.stg_demographic
),

addr as (
    select
        address_id,
        city,
        state,
        county,
        lat,
        lon
    from USER_DB_FALCON.RAW_public.stg_address
)

select
    cust.individual_id,
    cust.annual_premium,
    cust.days_tenure,
    cust.cust_orig_date,
    cust.age_in_years,
    cust.date_of_birth,
    demo.has_children,
    demo.length_of_residence,
    demo.marital_status,
    demo.home_owner,
    demo.home_market_value,
    addr.city,
    addr.state,
    addr.county,
    addr.lat,
    addr.lon
from cust
left join demo using (individual_id)
left join addr using (address_id)
  );
[0m23:49:20.432704 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:20.527951 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.749 seconds
[0m23:49:20.565712 [debug] [Thread-1 (]: On model.customer_churn.int_customer_enriched: Close
[0m23:49:21.002272 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2f59965-75a3-46f7-89af-10de89c680af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bcddd3200>]}
[0m23:49:21.004281 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW_public.int_customer_enriched .............. [[32mSUCCESS 1[0m in 1.34s]
[0m23:49:21.006140 [debug] [Thread-1 (]: Finished running node model.customer_churn.int_customer_enriched
[0m23:49:21.009367 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:49:21.010442 [debug] [MainThread]: Connection 'model.customer_churn.int_customer_enriched' was properly closed.
[0m23:49:21.011703 [info ] [MainThread]: 
[0m23:49:21.013186 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.50 seconds (3.50s).
[0m23:49:21.015511 [debug] [MainThread]: Command end result
[0m23:49:21.121601 [info ] [MainThread]: 
[0m23:49:21.123198 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:49:21.124244 [info ] [MainThread]: 
[0m23:49:21.124942 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:49:21.126303 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.7304378, "process_user_time": 5.914958, "process_kernel_time": 2.771992, "process_mem_max_rss": "275228", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m23:49:21.127325 [debug] [MainThread]: Command `dbt run` succeeded at 23:49:21.127206 after 6.73 seconds
[0m23:49:21.128153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c2e44fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c2b9efce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bcda5b260>]}
[0m23:49:21.128991 [debug] [MainThread]: Flushing usage events
[0m23:49:21.185069 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.752 seconds
[0m23:49:21.221307 [debug] [Thread-1 (]: On model.customer_churn.int_customer_enriched: Close
[0m23:49:21.374665 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67adcc1a-f9a3-4459-ba8d-ce90c8bc4003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72144e6c30>]}
[0m23:49:21.375767 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW_public.int_customer_enriched .............. [[32mSUCCESS 1[0m in 1.05s]
[0m23:49:21.377404 [debug] [Thread-1 (]: Finished running node model.customer_churn.int_customer_enriched
[0m23:49:21.381861 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:49:21.383042 [debug] [MainThread]: Connection 'model.customer_churn.int_customer_enriched' was properly closed.
[0m23:49:21.384034 [info ] [MainThread]: 
[0m23:49:21.385058 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.54 seconds (2.54s).
[0m23:49:21.386490 [debug] [MainThread]: Command end result
[0m23:49:21.501113 [info ] [MainThread]: 
[0m23:49:21.502117 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:49:21.503312 [info ] [MainThread]: 
[0m23:49:21.504245 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:49:21.505813 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.4696765, "process_user_time": 6.009131, "process_kernel_time": 2.906309, "process_mem_max_rss": "269844", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m23:49:21.508190 [debug] [MainThread]: Command `dbt run` succeeded at 23:49:21.508110 after 5.47 seconds
[0m23:49:21.510555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f726ead9100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f721510f170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f720fe65850>]}
[0m23:49:21.515119 [debug] [MainThread]: Flushing usage events
[0m23:49:25.446307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bd8e82ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bdac827e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bd9424bf0>]}


============================== 23:49:25.458510 | c54f0766-5263-4d4d-8b9e-3639ccdc3d93 ==============================
[0m23:49:25.458510 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:49:25.460040 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt --select marts', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:49:25.554012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fc09cdaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fc0cac410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fc1388aa0>]}


============================== 23:49:25.565609 | 65c2a8da-8fa8-4675-a498-f9b7dc175f8f ==============================
[0m23:49:25.565609 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:49:25.567282 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt --select marts', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:49:26.953084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c54f0766-5263-4d4d-8b9e-3639ccdc3d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bd830fec0>]}
[0m23:49:27.026007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c54f0766-5263-4d4d-8b9e-3639ccdc3d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b7aad9ca0>]}
[0m23:49:27.027728 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m23:49:27.063520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65c2a8da-8fa8-4675-a498-f9b7dc175f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fc18c9340>]}
[0m23:49:27.132810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '65c2a8da-8fa8-4675-a498-f9b7dc175f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f62d1b7d0>]}
[0m23:49:27.134069 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m23:49:27.141421 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:49:27.272747 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:49:27.640948 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:49:27.641685 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:49:27.705982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c54f0766-5263-4d4d-8b9e-3639ccdc3d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bd830fbc0>]}
[0m23:49:28.062452 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:49:28.068478 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:49:28.139382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '65c2a8da-8fa8-4675-a498-f9b7dc175f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f62bdc560>]}
[0m23:49:28.144018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c54f0766-5263-4d4d-8b9e-3639ccdc3d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b7a5ac500>]}
[0m23:49:28.144904 [info ] [MainThread]: Found 12 models, 10 data tests, 7 sources, 459 macros
[0m23:49:28.145795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c54f0766-5263-4d4d-8b9e-3639ccdc3d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b7a4f7320>]}
[0m23:49:28.148267 [info ] [MainThread]: 
[0m23:49:28.149375 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:49:28.154227 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON'
[0m23:49:28.171323 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON"
[0m23:49:28.172778 [debug] [ThreadPool]: On list_USER_DB_FALCON: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON"} */
show terse schemas in database USER_DB_FALCON
    limit 10000
[0m23:49:28.174269 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:49:28.327354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65c2a8da-8fa8-4675-a498-f9b7dc175f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f62dd0bc0>]}
[0m23:49:28.328414 [info ] [MainThread]: Found 12 models, 10 data tests, 7 sources, 459 macros
[0m23:49:28.329279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65c2a8da-8fa8-4675-a498-f9b7dc175f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f62d45970>]}
[0m23:49:28.331890 [info ] [MainThread]: 
[0m23:49:28.333015 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:49:28.339803 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON'
[0m23:49:28.361557 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON"
[0m23:49:28.362687 [debug] [ThreadPool]: On list_USER_DB_FALCON: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON"} */
show terse schemas in database USER_DB_FALCON
    limit 10000
[0m23:49:28.363592 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:49:28.787007 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.613 seconds
[0m23:49:28.792193 [debug] [ThreadPool]: On list_USER_DB_FALCON: Close
[0m23:49:28.873292 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.510 seconds
[0m23:49:28.876102 [debug] [ThreadPool]: On list_USER_DB_FALCON: Close
[0m23:49:28.938876 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON, now list_USER_DB_FALCON_RAW_public)
[0m23:49:28.958007 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m23:49:28.983136 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show terse objects in USER_DB_FALCON.RAW_public limit 10000
[0m23:49:28.983968 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:49:29.019859 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON, now list_USER_DB_FALCON_RAW_public)
[0m23:49:29.043334 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m23:49:29.049339 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show terse objects in USER_DB_FALCON.RAW_public limit 10000
[0m23:49:29.059976 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:49:29.435589 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.452 seconds
[0m23:49:29.447730 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m23:49:29.627976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c54f0766-5263-4d4d-8b9e-3639ccdc3d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b7aadb290>]}
[0m23:49:29.629856 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:49:29.631392 [info ] [MainThread]: 
[0m23:49:29.651824 [debug] [Thread-1 (]: Began running node model.customer_churn.dim_address
[0m23:49:29.652162 [debug] [Thread-2 (]: Began running node model.customer_churn.dim_customer
[0m23:49:29.652487 [debug] [Thread-3 (]: Began running node model.customer_churn.fact_churn
[0m23:49:29.658584 [info ] [Thread-1 (]: 1 of 5 START sql table model RAW_public.dim_address ............................ [RUN]
[0m23:49:29.661413 [info ] [Thread-2 (]: 2 of 5 START sql table model RAW_public.dim_customer ........................... [RUN]
[0m23:49:29.705147 [info ] [Thread-3 (]: 3 of 5 START sql incremental model RAW_public.fact_churn ....................... [RUN]
[0m23:49:29.711038 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON_RAW_public, now model.customer_churn.dim_address)
[0m23:49:29.768344 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.customer_churn.dim_customer'
[0m23:49:29.775509 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.customer_churn.fact_churn'
[0m23:49:29.779234 [debug] [Thread-1 (]: Began compiling node model.customer_churn.dim_address
[0m23:49:29.782943 [debug] [Thread-2 (]: Began compiling node model.customer_churn.dim_customer
[0m23:49:29.784706 [debug] [Thread-3 (]: Began compiling node model.customer_churn.fact_churn
[0m23:49:29.797270 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.dim_address"
[0m23:49:29.801967 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer_churn.dim_customer"
[0m23:49:29.822725 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.fact_churn"
[0m23:49:29.845979 [debug] [Thread-1 (]: Began executing node model.customer_churn.dim_address
[0m23:49:29.854249 [debug] [Thread-3 (]: Began executing node model.customer_churn.fact_churn
[0m23:49:29.873147 [debug] [Thread-2 (]: Began executing node model.customer_churn.dim_customer
[0m23:49:29.892126 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.dim_address"
[0m23:49:29.905741 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer_churn.dim_customer"
[0m23:49:29.925936 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:49:29.927207 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
create or replace  temporary view USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
  
   as (
    -- models/marts/fact_churn.sql


select
  t.individual_id,
  t.churn_date,
  e.city,
  e.state,
  e.county,
  e.age_in_years,
  e.days_tenure,
  e.annual_premium,
  c.churn_flag
from USER_DB_FALCON.RAW_public.stg_termination t
join USER_DB_FALCON.RAW_public.int_customer_enriched e
  using (individual_id)
left join USER_DB_FALCON.RAW_public.stg_autoinsurance_churn c
  using (individual_id)


where t.churn_date > (select max(churn_date) from USER_DB_FALCON.RAW_public.fact_churn)

  );
[0m23:49:29.928148 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:49:29.934530 [debug] [Thread-2 (]: Using snowflake connection "model.customer_churn.dim_customer"
[0m23:49:29.936921 [debug] [Thread-2 (]: On model.customer_churn.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.dim_customer"} */
create or replace transient table USER_DB_FALCON.RAW_public.dim_customer
         as
        (-- models/marts/dim_customer.sql


select distinct
  individual_id,
  age_in_years as age,
  marital_status,
  has_children,
  length_of_residence
from USER_DB_FALCON.RAW_public.int_customer_enriched
        );
[0m23:49:29.938109 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:49:29.939441 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.dim_address"
[0m23:49:29.941995 [debug] [Thread-1 (]: On model.customer_churn.dim_address: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.dim_address"} */
create or replace transient table USER_DB_FALCON.RAW_public.dim_address
         as
        (-- models/marts/dim_address.sql


select distinct
  individual_id,
  city,
  state,
  county,
  lat,
  lon
from USER_DB_FALCON.RAW_public.int_customer_enriched
        );
[0m23:49:29.942852 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:30.172100 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 1.113 seconds
[0m23:49:30.174295 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m23:49:30.311939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65c2a8da-8fa8-4675-a498-f9b7dc175f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f62fe2540>]}
[0m23:49:30.313740 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:49:30.314873 [info ] [MainThread]: 
[0m23:49:30.335282 [debug] [Thread-1 (]: Began running node model.customer_churn.dim_address
[0m23:49:30.336087 [debug] [Thread-2 (]: Began running node model.customer_churn.dim_customer
[0m23:49:30.336864 [debug] [Thread-3 (]: Began running node model.customer_churn.fact_churn
[0m23:49:30.337762 [info ] [Thread-1 (]: 1 of 5 START sql table model RAW_public.dim_address ............................ [RUN]
[0m23:49:30.338946 [info ] [Thread-2 (]: 2 of 5 START sql table model RAW_public.dim_customer ........................... [RUN]
[0m23:49:30.340028 [info ] [Thread-3 (]: 3 of 5 START sql incremental model RAW_public.fact_churn ....................... [RUN]
[0m23:49:30.340980 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON_RAW_public, now model.customer_churn.dim_address)
[0m23:49:30.342299 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.customer_churn.dim_customer'
[0m23:49:30.343358 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.customer_churn.fact_churn'
[0m23:49:30.344237 [debug] [Thread-1 (]: Began compiling node model.customer_churn.dim_address
[0m23:49:30.345026 [debug] [Thread-2 (]: Began compiling node model.customer_churn.dim_customer
[0m23:49:30.345732 [debug] [Thread-3 (]: Began compiling node model.customer_churn.fact_churn
[0m23:49:30.355529 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.dim_address"
[0m23:49:30.358292 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer_churn.dim_customer"
[0m23:49:30.366446 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.fact_churn"
[0m23:49:30.370063 [debug] [Thread-3 (]: Began executing node model.customer_churn.fact_churn
[0m23:49:30.370433 [debug] [Thread-1 (]: Began executing node model.customer_churn.dim_address
[0m23:49:30.375854 [debug] [Thread-2 (]: Began executing node model.customer_churn.dim_customer
[0m23:49:30.483308 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.dim_address"
[0m23:49:30.484543 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer_churn.dim_customer"
[0m23:49:30.485520 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:49:30.488804 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
create or replace  temporary view USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
  
   as (
    -- models/marts/fact_churn.sql


select
  t.individual_id,
  t.churn_date,
  e.city,
  e.state,
  e.county,
  e.age_in_years,
  e.days_tenure,
  e.annual_premium,
  c.churn_flag
from USER_DB_FALCON.RAW_public.stg_termination t
join USER_DB_FALCON.RAW_public.int_customer_enriched e
  using (individual_id)
left join USER_DB_FALCON.RAW_public.stg_autoinsurance_churn c
  using (individual_id)


where t.churn_date > (select max(churn_date) from USER_DB_FALCON.RAW_public.fact_churn)

  );
[0m23:49:30.489940 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:49:30.501980 [debug] [Thread-2 (]: Using snowflake connection "model.customer_churn.dim_customer"
[0m23:49:30.502910 [debug] [Thread-2 (]: On model.customer_churn.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.dim_customer"} */
create or replace transient table USER_DB_FALCON.RAW_public.dim_customer
         as
        (-- models/marts/dim_customer.sql


select distinct
  individual_id,
  age_in_years as age,
  marital_status,
  has_children,
  length_of_residence
from USER_DB_FALCON.RAW_public.int_customer_enriched
        );
[0m23:49:30.503808 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:49:30.506198 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.dim_address"
[0m23:49:30.508157 [debug] [Thread-1 (]: On model.customer_churn.dim_address: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.dim_address"} */
create or replace transient table USER_DB_FALCON.RAW_public.dim_address
         as
        (-- models/marts/dim_address.sql


select distinct
  individual_id,
  city,
  state,
  county,
  lat,
  lon
from USER_DB_FALCON.RAW_public.int_customer_enriched
        );
[0m23:49:30.509677 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:30.763535 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.835 seconds
[0m23:49:30.797400 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:49:30.801047 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
[0m23:49:30.927598 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 0.124 seconds
[0m23:49:30.931074 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:49:30.934400 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table USER_DB_FALCON.RAW_public.fact_churn
[0m23:49:31.055683 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 0.119 seconds
[0m23:49:31.066683 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:49:31.078404 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table "USER_DB_FALCON"."RAW_PUBLIC"."FACT_CHURN"
[0m23:49:31.149959 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.660 seconds
[0m23:49:31.168442 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:49:31.169692 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
[0m23:49:31.185265 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 0.105 seconds
[0m23:49:31.248292 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.fact_churn"
[0m23:49:31.268197 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 0.097 seconds
[0m23:49:31.278346 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:49:31.280573 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table USER_DB_FALCON.RAW_public.fact_churn
[0m23:49:31.295158 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:49:31.296217 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
-- back compat for old kwarg name
  
  begin;
[0m23:49:31.404043 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.107 seconds
[0m23:49:31.405546 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:49:31.406734 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
merge into USER_DB_FALCON.RAW_public.fact_churn as DBT_INTERNAL_DEST
        using USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.individual_id = DBT_INTERNAL_DEST.individual_id
                ) and (
                    DBT_INTERNAL_SOURCE.churn_date = DBT_INTERNAL_DEST.churn_date
                )

    
    when matched then update set
        "INDIVIDUAL_ID" = DBT_INTERNAL_SOURCE."INDIVIDUAL_ID","CHURN_DATE" = DBT_INTERNAL_SOURCE."CHURN_DATE","CITY" = DBT_INTERNAL_SOURCE."CITY","STATE" = DBT_INTERNAL_SOURCE."STATE","COUNTY" = DBT_INTERNAL_SOURCE."COUNTY","AGE_IN_YEARS" = DBT_INTERNAL_SOURCE."AGE_IN_YEARS","DAYS_TENURE" = DBT_INTERNAL_SOURCE."DAYS_TENURE","ANNUAL_PREMIUM" = DBT_INTERNAL_SOURCE."ANNUAL_PREMIUM","CHURN_FLAG" = DBT_INTERNAL_SOURCE."CHURN_FLAG"
    

    when not matched then insert
        ("INDIVIDUAL_ID", "CHURN_DATE", "CITY", "STATE", "COUNTY", "AGE_IN_YEARS", "DAYS_TENURE", "ANNUAL_PREMIUM", "CHURN_FLAG")
    values
        ("INDIVIDUAL_ID", "CHURN_DATE", "CITY", "STATE", "COUNTY", "AGE_IN_YEARS", "DAYS_TENURE", "ANNUAL_PREMIUM", "CHURN_FLAG")

;
[0m23:49:32.108661 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 0.824 seconds
[0m23:49:32.117875 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:49:32.119678 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table "USER_DB_FALCON"."RAW_PUBLIC"."FACT_CHURN"
[0m23:49:32.272046 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 0.151 seconds
[0m23:49:32.327168 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.fact_churn"
[0m23:49:32.356814 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:49:32.360339 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
-- back compat for old kwarg name
  
  begin;
[0m23:49:32.484140 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.120 seconds
[0m23:49:32.485728 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:49:32.486495 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
merge into USER_DB_FALCON.RAW_public.fact_churn as DBT_INTERNAL_DEST
        using USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.individual_id = DBT_INTERNAL_DEST.individual_id
                ) and (
                    DBT_INTERNAL_SOURCE.churn_date = DBT_INTERNAL_DEST.churn_date
                )

    
    when matched then update set
        "INDIVIDUAL_ID" = DBT_INTERNAL_SOURCE."INDIVIDUAL_ID","CHURN_DATE" = DBT_INTERNAL_SOURCE."CHURN_DATE","CITY" = DBT_INTERNAL_SOURCE."CITY","STATE" = DBT_INTERNAL_SOURCE."STATE","COUNTY" = DBT_INTERNAL_SOURCE."COUNTY","AGE_IN_YEARS" = DBT_INTERNAL_SOURCE."AGE_IN_YEARS","DAYS_TENURE" = DBT_INTERNAL_SOURCE."DAYS_TENURE","ANNUAL_PREMIUM" = DBT_INTERNAL_SOURCE."ANNUAL_PREMIUM","CHURN_FLAG" = DBT_INTERNAL_SOURCE."CHURN_FLAG"
    

    when not matched then insert
        ("INDIVIDUAL_ID", "CHURN_DATE", "CITY", "STATE", "COUNTY", "AGE_IN_YEARS", "DAYS_TENURE", "ANNUAL_PREMIUM", "CHURN_FLAG")
    values
        ("INDIVIDUAL_ID", "CHURN_DATE", "CITY", "STATE", "COUNTY", "AGE_IN_YEARS", "DAYS_TENURE", "ANNUAL_PREMIUM", "CHURN_FLAG")

;
[0m23:49:33.389096 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 0.901 seconds
[0m23:49:33.390386 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:49:33.391182 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
COMMIT
[0m23:49:33.602983 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.211 seconds
[0m23:49:33.611784 [debug] [Thread-3 (]: Applying DROP to: USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
[0m23:49:33.625377 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:49:33.630637 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
drop view if exists USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp cascade
[0m23:49:33.783260 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 2.375 seconds
[0m23:49:33.784305 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:49:33.786279 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
COMMIT
[0m23:49:34.426421 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 4.488 seconds
[0m23:49:34.442811 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.810 seconds
[0m23:49:34.463699 [debug] [Thread-2 (]: On model.customer_churn.dim_customer: Close
[0m23:49:34.469126 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: Close
[0m23:49:34.546325 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.758 seconds
[0m23:49:34.556660 [debug] [Thread-3 (]: Applying DROP to: USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
[0m23:49:34.565943 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:49:34.567162 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
drop view if exists USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp cascade
[0m23:49:34.585939 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c54f0766-5263-4d4d-8b9e-3639ccdc3d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bd8ee9b50>]}
[0m23:49:34.586723 [info ] [Thread-2 (]: 2 of 5 OK created sql table model RAW_public.dim_customer ...................... [[32mSUCCESS 1[0m in 4.82s]
[0m23:49:34.589129 [debug] [Thread-2 (]: Finished running node model.customer_churn.dim_customer
[0m23:49:34.599085 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65c2a8da-8fa8-4675-a498-f9b7dc175f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fc11cd790>]}
[0m23:49:34.600851 [info ] [Thread-3 (]: 3 of 5 OK created sql incremental model RAW_public.fact_churn .................. [[32mSUCCESS 0[0m in 4.25s]
[0m23:49:34.602340 [debug] [Thread-3 (]: Finished running node model.customer_churn.fact_churn
[0m23:49:34.603717 [debug] [Thread-4 (]: Began running node model.customer_churn.churn_metrics
[0m23:49:34.608698 [info ] [Thread-4 (]: 4 of 5 START sql table model RAW_public.churn_metrics .......................... [RUN]
[0m23:49:34.610147 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.customer_churn.churn_metrics'
[0m23:49:34.613856 [debug] [Thread-4 (]: Began compiling node model.customer_churn.churn_metrics
[0m23:49:34.618226 [debug] [Thread-4 (]: Writing injected SQL for node "model.customer_churn.churn_metrics"
[0m23:49:34.632500 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 4.129 seconds
[0m23:49:34.636646 [debug] [Thread-2 (]: On model.customer_churn.dim_customer: Close
[0m23:49:34.654538 [debug] [Thread-4 (]: Began executing node model.customer_churn.churn_metrics
[0m23:49:34.657636 [debug] [Thread-4 (]: Writing runtime sql for node "model.customer_churn.churn_metrics"
[0m23:49:34.683773 [debug] [Thread-4 (]: Using snowflake connection "model.customer_churn.churn_metrics"
[0m23:49:34.685023 [debug] [Thread-4 (]: On model.customer_churn.churn_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.churn_metrics"} */
create or replace transient table USER_DB_FALCON.RAW_public.churn_metrics
         as
        (WITH 
  by_tenure AS (
    SELECT
      width_bucket(days_tenure, 0, 6000, 6)           AS period,
      SUM(churn_flag)                                 AS churn_count,
      width_bucket(days_tenure, 0, 6000, 6)           AS tenure_bucket_index,
      CASE
        WHEN days_tenure <=  90 THEN '0-3 months'
        WHEN days_tenure <= 180 THEN '4-6 months'
        WHEN days_tenure <= 365 THEN '7-12 months'
        WHEN days_tenure <= 730 THEN '13-24 months'
        ELSE                        '25+ months'
      END                                             AS tenure_bucket_label
    FROM USER_DB_FALCON.RAW_public.fact_churn
    GROUP BY 1, 3, 4
  ),
  
  by_premium AS (
    SELECT
      premium_flag            AS period,
      SUM(churn_flag)         AS churn_count
    FROM USER_DB_FALCON.RAW_public.fact_churn
    GROUP BY 1
  )

SELECT
  CAST(period AS VARCHAR) AS period,
  churn_count,
  'by_tenure'             AS category
FROM by_tenure

UNION ALL

SELECT
  CAST(period AS VARCHAR) AS period,
  churn_count,
  'by_premium'            AS category
FROM by_premium;
[0m23:49:34.686282 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:49:34.759280 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.186 seconds
[0m23:49:34.763272 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: Close
[0m23:49:34.768666 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65c2a8da-8fa8-4675-a498-f9b7dc175f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f61d91f40>]}
[0m23:49:34.770435 [info ] [Thread-2 (]: 2 of 5 OK created sql table model RAW_public.dim_customer ...................... [[32mSUCCESS 1[0m in 4.43s]
[0m23:49:34.772152 [debug] [Thread-2 (]: Finished running node model.customer_churn.dim_customer
[0m23:49:34.887582 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c54f0766-5263-4d4d-8b9e-3639ccdc3d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b799de750>]}
[0m23:49:34.889924 [info ] [Thread-3 (]: 3 of 5 OK created sql incremental model RAW_public.fact_churn .................. [[32mSUCCESS 0[0m in 5.11s]
[0m23:49:34.891735 [debug] [Thread-3 (]: Finished running node model.customer_churn.fact_churn
[0m23:49:34.931894 [debug] [Thread-4 (]: Began running node model.customer_churn.churn_metrics
[0m23:49:34.933587 [info ] [Thread-4 (]: 4 of 5 START sql table model RAW_public.churn_metrics .......................... [RUN]
[0m23:49:34.934602 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.customer_churn.churn_metrics'
[0m23:49:34.935431 [debug] [Thread-4 (]: Began compiling node model.customer_churn.churn_metrics
[0m23:49:34.938546 [debug] [Thread-4 (]: Writing injected SQL for node "model.customer_churn.churn_metrics"
[0m23:49:35.001892 [debug] [Thread-4 (]: Began executing node model.customer_churn.churn_metrics
[0m23:49:35.010256 [debug] [Thread-4 (]: Writing runtime sql for node "model.customer_churn.churn_metrics"
[0m23:49:35.042888 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 5.100 seconds
[0m23:49:35.048314 [debug] [Thread-1 (]: On model.customer_churn.dim_address: Close
[0m23:49:35.059282 [debug] [Thread-4 (]: Using snowflake connection "model.customer_churn.churn_metrics"
[0m23:49:35.061018 [debug] [Thread-4 (]: On model.customer_churn.churn_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.churn_metrics"} */
create or replace transient table USER_DB_FALCON.RAW_public.churn_metrics
         as
        (WITH 
  by_tenure AS (
    SELECT
      width_bucket(days_tenure, 0, 6000, 6)           AS period,
      SUM(churn_flag)                                 AS churn_count,
      width_bucket(days_tenure, 0, 6000, 6)           AS tenure_bucket_index,
      CASE
        WHEN days_tenure <=  90 THEN '0-3 months'
        WHEN days_tenure <= 180 THEN '4-6 months'
        WHEN days_tenure <= 365 THEN '7-12 months'
        WHEN days_tenure <= 730 THEN '13-24 months'
        ELSE                        '25+ months'
      END                                             AS tenure_bucket_label
    FROM USER_DB_FALCON.RAW_public.fact_churn
    GROUP BY 1, 3, 4
  ),
  
  by_premium AS (
    SELECT
      premium_flag            AS period,
      SUM(churn_flag)         AS churn_count
    FROM USER_DB_FALCON.RAW_public.fact_churn
    GROUP BY 1
  )

SELECT
  CAST(period AS VARCHAR) AS period,
  churn_count,
  'by_tenure'             AS category
FROM by_tenure

UNION ALL

SELECT
  CAST(period AS VARCHAR) AS period,
  churn_count,
  'by_premium'            AS category
FROM by_premium;
[0m23:49:35.062998 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:49:35.100998 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01bc27b5-0305-27c0-0004-59ff003baca6
[0m23:49:35.101827 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 40 at position 15 unexpected ';'.
[0m23:49:35.102530 [debug] [Thread-4 (]: On model.customer_churn.churn_metrics: Close
[0m23:49:35.185702 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c54f0766-5263-4d4d-8b9e-3639ccdc3d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b799dca10>]}
[0m23:49:35.188217 [info ] [Thread-1 (]: 1 of 5 OK created sql table model RAW_public.dim_address ....................... [[32mSUCCESS 1[0m in 5.47s]
[0m23:49:35.189594 [debug] [Thread-1 (]: Finished running node model.customer_churn.dim_address
[0m23:49:35.192859 [debug] [Thread-3 (]: Began running node model.customer_churn.churn_map
[0m23:49:35.195709 [info ] [Thread-3 (]: 5 of 5 START sql table model RAW_public.churn_map .............................. [RUN]
[0m23:49:35.197095 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer_churn.fact_churn, now model.customer_churn.churn_map)
[0m23:49:35.198382 [debug] [Thread-3 (]: Began compiling node model.customer_churn.churn_map
[0m23:49:35.205899 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.churn_map"
[0m23:49:35.243741 [debug] [Thread-4 (]: Database Error in model churn_metrics (models/marts/churn_metrics.sql)
  001003 (42000): SQL compilation error:
  syntax error line 40 at position 15 unexpected ';'.
  compiled code at target/run/customer_churn/models/marts/churn_metrics.sql
[0m23:49:35.260958 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65c2a8da-8fa8-4675-a498-f9b7dc175f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f61d41a60>]}
[0m23:49:35.262019 [error] [Thread-4 (]: 4 of 5 ERROR creating sql table model RAW_public.churn_metrics ................. [[31mERROR[0m in 0.65s]
[0m23:49:35.262959 [debug] [Thread-4 (]: Finished running node model.customer_churn.churn_metrics
[0m23:49:35.288690 [debug] [Thread-3 (]: Began executing node model.customer_churn.churn_map
[0m23:49:35.292619 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.churn_map"
[0m23:49:35.315095 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.churn_map"
[0m23:49:35.315855 [debug] [Thread-3 (]: On model.customer_churn.churn_map: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.churn_map"} */
create or replace transient table USER_DB_FALCON.RAW_public.churn_map
         as
        (-- models/marts/churn_map.sql


select
  f.individual_id,
  f.churn_date,
  f.churn_flag,
  a.lon,
  a.lat
from USER_DB_FALCON.RAW_public.fact_churn      as f
join USER_DB_FALCON.RAW_public.dim_address    as a
  using (individual_id)
        );
[0m23:49:35.316480 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:49:35.399180 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01bc27b5-0305-2211-0004-59ff003bbc2e
[0m23:49:35.400159 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 40 at position 15 unexpected ';'.
[0m23:49:35.400838 [debug] [Thread-4 (]: On model.customer_churn.churn_metrics: Close
[0m23:49:35.549854 [debug] [Thread-4 (]: Database Error in model churn_metrics (models/marts/churn_metrics.sql)
  001003 (42000): SQL compilation error:
  syntax error line 40 at position 15 unexpected ';'.
  compiled code at target/run/customer_churn/models/marts/churn_metrics.sql
[0m23:49:35.552027 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c54f0766-5263-4d4d-8b9e-3639ccdc3d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bdba2c470>]}
[0m23:49:35.559885 [error] [Thread-4 (]: 4 of 5 ERROR creating sql table model RAW_public.churn_metrics ................. [[31mERROR[0m in 0.62s]
[0m23:49:35.565029 [debug] [Thread-4 (]: Finished running node model.customer_churn.churn_metrics
[0m23:49:35.644420 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 5.135 seconds
[0m23:49:35.649164 [debug] [Thread-1 (]: On model.customer_churn.dim_address: Close
[0m23:49:35.772580 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65c2a8da-8fa8-4675-a498-f9b7dc175f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f61db81a0>]}
[0m23:49:35.773730 [info ] [Thread-1 (]: 1 of 5 OK created sql table model RAW_public.dim_address ....................... [[32mSUCCESS 1[0m in 5.43s]
[0m23:49:35.774696 [debug] [Thread-1 (]: Finished running node model.customer_churn.dim_address
[0m23:49:35.775825 [debug] [Thread-3 (]: Began running node model.customer_churn.churn_map
[0m23:49:35.776682 [info ] [Thread-3 (]: 5 of 5 START sql table model RAW_public.churn_map .............................. [RUN]
[0m23:49:35.777589 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer_churn.fact_churn, now model.customer_churn.churn_map)
[0m23:49:35.778232 [debug] [Thread-3 (]: Began compiling node model.customer_churn.churn_map
[0m23:49:35.785694 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.churn_map"
[0m23:49:35.801906 [debug] [Thread-3 (]: Began executing node model.customer_churn.churn_map
[0m23:49:35.808213 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.churn_map"
[0m23:49:35.825553 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.churn_map"
[0m23:49:35.826283 [debug] [Thread-3 (]: On model.customer_churn.churn_map: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.churn_map"} */
create or replace transient table USER_DB_FALCON.RAW_public.churn_map
         as
        (-- models/marts/churn_map.sql


select
  f.individual_id,
  f.churn_date,
  f.churn_flag,
  a.lon,
  a.lat
from USER_DB_FALCON.RAW_public.fact_churn      as f
join USER_DB_FALCON.RAW_public.dim_address    as a
  using (individual_id)
        );
[0m23:49:35.826902 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:49:36.982078 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.155 seconds
[0m23:49:36.985810 [debug] [Thread-3 (]: On model.customer_churn.churn_map: Close
[0m23:49:37.100944 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65c2a8da-8fa8-4675-a498-f9b7dc175f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fc3de50d0>]}
[0m23:49:37.104767 [info ] [Thread-3 (]: 5 of 5 OK created sql table model RAW_public.churn_map ......................... [[32mSUCCESS 1[0m in 1.32s]
[0m23:49:37.106311 [debug] [Thread-3 (]: Finished running node model.customer_churn.churn_map
[0m23:49:37.108868 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:49:37.109706 [debug] [MainThread]: Connection 'model.customer_churn.dim_address' was properly closed.
[0m23:49:37.110337 [debug] [MainThread]: Connection 'model.customer_churn.dim_customer' was properly closed.
[0m23:49:37.110879 [debug] [MainThread]: Connection 'model.customer_churn.churn_map' was properly closed.
[0m23:49:37.111516 [debug] [MainThread]: Connection 'model.customer_churn.churn_metrics' was properly closed.
[0m23:49:37.112394 [info ] [MainThread]: 
[0m23:49:37.113041 [info ] [MainThread]: Finished running 1 incremental model, 4 table models in 0 hours 0 minutes and 8.78 seconds (8.78s).
[0m23:49:37.115313 [debug] [MainThread]: Command end result
[0m23:49:37.261615 [info ] [MainThread]: 
[0m23:49:37.262338 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:49:37.262914 [info ] [MainThread]: 
[0m23:49:37.263947 [error] [MainThread]:   Database Error in model churn_metrics (models/marts/churn_metrics.sql)
  001003 (42000): SQL compilation error:
  syntax error line 40 at position 15 unexpected ';'.
  compiled code at target/run/customer_churn/models/marts/churn_metrics.sql
[0m23:49:37.264818 [info ] [MainThread]: 
[0m23:49:37.265498 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m23:49:37.266757 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 11.832943, "process_user_time": 6.484516, "process_kernel_time": 2.92178, "process_mem_max_rss": "284568", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m23:49:37.267718 [debug] [MainThread]: Command `dbt run` failed at 23:49:37.267601 after 11.83 seconds
[0m23:49:37.268513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fc0986480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fc33c3ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f62bdd670>]}
[0m23:49:37.269408 [debug] [MainThread]: Flushing usage events
[0m23:49:37.546647 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.230 seconds
[0m23:49:37.550671 [debug] [Thread-3 (]: On model.customer_churn.churn_map: Close
[0m23:49:37.724466 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c54f0766-5263-4d4d-8b9e-3639ccdc3d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b79b6a6f0>]}
[0m23:49:37.726232 [info ] [Thread-3 (]: 5 of 5 OK created sql table model RAW_public.churn_map ......................... [[32mSUCCESS 1[0m in 2.53s]
[0m23:49:37.727396 [debug] [Thread-3 (]: Finished running node model.customer_churn.churn_map
[0m23:49:37.730759 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:49:37.732181 [debug] [MainThread]: Connection 'model.customer_churn.dim_address' was properly closed.
[0m23:49:37.732930 [debug] [MainThread]: Connection 'model.customer_churn.dim_customer' was properly closed.
[0m23:49:37.733680 [debug] [MainThread]: Connection 'model.customer_churn.churn_map' was properly closed.
[0m23:49:37.734395 [debug] [MainThread]: Connection 'model.customer_churn.churn_metrics' was properly closed.
[0m23:49:37.735261 [info ] [MainThread]: 
[0m23:49:37.736024 [info ] [MainThread]: Finished running 4 table models, 1 incremental model in 0 hours 0 minutes and 9.59 seconds (9.59s).
[0m23:49:37.738084 [debug] [MainThread]: Command end result
[0m23:49:37.841745 [info ] [MainThread]: 
[0m23:49:37.842907 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:49:37.843901 [info ] [MainThread]: 
[0m23:49:37.845095 [error] [MainThread]:   Database Error in model churn_metrics (models/marts/churn_metrics.sql)
  001003 (42000): SQL compilation error:
  syntax error line 40 at position 15 unexpected ';'.
  compiled code at target/run/customer_churn/models/marts/churn_metrics.sql
[0m23:49:37.846219 [info ] [MainThread]: 
[0m23:49:37.847553 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m23:49:37.849961 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 12.534319, "process_user_time": 6.485017, "process_kernel_time": 2.871235, "process_mem_max_rss": "279360", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m23:49:37.851275 [debug] [MainThread]: Command `dbt run` failed at 23:49:37.851027 after 12.54 seconds
[0m23:49:37.852243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bd86fd8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bd898c2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b7a7a13d0>]}
[0m23:49:37.853187 [debug] [MainThread]: Flushing usage events
[0m23:53:58.128980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc648d40b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc6867e270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc652f5df0>]}


============================== 23:53:58.136786 | 32c6e4bc-247d-481c-aa0e-19274bba3d0a ==============================
[0m23:53:58.136786 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:53:58.129043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f85e41220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f86049fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f85e41730>]}
[0m23:53:58.137783 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}


============================== 23:53:58.138811 | 48f7072e-e129-4c24-b33f-fe17aea48318 ==============================
[0m23:53:58.138811 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:53:58.140208 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:53:58.301834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '48f7072e-e129-4c24-b33f-fe17aea48318', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f873a6930>]}
[0m23:53:58.302761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '32c6e4bc-247d-481c-aa0e-19274bba3d0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc648cd580>]}
[0m23:53:58.321593 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:53:58.321594 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:53:58.329955 [error] [MainThread]: Encountered an error:
[Errno 2] No such file or directory: 'dbt_packages'
[0m23:53:58.333091 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:53:58.333555 [error] [MainThread]: Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 201, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/main.py", line 447, in deps
    results = task.run()
              ^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/task/deps.py", line 233, in run
    system.rmtree(self.project.packages_install_path)
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt_common/clients/system.py", line 715, in rmtree
    return shutil.rmtree(path, onerror=chmod_and_retry)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/shutil.py", line 759, in rmtree
    _rmtree_safe_fd(stack, onexc)
  File "/usr/local/lib/python3.12/shutil.py", line 703, in _rmtree_safe_fd
    onexc(func, path, err)
  File "/usr/local/lib/python3.12/shutil.py", line 750, in onexc
    return onerror(func, path, exc_info)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/shutil.py", line 662, in _rmtree_safe_fd
    os.rmdir(name, dir_fd=dirfd)
FileNotFoundError: [Errno 2] No such file or directory: 'dbt_packages'

[0m23:53:58.335137 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.29408258, "process_user_time": 2.923012, "process_kernel_time": 0.19694, "process_mem_max_rss": "165568", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:53:58.335587 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_wall_clock_time": 0.29490685, "process_user_time": 2.895024, "process_kernel_time": 0.229102, "process_mem_max_rss": "165564", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:53:58.336434 [debug] [MainThread]: Command `dbt deps` succeeded at 23:53:58.336213 after 0.30 seconds
[0m23:53:58.336805 [debug] [MainThread]: Command `dbt deps` failed at 23:53:58.336595 after 0.30 seconds
[0m23:53:58.337809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f86049fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f8888b050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f865d5520>]}
[0m23:53:58.337879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc65113530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc6867fad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc64454230>]}
[0m23:53:58.338936 [debug] [MainThread]: Flushing usage events
[0m23:53:58.339063 [debug] [MainThread]: Flushing usage events
[0m23:54:02.947520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69f52a74a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69f3041010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69f30432f0>]}


============================== 23:54:02.960545 | b39bb379-baee-4f17-b56e-68c1fe72f977 ==============================
[0m23:54:02.960545 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:54:02.994966 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt --select staging', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:54:04.385045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b39bb379-baee-4f17-b56e-68c1fe72f977', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f699b1a2570>]}
[0m23:54:04.456405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b39bb379-baee-4f17-b56e-68c1fe72f977', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6998f56000>]}
[0m23:54:04.458687 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m23:54:04.574919 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:54:05.066223 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:54:05.067885 [debug] [MainThread]: Partial parsing: updated file: customer_churn://models/marts/churn_metrics.sql
[0m23:54:05.559352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b39bb379-baee-4f17-b56e-68c1fe72f977', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f699057fcb0>]}
[0m23:54:05.801912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b39bb379-baee-4f17-b56e-68c1fe72f977', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6990502450>]}
[0m23:54:05.803050 [info ] [MainThread]: Found 12 models, 10 data tests, 7 sources, 459 macros
[0m23:54:05.803791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b39bb379-baee-4f17-b56e-68c1fe72f977', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6998b00ad0>]}
[0m23:54:05.806338 [info ] [MainThread]: 
[0m23:54:05.808141 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:54:05.813906 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON'
[0m23:54:05.829250 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON"
[0m23:54:05.830238 [debug] [ThreadPool]: On list_USER_DB_FALCON: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON"} */
show terse schemas in database USER_DB_FALCON
    limit 10000
[0m23:54:05.831013 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:54:06.442650 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.611 seconds
[0m23:54:06.447701 [debug] [ThreadPool]: On list_USER_DB_FALCON: Close
[0m23:54:06.601582 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON, now list_USER_DB_FALCON_RAW_public)
[0m23:54:06.618745 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m23:54:06.619833 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show terse objects in USER_DB_FALCON.RAW_public limit 10000
[0m23:54:06.620957 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:54:06.989842 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.369 seconds
[0m23:54:06.995650 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m23:54:07.139537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b39bb379-baee-4f17-b56e-68c1fe72f977', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6998daecc0>]}
[0m23:54:07.179035 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:54:07.182365 [info ] [MainThread]: 
[0m23:54:07.196632 [debug] [Thread-1 (]: Began running node model.customer_churn.stg_address
[0m23:54:07.197015 [debug] [Thread-2 (]: Began running node model.customer_churn.stg_autoinsurance_churn
[0m23:54:07.197579 [debug] [Thread-3 (]: Began running node model.customer_churn.stg_customer
[0m23:54:07.198919 [debug] [Thread-4 (]: Began running node model.customer_churn.stg_demographic
[0m23:54:07.204987 [info ] [Thread-1 (]: 1 of 6 START sql view model RAW_public.stg_address ............................. [RUN]
[0m23:54:07.207546 [info ] [Thread-2 (]: 2 of 6 START sql view model RAW_public.stg_autoinsurance_churn ................. [RUN]
[0m23:54:07.214467 [info ] [Thread-3 (]: 3 of 6 START sql view model RAW_public.stg_customer ............................ [RUN]
[0m23:54:07.215921 [info ] [Thread-4 (]: 4 of 6 START sql view model RAW_public.stg_demographic ......................... [RUN]
[0m23:54:07.218354 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON_RAW_public, now model.customer_churn.stg_address)
[0m23:54:07.220520 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.customer_churn.stg_autoinsurance_churn'
[0m23:54:07.221473 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.customer_churn.stg_customer'
[0m23:54:07.222318 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.customer_churn.stg_demographic'
[0m23:54:07.226200 [debug] [Thread-1 (]: Began compiling node model.customer_churn.stg_address
[0m23:54:07.230317 [debug] [Thread-2 (]: Began compiling node model.customer_churn.stg_autoinsurance_churn
[0m23:54:07.230905 [debug] [Thread-3 (]: Began compiling node model.customer_churn.stg_customer
[0m23:54:07.231419 [debug] [Thread-4 (]: Began compiling node model.customer_churn.stg_demographic
[0m23:54:07.237809 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.stg_address"
[0m23:54:07.241007 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer_churn.stg_autoinsurance_churn"
[0m23:54:07.243796 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.stg_customer"
[0m23:54:07.246224 [debug] [Thread-4 (]: Writing injected SQL for node "model.customer_churn.stg_demographic"
[0m23:54:07.252758 [debug] [Thread-3 (]: Began executing node model.customer_churn.stg_customer
[0m23:54:07.268771 [debug] [Thread-1 (]: Began executing node model.customer_churn.stg_address
[0m23:54:07.279592 [debug] [Thread-4 (]: Began executing node model.customer_churn.stg_demographic
[0m23:54:07.282159 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.stg_customer"
[0m23:54:07.283619 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.stg_address"
[0m23:54:07.285879 [debug] [Thread-4 (]: Writing runtime sql for node "model.customer_churn.stg_demographic"
[0m23:54:07.286197 [debug] [Thread-2 (]: Began executing node model.customer_churn.stg_autoinsurance_churn
[0m23:54:07.289909 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer_churn.stg_autoinsurance_churn"
[0m23:54:07.293441 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.stg_address"
[0m23:54:07.294195 [debug] [Thread-4 (]: Using snowflake connection "model.customer_churn.stg_demographic"
[0m23:54:07.295045 [debug] [Thread-1 (]: On model.customer_churn.stg_address: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_address"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_address
  
   as (
    -- models/staging/stg_address.sql

select
  address_id,
  street_address,
  city,
  state,
  county,
  latitude::float as lat,
  longitude::float as lon
from USER_DB_FALCON.RAW.ADDRESS_STAGING
  );
[0m23:54:07.295877 [debug] [Thread-4 (]: On model.customer_churn.stg_demographic: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_demographic"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_demographic
  
   as (
    

select
  individual_id,
  income,
  has_children,
  length_of_residence    as length_of_residence,  -- exact match
  marital_status,
  home_owner,
  home_market_value      as home_market_value,
  college_degree,
  good_credit
from USER_DB_FALCON.RAW.DEMOGRAPHIC_STAGING
  );
[0m23:54:07.296648 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.stg_customer"
[0m23:54:07.296991 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:54:07.297710 [debug] [Thread-2 (]: Using snowflake connection "model.customer_churn.stg_autoinsurance_churn"
[0m23:54:07.298097 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:54:07.298807 [debug] [Thread-3 (]: On model.customer_churn.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_customer"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_customer
  
   as (
    

select
  individual_id,
  address_id,
  curr_ann_amt    as annual_premium,
  days_tenure,
  cust_orig_date,
  age_in_years,            -- bring this in
  date_of_birth            -- and this
from USER_DB_FALCON.RAW.CUSTOMER_STAGING
where individual_id is not null
  );
[0m23:54:07.300794 [debug] [Thread-2 (]: On model.customer_churn.stg_autoinsurance_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_autoinsurance_churn"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_autoinsurance_churn
  
   as (
    

select
  individual_id,
  churn              as churn_flag
from USER_DB_FALCON.RAW.AUTOINSURANCE_CHURN_STAGING
  );
[0m23:54:07.303518 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:54:07.304856 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:54:07.892852 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.588 seconds
[0m23:54:07.911598 [debug] [Thread-2 (]: On model.customer_churn.stg_autoinsurance_churn: Close
[0m23:54:07.951129 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.647 seconds
[0m23:54:07.954311 [debug] [Thread-3 (]: On model.customer_churn.stg_customer: Close
[0m23:54:07.990490 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.693 seconds
[0m23:54:07.993018 [debug] [Thread-1 (]: On model.customer_churn.stg_address: Close
[0m23:54:08.042095 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b39bb379-baee-4f17-b56e-68c1fe72f977', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6998bc2930>]}
[0m23:54:08.044020 [info ] [Thread-2 (]: 2 of 6 OK created sql view model RAW_public.stg_autoinsurance_churn ............ [[32mSUCCESS 1[0m in 0.82s]
[0m23:54:08.047395 [debug] [Thread-2 (]: Finished running node model.customer_churn.stg_autoinsurance_churn
[0m23:54:08.049650 [debug] [Thread-2 (]: Began running node model.customer_churn.stg_termination
[0m23:54:08.051201 [info ] [Thread-2 (]: 5 of 6 START sql view model RAW_public.stg_termination ......................... [RUN]
[0m23:54:08.052099 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer_churn.stg_autoinsurance_churn, now model.customer_churn.stg_termination)
[0m23:54:08.054106 [debug] [Thread-2 (]: Began compiling node model.customer_churn.stg_termination
[0m23:54:08.059085 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer_churn.stg_termination"
[0m23:54:08.087582 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b39bb379-baee-4f17-b56e-68c1fe72f977', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69902a7680>]}
[0m23:54:08.089531 [info ] [Thread-3 (]: 3 of 6 OK created sql view model RAW_public.stg_customer ....................... [[32mSUCCESS 1[0m in 0.87s]
[0m23:54:08.090820 [debug] [Thread-3 (]: Finished running node model.customer_churn.stg_customer
[0m23:54:08.094662 [debug] [Thread-3 (]: Began running node model.customer_churn.stg_turning_movement
[0m23:54:08.095472 [info ] [Thread-3 (]: 6 of 6 START sql view model RAW_public.stg_turning_movement .................... [RUN]
[0m23:54:08.096578 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer_churn.stg_customer, now model.customer_churn.stg_turning_movement)
[0m23:54:08.097999 [debug] [Thread-3 (]: Began compiling node model.customer_churn.stg_turning_movement
[0m23:54:08.105170 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.stg_turning_movement"
[0m23:54:08.105957 [debug] [Thread-2 (]: Began executing node model.customer_churn.stg_termination
[0m23:54:08.109480 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer_churn.stg_termination"
[0m23:54:08.127249 [debug] [Thread-3 (]: Began executing node model.customer_churn.stg_turning_movement
[0m23:54:08.134219 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.stg_turning_movement"
[0m23:54:08.137035 [debug] [Thread-2 (]: Using snowflake connection "model.customer_churn.stg_termination"
[0m23:54:08.138943 [debug] [Thread-2 (]: On model.customer_churn.stg_termination: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_termination"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_termination
  
   as (
    

select
  individual_id,
  acct_suspd_date    as churn_date
from USER_DB_FALCON.RAW.TERMINATION_STAGING
  );
[0m23:54:08.140832 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b39bb379-baee-4f17-b56e-68c1fe72f977', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69903eb8f0>]}
[0m23:54:08.142618 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:54:08.154072 [info ] [Thread-1 (]: 1 of 6 OK created sql view model RAW_public.stg_address ........................ [[32mSUCCESS 1[0m in 0.92s]
[0m23:54:08.160658 [debug] [Thread-1 (]: Finished running node model.customer_churn.stg_address
[0m23:54:08.169334 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.stg_turning_movement"
[0m23:54:08.170127 [debug] [Thread-3 (]: On model.customer_churn.stg_turning_movement: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_turning_movement"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_turning_movement
  
   as (
    -- models/staging/stg_turning_movement.sql

select
  objectid,
  facilityid,
  intid,
  intname,
  nodeno,
  longitude::float as tm_lon,
  latitude::float  as tm_lat
from USER_DB_FALCON.RAW.TURNING_MOVEMENT
  );
[0m23:54:08.170774 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:54:08.353173 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.055 seconds
[0m23:54:08.357212 [debug] [Thread-4 (]: On model.customer_churn.stg_demographic: Close
[0m23:54:08.492161 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b39bb379-baee-4f17-b56e-68c1fe72f977', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69900c8830>]}
[0m23:54:08.493977 [info ] [Thread-4 (]: 4 of 6 OK created sql view model RAW_public.stg_demographic .................... [[32mSUCCESS 1[0m in 1.27s]
[0m23:54:08.495835 [debug] [Thread-4 (]: Finished running node model.customer_churn.stg_demographic
[0m23:54:08.608066 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.465 seconds
[0m23:54:08.612476 [debug] [Thread-2 (]: On model.customer_churn.stg_termination: Close
[0m23:54:08.746303 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b39bb379-baee-4f17-b56e-68c1fe72f977', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6990369d30>]}
[0m23:54:08.747406 [info ] [Thread-2 (]: 5 of 6 OK created sql view model RAW_public.stg_termination .................... [[32mSUCCESS 1[0m in 0.69s]
[0m23:54:08.748635 [debug] [Thread-2 (]: Finished running node model.customer_churn.stg_termination
[0m23:54:08.753838 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.583 seconds
[0m23:54:08.765554 [debug] [Thread-3 (]: On model.customer_churn.stg_turning_movement: Close
[0m23:54:08.896683 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b39bb379-baee-4f17-b56e-68c1fe72f977', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f699021cfe0>]}
[0m23:54:08.898173 [info ] [Thread-3 (]: 6 of 6 OK created sql view model RAW_public.stg_turning_movement ............... [[32mSUCCESS 1[0m in 0.80s]
[0m23:54:08.899149 [debug] [Thread-3 (]: Finished running node model.customer_churn.stg_turning_movement
[0m23:54:08.901647 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:54:08.902534 [debug] [MainThread]: Connection 'model.customer_churn.stg_address' was properly closed.
[0m23:54:08.903286 [debug] [MainThread]: Connection 'model.customer_churn.stg_termination' was properly closed.
[0m23:54:08.903735 [debug] [MainThread]: Connection 'model.customer_churn.stg_turning_movement' was properly closed.
[0m23:54:08.904415 [debug] [MainThread]: Connection 'model.customer_churn.stg_demographic' was properly closed.
[0m23:54:08.905226 [info ] [MainThread]: 
[0m23:54:08.906034 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 3.10 seconds (3.10s).
[0m23:54:08.907704 [debug] [MainThread]: Command end result
[0m23:54:09.122726 [info ] [MainThread]: 
[0m23:54:09.124568 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:54:09.126575 [info ] [MainThread]: 
[0m23:54:09.128549 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m23:54:09.131356 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.3001304, "process_user_time": 6.099158, "process_kernel_time": 2.769462, "process_mem_max_rss": "274172", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m23:54:09.132138 [debug] [MainThread]: Command `dbt run` succeeded at 23:54:09.132058 after 6.30 seconds
[0m23:54:09.134481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69f296e030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f699b1a04d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69f45d3890>]}
[0m23:54:09.136521 [debug] [MainThread]: Flushing usage events
[0m23:54:12.967212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cda177410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cd9deb680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cdc427410>]}


============================== 23:54:12.973180 | a9952b23-50a1-4d0d-bb25-533901568f96 ==============================
[0m23:54:12.973180 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:54:12.974121 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt --select intermediate', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:54:14.356402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9952b23-50a1-4d0d-bb25-533901568f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c812d0da0>]}
[0m23:54:14.425295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a9952b23-50a1-4d0d-bb25-533901568f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cdaf42870>]}
[0m23:54:14.427126 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m23:54:14.551720 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:54:15.694978 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:54:15.697063 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:54:15.733308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9952b23-50a1-4d0d-bb25-533901568f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c809d17c0>]}
[0m23:54:16.069927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9952b23-50a1-4d0d-bb25-533901568f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c7b897fe0>]}
[0m23:54:16.071369 [info ] [MainThread]: Found 12 models, 10 data tests, 7 sources, 459 macros
[0m23:54:16.072565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9952b23-50a1-4d0d-bb25-533901568f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c7bf39520>]}
[0m23:54:16.075765 [info ] [MainThread]: 
[0m23:54:16.077255 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:54:16.079100 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON'
[0m23:54:16.101160 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON"
[0m23:54:16.102082 [debug] [ThreadPool]: On list_USER_DB_FALCON: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON"} */
show terse schemas in database USER_DB_FALCON
    limit 10000
[0m23:54:16.102864 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:54:16.656824 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.554 seconds
[0m23:54:16.661472 [debug] [ThreadPool]: On list_USER_DB_FALCON: Close
[0m23:54:16.792300 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON, now list_USER_DB_FALCON_RAW_public)
[0m23:54:16.810545 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m23:54:16.811749 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show terse objects in USER_DB_FALCON.RAW_public limit 10000
[0m23:54:16.812915 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:54:17.768256 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.955 seconds
[0m23:54:17.773120 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m23:54:17.892467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9952b23-50a1-4d0d-bb25-533901568f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cdb00c0b0>]}
[0m23:54:17.893988 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:54:17.895648 [info ] [MainThread]: 
[0m23:54:17.905599 [debug] [Thread-1 (]: Began running node model.customer_churn.int_customer_enriched
[0m23:54:17.906738 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW_public.int_customer_enriched ................... [RUN]
[0m23:54:17.907680 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON_RAW_public, now model.customer_churn.int_customer_enriched)
[0m23:54:17.908537 [debug] [Thread-1 (]: Began compiling node model.customer_churn.int_customer_enriched
[0m23:54:17.918090 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.int_customer_enriched"
[0m23:54:17.935913 [debug] [Thread-1 (]: Began executing node model.customer_churn.int_customer_enriched
[0m23:54:17.973644 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.int_customer_enriched"
[0m23:54:18.022444 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.int_customer_enriched"
[0m23:54:18.023516 [debug] [Thread-1 (]: On model.customer_churn.int_customer_enriched: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.int_customer_enriched"} */
create or replace   view USER_DB_FALCON.RAW_public.int_customer_enriched
  
   as (
    

with cust as (
    select
        individual_id,
        annual_premium,
        days_tenure,
        cust_orig_date,
        age_in_years,
        date_of_birth,
        address_id
    from USER_DB_FALCON.RAW_public.stg_customer
),

demo as (
    select
        individual_id,
        has_children,
        length_of_residence,
        marital_status,
        home_owner,
        home_market_value,
        college_degree,
        good_credit
    from USER_DB_FALCON.RAW_public.stg_demographic
),

addr as (
    select
        address_id,
        city,
        state,
        county,
        lat,
        lon
    from USER_DB_FALCON.RAW_public.stg_address
)

select
    cust.individual_id,
    cust.annual_premium,
    cust.days_tenure,
    cust.cust_orig_date,
    cust.age_in_years,
    cust.date_of_birth,
    demo.has_children,
    demo.length_of_residence,
    demo.marital_status,
    demo.home_owner,
    demo.home_market_value,
    addr.city,
    addr.state,
    addr.county,
    addr.lat,
    addr.lon
from cust
left join demo using (individual_id)
left join addr using (address_id)
  );
[0m23:54:18.024598 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:54:18.836707 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.812 seconds
[0m23:54:18.855082 [debug] [Thread-1 (]: On model.customer_churn.int_customer_enriched: Close
[0m23:54:19.064080 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9952b23-50a1-4d0d-bb25-533901568f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c7bd86ed0>]}
[0m23:54:19.075674 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW_public.int_customer_enriched .............. [[32mSUCCESS 1[0m in 1.15s]
[0m23:54:19.095004 [debug] [Thread-1 (]: Finished running node model.customer_churn.int_customer_enriched
[0m23:54:19.096971 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:54:19.097693 [debug] [MainThread]: Connection 'model.customer_churn.int_customer_enriched' was properly closed.
[0m23:54:19.119469 [info ] [MainThread]: 
[0m23:54:19.149646 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.04 seconds (3.04s).
[0m23:54:19.203823 [debug] [MainThread]: Command end result
[0m23:54:19.603059 [info ] [MainThread]: 
[0m23:54:19.605234 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:54:19.606234 [info ] [MainThread]: 
[0m23:54:19.608273 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:54:19.611088 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.7070413, "process_user_time": 4.961774, "process_kernel_time": 2.885181, "process_mem_max_rss": "237060", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m23:54:19.613511 [debug] [MainThread]: Command `dbt run` succeeded at 23:54:19.613396 after 6.71 seconds
[0m23:54:19.615955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cd9deb680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c7ba8d700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c7b7e25a0>]}
[0m23:54:19.618092 [debug] [MainThread]: Flushing usage events
[0m23:54:23.657111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5705537b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f570570de20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5701a0a3c0>]}


============================== 23:54:23.664962 | 39eb8d9b-6d8b-44c3-b301-0d95e320b629 ==============================
[0m23:54:23.664962 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:54:23.665834 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt --select marts', 'send_anonymous_usage_stats': 'True'}
[0m23:54:24.806837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '39eb8d9b-6d8b-44c3-b301-0d95e320b629', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57058c2a20>]}
[0m23:54:24.893552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '39eb8d9b-6d8b-44c3-b301-0d95e320b629', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5701635a90>]}
[0m23:54:24.898440 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m23:54:25.077572 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:54:25.627707 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:54:25.628430 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:54:25.663187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39eb8d9b-6d8b-44c3-b301-0d95e320b629', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56a3ba5a30>]}
[0m23:54:25.843378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '39eb8d9b-6d8b-44c3-b301-0d95e320b629', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56a3a34470>]}
[0m23:54:25.844513 [info ] [MainThread]: Found 12 models, 10 data tests, 7 sources, 459 macros
[0m23:54:25.845506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39eb8d9b-6d8b-44c3-b301-0d95e320b629', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56afeadf70>]}
[0m23:54:25.848456 [info ] [MainThread]: 
[0m23:54:25.849799 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:54:25.855511 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON'
[0m23:54:25.874634 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON"
[0m23:54:25.875625 [debug] [ThreadPool]: On list_USER_DB_FALCON: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON"} */
show terse schemas in database USER_DB_FALCON
    limit 10000
[0m23:54:25.876650 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:54:26.869102 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.585 seconds
[0m23:54:27.847594 [debug] [ThreadPool]: On list_USER_DB_FALCON: Close
[0m23:54:27.976176 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON, now list_USER_DB_FALCON_RAW_public)
[0m23:54:27.995562 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m23:54:27.996850 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show terse objects in USER_DB_FALCON.RAW_public limit 10000
[0m23:54:27.997944 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:54:28.410917 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.413 seconds
[0m23:54:28.413745 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m23:54:28.534975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39eb8d9b-6d8b-44c3-b301-0d95e320b629', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56a2f0d2e0>]}
[0m23:54:28.536356 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:54:28.537344 [info ] [MainThread]: 
[0m23:54:28.549039 [debug] [Thread-1 (]: Began running node model.customer_churn.dim_address
[0m23:54:28.549593 [debug] [Thread-2 (]: Began running node model.customer_churn.dim_customer
[0m23:54:28.550024 [debug] [Thread-3 (]: Began running node model.customer_churn.fact_churn
[0m23:54:28.550555 [info ] [Thread-1 (]: 1 of 5 START sql table model RAW_public.dim_address ............................ [RUN]
[0m23:54:28.551267 [info ] [Thread-2 (]: 2 of 5 START sql table model RAW_public.dim_customer ........................... [RUN]
[0m23:54:28.552001 [info ] [Thread-3 (]: 3 of 5 START sql incremental model RAW_public.fact_churn ....................... [RUN]
[0m23:54:28.552879 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON_RAW_public, now model.customer_churn.dim_address)
[0m23:54:28.554123 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.customer_churn.dim_customer'
[0m23:54:28.555914 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.customer_churn.fact_churn'
[0m23:54:28.556669 [debug] [Thread-1 (]: Began compiling node model.customer_churn.dim_address
[0m23:54:28.557367 [debug] [Thread-2 (]: Began compiling node model.customer_churn.dim_customer
[0m23:54:28.558108 [debug] [Thread-3 (]: Began compiling node model.customer_churn.fact_churn
[0m23:54:28.569516 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.dim_address"
[0m23:54:28.574439 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer_churn.dim_customer"
[0m23:54:28.588044 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.fact_churn"
[0m23:54:28.595187 [debug] [Thread-1 (]: Began executing node model.customer_churn.dim_address
[0m23:54:28.595706 [debug] [Thread-3 (]: Began executing node model.customer_churn.fact_churn
[0m23:54:28.617467 [debug] [Thread-2 (]: Began executing node model.customer_churn.dim_customer
[0m23:54:28.647427 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.dim_address"
[0m23:54:28.659231 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer_churn.dim_customer"
[0m23:54:28.695094 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:54:28.696071 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
create or replace  temporary view USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
  
   as (
    -- models/marts/fact_churn.sql


select
  t.individual_id,
  t.churn_date,
  e.city,
  e.state,
  e.county,
  e.age_in_years,
  e.days_tenure,
  e.annual_premium,
  c.churn_flag
from USER_DB_FALCON.RAW_public.stg_termination t
join USER_DB_FALCON.RAW_public.int_customer_enriched e
  using (individual_id)
left join USER_DB_FALCON.RAW_public.stg_autoinsurance_churn c
  using (individual_id)


where t.churn_date > (select max(churn_date) from USER_DB_FALCON.RAW_public.fact_churn)

  );
[0m23:54:28.696810 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.dim_address"
[0m23:54:28.697784 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:54:28.698597 [debug] [Thread-1 (]: On model.customer_churn.dim_address: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.dim_address"} */
create or replace transient table USER_DB_FALCON.RAW_public.dim_address
         as
        (-- models/marts/dim_address.sql


select distinct
  individual_id,
  city,
  state,
  county,
  lat,
  lon
from USER_DB_FALCON.RAW_public.int_customer_enriched
        );
[0m23:54:28.700254 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:54:28.702208 [debug] [Thread-2 (]: Using snowflake connection "model.customer_churn.dim_customer"
[0m23:54:28.703730 [debug] [Thread-2 (]: On model.customer_churn.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.dim_customer"} */
create or replace transient table USER_DB_FALCON.RAW_public.dim_customer
         as
        (-- models/marts/dim_customer.sql


select distinct
  individual_id,
  age_in_years as age,
  marital_status,
  has_children,
  length_of_residence
from USER_DB_FALCON.RAW_public.int_customer_enriched
        );
[0m23:54:28.704711 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:54:30.091866 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.394 seconds
[0m23:54:30.100543 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:54:30.101946 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
[0m23:54:30.194685 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 0.092 seconds
[0m23:54:30.203500 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:54:30.205106 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table USER_DB_FALCON.RAW_public.fact_churn
[0m23:54:30.373589 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 0.167 seconds
[0m23:54:30.387622 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:54:30.390608 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table "USER_DB_FALCON"."RAW_PUBLIC"."FACT_CHURN"
[0m23:54:30.491560 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 0.099 seconds
[0m23:54:30.521280 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.fact_churn"
[0m23:54:30.558756 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:54:30.560457 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
-- back compat for old kwarg name
  
  begin;
[0m23:54:30.713487 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.152 seconds
[0m23:54:30.717950 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:54:30.719270 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
merge into USER_DB_FALCON.RAW_public.fact_churn as DBT_INTERNAL_DEST
        using USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.individual_id = DBT_INTERNAL_DEST.individual_id
                ) and (
                    DBT_INTERNAL_SOURCE.churn_date = DBT_INTERNAL_DEST.churn_date
                )

    
    when matched then update set
        "INDIVIDUAL_ID" = DBT_INTERNAL_SOURCE."INDIVIDUAL_ID","CHURN_DATE" = DBT_INTERNAL_SOURCE."CHURN_DATE","CITY" = DBT_INTERNAL_SOURCE."CITY","STATE" = DBT_INTERNAL_SOURCE."STATE","COUNTY" = DBT_INTERNAL_SOURCE."COUNTY","AGE_IN_YEARS" = DBT_INTERNAL_SOURCE."AGE_IN_YEARS","DAYS_TENURE" = DBT_INTERNAL_SOURCE."DAYS_TENURE","ANNUAL_PREMIUM" = DBT_INTERNAL_SOURCE."ANNUAL_PREMIUM","CHURN_FLAG" = DBT_INTERNAL_SOURCE."CHURN_FLAG"
    

    when not matched then insert
        ("INDIVIDUAL_ID", "CHURN_DATE", "CITY", "STATE", "COUNTY", "AGE_IN_YEARS", "DAYS_TENURE", "ANNUAL_PREMIUM", "CHURN_FLAG")
    values
        ("INDIVIDUAL_ID", "CHURN_DATE", "CITY", "STATE", "COUNTY", "AGE_IN_YEARS", "DAYS_TENURE", "ANNUAL_PREMIUM", "CHURN_FLAG")

;
[0m23:54:31.954583 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 1.233 seconds
[0m23:54:31.955895 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:54:31.957034 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
COMMIT
[0m23:54:32.115318 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.157 seconds
[0m23:54:32.128677 [debug] [Thread-3 (]: Applying DROP to: USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
[0m23:54:32.140783 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:54:32.141540 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
drop view if exists USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp cascade
[0m23:54:32.302303 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.597 seconds
[0m23:54:32.317917 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.176 seconds
[0m23:54:32.367276 [debug] [Thread-2 (]: On model.customer_churn.dim_customer: Close
[0m23:54:32.367615 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: Close
[0m23:54:32.527017 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39eb8d9b-6d8b-44c3-b301-0d95e320b629', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56a04e3e00>]}
[0m23:54:32.549802 [info ] [Thread-2 (]: 2 of 5 OK created sql table model RAW_public.dim_customer ...................... [[32mSUCCESS 1[0m in 3.97s]
[0m23:54:32.552365 [debug] [Thread-2 (]: Finished running node model.customer_churn.dim_customer
[0m23:54:33.087381 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39eb8d9b-6d8b-44c3-b301-0d95e320b629', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56a04842c0>]}
[0m23:54:33.089347 [info ] [Thread-3 (]: 3 of 5 OK created sql incremental model RAW_public.fact_churn .................. [[32mSUCCESS 0[0m in 4.53s]
[0m23:54:33.091084 [debug] [Thread-3 (]: Finished running node model.customer_churn.fact_churn
[0m23:54:33.092820 [debug] [Thread-4 (]: Began running node model.customer_churn.churn_metrics
[0m23:54:33.094065 [info ] [Thread-4 (]: 4 of 5 START sql table model RAW_public.churn_metrics .......................... [RUN]
[0m23:54:33.095615 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.customer_churn.churn_metrics'
[0m23:54:33.096672 [debug] [Thread-4 (]: Began compiling node model.customer_churn.churn_metrics
[0m23:54:33.103924 [debug] [Thread-4 (]: Writing injected SQL for node "model.customer_churn.churn_metrics"
[0m23:54:33.117123 [debug] [Thread-4 (]: Began executing node model.customer_churn.churn_metrics
[0m23:54:33.121845 [debug] [Thread-4 (]: Writing runtime sql for node "model.customer_churn.churn_metrics"
[0m23:54:33.134836 [debug] [Thread-4 (]: Using snowflake connection "model.customer_churn.churn_metrics"
[0m23:54:33.135799 [debug] [Thread-4 (]: On model.customer_churn.churn_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.churn_metrics"} */
create or replace transient table USER_DB_FALCON.RAW_public.churn_metrics
         as
        (WITH 
  monthly AS (
    SELECT
      DATE_TRUNC('month', churn_date) AS period,
      COUNT(*) AS churn_count
    FROM USER_DB_FALCON.RAW_public.fact_churn
    GROUP BY 1
  ),
  
  by_state AS (
    SELECT
      state AS period,
      COUNT(*) AS churn_count
    FROM USER_DB_FALCON.RAW_public.fact_churn
    GROUP BY 1
  ),
  
  by_age AS (
    SELECT
      age_group AS period,
      COUNT(*) AS churn_count
    FROM USER_DB_FALCON.RAW_public.fact_churn
    GROUP BY 1
  ),
  
  by_tenure AS (
    SELECT
      width_bucket(days_tenure, 0, 6000, 6)           AS period,
      SUM(churn_flag)                                 AS churn_count,
      width_bucket(days_tenure, 0, 6000, 6)           AS tenure_bucket_index,
      CASE
        WHEN days_tenure <=  90 THEN '0-3 months'
        WHEN days_tenure <= 180 THEN '4-6 months'
        WHEN days_tenure <= 365 THEN '7-12 months'
        WHEN days_tenure <= 730 THEN '13-24 months'
        ELSE                        '25+ months'
      END                                             AS tenure_bucket_label
    FROM USER_DB_FALCON.RAW_public.fact_churn
    GROUP BY 1, 3, 4
  ),
  
  by_premium AS (
    SELECT
      premium_flag            AS period,
      SUM(churn_flag)         AS churn_count
    FROM USER_DB_FALCON.RAW_public.fact_churn
    GROUP BY 1
  )

SELECT
  CAST(period AS VARCHAR) AS period,
  churn_count,
  'monthly'              AS category
FROM monthly

UNION ALL

SELECT
  CAST(period AS VARCHAR) AS period,
  churn_count,
  'by_state'             AS category
FROM by_state

UNION ALL

SELECT
  CAST(period AS VARCHAR) AS period,
  churn_count,
  'by_age'               AS category
FROM by_age

UNION ALL

SELECT
  CAST(period AS VARCHAR) AS period,
  churn_count,
  'by_tenure'            AS category
FROM by_tenure

UNION ALL

SELECT
  CAST(period AS VARCHAR) AS period,
  churn_count,
  'by_premium'           AS category
FROM by_premium
        );
[0m23:54:33.136675 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:54:33.460094 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.760 seconds
[0m23:54:33.462003 [debug] [Thread-1 (]: On model.customer_churn.dim_address: Close
[0m23:54:33.612826 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39eb8d9b-6d8b-44c3-b301-0d95e320b629', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56a3803320>]}
[0m23:54:33.627798 [info ] [Thread-1 (]: 1 of 5 OK created sql table model RAW_public.dim_address ....................... [[32mSUCCESS 1[0m in 5.06s]
[0m23:54:33.634893 [debug] [Thread-1 (]: Finished running node model.customer_churn.dim_address
[0m23:54:33.639197 [debug] [Thread-3 (]: Began running node model.customer_churn.churn_map
[0m23:54:33.641647 [info ] [Thread-3 (]: 5 of 5 START sql table model RAW_public.churn_map .............................. [RUN]
[0m23:54:33.645617 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer_churn.fact_churn, now model.customer_churn.churn_map)
[0m23:54:33.650927 [debug] [Thread-3 (]: Began compiling node model.customer_churn.churn_map
[0m23:54:33.657420 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.churn_map"
[0m23:54:33.681190 [debug] [Thread-3 (]: Began executing node model.customer_churn.churn_map
[0m23:54:33.687366 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.churn_map"
[0m23:54:33.704310 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.churn_map"
[0m23:54:33.705659 [debug] [Thread-3 (]: On model.customer_churn.churn_map: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.churn_map"} */
create or replace transient table USER_DB_FALCON.RAW_public.churn_map
         as
        (-- models/marts/churn_map.sql


select
  f.individual_id,
  f.churn_date,
  f.churn_flag,
  a.lon,
  a.lat
from USER_DB_FALCON.RAW_public.fact_churn      as f
join USER_DB_FALCON.RAW_public.dim_address    as a
  using (individual_id)
        );
[0m23:54:33.706908 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:54:34.253452 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01bc27ba-0305-29ae-0004-59ff003c9056
[0m23:54:34.263974 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 22 at position 6
invalid identifier 'AGE_GROUP'
[0m23:54:34.287242 [debug] [Thread-4 (]: On model.customer_churn.churn_metrics: Close
[0m23:54:34.446142 [debug] [Thread-4 (]: Database Error in model churn_metrics (models/marts/churn_metrics.sql)
  000904 (42000): SQL compilation error: error line 22 at position 6
  invalid identifier 'AGE_GROUP'
  compiled code at target/run/customer_churn/models/marts/churn_metrics.sql
[0m23:54:34.448750 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39eb8d9b-6d8b-44c3-b301-0d95e320b629', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5704d48b60>]}
[0m23:54:34.451086 [error] [Thread-4 (]: 4 of 5 ERROR creating sql table model RAW_public.churn_metrics ................. [[31mERROR[0m in 1.35s]
[0m23:54:34.454152 [debug] [Thread-4 (]: Finished running node model.customer_churn.churn_metrics
[0m23:54:35.147482 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.440 seconds
[0m23:54:35.151173 [debug] [Thread-3 (]: On model.customer_churn.churn_map: Close
[0m23:54:35.300985 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39eb8d9b-6d8b-44c3-b301-0d95e320b629', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5704d48bf0>]}
[0m23:54:35.302753 [info ] [Thread-3 (]: 5 of 5 OK created sql table model RAW_public.churn_map ......................... [[32mSUCCESS 1[0m in 1.66s]
[0m23:54:35.305055 [debug] [Thread-3 (]: Finished running node model.customer_churn.churn_map
[0m23:54:35.310297 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:54:35.311178 [debug] [MainThread]: Connection 'model.customer_churn.dim_address' was properly closed.
[0m23:54:35.312004 [debug] [MainThread]: Connection 'model.customer_churn.dim_customer' was properly closed.
[0m23:54:35.320054 [debug] [MainThread]: Connection 'model.customer_churn.churn_map' was properly closed.
[0m23:54:35.323210 [debug] [MainThread]: Connection 'model.customer_churn.churn_metrics' was properly closed.
[0m23:54:35.329076 [info ] [MainThread]: 
[0m23:54:35.330182 [info ] [MainThread]: Finished running 4 table models, 1 incremental model in 0 hours 0 minutes and 9.48 seconds (9.48s).
[0m23:54:35.332589 [debug] [MainThread]: Command end result
[0m23:54:35.662308 [info ] [MainThread]: 
[0m23:54:35.665855 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:54:35.668382 [info ] [MainThread]: 
[0m23:54:35.669866 [error] [MainThread]:   Database Error in model churn_metrics (models/marts/churn_metrics.sql)
  000904 (42000): SQL compilation error: error line 22 at position 6
  invalid identifier 'AGE_GROUP'
  compiled code at target/run/customer_churn/models/marts/churn_metrics.sql
[0m23:54:35.671777 [info ] [MainThread]: 
[0m23:54:35.673073 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m23:54:35.674735 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 10.820261, "process_user_time": 5.724803, "process_kernel_time": 2.909621, "process_mem_max_rss": "235436", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m23:54:35.675843 [debug] [MainThread]: Command `dbt run` failed at 23:54:35.675689 after 10.82 seconds
[0m23:54:35.676705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5705537b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5701e4e4b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56a377eb40>]}
[0m23:54:35.677424 [debug] [MainThread]: Flushing usage events
[0m23:59:01.789531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1bd8d0650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1be325c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1be06f530>]}


============================== 23:59:01.801085 | 478c7e72-3de5-4504-8087-51d2693879e6 ==============================
[0m23:59:01.801085 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:59:01.802641 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:59:01.952023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '478c7e72-3de5-4504-8087-51d2693879e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1bebad340>]}
[0m23:59:01.966496 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:59:01.983803 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:59:01.985454 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.26826212, "process_user_time": 1.681927, "process_kernel_time": 0.09402, "process_mem_max_rss": "165568", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:59:01.986829 [debug] [MainThread]: Command `dbt deps` succeeded at 23:59:01.986627 after 0.27 seconds
[0m23:59:01.988180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1be325c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1bf94d700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1bd8d2ba0>]}
[0m23:59:01.989415 [debug] [MainThread]: Flushing usage events
[0m23:59:05.747861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf7f32d2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf8077c260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf7f47be00>]}


============================== 23:59:05.768657 | f66f61e5-0ff8-49c9-af33-aa6b90f4ad89 ==============================
[0m23:59:05.768657 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:59:05.770644 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt --select staging', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:59:06.764905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f66f61e5-0ff8-49c9-af33-aa6b90f4ad89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf800fe540>]}
[0m23:59:06.823637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f66f61e5-0ff8-49c9-af33-aa6b90f4ad89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf265d2330>]}
[0m23:59:06.824926 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m23:59:06.897750 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:59:07.788605 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:59:07.790495 [debug] [MainThread]: Partial parsing: updated file: customer_churn://models/marts/churn_metrics.sql
[0m23:59:08.234704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f66f61e5-0ff8-49c9-af33-aa6b90f4ad89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf24933bc0>]}
[0m23:59:08.782086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f66f61e5-0ff8-49c9-af33-aa6b90f4ad89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf248b6cf0>]}
[0m23:59:08.783859 [info ] [MainThread]: Found 12 models, 10 data tests, 7 sources, 459 macros
[0m23:59:08.785614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f66f61e5-0ff8-49c9-af33-aa6b90f4ad89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf25cdfda0>]}
[0m23:59:08.790637 [info ] [MainThread]: 
[0m23:59:08.792700 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:59:08.805344 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON'
[0m23:59:08.835577 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON"
[0m23:59:08.840430 [debug] [ThreadPool]: On list_USER_DB_FALCON: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON"} */
show terse schemas in database USER_DB_FALCON
    limit 10000
[0m23:59:08.844100 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:59:10.923669 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.678 seconds
[0m23:59:10.934281 [debug] [ThreadPool]: On list_USER_DB_FALCON: Close
[0m23:59:11.152921 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON, now list_USER_DB_FALCON_RAW_public)
[0m23:59:11.172656 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m23:59:11.174373 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show terse objects in USER_DB_FALCON.RAW_public limit 10000
[0m23:59:11.176008 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:59:11.620118 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.444 seconds
[0m23:59:11.624713 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m23:59:11.757408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f66f61e5-0ff8-49c9-af33-aa6b90f4ad89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf7e522bd0>]}
[0m23:59:11.759102 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:59:11.760244 [info ] [MainThread]: 
[0m23:59:11.777743 [debug] [Thread-1 (]: Began running node model.customer_churn.stg_address
[0m23:59:11.778649 [debug] [Thread-2 (]: Began running node model.customer_churn.stg_autoinsurance_churn
[0m23:59:11.779425 [debug] [Thread-3 (]: Began running node model.customer_churn.stg_customer
[0m23:59:11.780388 [info ] [Thread-1 (]: 1 of 6 START sql view model RAW_public.stg_address ............................. [RUN]
[0m23:59:11.781810 [debug] [Thread-4 (]: Began running node model.customer_churn.stg_demographic
[0m23:59:11.783543 [info ] [Thread-2 (]: 2 of 6 START sql view model RAW_public.stg_autoinsurance_churn ................. [RUN]
[0m23:59:11.785393 [info ] [Thread-3 (]: 3 of 6 START sql view model RAW_public.stg_customer ............................ [RUN]
[0m23:59:11.787221 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON_RAW_public, now model.customer_churn.stg_address)
[0m23:59:11.789050 [info ] [Thread-4 (]: 4 of 6 START sql view model RAW_public.stg_demographic ......................... [RUN]
[0m23:59:11.790949 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.customer_churn.stg_autoinsurance_churn'
[0m23:59:11.793349 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.customer_churn.stg_customer'
[0m23:59:11.795198 [debug] [Thread-1 (]: Began compiling node model.customer_churn.stg_address
[0m23:59:11.797011 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.customer_churn.stg_demographic'
[0m23:59:11.798814 [debug] [Thread-2 (]: Began compiling node model.customer_churn.stg_autoinsurance_churn
[0m23:59:11.800741 [debug] [Thread-3 (]: Began compiling node model.customer_churn.stg_customer
[0m23:59:11.814019 [debug] [Thread-4 (]: Began compiling node model.customer_churn.stg_demographic
[0m23:59:11.816310 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.stg_address"
[0m23:59:11.824309 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer_churn.stg_autoinsurance_churn"
[0m23:59:11.829502 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.stg_customer"
[0m23:59:11.835332 [debug] [Thread-4 (]: Writing injected SQL for node "model.customer_churn.stg_demographic"
[0m23:59:11.853299 [debug] [Thread-1 (]: Began executing node model.customer_churn.stg_address
[0m23:59:11.866554 [debug] [Thread-3 (]: Began executing node model.customer_churn.stg_customer
[0m23:59:11.888961 [debug] [Thread-4 (]: Began executing node model.customer_churn.stg_demographic
[0m23:59:11.918704 [debug] [Thread-2 (]: Began executing node model.customer_churn.stg_autoinsurance_churn
[0m23:59:11.953513 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.stg_address"
[0m23:59:11.966290 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.stg_customer"
[0m23:59:11.967215 [debug] [Thread-4 (]: Writing runtime sql for node "model.customer_churn.stg_demographic"
[0m23:59:11.971764 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer_churn.stg_autoinsurance_churn"
[0m23:59:11.989331 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.stg_address"
[0m23:59:11.990913 [debug] [Thread-1 (]: On model.customer_churn.stg_address: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_address"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_address
  
   as (
    -- models/staging/stg_address.sql

select
  address_id,
  street_address,
  city,
  state,
  county,
  latitude::float as lat,
  longitude::float as lon
from USER_DB_FALCON.RAW.ADDRESS_STAGING
  );
[0m23:59:11.992314 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.stg_customer"
[0m23:59:11.993151 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:59:11.994765 [debug] [Thread-4 (]: Using snowflake connection "model.customer_churn.stg_demographic"
[0m23:59:11.995480 [debug] [Thread-3 (]: On model.customer_churn.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_customer"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_customer
  
   as (
    

select
  individual_id,
  address_id,
  curr_ann_amt    as annual_premium,
  days_tenure,
  cust_orig_date,
  age_in_years,            -- bring this in
  date_of_birth            -- and this
from USER_DB_FALCON.RAW.CUSTOMER_STAGING
where individual_id is not null
  );
[0m23:59:12.000569 [debug] [Thread-2 (]: Using snowflake connection "model.customer_churn.stg_autoinsurance_churn"
[0m23:59:12.001323 [debug] [Thread-4 (]: On model.customer_churn.stg_demographic: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_demographic"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_demographic
  
   as (
    

select
  individual_id,
  income,
  has_children,
  length_of_residence    as length_of_residence,  -- exact match
  marital_status,
  home_owner,
  home_market_value      as home_market_value,
  college_degree,
  good_credit
from USER_DB_FALCON.RAW.DEMOGRAPHIC_STAGING
  );
[0m23:59:12.002817 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:59:12.004310 [debug] [Thread-2 (]: On model.customer_churn.stg_autoinsurance_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_autoinsurance_churn"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_autoinsurance_churn
  
   as (
    

select
  individual_id,
  churn              as churn_flag
from USER_DB_FALCON.RAW.AUTOINSURANCE_CHURN_STAGING
  );
[0m23:59:12.005584 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:59:12.011082 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:59:12.605285 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.600 seconds
[0m23:59:12.607007 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.604 seconds
[0m23:59:12.607862 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.615 seconds
[0m23:59:12.613487 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.603 seconds
[0m23:59:12.632622 [debug] [Thread-4 (]: On model.customer_churn.stg_demographic: Close
[0m23:59:12.633121 [debug] [Thread-3 (]: On model.customer_churn.stg_customer: Close
[0m23:59:12.638086 [debug] [Thread-1 (]: On model.customer_churn.stg_address: Close
[0m23:59:12.641054 [debug] [Thread-2 (]: On model.customer_churn.stg_autoinsurance_churn: Close
[0m23:59:13.198835 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f66f61e5-0ff8-49c9-af33-aa6b90f4ad89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf7f395a00>]}
[0m23:59:13.201715 [info ] [Thread-1 (]: 1 of 6 OK created sql view model RAW_public.stg_address ........................ [[32mSUCCESS 1[0m in 1.41s]
[0m23:59:13.203822 [debug] [Thread-1 (]: Finished running node model.customer_churn.stg_address
[0m23:59:13.206788 [debug] [Thread-1 (]: Began running node model.customer_churn.stg_termination
[0m23:59:13.210951 [info ] [Thread-1 (]: 5 of 6 START sql view model RAW_public.stg_termination ......................... [RUN]
[0m23:59:13.214448 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer_churn.stg_address, now model.customer_churn.stg_termination)
[0m23:59:13.216610 [debug] [Thread-1 (]: Began compiling node model.customer_churn.stg_termination
[0m23:59:13.222600 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.stg_termination"
[0m23:59:13.257993 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f66f61e5-0ff8-49c9-af33-aa6b90f4ad89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf143e8410>]}
[0m23:59:13.263133 [info ] [Thread-3 (]: 3 of 6 OK created sql view model RAW_public.stg_customer ....................... [[32mSUCCESS 1[0m in 1.46s]
[0m23:59:13.264501 [debug] [Thread-3 (]: Finished running node model.customer_churn.stg_customer
[0m23:59:13.292531 [debug] [Thread-3 (]: Began running node model.customer_churn.stg_turning_movement
[0m23:59:13.295007 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f66f61e5-0ff8-49c9-af33-aa6b90f4ad89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf143ea480>]}
[0m23:59:13.296425 [info ] [Thread-3 (]: 6 of 6 START sql view model RAW_public.stg_turning_movement .................... [RUN]
[0m23:59:13.307152 [info ] [Thread-4 (]: 4 of 6 OK created sql view model RAW_public.stg_demographic .................... [[32mSUCCESS 1[0m in 1.50s]
[0m23:59:13.308702 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer_churn.stg_customer, now model.customer_churn.stg_turning_movement)
[0m23:59:13.310076 [debug] [Thread-4 (]: Finished running node model.customer_churn.stg_demographic
[0m23:59:13.313158 [debug] [Thread-3 (]: Began compiling node model.customer_churn.stg_turning_movement
[0m23:59:13.321224 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.stg_turning_movement"
[0m23:59:13.329546 [debug] [Thread-1 (]: Began executing node model.customer_churn.stg_termination
[0m23:59:13.346361 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.stg_termination"
[0m23:59:13.347717 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f66f61e5-0ff8-49c9-af33-aa6b90f4ad89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf145b37a0>]}
[0m23:59:13.351425 [info ] [Thread-2 (]: 2 of 6 OK created sql view model RAW_public.stg_autoinsurance_churn ............ [[32mSUCCESS 1[0m in 1.56s]
[0m23:59:13.353915 [debug] [Thread-2 (]: Finished running node model.customer_churn.stg_autoinsurance_churn
[0m23:59:13.372033 [debug] [Thread-3 (]: Began executing node model.customer_churn.stg_turning_movement
[0m23:59:13.375684 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.stg_turning_movement"
[0m23:59:13.377499 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.stg_termination"
[0m23:59:13.378572 [debug] [Thread-1 (]: On model.customer_churn.stg_termination: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_termination"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_termination
  
   as (
    

select
  individual_id,
  acct_suspd_date    as churn_date
from USER_DB_FALCON.RAW.TERMINATION_STAGING
  );
[0m23:59:13.379978 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:59:13.385764 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.stg_turning_movement"
[0m23:59:13.386615 [debug] [Thread-3 (]: On model.customer_churn.stg_turning_movement: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_turning_movement"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_turning_movement
  
   as (
    -- models/staging/stg_turning_movement.sql

select
  objectid,
  facilityid,
  intid,
  intname,
  nodeno,
  longitude::float as tm_lon,
  latitude::float  as tm_lat
from USER_DB_FALCON.RAW.TURNING_MOVEMENT
  );
[0m23:59:13.388885 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:59:13.973492 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.584 seconds
[0m23:59:13.975031 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.595 seconds
[0m23:59:13.979149 [debug] [Thread-3 (]: On model.customer_churn.stg_turning_movement: Close
[0m23:59:13.983915 [debug] [Thread-1 (]: On model.customer_churn.stg_termination: Close
[0m23:59:14.138526 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f66f61e5-0ff8-49c9-af33-aa6b90f4ad89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf14579100>]}
[0m23:59:14.140579 [info ] [Thread-1 (]: 5 of 6 OK created sql view model RAW_public.stg_termination .................... [[32mSUCCESS 1[0m in 0.92s]
[0m23:59:14.141663 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f66f61e5-0ff8-49c9-af33-aa6b90f4ad89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf145b2a50>]}
[0m23:59:14.142682 [debug] [Thread-1 (]: Finished running node model.customer_churn.stg_termination
[0m23:59:14.144165 [info ] [Thread-3 (]: 6 of 6 OK created sql view model RAW_public.stg_turning_movement ............... [[32mSUCCESS 1[0m in 0.83s]
[0m23:59:14.146993 [debug] [Thread-3 (]: Finished running node model.customer_churn.stg_turning_movement
[0m23:59:14.150876 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:59:14.151993 [debug] [MainThread]: Connection 'model.customer_churn.stg_termination' was properly closed.
[0m23:59:14.153241 [debug] [MainThread]: Connection 'model.customer_churn.stg_autoinsurance_churn' was properly closed.
[0m23:59:14.154484 [debug] [MainThread]: Connection 'model.customer_churn.stg_turning_movement' was properly closed.
[0m23:59:14.155523 [debug] [MainThread]: Connection 'model.customer_churn.stg_demographic' was properly closed.
[0m23:59:14.156699 [info ] [MainThread]: 
[0m23:59:14.157795 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 5.36 seconds (5.36s).
[0m23:59:14.160353 [debug] [MainThread]: Command end result
[0m23:59:14.315318 [info ] [MainThread]: 
[0m23:59:14.316314 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:59:14.317278 [info ] [MainThread]: 
[0m23:59:14.317995 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m23:59:14.319187 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.2539644, "process_user_time": 5.805795, "process_kernel_time": 2.808579, "process_mem_max_rss": "282392", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m23:59:14.319848 [debug] [MainThread]: Command `dbt run` succeeded at 23:59:14.319742 after 7.25 seconds
[0m23:59:14.320330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf82a52a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf82a529f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf7f4792b0>]}
[0m23:59:14.320869 [debug] [MainThread]: Flushing usage events
[0m23:59:18.455440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f328624cbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f328630b170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f328624fa70>]}


============================== 23:59:18.468465 | 53a4b0e0-7b48-4a10-8d29-1be8f3d5ce2e ==============================
[0m23:59:18.468465 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:59:18.470803 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt --select intermediate', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:59:19.503466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '53a4b0e0-7b48-4a10-8d29-1be8f3d5ce2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32869968a0>]}
[0m23:59:19.599924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '53a4b0e0-7b48-4a10-8d29-1be8f3d5ce2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3285a23650>]}
[0m23:59:19.602366 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m23:59:19.710384 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:59:20.469417 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:59:20.471611 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:59:20.552402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '53a4b0e0-7b48-4a10-8d29-1be8f3d5ce2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f322c604290>]}
[0m23:59:20.826909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53a4b0e0-7b48-4a10-8d29-1be8f3d5ce2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3227a87c20>]}
[0m23:59:20.827953 [info ] [MainThread]: Found 12 models, 10 data tests, 7 sources, 459 macros
[0m23:59:20.828722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53a4b0e0-7b48-4a10-8d29-1be8f3d5ce2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3227ca0230>]}
[0m23:59:20.830654 [info ] [MainThread]: 
[0m23:59:20.831828 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:59:20.833679 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON'
[0m23:59:20.863242 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON"
[0m23:59:20.867378 [debug] [ThreadPool]: On list_USER_DB_FALCON: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON"} */
show terse schemas in database USER_DB_FALCON
    limit 10000
[0m23:59:20.868733 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:59:21.624355 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.755 seconds
[0m23:59:21.628957 [debug] [ThreadPool]: On list_USER_DB_FALCON: Close
[0m23:59:21.773788 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON, now list_USER_DB_FALCON_RAW_public)
[0m23:59:21.788042 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m23:59:21.789341 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show terse objects in USER_DB_FALCON.RAW_public limit 10000
[0m23:59:21.790643 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:59:22.256495 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.466 seconds
[0m23:59:22.265931 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m23:59:22.410360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53a4b0e0-7b48-4a10-8d29-1be8f3d5ce2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3227b01dc0>]}
[0m23:59:22.411976 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:59:22.413380 [info ] [MainThread]: 
[0m23:59:22.430527 [debug] [Thread-1 (]: Began running node model.customer_churn.int_customer_enriched
[0m23:59:22.432203 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW_public.int_customer_enriched ................... [RUN]
[0m23:59:22.433617 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON_RAW_public, now model.customer_churn.int_customer_enriched)
[0m23:59:22.434969 [debug] [Thread-1 (]: Began compiling node model.customer_churn.int_customer_enriched
[0m23:59:22.451552 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.int_customer_enriched"
[0m23:59:22.477985 [debug] [Thread-1 (]: Began executing node model.customer_churn.int_customer_enriched
[0m23:59:22.520956 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.int_customer_enriched"
[0m23:59:22.543809 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.int_customer_enriched"
[0m23:59:22.545271 [debug] [Thread-1 (]: On model.customer_churn.int_customer_enriched: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.int_customer_enriched"} */
create or replace   view USER_DB_FALCON.RAW_public.int_customer_enriched
  
   as (
    

with cust as (
    select
        individual_id,
        annual_premium,
        days_tenure,
        cust_orig_date,
        age_in_years,
        date_of_birth,
        address_id
    from USER_DB_FALCON.RAW_public.stg_customer
),

demo as (
    select
        individual_id,
        has_children,
        length_of_residence,
        marital_status,
        home_owner,
        home_market_value,
        college_degree,
        good_credit
    from USER_DB_FALCON.RAW_public.stg_demographic
),

addr as (
    select
        address_id,
        city,
        state,
        county,
        lat,
        lon
    from USER_DB_FALCON.RAW_public.stg_address
)

select
    cust.individual_id,
    cust.annual_premium,
    cust.days_tenure,
    cust.cust_orig_date,
    cust.age_in_years,
    cust.date_of_birth,
    demo.has_children,
    demo.length_of_residence,
    demo.marital_status,
    demo.home_owner,
    demo.home_market_value,
    addr.city,
    addr.state,
    addr.county,
    addr.lat,
    addr.lon
from cust
left join demo using (individual_id)
left join addr using (address_id)
  );
[0m23:59:22.546408 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:59:23.654305 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.108 seconds
[0m23:59:23.711643 [debug] [Thread-1 (]: On model.customer_churn.int_customer_enriched: Close
[0m23:59:23.826382 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53a4b0e0-7b48-4a10-8d29-1be8f3d5ce2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3227d7a5a0>]}
[0m23:59:23.828127 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW_public.int_customer_enriched .............. [[32mSUCCESS 1[0m in 1.39s]
[0m23:59:23.829458 [debug] [Thread-1 (]: Finished running node model.customer_churn.int_customer_enriched
[0m23:59:23.832793 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:59:23.833724 [debug] [MainThread]: Connection 'model.customer_churn.int_customer_enriched' was properly closed.
[0m23:59:23.834729 [info ] [MainThread]: 
[0m23:59:23.835539 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.00 seconds (3.00s).
[0m23:59:23.836723 [debug] [MainThread]: Command end result
[0m23:59:23.910735 [info ] [MainThread]: 
[0m23:59:23.911524 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:59:23.913224 [info ] [MainThread]: 
[0m23:59:23.913766 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:59:23.914756 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.8605027, "process_user_time": 4.411739, "process_kernel_time": 2.850982, "process_mem_max_rss": "269308", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m23:59:23.915662 [debug] [MainThread]: Command `dbt run` succeeded at 23:59:23.915548 after 5.86 seconds
[0m23:59:23.916397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32864d89b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3289772de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3285d1ad50>]}
[0m23:59:23.917063 [debug] [MainThread]: Flushing usage events
[0m23:59:26.839529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c91df38c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c91df3b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c91df3950>]}


============================== 23:59:26.844925 | 58a0623e-247e-4a75-a78d-82846931c971 ==============================
[0m23:59:26.844925 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:59:26.846055 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt --select marts', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:59:27.871595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58a0623e-247e-4a75-a78d-82846931c971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c95d4ea20>]}
[0m23:59:27.911613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '58a0623e-247e-4a75-a78d-82846931c971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c38760950>]}
[0m23:59:27.912767 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m23:59:27.995382 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:59:28.495743 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:59:28.497153 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:59:28.558348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '58a0623e-247e-4a75-a78d-82846931c971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c3836ee70>]}
[0m23:59:29.308468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '58a0623e-247e-4a75-a78d-82846931c971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c33c79520>]}
[0m23:59:29.309927 [info ] [MainThread]: Found 12 models, 10 data tests, 7 sources, 459 macros
[0m23:59:29.311264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58a0623e-247e-4a75-a78d-82846931c971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c40314e00>]}
[0m23:59:29.315559 [info ] [MainThread]: 
[0m23:59:29.321133 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:59:29.337058 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON'
[0m23:59:29.374957 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON"
[0m23:59:29.376719 [debug] [ThreadPool]: On list_USER_DB_FALCON: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON"} */
show terse schemas in database USER_DB_FALCON
    limit 10000
[0m23:59:29.378442 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:59:30.283226 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.905 seconds
[0m23:59:30.286660 [debug] [ThreadPool]: On list_USER_DB_FALCON: Close
[0m23:59:30.412966 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON_RAW_public'
[0m23:59:30.430401 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m23:59:30.431947 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show terse objects in USER_DB_FALCON.RAW_public limit 10000
[0m23:59:30.433271 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:59:30.817501 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.384 seconds
[0m23:59:30.836885 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m23:59:31.318852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58a0623e-247e-4a75-a78d-82846931c971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c386faed0>]}
[0m23:59:31.322927 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:59:31.326050 [info ] [MainThread]: 
[0m23:59:31.349105 [debug] [Thread-1 (]: Began running node model.customer_churn.dim_address
[0m23:59:31.350207 [debug] [Thread-2 (]: Began running node model.customer_churn.dim_customer
[0m23:59:31.351353 [debug] [Thread-3 (]: Began running node model.customer_churn.fact_churn
[0m23:59:31.352770 [info ] [Thread-1 (]: 1 of 5 START sql table model RAW_public.dim_address ............................ [RUN]
[0m23:59:31.355670 [info ] [Thread-2 (]: 2 of 5 START sql table model RAW_public.dim_customer ........................... [RUN]
[0m23:59:31.358993 [info ] [Thread-3 (]: 3 of 5 START sql incremental model RAW_public.fact_churn ....................... [RUN]
[0m23:59:31.360647 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON_RAW_public, now model.customer_churn.dim_address)
[0m23:59:31.363078 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON, now model.customer_churn.dim_customer)
[0m23:59:31.365103 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.customer_churn.fact_churn'
[0m23:59:31.368712 [debug] [Thread-1 (]: Began compiling node model.customer_churn.dim_address
[0m23:59:31.370636 [debug] [Thread-2 (]: Began compiling node model.customer_churn.dim_customer
[0m23:59:31.372432 [debug] [Thread-3 (]: Began compiling node model.customer_churn.fact_churn
[0m23:59:31.394227 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.dim_address"
[0m23:59:31.411666 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer_churn.dim_customer"
[0m23:59:31.424154 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.fact_churn"
[0m23:59:31.428394 [debug] [Thread-1 (]: Began executing node model.customer_churn.dim_address
[0m23:59:31.460460 [debug] [Thread-2 (]: Began executing node model.customer_churn.dim_customer
[0m23:59:31.502987 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer_churn.dim_customer"
[0m23:59:31.507596 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.dim_address"
[0m23:59:31.508107 [debug] [Thread-3 (]: Began executing node model.customer_churn.fact_churn
[0m23:59:31.537454 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:59:31.539069 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
create or replace  temporary view USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
  
   as (
    -- models/marts/fact_churn.sql


select
  t.individual_id,
  t.churn_date,
  e.city,
  e.state,
  e.county,
  e.age_in_years,
  e.days_tenure,
  e.annual_premium,
  c.churn_flag
from USER_DB_FALCON.RAW_public.stg_termination t
join USER_DB_FALCON.RAW_public.int_customer_enriched e
  using (individual_id)
left join USER_DB_FALCON.RAW_public.stg_autoinsurance_churn c
  using (individual_id)


where t.churn_date > (select max(churn_date) from USER_DB_FALCON.RAW_public.fact_churn)

  );
[0m23:59:31.540899 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:59:31.541879 [debug] [Thread-2 (]: Using snowflake connection "model.customer_churn.dim_customer"
[0m23:59:31.543694 [debug] [Thread-2 (]: On model.customer_churn.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.dim_customer"} */
create or replace transient table USER_DB_FALCON.RAW_public.dim_customer
         as
        (-- models/marts/dim_customer.sql


select distinct
  individual_id,
  age_in_years as age,
  marital_status,
  has_children,
  length_of_residence
from USER_DB_FALCON.RAW_public.int_customer_enriched
        );
[0m23:59:31.544544 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.dim_address"
[0m23:59:31.544920 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:59:31.547216 [debug] [Thread-1 (]: On model.customer_churn.dim_address: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.dim_address"} */
create or replace transient table USER_DB_FALCON.RAW_public.dim_address
         as
        (-- models/marts/dim_address.sql


select distinct
  individual_id,
  city,
  state,
  county,
  lat,
  lon
from USER_DB_FALCON.RAW_public.int_customer_enriched
        );
[0m23:59:31.549296 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:59:32.333766 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.793 seconds
[0m23:59:32.352429 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:59:32.354604 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
[0m23:59:32.451057 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 0.095 seconds
[0m23:59:32.464223 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:59:32.466479 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table USER_DB_FALCON.RAW_public.fact_churn
[0m23:59:32.587937 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 0.118 seconds
[0m23:59:32.620347 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:59:32.622006 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table "USER_DB_FALCON"."RAW_PUBLIC"."FACT_CHURN"
[0m23:59:32.725163 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 0.101 seconds
[0m23:59:32.804831 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.fact_churn"
[0m23:59:32.854936 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:59:32.892439 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
-- back compat for old kwarg name
  
  begin;
[0m23:59:33.132075 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.238 seconds
[0m23:59:33.137210 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:59:33.140313 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
merge into USER_DB_FALCON.RAW_public.fact_churn as DBT_INTERNAL_DEST
        using USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.individual_id = DBT_INTERNAL_DEST.individual_id
                ) and (
                    DBT_INTERNAL_SOURCE.churn_date = DBT_INTERNAL_DEST.churn_date
                )

    
    when matched then update set
        "INDIVIDUAL_ID" = DBT_INTERNAL_SOURCE."INDIVIDUAL_ID","CHURN_DATE" = DBT_INTERNAL_SOURCE."CHURN_DATE","CITY" = DBT_INTERNAL_SOURCE."CITY","STATE" = DBT_INTERNAL_SOURCE."STATE","COUNTY" = DBT_INTERNAL_SOURCE."COUNTY","AGE_IN_YEARS" = DBT_INTERNAL_SOURCE."AGE_IN_YEARS","DAYS_TENURE" = DBT_INTERNAL_SOURCE."DAYS_TENURE","ANNUAL_PREMIUM" = DBT_INTERNAL_SOURCE."ANNUAL_PREMIUM","CHURN_FLAG" = DBT_INTERNAL_SOURCE."CHURN_FLAG"
    

    when not matched then insert
        ("INDIVIDUAL_ID", "CHURN_DATE", "CITY", "STATE", "COUNTY", "AGE_IN_YEARS", "DAYS_TENURE", "ANNUAL_PREMIUM", "CHURN_FLAG")
    values
        ("INDIVIDUAL_ID", "CHURN_DATE", "CITY", "STATE", "COUNTY", "AGE_IN_YEARS", "DAYS_TENURE", "ANNUAL_PREMIUM", "CHURN_FLAG")

;
[0m23:59:33.877692 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 0.734 seconds
[0m23:59:33.881280 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:59:33.883019 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
COMMIT
[0m23:59:34.151684 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.266 seconds
[0m23:59:34.169642 [debug] [Thread-3 (]: Applying DROP to: USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
[0m23:59:34.187310 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:59:34.191084 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
drop view if exists USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp cascade
[0m23:59:34.343720 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.150 seconds
[0m23:59:34.374269 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: Close
[0m23:59:34.844157 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58a0623e-247e-4a75-a78d-82846931c971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c38246e70>]}
[0m23:59:34.846716 [info ] [Thread-3 (]: 3 of 5 OK created sql incremental model RAW_public.fact_churn .................. [[32mSUCCESS 0[0m in 3.48s]
[0m23:59:34.849373 [debug] [Thread-3 (]: Finished running node model.customer_churn.fact_churn
[0m23:59:34.852933 [debug] [Thread-4 (]: Began running node model.customer_churn.churn_metrics
[0m23:59:34.854857 [info ] [Thread-4 (]: 4 of 5 START sql table model RAW_public.churn_metrics .......................... [RUN]
[0m23:59:34.859962 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.customer_churn.churn_metrics'
[0m23:59:34.861616 [debug] [Thread-4 (]: Began compiling node model.customer_churn.churn_metrics
[0m23:59:34.873137 [debug] [Thread-4 (]: Writing injected SQL for node "model.customer_churn.churn_metrics"
[0m23:59:35.105990 [debug] [Thread-4 (]: Began executing node model.customer_churn.churn_metrics
[0m23:59:35.112978 [debug] [Thread-4 (]: Writing runtime sql for node "model.customer_churn.churn_metrics"
[0m23:59:35.173928 [debug] [Thread-4 (]: Using snowflake connection "model.customer_churn.churn_metrics"
[0m23:59:35.181763 [debug] [Thread-4 (]: On model.customer_churn.churn_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.churn_metrics"} */
create or replace transient table USER_DB_FALCON.RAW_public.churn_metrics
         as
        (WITH 
  monthly AS (
    SELECT
      DATE_TRUNC('month', churn_date) AS period,
      COUNT(*) AS churn_count
    FROM USER_DB_FALCON.RAW_public.fact_churn
    GROUP BY 1
  ),
  
  by_state AS (
    SELECT
      state AS period,
      COUNT(*) AS churn_count
    FROM USER_DB_FALCON.RAW_public.fact_churn
    GROUP BY 1
  ),
  
  by_age AS (
    SELECT
      CASE
        WHEN age_in_years < 25 THEN 'Under 25'
        WHEN age_in_years < 35 THEN '25-34'
        WHEN age_in_years < 45 THEN '35-44'
        WHEN age_in_years < 55 THEN '45-54'
        WHEN age_in_years < 65 THEN '55-64'
        ELSE '65+'
      END AS period,
      COUNT(*) AS churn_count
    FROM USER_DB_FALCON.RAW_public.fact_churn
    GROUP BY 1
  ),
  
  by_tenure AS (
    SELECT
      CASE
        WHEN days_tenure <= 90 THEN '0-3 months'
        WHEN days_tenure <= 180 THEN '4-6 months'
        WHEN days_tenure <= 365 THEN '7-12 months'
        WHEN days_tenure <= 730 THEN '13-24 months'
        ELSE '25+ months'
      END AS period,
      COUNT(*) AS churn_count
    FROM USER_DB_FALCON.RAW_public.fact_churn
    GROUP BY 1
  ),
  
  by_premium AS (
    SELECT
      CASE
        WHEN annual_premium < 1000 THEN 'Under $1,000'
        WHEN annual_premium < 2000 THEN '$1,000-$1,999'
        WHEN annual_premium < 3000 THEN '$2,000-$2,999'
        ELSE '$3,000+'
      END AS period,
      COUNT(*) AS churn_count
    FROM USER_DB_FALCON.RAW_public.fact_churn
    GROUP BY 1
  )

SELECT
  CAST(period AS VARCHAR) AS period,
  churn_count,
  'monthly'              AS category
FROM monthly

UNION ALL

SELECT
  CAST(period AS VARCHAR) AS period,
  churn_count,
  'by_state'             AS category
FROM by_state

UNION ALL

SELECT
  CAST(period AS VARCHAR) AS period,
  churn_count,
  'by_age'               AS category
FROM by_age

UNION ALL

SELECT
  CAST(period AS VARCHAR) AS period,
  churn_count,
  'by_tenure'            AS category
FROM by_tenure

UNION ALL

SELECT
  CAST(period AS VARCHAR) AS period,
  churn_count,
  'by_premium'           AS category
FROM by_premium
        );
[0m23:59:35.187270 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:59:35.252410 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.707 seconds
[0m23:59:35.292709 [debug] [Thread-2 (]: On model.customer_churn.dim_customer: Close
[0m23:59:35.756149 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.207 seconds
[0m23:59:35.760304 [debug] [Thread-1 (]: On model.customer_churn.dim_address: Close
[0m23:59:35.814905 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58a0623e-247e-4a75-a78d-82846931c971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c329bd9d0>]}
[0m23:59:35.817448 [info ] [Thread-2 (]: 2 of 5 OK created sql table model RAW_public.dim_customer ...................... [[32mSUCCESS 1[0m in 4.45s]
[0m23:59:35.822723 [debug] [Thread-2 (]: Finished running node model.customer_churn.dim_customer
[0m23:59:35.942738 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58a0623e-247e-4a75-a78d-82846931c971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c329857c0>]}
[0m23:59:35.944405 [info ] [Thread-1 (]: 1 of 5 OK created sql table model RAW_public.dim_address ....................... [[32mSUCCESS 1[0m in 4.58s]
[0m23:59:35.946519 [debug] [Thread-1 (]: Finished running node model.customer_churn.dim_address
[0m23:59:35.948964 [debug] [Thread-3 (]: Began running node model.customer_churn.churn_map
[0m23:59:35.950535 [info ] [Thread-3 (]: 5 of 5 START sql table model RAW_public.churn_map .............................. [RUN]
[0m23:59:35.952171 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer_churn.fact_churn, now model.customer_churn.churn_map)
[0m23:59:35.953662 [debug] [Thread-3 (]: Began compiling node model.customer_churn.churn_map
[0m23:59:35.960338 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.churn_map"
[0m23:59:35.991300 [debug] [Thread-3 (]: Began executing node model.customer_churn.churn_map
[0m23:59:35.996636 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.churn_map"
[0m23:59:36.027478 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.churn_map"
[0m23:59:36.028867 [debug] [Thread-3 (]: On model.customer_churn.churn_map: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.churn_map"} */
create or replace transient table USER_DB_FALCON.RAW_public.churn_map
         as
        (-- models/marts/churn_map.sql


select
  f.individual_id,
  f.churn_date,
  f.churn_flag,
  a.lon,
  a.lat
from USER_DB_FALCON.RAW_public.fact_churn      as f
join USER_DB_FALCON.RAW_public.dim_address    as a
  using (individual_id)
        );
[0m23:59:36.030463 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:59:36.699829 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.513 seconds
[0m23:59:36.706301 [debug] [Thread-4 (]: On model.customer_churn.churn_metrics: Close
[0m23:59:36.865052 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58a0623e-247e-4a75-a78d-82846931c971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c3297a3f0>]}
[0m23:59:36.867101 [info ] [Thread-4 (]: 4 of 5 OK created sql table model RAW_public.churn_metrics ..................... [[32mSUCCESS 1[0m in 2.00s]
[0m23:59:36.868967 [debug] [Thread-4 (]: Finished running node model.customer_churn.churn_metrics
[0m23:59:37.603758 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.573 seconds
[0m23:59:37.606210 [debug] [Thread-3 (]: On model.customer_churn.churn_map: Close
[0m23:59:37.731808 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58a0623e-247e-4a75-a78d-82846931c971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c951dc9e0>]}
[0m23:59:37.733378 [info ] [Thread-3 (]: 5 of 5 OK created sql table model RAW_public.churn_map ......................... [[32mSUCCESS 1[0m in 1.78s]
[0m23:59:37.734619 [debug] [Thread-3 (]: Finished running node model.customer_churn.churn_map
[0m23:59:37.737979 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:59:37.738830 [debug] [MainThread]: Connection 'model.customer_churn.dim_customer' was properly closed.
[0m23:59:37.739511 [debug] [MainThread]: Connection 'model.customer_churn.dim_address' was properly closed.
[0m23:59:37.740207 [debug] [MainThread]: Connection 'model.customer_churn.churn_map' was properly closed.
[0m23:59:37.740772 [debug] [MainThread]: Connection 'model.customer_churn.churn_metrics' was properly closed.
[0m23:59:37.741530 [info ] [MainThread]: 
[0m23:59:37.742516 [info ] [MainThread]: Finished running 1 incremental model, 4 table models in 0 hours 0 minutes and 8.42 seconds (8.42s).
[0m23:59:37.744510 [debug] [MainThread]: Command end result
[0m23:59:37.974849 [info ] [MainThread]: 
[0m23:59:38.018718 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:59:38.034008 [info ] [MainThread]: 
[0m23:59:38.035399 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m23:59:38.099342 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.344569, "process_user_time": 4.670027, "process_kernel_time": 2.885642, "process_mem_max_rss": "266860", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m23:59:38.142398 [debug] [MainThread]: Command `dbt run` succeeded at 23:59:38.141993 after 11.39 seconds
[0m23:59:38.146873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c33f1f890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c91a90170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c91a91190>]}
[0m23:59:38.149041 [debug] [MainThread]: Flushing usage events
[0m23:59:39.895260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0240154c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff023fe4c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff023fe62d0>]}


============================== 23:59:39.907733 | c644a119-d1fa-4f03-8710-51054b67514b ==============================
[0m23:59:39.907733 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:59:39.909415 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt --select marts', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:59:40.643342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c644a119-d1fa-4f03-8710-51054b67514b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc6556450>]}
[0m23:59:41.166979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c644a119-d1fa-4f03-8710-51054b67514b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff024a36c90>]}
[0m23:59:41.168228 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m23:59:41.233113 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:59:42.770077 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:59:42.770961 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:59:42.784458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0d515cd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0d566a930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0d515d250>]}


============================== 23:59:42.789892 | cbd906d3-edca-4f8e-addf-f54246b3efa4 ==============================
[0m23:59:42.789892 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:59:42.790919 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m23:59:42.802436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c644a119-d1fa-4f03-8710-51054b67514b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc60d00b0>]}
[0m23:59:42.964792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c644a119-d1fa-4f03-8710-51054b67514b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc5ed14f0>]}
[0m23:59:42.965842 [info ] [MainThread]: Found 12 models, 10 data tests, 7 sources, 459 macros
[0m23:59:42.966628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c644a119-d1fa-4f03-8710-51054b67514b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc64f7050>]}
[0m23:59:42.969216 [info ] [MainThread]: 
[0m23:59:42.970530 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:59:42.976651 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON'
[0m23:59:42.993747 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON"
[0m23:59:42.994877 [debug] [ThreadPool]: On list_USER_DB_FALCON: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON"} */
show terse schemas in database USER_DB_FALCON
    limit 10000
[0m23:59:42.996030 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:59:43.667775 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.672 seconds
[0m23:59:43.671974 [debug] [ThreadPool]: On list_USER_DB_FALCON: Close
[0m23:59:43.784703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cbd906d3-edca-4f8e-addf-f54246b3efa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0775311f0>]}
[0m23:59:43.862562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cbd906d3-edca-4f8e-addf-f54246b3efa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd07ea5c500>]}
[0m23:59:43.864211 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m23:59:43.965012 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:59:43.971554 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON, now list_USER_DB_FALCON_RAW_public)
[0m23:59:43.977301 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m23:59:43.977942 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show terse objects in USER_DB_FALCON.RAW_public limit 10000
[0m23:59:43.978650 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:59:44.421515 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.443 seconds
[0m23:59:44.423385 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m23:59:44.525642 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:59:44.526629 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:59:44.557401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cbd906d3-edca-4f8e-addf-f54246b3efa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0773a8ec0>]}
[0m23:59:44.562044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c644a119-d1fa-4f03-8710-51054b67514b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc6220a40>]}
[0m23:59:44.563363 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:59:44.564142 [info ] [MainThread]: 
[0m23:59:44.574136 [debug] [Thread-1 (]: Began running node model.customer_churn.dim_address
[0m23:59:44.574675 [debug] [Thread-2 (]: Began running node model.customer_churn.dim_customer
[0m23:59:44.575139 [debug] [Thread-3 (]: Began running node model.customer_churn.fact_churn
[0m23:59:44.575869 [info ] [Thread-1 (]: 1 of 5 START sql table model RAW_public.dim_address ............................ [RUN]
[0m23:59:44.579948 [info ] [Thread-2 (]: 2 of 5 START sql table model RAW_public.dim_customer ........................... [RUN]
[0m23:59:44.581198 [info ] [Thread-3 (]: 3 of 5 START sql incremental model RAW_public.fact_churn ....................... [RUN]
[0m23:59:44.582592 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON_RAW_public, now model.customer_churn.dim_address)
[0m23:59:44.588667 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.customer_churn.dim_customer'
[0m23:59:44.590177 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.customer_churn.fact_churn'
[0m23:59:44.591201 [debug] [Thread-1 (]: Began compiling node model.customer_churn.dim_address
[0m23:59:44.592557 [debug] [Thread-2 (]: Began compiling node model.customer_churn.dim_customer
[0m23:59:44.595053 [debug] [Thread-3 (]: Began compiling node model.customer_churn.fact_churn
[0m23:59:44.603607 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.dim_address"
[0m23:59:44.605999 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer_churn.dim_customer"
[0m23:59:44.613436 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.fact_churn"
[0m23:59:44.629365 [debug] [Thread-2 (]: Began executing node model.customer_churn.dim_customer
[0m23:59:44.636942 [debug] [Thread-1 (]: Began executing node model.customer_churn.dim_address
[0m23:59:44.653231 [debug] [Thread-3 (]: Began executing node model.customer_churn.fact_churn
[0m23:59:44.667922 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.dim_address"
[0m23:59:44.673365 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer_churn.dim_customer"
[0m23:59:44.700374 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:59:44.701701 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
create or replace  temporary view USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
  
   as (
    -- models/marts/fact_churn.sql


select
  t.individual_id,
  t.churn_date,
  e.city,
  e.state,
  e.county,
  e.age_in_years,
  e.days_tenure,
  e.annual_premium,
  c.churn_flag
from USER_DB_FALCON.RAW_public.stg_termination t
join USER_DB_FALCON.RAW_public.int_customer_enriched e
  using (individual_id)
left join USER_DB_FALCON.RAW_public.stg_autoinsurance_churn c
  using (individual_id)


where t.churn_date > (select max(churn_date) from USER_DB_FALCON.RAW_public.fact_churn)

  );
[0m23:59:44.702663 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:59:44.712407 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.dim_address"
[0m23:59:44.713177 [debug] [Thread-1 (]: On model.customer_churn.dim_address: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.dim_address"} */
create or replace transient table USER_DB_FALCON.RAW_public.dim_address
         as
        (-- models/marts/dim_address.sql


select distinct
  individual_id,
  city,
  state,
  county,
  lat,
  lon
from USER_DB_FALCON.RAW_public.int_customer_enriched
        );
[0m23:59:44.714876 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:59:44.718620 [debug] [Thread-2 (]: Using snowflake connection "model.customer_churn.dim_customer"
[0m23:59:44.719333 [debug] [Thread-2 (]: On model.customer_churn.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.dim_customer"} */
create or replace transient table USER_DB_FALCON.RAW_public.dim_customer
         as
        (-- models/marts/dim_customer.sql


select distinct
  individual_id,
  age_in_years as age,
  marital_status,
  has_children,
  length_of_residence
from USER_DB_FALCON.RAW_public.int_customer_enriched
        );
[0m23:59:44.720195 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:59:44.728333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cbd906d3-edca-4f8e-addf-f54246b3efa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd076ce6510>]}
[0m23:59:44.729346 [info ] [MainThread]: Found 12 models, 10 data tests, 7 sources, 459 macros
[0m23:59:44.730727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cbd906d3-edca-4f8e-addf-f54246b3efa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd076e2eba0>]}
[0m23:59:44.732904 [info ] [MainThread]: 
[0m23:59:44.733782 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:59:44.737901 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON_RAW_public'
[0m23:59:44.749717 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m23:59:44.750581 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show terse objects in USER_DB_FALCON.RAW_public limit 10000
[0m23:59:44.751290 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:59:45.226835 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.475 seconds
[0m23:59:45.231192 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m23:59:45.362639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cbd906d3-edca-4f8e-addf-f54246b3efa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd076ccaa50>]}
[0m23:59:45.364211 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:59:45.365572 [info ] [MainThread]: 
[0m23:59:45.385122 [debug] [Thread-1 (]: Began running node test.customer_churn.not_null_dim_address_individual_id.efa1478d3c
[0m23:59:45.386055 [debug] [Thread-2 (]: Began running node test.customer_churn.not_null_dim_customer_individual_id.80bf9c0ee7
[0m23:59:45.390518 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.688 seconds
[0m23:59:45.386921 [debug] [Thread-3 (]: Began running node test.customer_churn.not_null_fact_churn_churn_date.c88bd69eeb
[0m23:59:45.387859 [debug] [Thread-4 (]: Began running node test.customer_churn.not_null_fact_churn_individual_id.96f069e355
[0m23:59:45.388737 [info ] [Thread-1 (]: 1 of 10 START test not_null_dim_address_individual_id .......................... [RUN]
[0m23:59:45.390599 [info ] [Thread-2 (]: 2 of 10 START test not_null_dim_customer_individual_id ......................... [RUN]
[0m23:59:45.392279 [info ] [Thread-3 (]: 3 of 10 START test not_null_fact_churn_churn_date .............................. [RUN]
[0m23:59:45.395132 [info ] [Thread-4 (]: 4 of 10 START test not_null_fact_churn_individual_id ........................... [RUN]
[0m23:59:45.396589 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON_RAW_public, now test.customer_churn.not_null_dim_address_individual_id.efa1478d3c)
[0m23:59:45.398227 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.customer_churn.not_null_dim_customer_individual_id.80bf9c0ee7'
[0m23:59:45.400264 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.customer_churn.not_null_fact_churn_churn_date.c88bd69eeb'
[0m23:59:45.402193 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.customer_churn.not_null_fact_churn_individual_id.96f069e355'
[0m23:59:45.403908 [debug] [Thread-1 (]: Began compiling node test.customer_churn.not_null_dim_address_individual_id.efa1478d3c
[0m23:59:45.409478 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:59:45.410840 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
[0m23:59:45.405469 [debug] [Thread-2 (]: Began compiling node test.customer_churn.not_null_dim_customer_individual_id.80bf9c0ee7
[0m23:59:45.406812 [debug] [Thread-3 (]: Began compiling node test.customer_churn.not_null_fact_churn_churn_date.c88bd69eeb
[0m23:59:45.408317 [debug] [Thread-4 (]: Began compiling node test.customer_churn.not_null_fact_churn_individual_id.96f069e355
[0m23:59:45.470295 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer_churn.not_null_dim_address_individual_id.efa1478d3c"
[0m23:59:45.470928 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer_churn.not_null_dim_customer_individual_id.80bf9c0ee7"
[0m23:59:45.473004 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer_churn.not_null_fact_churn_churn_date.c88bd69eeb"
[0m23:59:45.477046 [debug] [Thread-4 (]: Writing injected SQL for node "test.customer_churn.not_null_fact_churn_individual_id.96f069e355"
[0m23:59:45.492872 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 0.081 seconds
[0m23:59:45.494512 [debug] [Thread-3 (]: Began executing node test.customer_churn.not_null_fact_churn_churn_date.c88bd69eeb
[0m23:59:45.498553 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:59:45.499759 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table USER_DB_FALCON.RAW_public.fact_churn
[0m23:59:45.495302 [debug] [Thread-1 (]: Began executing node test.customer_churn.not_null_dim_address_individual_id.efa1478d3c
[0m23:59:45.508458 [debug] [Thread-4 (]: Began executing node test.customer_churn.not_null_fact_churn_individual_id.96f069e355
[0m23:59:45.537228 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer_churn.not_null_fact_churn_churn_date.c88bd69eeb"
[0m23:59:45.554980 [debug] [Thread-4 (]: Writing runtime sql for node "test.customer_churn.not_null_fact_churn_individual_id.96f069e355"
[0m23:59:45.561241 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer_churn.not_null_dim_address_individual_id.efa1478d3c"
[0m23:59:45.574854 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 0.074 seconds
[0m23:59:45.562264 [debug] [Thread-2 (]: Began executing node test.customer_churn.not_null_dim_customer_individual_id.80bf9c0ee7
[0m23:59:45.593327 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer_churn.not_null_dim_customer_individual_id.80bf9c0ee7"
[0m23:59:45.600791 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:59:45.602678 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table "USER_DB_FALCON"."RAW_PUBLIC"."FACT_CHURN"
[0m23:59:45.612216 [debug] [Thread-1 (]: Using snowflake connection "test.customer_churn.not_null_dim_address_individual_id.efa1478d3c"
[0m23:59:45.613956 [debug] [Thread-3 (]: Using snowflake connection "test.customer_churn.not_null_fact_churn_churn_date.c88bd69eeb"
[0m23:59:45.614866 [debug] [Thread-1 (]: On test.customer_churn.not_null_dim_address_individual_id.efa1478d3c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "test.customer_churn.not_null_dim_address_individual_id.efa1478d3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select individual_id
from USER_DB_FALCON.RAW_public.dim_address
where individual_id is null



      
    ) dbt_internal_test
[0m23:59:45.617185 [debug] [Thread-3 (]: On test.customer_churn.not_null_fact_churn_churn_date.c88bd69eeb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "test.customer_churn.not_null_fact_churn_churn_date.c88bd69eeb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select churn_date
from USER_DB_FALCON.RAW_public.fact_churn
where churn_date is null



      
    ) dbt_internal_test
[0m23:59:45.619021 [debug] [Thread-2 (]: Using snowflake connection "test.customer_churn.not_null_dim_customer_individual_id.80bf9c0ee7"
[0m23:59:45.619875 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:59:45.621657 [debug] [Thread-4 (]: Using snowflake connection "test.customer_churn.not_null_fact_churn_individual_id.96f069e355"
[0m23:59:45.622394 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:59:45.623831 [debug] [Thread-2 (]: On test.customer_churn.not_null_dim_customer_individual_id.80bf9c0ee7: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "test.customer_churn.not_null_dim_customer_individual_id.80bf9c0ee7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select individual_id
from USER_DB_FALCON.RAW_public.dim_customer
where individual_id is null



      
    ) dbt_internal_test
[0m23:59:45.629953 [debug] [Thread-4 (]: On test.customer_churn.not_null_fact_churn_individual_id.96f069e355: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "test.customer_churn.not_null_fact_churn_individual_id.96f069e355"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select individual_id
from USER_DB_FALCON.RAW_public.fact_churn
where individual_id is null



      
    ) dbt_internal_test
[0m23:59:45.636082 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:59:45.638720 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:59:45.683660 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 0.079 seconds
[0m23:59:45.725827 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.fact_churn"
[0m23:59:45.749442 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:59:45.750618 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
-- back compat for old kwarg name
  
  begin;
[0m23:59:45.899277 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.147 seconds
[0m23:59:45.902037 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:59:45.903866 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
merge into USER_DB_FALCON.RAW_public.fact_churn as DBT_INTERNAL_DEST
        using USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.individual_id = DBT_INTERNAL_DEST.individual_id
                ) and (
                    DBT_INTERNAL_SOURCE.churn_date = DBT_INTERNAL_DEST.churn_date
                )

    
    when matched then update set
        "INDIVIDUAL_ID" = DBT_INTERNAL_SOURCE."INDIVIDUAL_ID","CHURN_DATE" = DBT_INTERNAL_SOURCE."CHURN_DATE","CITY" = DBT_INTERNAL_SOURCE."CITY","STATE" = DBT_INTERNAL_SOURCE."STATE","COUNTY" = DBT_INTERNAL_SOURCE."COUNTY","AGE_IN_YEARS" = DBT_INTERNAL_SOURCE."AGE_IN_YEARS","DAYS_TENURE" = DBT_INTERNAL_SOURCE."DAYS_TENURE","ANNUAL_PREMIUM" = DBT_INTERNAL_SOURCE."ANNUAL_PREMIUM","CHURN_FLAG" = DBT_INTERNAL_SOURCE."CHURN_FLAG"
    

    when not matched then insert
        ("INDIVIDUAL_ID", "CHURN_DATE", "CITY", "STATE", "COUNTY", "AGE_IN_YEARS", "DAYS_TENURE", "ANNUAL_PREMIUM", "CHURN_FLAG")
    values
        ("INDIVIDUAL_ID", "CHURN_DATE", "CITY", "STATE", "COUNTY", "AGE_IN_YEARS", "DAYS_TENURE", "ANNUAL_PREMIUM", "CHURN_FLAG")

;
[0m23:59:45.962038 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.340 seconds
[0m23:59:45.984348 [debug] [Thread-3 (]: On test.customer_churn.not_null_fact_churn_churn_date.c88bd69eeb: Close
[0m23:59:46.046823 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.408 seconds
[0m23:59:46.052379 [debug] [Thread-4 (]: On test.customer_churn.not_null_fact_churn_individual_id.96f069e355: Close
[0m23:59:46.125858 [info ] [Thread-3 (]: 3 of 10 PASS not_null_fact_churn_churn_date .................................... [[32mPASS[0m in 0.73s]
[0m23:59:46.135862 [debug] [Thread-3 (]: Finished running node test.customer_churn.not_null_fact_churn_churn_date.c88bd69eeb
[0m23:59:46.137813 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.518 seconds
[0m23:59:46.139121 [debug] [Thread-3 (]: Began running node test.customer_churn.not_null_int_customer_enriched_individual_id.4f23212833
[0m23:59:46.146282 [debug] [Thread-1 (]: On test.customer_churn.not_null_dim_address_individual_id.efa1478d3c: Close
[0m23:59:46.148212 [info ] [Thread-3 (]: 5 of 10 START test not_null_int_customer_enriched_individual_id ................ [RUN]
[0m23:59:46.153053 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer_churn.not_null_fact_churn_churn_date.c88bd69eeb, now test.customer_churn.not_null_int_customer_enriched_individual_id.4f23212833)
[0m23:59:46.154368 [debug] [Thread-3 (]: Began compiling node test.customer_churn.not_null_int_customer_enriched_individual_id.4f23212833
[0m23:59:46.164141 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer_churn.not_null_int_customer_enriched_individual_id.4f23212833"
[0m23:59:46.193207 [info ] [Thread-4 (]: 4 of 10 PASS not_null_fact_churn_individual_id ................................. [[32mPASS[0m in 0.79s]
[0m23:59:46.195229 [debug] [Thread-4 (]: Finished running node test.customer_churn.not_null_fact_churn_individual_id.96f069e355
[0m23:59:46.197119 [debug] [Thread-4 (]: Began running node test.customer_churn.not_null_stg_address_address_id.a26685b6d5
[0m23:59:46.198555 [info ] [Thread-4 (]: 6 of 10 START test not_null_stg_address_address_id ............................. [RUN]
[0m23:59:46.199897 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.customer_churn.not_null_fact_churn_individual_id.96f069e355, now test.customer_churn.not_null_stg_address_address_id.a26685b6d5)
[0m23:59:46.200483 [debug] [Thread-3 (]: Began executing node test.customer_churn.not_null_int_customer_enriched_individual_id.4f23212833
[0m23:59:46.201299 [debug] [Thread-4 (]: Began compiling node test.customer_churn.not_null_stg_address_address_id.a26685b6d5
[0m23:59:46.205935 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer_churn.not_null_int_customer_enriched_individual_id.4f23212833"
[0m23:59:46.215438 [debug] [Thread-4 (]: Writing injected SQL for node "test.customer_churn.not_null_stg_address_address_id.a26685b6d5"
[0m23:59:46.232195 [debug] [Thread-3 (]: Using snowflake connection "test.customer_churn.not_null_int_customer_enriched_individual_id.4f23212833"
[0m23:59:46.232536 [debug] [Thread-4 (]: Began executing node test.customer_churn.not_null_stg_address_address_id.a26685b6d5
[0m23:59:46.233382 [debug] [Thread-3 (]: On test.customer_churn.not_null_int_customer_enriched_individual_id.4f23212833: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "test.customer_churn.not_null_int_customer_enriched_individual_id.4f23212833"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select individual_id
from USER_DB_FALCON.RAW_public.int_customer_enriched
where individual_id is null



      
    ) dbt_internal_test
[0m23:59:46.236153 [debug] [Thread-4 (]: Writing runtime sql for node "test.customer_churn.not_null_stg_address_address_id.a26685b6d5"
[0m23:59:46.237052 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:59:46.289392 [debug] [Thread-4 (]: Using snowflake connection "test.customer_churn.not_null_stg_address_address_id.a26685b6d5"
[0m23:59:46.291449 [info ] [Thread-1 (]: 1 of 10 PASS not_null_dim_address_individual_id ................................ [[32mPASS[0m in 0.89s]
[0m23:59:46.317360 [debug] [Thread-4 (]: On test.customer_churn.not_null_stg_address_address_id.a26685b6d5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "test.customer_churn.not_null_stg_address_address_id.a26685b6d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select address_id
from USER_DB_FALCON.RAW_public.stg_address
where address_id is null



      
    ) dbt_internal_test
[0m23:59:46.333352 [debug] [Thread-1 (]: Finished running node test.customer_churn.not_null_dim_address_individual_id.efa1478d3c
[0m23:59:46.369504 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 0.463 seconds
[0m23:59:46.367072 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:59:46.372435 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:59:46.374861 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
COMMIT
[0m23:59:46.371920 [debug] [Thread-1 (]: Began running node test.customer_churn.not_null_stg_autoinsurance_churn_individual_id.c3c7b154c3
[0m23:59:46.400629 [info ] [Thread-1 (]: 7 of 10 START test not_null_stg_autoinsurance_churn_individual_id .............. [RUN]
[0m23:59:46.403457 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer_churn.not_null_dim_address_individual_id.efa1478d3c, now test.customer_churn.not_null_stg_autoinsurance_churn_individual_id.c3c7b154c3)
[0m23:59:46.405532 [debug] [Thread-1 (]: Began compiling node test.customer_churn.not_null_stg_autoinsurance_churn_individual_id.c3c7b154c3
[0m23:59:46.415332 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer_churn.not_null_stg_autoinsurance_churn_individual_id.c3c7b154c3"
[0m23:59:46.435117 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.799 seconds
[0m23:59:46.440567 [debug] [Thread-2 (]: On test.customer_churn.not_null_dim_customer_individual_id.80bf9c0ee7: Close
[0m23:59:46.525447 [debug] [Thread-1 (]: Began executing node test.customer_churn.not_null_stg_autoinsurance_churn_individual_id.c3c7b154c3
[0m23:59:46.532729 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer_churn.not_null_stg_autoinsurance_churn_individual_id.c3c7b154c3"
[0m23:59:46.568410 [info ] [Thread-2 (]: 2 of 10 PASS not_null_dim_customer_individual_id ............................... [[32mPASS[0m in 1.17s]
[0m23:59:46.613075 [debug] [Thread-2 (]: Finished running node test.customer_churn.not_null_dim_customer_individual_id.80bf9c0ee7
[0m23:59:46.615617 [debug] [Thread-2 (]: Began running node test.customer_churn.not_null_stg_customer_individual_id.af262c3e65
[0m23:59:46.617107 [info ] [Thread-2 (]: 8 of 10 START test not_null_stg_customer_individual_id ......................... [RUN]
[0m23:59:46.618906 [debug] [Thread-1 (]: Using snowflake connection "test.customer_churn.not_null_stg_autoinsurance_churn_individual_id.c3c7b154c3"
[0m23:59:46.619977 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer_churn.not_null_dim_customer_individual_id.80bf9c0ee7, now test.customer_churn.not_null_stg_customer_individual_id.af262c3e65)
[0m23:59:46.621903 [debug] [Thread-1 (]: On test.customer_churn.not_null_stg_autoinsurance_churn_individual_id.c3c7b154c3: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "test.customer_churn.not_null_stg_autoinsurance_churn_individual_id.c3c7b154c3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select individual_id
from USER_DB_FALCON.RAW_public.stg_autoinsurance_churn
where individual_id is null



      
    ) dbt_internal_test
[0m23:59:46.623832 [debug] [Thread-2 (]: Began compiling node test.customer_churn.not_null_stg_customer_individual_id.af262c3e65
[0m23:59:46.625728 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:59:46.636071 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer_churn.not_null_stg_customer_individual_id.af262c3e65"
[0m23:59:46.682565 [debug] [Thread-2 (]: Began executing node test.customer_churn.not_null_stg_customer_individual_id.af262c3e65
[0m23:59:46.689073 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer_churn.not_null_stg_customer_individual_id.af262c3e65"
[0m23:59:46.801221 [debug] [Thread-2 (]: Using snowflake connection "test.customer_churn.not_null_stg_customer_individual_id.af262c3e65"
[0m23:59:46.828247 [debug] [Thread-2 (]: On test.customer_churn.not_null_stg_customer_individual_id.af262c3e65: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "test.customer_churn.not_null_stg_customer_individual_id.af262c3e65"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select individual_id
from USER_DB_FALCON.RAW_public.stg_customer
where individual_id is null



      
    ) dbt_internal_test
[0m23:59:46.855389 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:59:46.956288 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.580 seconds
[0m23:59:46.966520 [debug] [Thread-3 (]: Applying DROP to: USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
[0m23:59:46.975812 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m23:59:46.976702 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
drop view if exists USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp cascade
[0m23:59:47.043712 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.677 seconds
[0m23:59:47.048422 [debug] [Thread-4 (]: On test.customer_churn.not_null_stg_address_address_id.a26685b6d5: Close
[0m23:59:47.110489 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.133 seconds
[0m23:59:47.138904 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: Close
[0m23:59:47.183979 [info ] [Thread-4 (]: 6 of 10 PASS not_null_stg_address_address_id ................................... [[32mPASS[0m in 0.98s]
[0m23:59:47.186231 [debug] [Thread-4 (]: Finished running node test.customer_churn.not_null_stg_address_address_id.a26685b6d5
[0m23:59:47.188469 [debug] [Thread-4 (]: Began running node test.customer_churn.not_null_stg_demographic_individual_id.68140728ca
[0m23:59:47.190167 [info ] [Thread-4 (]: 9 of 10 START test not_null_stg_demographic_individual_id ...................... [RUN]
[0m23:59:47.191833 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.customer_churn.not_null_stg_address_address_id.a26685b6d5, now test.customer_churn.not_null_stg_demographic_individual_id.68140728ca)
[0m23:59:47.193460 [debug] [Thread-4 (]: Began compiling node test.customer_churn.not_null_stg_demographic_individual_id.68140728ca
[0m23:59:47.203164 [debug] [Thread-4 (]: Writing injected SQL for node "test.customer_churn.not_null_stg_demographic_individual_id.68140728ca"
[0m23:59:47.236563 [debug] [Thread-4 (]: Began executing node test.customer_churn.not_null_stg_demographic_individual_id.68140728ca
[0m23:59:47.241505 [debug] [Thread-4 (]: Writing runtime sql for node "test.customer_churn.not_null_stg_demographic_individual_id.68140728ca"
[0m23:59:47.245964 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c644a119-d1fa-4f03-8710-51054b67514b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc63cef00>]}
[0m23:59:47.247889 [info ] [Thread-3 (]: 3 of 5 OK created sql incremental model RAW_public.fact_churn .................. [[32mSUCCESS 0[0m in 2.65s]
[0m23:59:47.249917 [debug] [Thread-3 (]: Finished running node model.customer_churn.fact_churn
[0m23:59:47.253709 [debug] [Thread-4 (]: Began running node model.customer_churn.churn_metrics
[0m23:59:47.255450 [info ] [Thread-4 (]: 4 of 5 START sql table model RAW_public.churn_metrics .......................... [RUN]
[0m23:59:47.257437 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.customer_churn.churn_metrics'
[0m23:59:47.259176 [debug] [Thread-4 (]: Began compiling node model.customer_churn.churn_metrics
[0m23:59:47.270272 [debug] [Thread-4 (]: Writing injected SQL for node "model.customer_churn.churn_metrics"
[0m23:59:47.273529 [debug] [Thread-4 (]: Using snowflake connection "test.customer_churn.not_null_stg_demographic_individual_id.68140728ca"
[0m23:59:47.276180 [debug] [Thread-4 (]: On test.customer_churn.not_null_stg_demographic_individual_id.68140728ca: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "test.customer_churn.not_null_stg_demographic_individual_id.68140728ca"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select individual_id
from USER_DB_FALCON.RAW_public.stg_demographic
where individual_id is null



      
    ) dbt_internal_test
[0m23:59:47.277677 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:59:47.299675 [debug] [Thread-4 (]: Began executing node model.customer_churn.churn_metrics
[0m23:59:47.304698 [debug] [Thread-4 (]: Writing runtime sql for node "model.customer_churn.churn_metrics"
[0m23:59:47.327418 [debug] [Thread-4 (]: Using snowflake connection "model.customer_churn.churn_metrics"
[0m23:59:47.328328 [debug] [Thread-4 (]: On model.customer_churn.churn_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.churn_metrics"} */
create or replace transient table USER_DB_FALCON.RAW_public.churn_metrics
         as
        (WITH 
  monthly AS (
    SELECT
      DATE_TRUNC('month', churn_date) AS period,
      COUNT(*) AS churn_count
    FROM USER_DB_FALCON.RAW_public.fact_churn
    GROUP BY 1
  ),
  
  by_state AS (
    SELECT
      state AS period,
      COUNT(*) AS churn_count
    FROM USER_DB_FALCON.RAW_public.fact_churn
    GROUP BY 1
  ),
  
  by_age AS (
    SELECT
      CASE
        WHEN age_in_years < 25 THEN 'Under 25'
        WHEN age_in_years < 35 THEN '25-34'
        WHEN age_in_years < 45 THEN '35-44'
        WHEN age_in_years < 55 THEN '45-54'
        WHEN age_in_years < 65 THEN '55-64'
        ELSE '65+'
      END AS period,
      COUNT(*) AS churn_count
    FROM USER_DB_FALCON.RAW_public.fact_churn
    GROUP BY 1
  ),
  
  by_tenure AS (
    SELECT
      CASE
        WHEN days_tenure <= 90 THEN '0-3 months'
        WHEN days_tenure <= 180 THEN '4-6 months'
        WHEN days_tenure <= 365 THEN '7-12 months'
        WHEN days_tenure <= 730 THEN '13-24 months'
        ELSE '25+ months'
      END AS period,
      COUNT(*) AS churn_count
    FROM USER_DB_FALCON.RAW_public.fact_churn
    GROUP BY 1
  ),
  
  by_premium AS (
    SELECT
      CASE
        WHEN annual_premium < 1000 THEN 'Under $1,000'
        WHEN annual_premium < 2000 THEN '$1,000-$1,999'
        WHEN annual_premium < 3000 THEN '$2,000-$2,999'
        ELSE '$3,000+'
      END AS period,
      COUNT(*) AS churn_count
    FROM USER_DB_FALCON.RAW_public.fact_churn
    GROUP BY 1
  )

SELECT
  CAST(period AS VARCHAR) AS period,
  churn_count,
  'monthly'              AS category
FROM monthly

UNION ALL

SELECT
  CAST(period AS VARCHAR) AS period,
  churn_count,
  'by_state'             AS category
FROM by_state

UNION ALL

SELECT
  CAST(period AS VARCHAR) AS period,
  churn_count,
  'by_age'               AS category
FROM by_age

UNION ALL

SELECT
  CAST(period AS VARCHAR) AS period,
  churn_count,
  'by_tenure'            AS category
FROM by_tenure

UNION ALL

SELECT
  CAST(period AS VARCHAR) AS period,
  churn_count,
  'by_premium'           AS category
FROM by_premium
        );
[0m23:59:47.329364 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:59:47.367881 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.513 seconds
[0m23:59:47.370750 [debug] [Thread-2 (]: On test.customer_churn.not_null_stg_customer_individual_id.af262c3e65: Close
[0m23:59:47.482640 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.857 seconds
[0m23:59:47.487347 [debug] [Thread-1 (]: On test.customer_churn.not_null_stg_autoinsurance_churn_individual_id.c3c7b154c3: Close
[0m23:59:47.538208 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.301 seconds
[0m23:59:47.541144 [debug] [Thread-3 (]: On test.customer_churn.not_null_int_customer_enriched_individual_id.4f23212833: Close
[0m23:59:47.617893 [info ] [Thread-2 (]: 8 of 10 PASS not_null_stg_customer_individual_id ............................... [[32mPASS[0m in 1.00s]
[0m23:59:47.623363 [debug] [Thread-2 (]: Finished running node test.customer_churn.not_null_stg_customer_individual_id.af262c3e65
[0m23:59:47.625600 [info ] [Thread-1 (]: 7 of 10 PASS not_null_stg_autoinsurance_churn_individual_id .................... [[32mPASS[0m in 1.22s]
[0m23:59:47.628474 [debug] [Thread-2 (]: Began running node test.customer_churn.not_null_stg_termination_individual_id.b6d8d40bdf
[0m23:59:47.630642 [debug] [Thread-1 (]: Finished running node test.customer_churn.not_null_stg_autoinsurance_churn_individual_id.c3c7b154c3
[0m23:59:47.641342 [info ] [Thread-2 (]: 10 of 10 START test not_null_stg_termination_individual_id ..................... [RUN]
[0m23:59:47.644729 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.367 seconds
[0m23:59:47.647819 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer_churn.not_null_stg_customer_individual_id.af262c3e65, now test.customer_churn.not_null_stg_termination_individual_id.b6d8d40bdf)
[0m23:59:47.653080 [debug] [Thread-4 (]: On test.customer_churn.not_null_stg_demographic_individual_id.68140728ca: Close
[0m23:59:47.657757 [debug] [Thread-2 (]: Began compiling node test.customer_churn.not_null_stg_termination_individual_id.b6d8d40bdf
[0m23:59:47.672943 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer_churn.not_null_stg_termination_individual_id.b6d8d40bdf"
[0m23:59:47.689661 [info ] [Thread-3 (]: 5 of 10 PASS not_null_int_customer_enriched_individual_id ...................... [[32mPASS[0m in 1.54s]
[0m23:59:47.691034 [debug] [Thread-3 (]: Finished running node test.customer_churn.not_null_int_customer_enriched_individual_id.4f23212833
[0m23:59:47.696888 [debug] [Thread-2 (]: Began executing node test.customer_churn.not_null_stg_termination_individual_id.b6d8d40bdf
[0m23:59:47.700917 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer_churn.not_null_stg_termination_individual_id.b6d8d40bdf"
[0m23:59:47.722717 [debug] [Thread-2 (]: Using snowflake connection "test.customer_churn.not_null_stg_termination_individual_id.b6d8d40bdf"
[0m23:59:47.723569 [debug] [Thread-2 (]: On test.customer_churn.not_null_stg_termination_individual_id.b6d8d40bdf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "test.customer_churn.not_null_stg_termination_individual_id.b6d8d40bdf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select individual_id
from USER_DB_FALCON.RAW_public.stg_termination
where individual_id is null



      
    ) dbt_internal_test
[0m23:59:47.724355 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:59:47.937022 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.217 seconds
[0m23:59:47.947445 [debug] [Thread-2 (]: On model.customer_churn.dim_customer: Close
[0m23:59:48.009269 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.294 seconds
[0m23:59:48.012831 [debug] [Thread-1 (]: On model.customer_churn.dim_address: Close
[0m23:59:48.077525 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c644a119-d1fa-4f03-8710-51054b67514b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc5365cd0>]}
[0m23:59:48.079726 [info ] [Thread-2 (]: 2 of 5 OK created sql table model RAW_public.dim_customer ...................... [[32mSUCCESS 1[0m in 3.49s]
[0m23:59:48.082805 [debug] [Thread-2 (]: Finished running node model.customer_churn.dim_customer
[0m23:59:48.143238 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c644a119-d1fa-4f03-8710-51054b67514b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc532cc50>]}
[0m23:59:48.144356 [info ] [Thread-1 (]: 1 of 5 OK created sql table model RAW_public.dim_address ....................... [[32mSUCCESS 1[0m in 3.56s]
[0m23:59:48.145520 [debug] [Thread-1 (]: Finished running node model.customer_churn.dim_address
[0m23:59:48.147102 [debug] [Thread-3 (]: Began running node model.customer_churn.churn_map
[0m23:59:48.149835 [info ] [Thread-3 (]: 5 of 5 START sql table model RAW_public.churn_map .............................. [RUN]
[0m23:59:48.150742 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer_churn.fact_churn, now model.customer_churn.churn_map)
[0m23:59:48.151472 [debug] [Thread-3 (]: Began compiling node model.customer_churn.churn_map
[0m23:59:48.151451 [info ] [Thread-4 (]: 9 of 10 PASS not_null_stg_demographic_individual_id ............................ [[32mPASS[0m in 0.96s]
[0m23:59:48.152725 [debug] [Thread-4 (]: Finished running node test.customer_churn.not_null_stg_demographic_individual_id.68140728ca
[0m23:59:48.154290 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.churn_map"
[0m23:59:48.182018 [debug] [Thread-3 (]: Began executing node model.customer_churn.churn_map
[0m23:59:48.185357 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.churn_map"
[0m23:59:48.213364 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.churn_map"
[0m23:59:48.214949 [debug] [Thread-3 (]: On model.customer_churn.churn_map: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.churn_map"} */
create or replace transient table USER_DB_FALCON.RAW_public.churn_map
         as
        (-- models/marts/churn_map.sql


select
  f.individual_id,
  f.churn_date,
  f.churn_flag,
  a.lon,
  a.lat
from USER_DB_FALCON.RAW_public.fact_churn      as f
join USER_DB_FALCON.RAW_public.dim_address    as a
  using (individual_id)
        );
[0m23:59:48.216635 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:59:48.328032 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.999 seconds
[0m23:59:48.335154 [debug] [Thread-4 (]: On model.customer_churn.churn_metrics: Close
[0m23:59:49.300808 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c644a119-d1fa-4f03-8710-51054b67514b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc5328620>]}
[0m23:59:49.304110 [info ] [Thread-4 (]: 4 of 5 OK created sql table model RAW_public.churn_metrics ..................... [[32mSUCCESS 1[0m in 2.04s]
[0m23:59:49.305737 [debug] [Thread-4 (]: Finished running node model.customer_churn.churn_metrics
[0m23:59:49.326283 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.602 seconds
[0m23:59:49.335777 [debug] [Thread-2 (]: On test.customer_churn.not_null_stg_termination_individual_id.b6d8d40bdf: Close
[0m23:59:49.990757 [info ] [Thread-2 (]: 10 of 10 PASS not_null_stg_termination_individual_id ........................... [[32mPASS[0m in 2.34s]
[0m23:59:50.008140 [debug] [Thread-2 (]: Finished running node test.customer_churn.not_null_stg_termination_individual_id.b6d8d40bdf
[0m23:59:50.014849 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:59:50.016225 [debug] [MainThread]: Connection 'test.customer_churn.not_null_stg_autoinsurance_churn_individual_id.c3c7b154c3' was properly closed.
[0m23:59:50.017990 [debug] [MainThread]: Connection 'test.customer_churn.not_null_stg_termination_individual_id.b6d8d40bdf' was properly closed.
[0m23:59:50.020617 [debug] [MainThread]: Connection 'test.customer_churn.not_null_int_customer_enriched_individual_id.4f23212833' was properly closed.
[0m23:59:50.022082 [debug] [MainThread]: Connection 'test.customer_churn.not_null_stg_demographic_individual_id.68140728ca' was properly closed.
[0m23:59:50.025096 [info ] [MainThread]: 
[0m23:59:50.031785 [info ] [MainThread]: Finished running 10 data tests in 0 hours 0 minutes and 5.29 seconds (5.29s).
[0m23:59:50.037046 [debug] [MainThread]: Command end result
[0m23:59:50.267764 [info ] [MainThread]: 
[0m23:59:50.270440 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:59:50.273105 [info ] [MainThread]: 
[0m23:59:50.276530 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m23:59:50.279110 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 7.5587444, "process_user_time": 4.772455, "process_kernel_time": 2.700205, "process_mem_max_rss": "259132", "process_in_blocks": "1320", "process_out_blocks": "8"}
[0m23:59:50.280616 [debug] [MainThread]: Command `dbt test` succeeded at 23:59:50.280487 after 7.56 seconds
[0m23:59:50.282154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0d4f9e090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd076e2eba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0d54362a0>]}
[0m23:59:50.283175 [debug] [MainThread]: Flushing usage events
[0m23:59:50.299735 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.083 seconds
[0m23:59:50.303870 [debug] [Thread-3 (]: On model.customer_churn.churn_map: Close
[0m23:59:50.435365 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c644a119-d1fa-4f03-8710-51054b67514b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc545adb0>]}
[0m23:59:50.438990 [info ] [Thread-3 (]: 5 of 5 OK created sql table model RAW_public.churn_map ......................... [[32mSUCCESS 1[0m in 2.28s]
[0m23:59:50.441999 [debug] [Thread-3 (]: Finished running node model.customer_churn.churn_map
[0m23:59:50.445796 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:59:50.447826 [debug] [MainThread]: Connection 'model.customer_churn.dim_address' was properly closed.
[0m23:59:50.448911 [debug] [MainThread]: Connection 'model.customer_churn.dim_customer' was properly closed.
[0m23:59:50.449781 [debug] [MainThread]: Connection 'model.customer_churn.churn_map' was properly closed.
[0m23:59:50.455649 [debug] [MainThread]: Connection 'model.customer_churn.churn_metrics' was properly closed.
[0m23:59:50.458410 [info ] [MainThread]: 
[0m23:59:50.460536 [info ] [MainThread]: Finished running 1 incremental model, 4 table models in 0 hours 0 minutes and 7.49 seconds (7.49s).
[0m23:59:50.462932 [debug] [MainThread]: Command end result
[0m23:59:50.706679 [info ] [MainThread]: 
[0m23:59:50.707827 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:59:50.709132 [info ] [MainThread]: 
[0m23:59:50.710976 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m23:59:50.714345 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.478693, "process_user_time": 4.543493, "process_kernel_time": 2.674834, "process_mem_max_rss": "261892", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m23:59:50.715843 [debug] [MainThread]: Command `dbt run` succeeded at 23:59:50.715765 after 9.48 seconds
[0m23:59:50.716513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc7c70830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff023f77bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff023f77e90>]}
[0m23:59:50.720397 [debug] [MainThread]: Flushing usage events
[0m23:59:53.648603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6af8dafc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6af5cdc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6b1367dd0>]}
[0m23:59:53.649309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0a3b0ddf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0a4691d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0a4690410>]}


============================== 23:59:53.663407 | 7bf148a5-e0af-4fa2-9837-7be2f03fd98d ==============================
[0m23:59:53.663407 [info ] [MainThread]: Running with dbt=1.8.7


============================== 23:59:53.664159 | 27255bc0-a523-4b85-9db9-91f12b8fdfb0 ==============================
[0m23:59:53.664159 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:59:53.665205 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:59:53.666272 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:59:54.458515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27255bc0-a523-4b85-9db9-91f12b8fdfb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0a3415df0>]}
[0m23:59:54.465971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7bf148a5-e0af-4fa2-9837-7be2f03fd98d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb655a0b6b0>]}
[0m23:59:54.506238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '27255bc0-a523-4b85-9db9-91f12b8fdfb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff046785490>]}
[0m23:59:54.509116 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m23:59:54.523321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7bf148a5-e0af-4fa2-9837-7be2f03fd98d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb655a09760>]}
[0m23:59:54.529698 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m23:59:54.627322 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:59:54.629080 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:59:55.085688 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:59:55.087426 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:59:55.090074 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:59:55.091734 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:59:55.161776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '27255bc0-a523-4b85-9db9-91f12b8fdfb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff045a13290>]}
[0m23:59:55.164184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7bf148a5-e0af-4fa2-9837-7be2f03fd98d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6556d8c50>]}
[0m23:59:55.609150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7bf148a5-e0af-4fa2-9837-7be2f03fd98d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb655327110>]}
[0m23:59:55.613586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '27255bc0-a523-4b85-9db9-91f12b8fdfb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff04559d970>]}
[0m23:59:55.614661 [info ] [MainThread]: Found 12 models, 10 data tests, 7 sources, 459 macros
[0m23:59:55.649624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7bf148a5-e0af-4fa2-9837-7be2f03fd98d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb655baa960>]}
[0m23:59:55.649758 [info ] [MainThread]: Found 12 models, 10 data tests, 7 sources, 459 macros
[0m23:59:55.650872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27255bc0-a523-4b85-9db9-91f12b8fdfb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0a3446de0>]}
[0m23:59:55.653130 [info ] [MainThread]: 
[0m23:59:55.653763 [info ] [MainThread]: 
[0m23:59:55.654561 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:59:55.654790 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:59:55.658340 [debug] [MainThread]: Command end result
[0m23:59:55.663323 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON_RAW_public'
[0m23:59:55.700309 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m23:59:55.723189 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show terse objects in USER_DB_FALCON.RAW_public limit 10000
[0m23:59:55.723987 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:59:55.903961 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 2.3419402, "process_user_time": 2.994283, "process_kernel_time": 1.561766, "process_mem_max_rss": "233256", "process_in_blocks": "8", "process_out_blocks": "0"}
[0m23:59:55.905447 [debug] [MainThread]: Command `dbt snapshot` succeeded at 23:59:55.905263 after 2.34 seconds
[0m23:59:55.906554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff045bdf680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0a3c5e1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0a600d370>]}
[0m23:59:55.907618 [debug] [MainThread]: Flushing usage events
[0m23:59:56.328242 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.604 seconds
[0m23:59:56.332356 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m23:59:56.448462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7bf148a5-e0af-4fa2-9837-7be2f03fd98d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6556d8f50>]}
[0m23:59:56.449193 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:59:56.449667 [info ] [MainThread]: 
[0m23:59:56.460708 [debug] [Thread-1 (]: Began running node test.customer_churn.not_null_dim_address_individual_id.efa1478d3c
[0m23:59:56.461105 [debug] [Thread-2 (]: Began running node test.customer_churn.not_null_dim_customer_individual_id.80bf9c0ee7
[0m23:59:56.461543 [debug] [Thread-3 (]: Began running node test.customer_churn.not_null_fact_churn_churn_date.c88bd69eeb
[0m23:59:56.461859 [debug] [Thread-4 (]: Began running node test.customer_churn.not_null_fact_churn_individual_id.96f069e355
[0m23:59:56.462107 [info ] [Thread-1 (]: 1 of 10 START test not_null_dim_address_individual_id .......................... [RUN]
[0m23:59:56.462721 [info ] [Thread-2 (]: 2 of 10 START test not_null_dim_customer_individual_id ......................... [RUN]
[0m23:59:56.463450 [info ] [Thread-3 (]: 3 of 10 START test not_null_fact_churn_churn_date .............................. [RUN]
[0m23:59:56.464169 [info ] [Thread-4 (]: 4 of 10 START test not_null_fact_churn_individual_id ........................... [RUN]
[0m23:59:56.464867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON_RAW_public, now test.customer_churn.not_null_dim_address_individual_id.efa1478d3c)
[0m23:59:56.465497 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.customer_churn.not_null_dim_customer_individual_id.80bf9c0ee7'
[0m23:59:56.466320 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.customer_churn.not_null_fact_churn_churn_date.c88bd69eeb'
[0m23:59:56.467159 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.customer_churn.not_null_fact_churn_individual_id.96f069e355'
[0m23:59:56.467868 [debug] [Thread-1 (]: Began compiling node test.customer_churn.not_null_dim_address_individual_id.efa1478d3c
[0m23:59:56.468631 [debug] [Thread-2 (]: Began compiling node test.customer_churn.not_null_dim_customer_individual_id.80bf9c0ee7
[0m23:59:56.469910 [debug] [Thread-3 (]: Began compiling node test.customer_churn.not_null_fact_churn_churn_date.c88bd69eeb
[0m23:59:56.470598 [debug] [Thread-4 (]: Began compiling node test.customer_churn.not_null_fact_churn_individual_id.96f069e355
[0m23:59:56.495750 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer_churn.not_null_dim_address_individual_id.efa1478d3c"
[0m23:59:56.496675 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer_churn.not_null_dim_customer_individual_id.80bf9c0ee7"
[0m23:59:56.503076 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer_churn.not_null_fact_churn_churn_date.c88bd69eeb"
[0m23:59:56.507708 [debug] [Thread-4 (]: Writing injected SQL for node "test.customer_churn.not_null_fact_churn_individual_id.96f069e355"
[0m23:59:56.517498 [debug] [Thread-4 (]: Began executing node test.customer_churn.not_null_fact_churn_individual_id.96f069e355
[0m23:59:56.518028 [debug] [Thread-3 (]: Began executing node test.customer_churn.not_null_fact_churn_churn_date.c88bd69eeb
[0m23:59:56.548069 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer_churn.not_null_fact_churn_churn_date.c88bd69eeb"
[0m23:59:56.549382 [debug] [Thread-4 (]: Writing runtime sql for node "test.customer_churn.not_null_fact_churn_individual_id.96f069e355"
[0m23:59:56.549898 [debug] [Thread-1 (]: Began executing node test.customer_churn.not_null_dim_address_individual_id.efa1478d3c
[0m23:59:56.551546 [debug] [Thread-2 (]: Began executing node test.customer_churn.not_null_dim_customer_individual_id.80bf9c0ee7
[0m23:59:56.554477 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer_churn.not_null_dim_address_individual_id.efa1478d3c"
[0m23:59:56.557938 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer_churn.not_null_dim_customer_individual_id.80bf9c0ee7"
[0m23:59:56.560543 [debug] [Thread-4 (]: Using snowflake connection "test.customer_churn.not_null_fact_churn_individual_id.96f069e355"
[0m23:59:56.561229 [debug] [Thread-3 (]: Using snowflake connection "test.customer_churn.not_null_fact_churn_churn_date.c88bd69eeb"
[0m23:59:56.561749 [debug] [Thread-4 (]: On test.customer_churn.not_null_fact_churn_individual_id.96f069e355: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "test.customer_churn.not_null_fact_churn_individual_id.96f069e355"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select individual_id
from USER_DB_FALCON.RAW_public.fact_churn
where individual_id is null



      
    ) dbt_internal_test
[0m23:59:56.562532 [debug] [Thread-3 (]: On test.customer_churn.not_null_fact_churn_churn_date.c88bd69eeb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "test.customer_churn.not_null_fact_churn_churn_date.c88bd69eeb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select churn_date
from USER_DB_FALCON.RAW_public.fact_churn
where churn_date is null



      
    ) dbt_internal_test
[0m23:59:56.563227 [debug] [Thread-1 (]: Using snowflake connection "test.customer_churn.not_null_dim_address_individual_id.efa1478d3c"
[0m23:59:56.563627 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:59:56.564267 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:59:56.564948 [debug] [Thread-2 (]: Using snowflake connection "test.customer_churn.not_null_dim_customer_individual_id.80bf9c0ee7"
[0m23:59:56.565267 [debug] [Thread-1 (]: On test.customer_churn.not_null_dim_address_individual_id.efa1478d3c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "test.customer_churn.not_null_dim_address_individual_id.efa1478d3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select individual_id
from USER_DB_FALCON.RAW_public.dim_address
where individual_id is null



      
    ) dbt_internal_test
[0m23:59:56.569730 [debug] [Thread-2 (]: On test.customer_churn.not_null_dim_customer_individual_id.80bf9c0ee7: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "test.customer_churn.not_null_dim_customer_individual_id.80bf9c0ee7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select individual_id
from USER_DB_FALCON.RAW_public.dim_customer
where individual_id is null



      
    ) dbt_internal_test
[0m23:59:56.570934 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:59:56.571694 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:59:56.910832 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.346 seconds
[0m23:59:56.937073 [debug] [Thread-3 (]: On test.customer_churn.not_null_fact_churn_churn_date.c88bd69eeb: Close
[0m23:59:57.058571 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.495 seconds
[0m23:59:57.060705 [debug] [Thread-4 (]: On test.customer_churn.not_null_fact_churn_individual_id.96f069e355: Close
[0m23:59:57.075583 [info ] [Thread-3 (]: 3 of 10 PASS not_null_fact_churn_churn_date .................................... [[32mPASS[0m in 0.61s]
[0m23:59:57.079630 [debug] [Thread-3 (]: Finished running node test.customer_churn.not_null_fact_churn_churn_date.c88bd69eeb
[0m23:59:57.084720 [debug] [Thread-3 (]: Began running node test.customer_churn.not_null_int_customer_enriched_individual_id.4f23212833
[0m23:59:57.086759 [info ] [Thread-3 (]: 5 of 10 START test not_null_int_customer_enriched_individual_id ................ [RUN]
[0m23:59:57.088721 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer_churn.not_null_fact_churn_churn_date.c88bd69eeb, now test.customer_churn.not_null_int_customer_enriched_individual_id.4f23212833)
[0m23:59:57.090343 [debug] [Thread-3 (]: Began compiling node test.customer_churn.not_null_int_customer_enriched_individual_id.4f23212833
[0m23:59:57.100525 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer_churn.not_null_int_customer_enriched_individual_id.4f23212833"
[0m23:59:57.118355 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.547 seconds
[0m23:59:57.123116 [debug] [Thread-1 (]: On test.customer_churn.not_null_dim_address_individual_id.efa1478d3c: Close
[0m23:59:57.141770 [debug] [Thread-3 (]: Began executing node test.customer_churn.not_null_int_customer_enriched_individual_id.4f23212833
[0m23:59:57.145185 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer_churn.not_null_int_customer_enriched_individual_id.4f23212833"
[0m23:59:57.169935 [debug] [Thread-3 (]: Using snowflake connection "test.customer_churn.not_null_int_customer_enriched_individual_id.4f23212833"
[0m23:59:57.170928 [debug] [Thread-3 (]: On test.customer_churn.not_null_int_customer_enriched_individual_id.4f23212833: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "test.customer_churn.not_null_int_customer_enriched_individual_id.4f23212833"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select individual_id
from USER_DB_FALCON.RAW_public.int_customer_enriched
where individual_id is null



      
    ) dbt_internal_test
[0m23:59:57.171869 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:59:57.182825 [info ] [Thread-4 (]: 4 of 10 PASS not_null_fact_churn_individual_id ................................. [[32mPASS[0m in 0.72s]
[0m23:59:57.185878 [debug] [Thread-4 (]: Finished running node test.customer_churn.not_null_fact_churn_individual_id.96f069e355
[0m23:59:57.186938 [debug] [Thread-4 (]: Began running node test.customer_churn.not_null_stg_address_address_id.a26685b6d5
[0m23:59:57.187893 [info ] [Thread-4 (]: 6 of 10 START test not_null_stg_address_address_id ............................. [RUN]
[0m23:59:57.188981 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.customer_churn.not_null_fact_churn_individual_id.96f069e355, now test.customer_churn.not_null_stg_address_address_id.a26685b6d5)
[0m23:59:57.189819 [debug] [Thread-4 (]: Began compiling node test.customer_churn.not_null_stg_address_address_id.a26685b6d5
[0m23:59:57.194169 [debug] [Thread-4 (]: Writing injected SQL for node "test.customer_churn.not_null_stg_address_address_id.a26685b6d5"
[0m23:59:57.257514 [info ] [Thread-1 (]: 1 of 10 PASS not_null_dim_address_individual_id ................................ [[32mPASS[0m in 0.79s]
[0m23:59:57.314334 [debug] [Thread-1 (]: Finished running node test.customer_churn.not_null_dim_address_individual_id.efa1478d3c
[0m23:59:57.314926 [debug] [Thread-4 (]: Began executing node test.customer_churn.not_null_stg_address_address_id.a26685b6d5
[0m23:59:57.316100 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.744 seconds
[0m23:59:57.316463 [debug] [Thread-1 (]: Began running node test.customer_churn.not_null_stg_autoinsurance_churn_individual_id.c3c7b154c3
[0m23:59:57.319321 [debug] [Thread-4 (]: Writing runtime sql for node "test.customer_churn.not_null_stg_address_address_id.a26685b6d5"
[0m23:59:57.335528 [debug] [Thread-2 (]: On test.customer_churn.not_null_dim_customer_individual_id.80bf9c0ee7: Close
[0m23:59:57.341545 [info ] [Thread-1 (]: 7 of 10 START test not_null_stg_autoinsurance_churn_individual_id .............. [RUN]
[0m23:59:57.355223 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer_churn.not_null_dim_address_individual_id.efa1478d3c, now test.customer_churn.not_null_stg_autoinsurance_churn_individual_id.c3c7b154c3)
[0m23:59:57.365657 [debug] [Thread-1 (]: Began compiling node test.customer_churn.not_null_stg_autoinsurance_churn_individual_id.c3c7b154c3
[0m23:59:57.375748 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer_churn.not_null_stg_autoinsurance_churn_individual_id.c3c7b154c3"
[0m23:59:57.398082 [debug] [Thread-4 (]: Using snowflake connection "test.customer_churn.not_null_stg_address_address_id.a26685b6d5"
[0m23:59:57.402368 [debug] [Thread-4 (]: On test.customer_churn.not_null_stg_address_address_id.a26685b6d5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "test.customer_churn.not_null_stg_address_address_id.a26685b6d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select address_id
from USER_DB_FALCON.RAW_public.stg_address
where address_id is null



      
    ) dbt_internal_test
[0m23:59:57.409090 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:59:57.417648 [debug] [Thread-1 (]: Began executing node test.customer_churn.not_null_stg_autoinsurance_churn_individual_id.c3c7b154c3
[0m23:59:57.422656 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer_churn.not_null_stg_autoinsurance_churn_individual_id.c3c7b154c3"
[0m23:59:57.446711 [debug] [Thread-1 (]: Using snowflake connection "test.customer_churn.not_null_stg_autoinsurance_churn_individual_id.c3c7b154c3"
[0m23:59:57.448062 [debug] [Thread-1 (]: On test.customer_churn.not_null_stg_autoinsurance_churn_individual_id.c3c7b154c3: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "test.customer_churn.not_null_stg_autoinsurance_churn_individual_id.c3c7b154c3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select individual_id
from USER_DB_FALCON.RAW_public.stg_autoinsurance_churn
where individual_id is null



      
    ) dbt_internal_test
[0m23:59:57.449362 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:59:57.468558 [info ] [Thread-2 (]: 2 of 10 PASS not_null_dim_customer_individual_id ............................... [[32mPASS[0m in 1.00s]
[0m23:59:57.470559 [debug] [Thread-2 (]: Finished running node test.customer_churn.not_null_dim_customer_individual_id.80bf9c0ee7
[0m23:59:57.472317 [debug] [Thread-2 (]: Began running node test.customer_churn.not_null_stg_customer_individual_id.af262c3e65
[0m23:59:57.473912 [info ] [Thread-2 (]: 8 of 10 START test not_null_stg_customer_individual_id ......................... [RUN]
[0m23:59:57.475923 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer_churn.not_null_dim_customer_individual_id.80bf9c0ee7, now test.customer_churn.not_null_stg_customer_individual_id.af262c3e65)
[0m23:59:57.477606 [debug] [Thread-2 (]: Began compiling node test.customer_churn.not_null_stg_customer_individual_id.af262c3e65
[0m23:59:57.486731 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer_churn.not_null_stg_customer_individual_id.af262c3e65"
[0m23:59:57.528721 [debug] [Thread-2 (]: Began executing node test.customer_churn.not_null_stg_customer_individual_id.af262c3e65
[0m23:59:57.534094 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer_churn.not_null_stg_customer_individual_id.af262c3e65"
[0m23:59:57.569531 [debug] [Thread-2 (]: Using snowflake connection "test.customer_churn.not_null_stg_customer_individual_id.af262c3e65"
[0m23:59:57.571057 [debug] [Thread-2 (]: On test.customer_churn.not_null_stg_customer_individual_id.af262c3e65: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "test.customer_churn.not_null_stg_customer_individual_id.af262c3e65"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select individual_id
from USER_DB_FALCON.RAW_public.stg_customer
where individual_id is null



      
    ) dbt_internal_test
[0m23:59:57.572467 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:59:57.685430 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.513 seconds
[0m23:59:57.690430 [debug] [Thread-3 (]: On test.customer_churn.not_null_int_customer_enriched_individual_id.4f23212833: Close
[0m23:59:57.735377 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.326 seconds
[0m23:59:57.739708 [debug] [Thread-4 (]: On test.customer_churn.not_null_stg_address_address_id.a26685b6d5: Close
[0m23:59:57.854315 [info ] [Thread-4 (]: 6 of 10 PASS not_null_stg_address_address_id ................................... [[32mPASS[0m in 0.66s]
[0m23:59:57.857907 [debug] [Thread-4 (]: Finished running node test.customer_churn.not_null_stg_address_address_id.a26685b6d5
[0m23:59:57.862384 [debug] [Thread-4 (]: Began running node test.customer_churn.not_null_stg_demographic_individual_id.68140728ca
[0m23:59:57.865795 [info ] [Thread-4 (]: 9 of 10 START test not_null_stg_demographic_individual_id ...................... [RUN]
[0m23:59:57.869083 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.customer_churn.not_null_stg_address_address_id.a26685b6d5, now test.customer_churn.not_null_stg_demographic_individual_id.68140728ca)
[0m23:59:57.872398 [debug] [Thread-4 (]: Began compiling node test.customer_churn.not_null_stg_demographic_individual_id.68140728ca
[0m23:59:57.884824 [debug] [Thread-4 (]: Writing injected SQL for node "test.customer_churn.not_null_stg_demographic_individual_id.68140728ca"
[0m23:59:57.888618 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.439 seconds
[0m23:59:57.895286 [debug] [Thread-1 (]: On test.customer_churn.not_null_stg_autoinsurance_churn_individual_id.c3c7b154c3: Close
[0m23:59:57.918440 [debug] [Thread-4 (]: Began executing node test.customer_churn.not_null_stg_demographic_individual_id.68140728ca
[0m23:59:57.923378 [debug] [Thread-4 (]: Writing runtime sql for node "test.customer_churn.not_null_stg_demographic_individual_id.68140728ca"
[0m23:59:57.926382 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.354 seconds
[0m23:59:57.932334 [debug] [Thread-2 (]: On test.customer_churn.not_null_stg_customer_individual_id.af262c3e65: Close
[0m23:59:58.008620 [debug] [Thread-4 (]: Using snowflake connection "test.customer_churn.not_null_stg_demographic_individual_id.68140728ca"
[0m23:59:58.010743 [info ] [Thread-1 (]: 7 of 10 PASS not_null_stg_autoinsurance_churn_individual_id .................... [[32mPASS[0m in 0.66s]
[0m23:59:58.021744 [debug] [Thread-4 (]: On test.customer_churn.not_null_stg_demographic_individual_id.68140728ca: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "test.customer_churn.not_null_stg_demographic_individual_id.68140728ca"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select individual_id
from USER_DB_FALCON.RAW_public.stg_demographic
where individual_id is null



      
    ) dbt_internal_test
[0m23:59:58.023234 [debug] [Thread-1 (]: Finished running node test.customer_churn.not_null_stg_autoinsurance_churn_individual_id.c3c7b154c3
[0m23:59:58.024366 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:59:58.025687 [debug] [Thread-1 (]: Began running node test.customer_churn.not_null_stg_termination_individual_id.b6d8d40bdf
[0m23:59:58.029429 [info ] [Thread-1 (]: 10 of 10 START test not_null_stg_termination_individual_id ..................... [RUN]
[0m23:59:58.034574 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer_churn.not_null_stg_autoinsurance_churn_individual_id.c3c7b154c3, now test.customer_churn.not_null_stg_termination_individual_id.b6d8d40bdf)
[0m23:59:58.036332 [debug] [Thread-1 (]: Began compiling node test.customer_churn.not_null_stg_termination_individual_id.b6d8d40bdf
[0m23:59:58.041010 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer_churn.not_null_stg_termination_individual_id.b6d8d40bdf"
[0m23:59:58.058232 [debug] [Thread-1 (]: Began executing node test.customer_churn.not_null_stg_termination_individual_id.b6d8d40bdf
[0m23:59:58.062829 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer_churn.not_null_stg_termination_individual_id.b6d8d40bdf"
[0m23:59:58.076741 [debug] [Thread-1 (]: Using snowflake connection "test.customer_churn.not_null_stg_termination_individual_id.b6d8d40bdf"
[0m23:59:58.077504 [debug] [Thread-1 (]: On test.customer_churn.not_null_stg_termination_individual_id.b6d8d40bdf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "test.customer_churn.not_null_stg_termination_individual_id.b6d8d40bdf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select individual_id
from USER_DB_FALCON.RAW_public.stg_termination
where individual_id is null



      
    ) dbt_internal_test
[0m23:59:58.078458 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:59:58.230621 [info ] [Thread-3 (]: 5 of 10 PASS not_null_int_customer_enriched_individual_id ...................... [[32mPASS[0m in 1.14s]
[0m23:59:58.244207 [debug] [Thread-3 (]: Finished running node test.customer_churn.not_null_int_customer_enriched_individual_id.4f23212833
[0m23:59:58.660463 [info ] [Thread-2 (]: 8 of 10 PASS not_null_stg_customer_individual_id ............................... [[32mPASS[0m in 1.18s]
[0m23:59:58.663406 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.639 seconds
[0m23:59:58.664791 [debug] [Thread-2 (]: Finished running node test.customer_churn.not_null_stg_customer_individual_id.af262c3e65
[0m23:59:58.671717 [debug] [Thread-4 (]: On test.customer_churn.not_null_stg_demographic_individual_id.68140728ca: Close
[0m23:59:58.775674 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.697 seconds
[0m23:59:58.780973 [debug] [Thread-1 (]: On test.customer_churn.not_null_stg_termination_individual_id.b6d8d40bdf: Close
[0m23:59:58.802611 [info ] [Thread-4 (]: 9 of 10 PASS not_null_stg_demographic_individual_id ............................ [[32mPASS[0m in 0.93s]
[0m23:59:58.808582 [debug] [Thread-4 (]: Finished running node test.customer_churn.not_null_stg_demographic_individual_id.68140728ca
[0m23:59:58.959204 [info ] [Thread-1 (]: 10 of 10 PASS not_null_stg_termination_individual_id ........................... [[32mPASS[0m in 0.92s]
[0m23:59:58.962284 [debug] [Thread-1 (]: Finished running node test.customer_churn.not_null_stg_termination_individual_id.b6d8d40bdf
[0m23:59:58.966182 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:59:58.967396 [debug] [MainThread]: Connection 'test.customer_churn.not_null_stg_termination_individual_id.b6d8d40bdf' was properly closed.
[0m23:59:58.968789 [debug] [MainThread]: Connection 'test.customer_churn.not_null_stg_customer_individual_id.af262c3e65' was properly closed.
[0m23:59:58.969788 [debug] [MainThread]: Connection 'test.customer_churn.not_null_int_customer_enriched_individual_id.4f23212833' was properly closed.
[0m23:59:58.971541 [debug] [MainThread]: Connection 'test.customer_churn.not_null_stg_demographic_individual_id.68140728ca' was properly closed.
[0m23:59:58.972842 [info ] [MainThread]: 
[0m23:59:58.973966 [info ] [MainThread]: Finished running 10 data tests in 0 hours 0 minutes and 3.32 seconds (3.32s).
[0m23:59:58.976589 [debug] [MainThread]: Command end result
[0m23:59:59.138645 [info ] [MainThread]: 
[0m23:59:59.139661 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:59:59.140393 [info ] [MainThread]: 
[0m23:59:59.141243 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m23:59:59.142365 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.583481, "process_user_time": 3.98009, "process_kernel_time": 1.794131, "process_mem_max_rss": "265048", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m23:59:59.143279 [debug] [MainThread]: Command `dbt test` succeeded at 23:59:59.143214 after 5.58 seconds
[0m23:59:59.144085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6afdbb170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6af7b1e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6af7b30e0>]}
[0m23:59:59.145035 [debug] [MainThread]: Flushing usage events
[0m00:00:01.606310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f912a3c7fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f912cb932c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f912a3c7b90>]}


============================== 00:00:01.611670 | 7625b48f-1ff2-458e-9815-eb930593c601 ==============================
[0m00:00:01.611670 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:00:01.612441 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:00:02.241189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7625b48f-1ff2-458e-9815-eb930593c601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f912b548ef0>]}
[0m00:00:02.277293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7625b48f-1ff2-458e-9815-eb930593c601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90d89f22d0>]}
[0m00:00:02.278921 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m00:00:02.407630 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:00:03.459956 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:00:03.460839 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:00:03.494041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7625b48f-1ff2-458e-9815-eb930593c601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90d2e83950>]}
[0m00:00:03.653314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7625b48f-1ff2-458e-9815-eb930593c601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90d03df710>]}
[0m00:00:03.655874 [info ] [MainThread]: Found 12 models, 10 data tests, 7 sources, 459 macros
[0m00:00:03.657282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7625b48f-1ff2-458e-9815-eb930593c601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90d03bd850>]}
[0m00:00:03.660070 [info ] [MainThread]: 
[0m00:00:03.660841 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m00:00:03.663529 [debug] [MainThread]: Command end result
[0m00:00:03.928272 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 2.3707266, "process_user_time": 3.051403, "process_kernel_time": 2.798705, "process_mem_max_rss": "243940", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:00:03.931632 [debug] [MainThread]: Command `dbt snapshot` succeeded at 00:00:03.931492 after 2.37 seconds
[0m00:00:03.973139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f912a64ec30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f912a64e300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f912a64d520>]}
[0m00:00:03.975338 [debug] [MainThread]: Flushing usage events
[0m00:04:38.464076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa102a0cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa1020a6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa11f373e0>]}


============================== 00:04:38.468909 | 2b2f3f90-c553-4d87-98f4-0ca64377c8f7 ==============================
[0m00:04:38.468909 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:04:38.470267 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:04:38.550338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b2f3f90-c553-4d87-98f4-0ca64377c8f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa100f23c0>]}
[0m00:04:38.561545 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m00:04:38.571830 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m00:04:38.573106 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.16757472, "process_user_time": 1.495072, "process_kernel_time": 0.08364, "process_mem_max_rss": "165616", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:04:38.573951 [debug] [MainThread]: Command `dbt deps` succeeded at 00:04:38.573843 after 0.17 seconds
[0m00:04:38.574582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa102a0cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa0f0b5910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa108518b0>]}
[0m00:04:38.575351 [debug] [MainThread]: Flushing usage events
[0m00:04:41.288136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb603c9520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb603c9220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb60767200>]}


============================== 00:04:41.294803 | 675e1299-b247-4964-ad27-2b0e99fe0966 ==============================
[0m00:04:41.294803 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:04:41.295856 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt --select staging', 'send_anonymous_usage_stats': 'True'}
[0m00:04:42.016840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '675e1299-b247-4964-ad27-2b0e99fe0966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb0e509be0>]}
[0m00:04:42.051620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '675e1299-b247-4964-ad27-2b0e99fe0966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb02743b90>]}
[0m00:04:42.052726 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m00:04:42.128843 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:04:42.591750 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:04:42.592836 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:04:42.624905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '675e1299-b247-4964-ad27-2b0e99fe0966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb09d19790>]}
[0m00:04:42.750741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '675e1299-b247-4964-ad27-2b0e99fe0966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb0221cf20>]}
[0m00:04:42.751509 [info ] [MainThread]: Found 12 models, 10 data tests, 7 sources, 459 macros
[0m00:04:42.752197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '675e1299-b247-4964-ad27-2b0e99fe0966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb0240c2f0>]}
[0m00:04:42.754217 [info ] [MainThread]: 
[0m00:04:42.755033 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:04:42.758627 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON'
[0m00:04:42.770617 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON"
[0m00:04:42.771739 [debug] [ThreadPool]: On list_USER_DB_FALCON: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON"} */
show terse schemas in database USER_DB_FALCON
    limit 10000
[0m00:04:42.772482 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:04:43.416558 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.644 seconds
[0m00:04:43.418465 [debug] [ThreadPool]: On list_USER_DB_FALCON: Close
[0m00:04:43.766846 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON, now list_USER_DB_FALCON_RAW_public)
[0m00:04:43.774255 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m00:04:43.774910 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show terse objects in USER_DB_FALCON.RAW_public limit 10000
[0m00:04:43.775637 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:04:44.213195 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.437 seconds
[0m00:04:44.217058 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m00:04:44.364225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '675e1299-b247-4964-ad27-2b0e99fe0966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb027430b0>]}
[0m00:04:44.365492 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:04:44.366729 [info ] [MainThread]: 
[0m00:04:44.377725 [debug] [Thread-1 (]: Began running node model.customer_churn.stg_address
[0m00:04:44.378375 [debug] [Thread-2 (]: Began running node model.customer_churn.stg_autoinsurance_churn
[0m00:04:44.378780 [debug] [Thread-3 (]: Began running node model.customer_churn.stg_customer
[0m00:04:44.379712 [debug] [Thread-4 (]: Began running node model.customer_churn.stg_demographic
[0m00:04:44.379277 [info ] [Thread-1 (]: 1 of 6 START sql view model RAW_public.stg_address ............................. [RUN]
[0m00:04:44.380556 [info ] [Thread-2 (]: 2 of 6 START sql view model RAW_public.stg_autoinsurance_churn ................. [RUN]
[0m00:04:44.381166 [info ] [Thread-3 (]: 3 of 6 START sql view model RAW_public.stg_customer ............................ [RUN]
[0m00:04:44.381933 [info ] [Thread-4 (]: 4 of 6 START sql view model RAW_public.stg_demographic ......................... [RUN]
[0m00:04:44.382651 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON_RAW_public, now model.customer_churn.stg_address)
[0m00:04:44.383590 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.customer_churn.stg_autoinsurance_churn'
[0m00:04:44.384393 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.customer_churn.stg_customer'
[0m00:04:44.385015 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.customer_churn.stg_demographic'
[0m00:04:44.385793 [debug] [Thread-1 (]: Began compiling node model.customer_churn.stg_address
[0m00:04:44.386633 [debug] [Thread-2 (]: Began compiling node model.customer_churn.stg_autoinsurance_churn
[0m00:04:44.387431 [debug] [Thread-3 (]: Began compiling node model.customer_churn.stg_customer
[0m00:04:44.388186 [debug] [Thread-4 (]: Began compiling node model.customer_churn.stg_demographic
[0m00:04:44.394378 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.stg_address"
[0m00:04:44.396772 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer_churn.stg_autoinsurance_churn"
[0m00:04:44.399230 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.stg_customer"
[0m00:04:44.402615 [debug] [Thread-4 (]: Writing injected SQL for node "model.customer_churn.stg_demographic"
[0m00:04:44.413731 [debug] [Thread-1 (]: Began executing node model.customer_churn.stg_address
[0m00:04:44.414089 [debug] [Thread-3 (]: Began executing node model.customer_churn.stg_customer
[0m00:04:44.419679 [debug] [Thread-4 (]: Began executing node model.customer_churn.stg_demographic
[0m00:04:44.425618 [debug] [Thread-2 (]: Began executing node model.customer_churn.stg_autoinsurance_churn
[0m00:04:44.449312 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.stg_address"
[0m00:04:44.450465 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.stg_customer"
[0m00:04:44.452694 [debug] [Thread-4 (]: Writing runtime sql for node "model.customer_churn.stg_demographic"
[0m00:04:44.455044 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer_churn.stg_autoinsurance_churn"
[0m00:04:44.465606 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.stg_customer"
[0m00:04:44.466437 [debug] [Thread-4 (]: Using snowflake connection "model.customer_churn.stg_demographic"
[0m00:04:44.466818 [debug] [Thread-3 (]: On model.customer_churn.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_customer"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_customer
  
   as (
    

select
  individual_id,
  address_id,
  curr_ann_amt    as annual_premium,
  days_tenure,
  cust_orig_date,
  age_in_years,            -- bring this in
  date_of_birth            -- and this
from USER_DB_FALCON.RAW.CUSTOMER_STAGING
where individual_id is not null
  );
[0m00:04:44.467819 [debug] [Thread-4 (]: On model.customer_churn.stg_demographic: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_demographic"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_demographic
  
   as (
    

select
  individual_id,
  income,
  has_children,
  length_of_residence    as length_of_residence,  -- exact match
  marital_status,
  home_owner,
  home_market_value      as home_market_value,
  college_degree,
  good_credit
from USER_DB_FALCON.RAW.DEMOGRAPHIC_STAGING
  );
[0m00:04:44.468469 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.stg_address"
[0m00:04:44.468804 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:04:44.469918 [debug] [Thread-2 (]: Using snowflake connection "model.customer_churn.stg_autoinsurance_churn"
[0m00:04:44.470267 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:04:44.470974 [debug] [Thread-1 (]: On model.customer_churn.stg_address: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_address"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_address
  
   as (
    -- models/staging/stg_address.sql

select
  address_id,
  street_address,
  city,
  state,
  county,
  latitude::float as lat,
  longitude::float as lon
from USER_DB_FALCON.RAW.ADDRESS_STAGING
  );
[0m00:04:44.473020 [debug] [Thread-2 (]: On model.customer_churn.stg_autoinsurance_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_autoinsurance_churn"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_autoinsurance_churn
  
   as (
    

select
  individual_id,
  churn              as churn_flag
from USER_DB_FALCON.RAW.AUTOINSURANCE_CHURN_STAGING
  );
[0m00:04:44.475610 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:04:44.476924 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:04:45.006247 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.531 seconds
[0m00:04:45.025439 [debug] [Thread-1 (]: On model.customer_churn.stg_address: Close
[0m00:04:45.077556 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.607 seconds
[0m00:04:45.081991 [debug] [Thread-4 (]: On model.customer_churn.stg_demographic: Close
[0m00:04:45.166279 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '675e1299-b247-4964-ad27-2b0e99fe0966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb02702e40>]}
[0m00:04:45.167379 [info ] [Thread-1 (]: 1 of 6 OK created sql view model RAW_public.stg_address ........................ [[32mSUCCESS 1[0m in 0.78s]
[0m00:04:45.168321 [debug] [Thread-1 (]: Finished running node model.customer_churn.stg_address
[0m00:04:45.168948 [debug] [Thread-1 (]: Began running node model.customer_churn.stg_termination
[0m00:04:45.169714 [info ] [Thread-1 (]: 5 of 6 START sql view model RAW_public.stg_termination ......................... [RUN]
[0m00:04:45.170473 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer_churn.stg_address, now model.customer_churn.stg_termination)
[0m00:04:45.171252 [debug] [Thread-1 (]: Began compiling node model.customer_churn.stg_termination
[0m00:04:45.177656 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.stg_termination"
[0m00:04:45.191831 [debug] [Thread-1 (]: Began executing node model.customer_churn.stg_termination
[0m00:04:45.195659 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.stg_termination"
[0m00:04:45.214893 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.stg_termination"
[0m00:04:45.215582 [debug] [Thread-1 (]: On model.customer_churn.stg_termination: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_termination"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_termination
  
   as (
    

select
  individual_id,
  acct_suspd_date    as churn_date
from USER_DB_FALCON.RAW.TERMINATION_STAGING
  );
[0m00:04:45.216119 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:04:45.522373 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.045 seconds
[0m00:04:45.526910 [debug] [Thread-2 (]: On model.customer_churn.stg_autoinsurance_churn: Close
[0m00:04:45.544462 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '675e1299-b247-4964-ad27-2b0e99fe0966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb017aa060>]}
[0m00:04:45.546209 [info ] [Thread-4 (]: 4 of 6 OK created sql view model RAW_public.stg_demographic .................... [[32mSUCCESS 1[0m in 1.16s]
[0m00:04:45.547698 [debug] [Thread-4 (]: Finished running node model.customer_churn.stg_demographic
[0m00:04:45.549175 [debug] [Thread-4 (]: Began running node model.customer_churn.stg_turning_movement
[0m00:04:45.550471 [info ] [Thread-4 (]: 6 of 6 START sql view model RAW_public.stg_turning_movement .................... [RUN]
[0m00:04:45.551854 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.customer_churn.stg_demographic, now model.customer_churn.stg_turning_movement)
[0m00:04:45.553073 [debug] [Thread-4 (]: Began compiling node model.customer_churn.stg_turning_movement
[0m00:04:45.560082 [debug] [Thread-4 (]: Writing injected SQL for node "model.customer_churn.stg_turning_movement"
[0m00:04:45.579561 [debug] [Thread-4 (]: Began executing node model.customer_churn.stg_turning_movement
[0m00:04:45.585090 [debug] [Thread-4 (]: Writing runtime sql for node "model.customer_churn.stg_turning_movement"
[0m00:04:45.609723 [debug] [Thread-4 (]: Using snowflake connection "model.customer_churn.stg_turning_movement"
[0m00:04:45.611221 [debug] [Thread-4 (]: On model.customer_churn.stg_turning_movement: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_turning_movement"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_turning_movement
  
   as (
    -- models/staging/stg_turning_movement.sql

select
  objectid,
  facilityid,
  intid,
  intname,
  nodeno,
  longitude::float as tm_lon,
  latitude::float  as tm_lat
from USER_DB_FALCON.RAW.TURNING_MOVEMENT
  );
[0m00:04:45.612036 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:04:45.647039 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.431 seconds
[0m00:04:45.652453 [debug] [Thread-1 (]: On model.customer_churn.stg_termination: Close
[0m00:04:45.670586 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '675e1299-b247-4964-ad27-2b0e99fe0966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb01692f30>]}
[0m00:04:45.671579 [info ] [Thread-2 (]: 2 of 6 OK created sql view model RAW_public.stg_autoinsurance_churn ............ [[32mSUCCESS 1[0m in 1.29s]
[0m00:04:45.672519 [debug] [Thread-2 (]: Finished running node model.customer_churn.stg_autoinsurance_churn
[0m00:04:45.766666 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '675e1299-b247-4964-ad27-2b0e99fe0966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb016798b0>]}
[0m00:04:45.768502 [info ] [Thread-1 (]: 5 of 6 OK created sql view model RAW_public.stg_termination .................... [[32mSUCCESS 1[0m in 0.60s]
[0m00:04:45.770458 [debug] [Thread-1 (]: Finished running node model.customer_churn.stg_termination
[0m00:04:45.830091 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.361 seconds
[0m00:04:45.832261 [debug] [Thread-3 (]: On model.customer_churn.stg_customer: Close
[0m00:04:45.953266 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '675e1299-b247-4964-ad27-2b0e99fe0966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb0167a030>]}
[0m00:04:45.954543 [info ] [Thread-3 (]: 3 of 6 OK created sql view model RAW_public.stg_customer ....................... [[32mSUCCESS 1[0m in 1.57s]
[0m00:04:45.955576 [debug] [Thread-3 (]: Finished running node model.customer_churn.stg_customer
[0m00:04:46.437667 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.826 seconds
[0m00:04:46.440296 [debug] [Thread-4 (]: On model.customer_churn.stg_turning_movement: Close
[0m00:04:46.577056 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '675e1299-b247-4964-ad27-2b0e99fe0966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb0168ef90>]}
[0m00:04:46.578540 [info ] [Thread-4 (]: 6 of 6 OK created sql view model RAW_public.stg_turning_movement ............... [[32mSUCCESS 1[0m in 1.02s]
[0m00:04:46.579582 [debug] [Thread-4 (]: Finished running node model.customer_churn.stg_turning_movement
[0m00:04:46.581739 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:04:46.582406 [debug] [MainThread]: Connection 'model.customer_churn.stg_termination' was properly closed.
[0m00:04:46.583018 [debug] [MainThread]: Connection 'model.customer_churn.stg_autoinsurance_churn' was properly closed.
[0m00:04:46.583978 [debug] [MainThread]: Connection 'model.customer_churn.stg_customer' was properly closed.
[0m00:04:46.584545 [debug] [MainThread]: Connection 'model.customer_churn.stg_turning_movement' was properly closed.
[0m00:04:46.585176 [info ] [MainThread]: 
[0m00:04:46.585763 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 3.83 seconds (3.83s).
[0m00:04:46.586846 [debug] [MainThread]: Command end result
[0m00:04:46.686529 [info ] [MainThread]: 
[0m00:04:46.687525 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:04:46.688419 [info ] [MainThread]: 
[0m00:04:46.689384 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m00:04:46.690676 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.4605317, "process_user_time": 3.587633, "process_kernel_time": 2.865922, "process_mem_max_rss": "269624", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m00:04:46.691871 [debug] [MainThread]: Command `dbt run` succeeded at 00:04:46.691673 after 5.46 seconds
[0m00:04:46.692906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb60327e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb612585c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb603deab0>]}
[0m00:04:46.693901 [debug] [MainThread]: Flushing usage events
[0m00:04:49.184845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3c10618e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3c0232000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3c0231af0>]}


============================== 00:04:49.193177 | 7094bede-5d7c-4a9a-aed5-96187ef00a06 ==============================
[0m00:04:49.193177 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:04:49.194095 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt --select intermediate', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:04:50.082108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7094bede-5d7c-4a9a-aed5-96187ef00a06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3621ada30>]}
[0m00:04:50.121664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7094bede-5d7c-4a9a-aed5-96187ef00a06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3bf7cc710>]}
[0m00:04:50.122686 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m00:04:50.194533 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:04:50.646012 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:04:50.647318 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:04:50.685133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7094bede-5d7c-4a9a-aed5-96187ef00a06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe361bc62a0>]}
[0m00:04:50.812260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7094bede-5d7c-4a9a-aed5-96187ef00a06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe361d487a0>]}
[0m00:04:50.812864 [info ] [MainThread]: Found 12 models, 10 data tests, 7 sources, 459 macros
[0m00:04:50.813378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7094bede-5d7c-4a9a-aed5-96187ef00a06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe361bec8c0>]}
[0m00:04:50.815004 [info ] [MainThread]: 
[0m00:04:50.816043 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:04:50.818254 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON'
[0m00:04:50.829939 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON"
[0m00:04:50.830937 [debug] [ThreadPool]: On list_USER_DB_FALCON: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON"} */
show terse schemas in database USER_DB_FALCON
    limit 10000
[0m00:04:50.831619 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:04:51.436505 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.605 seconds
[0m00:04:51.452968 [debug] [ThreadPool]: On list_USER_DB_FALCON: Close
[0m00:04:51.601999 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON, now list_USER_DB_FALCON_RAW_public)
[0m00:04:51.612684 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m00:04:51.613832 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show terse objects in USER_DB_FALCON.RAW_public limit 10000
[0m00:04:51.614771 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:04:51.989756 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.375 seconds
[0m00:04:51.992096 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m00:04:52.114066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7094bede-5d7c-4a9a-aed5-96187ef00a06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe361bc7650>]}
[0m00:04:52.115269 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:04:52.115957 [info ] [MainThread]: 
[0m00:04:52.127241 [debug] [Thread-1 (]: Began running node model.customer_churn.int_customer_enriched
[0m00:04:52.128155 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW_public.int_customer_enriched ................... [RUN]
[0m00:04:52.128966 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON_RAW_public, now model.customer_churn.int_customer_enriched)
[0m00:04:52.129675 [debug] [Thread-1 (]: Began compiling node model.customer_churn.int_customer_enriched
[0m00:04:52.137336 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.int_customer_enriched"
[0m00:04:52.150901 [debug] [Thread-1 (]: Began executing node model.customer_churn.int_customer_enriched
[0m00:04:52.172716 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.int_customer_enriched"
[0m00:04:52.188753 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.int_customer_enriched"
[0m00:04:52.189542 [debug] [Thread-1 (]: On model.customer_churn.int_customer_enriched: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.int_customer_enriched"} */
create or replace   view USER_DB_FALCON.RAW_public.int_customer_enriched
  
   as (
    

with cust as (
    select
        individual_id,
        annual_premium,
        days_tenure,
        cust_orig_date,
        age_in_years,
        date_of_birth,
        address_id
    from USER_DB_FALCON.RAW_public.stg_customer
),

demo as (
    select
        individual_id,
        has_children,
        length_of_residence,
        marital_status,
        home_owner,
        home_market_value,
        college_degree,
        good_credit
    from USER_DB_FALCON.RAW_public.stg_demographic
),

addr as (
    select
        address_id,
        city,
        state,
        county,
        lat,
        lon
    from USER_DB_FALCON.RAW_public.stg_address
)

select
    cust.individual_id,
    cust.annual_premium,
    cust.days_tenure,
    cust.cust_orig_date,
    cust.age_in_years,
    cust.date_of_birth,
    demo.has_children,
    demo.length_of_residence,
    demo.marital_status,
    demo.home_owner,
    demo.home_market_value,
    addr.city,
    addr.state,
    addr.county,
    addr.lat,
    addr.lon
from cust
left join demo using (individual_id)
left join addr using (address_id)
  );
[0m00:04:52.190401 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:04:53.348885 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.158 seconds
[0m00:04:53.375674 [debug] [Thread-1 (]: On model.customer_churn.int_customer_enriched: Close
[0m00:04:53.502186 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7094bede-5d7c-4a9a-aed5-96187ef00a06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe361eaf020>]}
[0m00:04:53.504082 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW_public.int_customer_enriched .............. [[32mSUCCESS 1[0m in 1.37s]
[0m00:04:53.506389 [debug] [Thread-1 (]: Finished running node model.customer_churn.int_customer_enriched
[0m00:04:53.511237 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:04:53.512951 [debug] [MainThread]: Connection 'model.customer_churn.int_customer_enriched' was properly closed.
[0m00:04:53.514479 [info ] [MainThread]: 
[0m00:04:53.516152 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.70 seconds (2.70s).
[0m00:04:53.518601 [debug] [MainThread]: Command end result
[0m00:04:53.602270 [info ] [MainThread]: 
[0m00:04:53.603356 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:04:53.604221 [info ] [MainThread]: 
[0m00:04:53.605109 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:04:53.606320 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.492776, "process_user_time": 3.8613, "process_kernel_time": 2.69025, "process_mem_max_rss": "275348", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m00:04:53.607235 [debug] [MainThread]: Command `dbt run` succeeded at 00:04:53.607130 after 4.49 seconds
[0m00:04:53.607989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3bfadbb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3c08decf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe360d9e540>]}
[0m00:04:53.608606 [debug] [MainThread]: Flushing usage events
[0m00:04:58.068943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cdebbee40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cde3c2330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cde3c23c0>]}


============================== 00:04:58.074206 | a07b691c-87b1-495c-9193-8c5d7a252a40 ==============================
[0m00:04:58.074206 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:04:58.075151 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt --select marts', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:04:58.776791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a07b691c-87b1-495c-9193-8c5d7a252a40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c86cc2d50>]}
[0m00:04:58.817638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a07b691c-87b1-495c-9193-8c5d7a252a40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cde531c70>]}
[0m00:04:58.818722 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m00:04:58.893970 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:04:59.242436 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:04:59.242905 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:04:59.277442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a07b691c-87b1-495c-9193-8c5d7a252a40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c847abcb0>]}
[0m00:04:59.420087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a07b691c-87b1-495c-9193-8c5d7a252a40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c8418e000>]}
[0m00:04:59.421103 [info ] [MainThread]: Found 12 models, 10 data tests, 7 sources, 459 macros
[0m00:04:59.421964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a07b691c-87b1-495c-9193-8c5d7a252a40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cde6954f0>]}
[0m00:04:59.423769 [info ] [MainThread]: 
[0m00:04:59.424778 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:04:59.429391 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON'
[0m00:04:59.440731 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON"
[0m00:04:59.441595 [debug] [ThreadPool]: On list_USER_DB_FALCON: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON"} */
show terse schemas in database USER_DB_FALCON
    limit 10000
[0m00:04:59.442433 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:05:00.379034 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.937 seconds
[0m00:05:00.381448 [debug] [ThreadPool]: On list_USER_DB_FALCON: Close
[0m00:05:00.536190 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON, now list_USER_DB_FALCON_RAW_public)
[0m00:05:00.591914 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m00:05:00.593648 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show terse objects in USER_DB_FALCON.RAW_public limit 10000
[0m00:05:00.594960 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:05:01.795182 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 1.200 seconds
[0m00:05:01.798173 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m00:05:01.933574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a07b691c-87b1-495c-9193-8c5d7a252a40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c843ebbc0>]}
[0m00:05:01.934881 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:05:01.935452 [info ] [MainThread]: 
[0m00:05:01.951092 [debug] [Thread-1 (]: Began running node model.customer_churn.dim_address
[0m00:05:01.951495 [debug] [Thread-2 (]: Began running node model.customer_churn.dim_customer
[0m00:05:01.951868 [debug] [Thread-3 (]: Began running node model.customer_churn.fact_churn
[0m00:05:01.952369 [info ] [Thread-1 (]: 1 of 5 START sql table model RAW_public.dim_address ............................ [RUN]
[0m00:05:01.953257 [info ] [Thread-2 (]: 2 of 5 START sql table model RAW_public.dim_customer ........................... [RUN]
[0m00:05:01.954053 [info ] [Thread-3 (]: 3 of 5 START sql incremental model RAW_public.fact_churn ....................... [RUN]
[0m00:05:01.954923 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON_RAW_public, now model.customer_churn.dim_address)
[0m00:05:01.957969 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.customer_churn.dim_customer'
[0m00:05:01.959387 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.customer_churn.fact_churn'
[0m00:05:01.960769 [debug] [Thread-1 (]: Began compiling node model.customer_churn.dim_address
[0m00:05:01.962058 [debug] [Thread-2 (]: Began compiling node model.customer_churn.dim_customer
[0m00:05:01.963314 [debug] [Thread-3 (]: Began compiling node model.customer_churn.fact_churn
[0m00:05:01.969683 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.dim_address"
[0m00:05:01.971894 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer_churn.dim_customer"
[0m00:05:01.978984 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.fact_churn"
[0m00:05:01.992624 [debug] [Thread-3 (]: Began executing node model.customer_churn.fact_churn
[0m00:05:01.998904 [debug] [Thread-1 (]: Began executing node model.customer_churn.dim_address
[0m00:05:02.006703 [debug] [Thread-2 (]: Began executing node model.customer_churn.dim_customer
[0m00:05:02.080911 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.dim_address"
[0m00:05:02.081412 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer_churn.dim_customer"
[0m00:05:02.082219 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:05:02.083856 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
create or replace  temporary view USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
  
   as (
    -- models/marts/fact_churn.sql


select
  t.individual_id,
  t.churn_date,
  e.city,
  e.state,
  e.county,
  e.age_in_years,
  e.days_tenure,
  e.annual_premium,
  c.churn_flag
from USER_DB_FALCON.RAW_public.stg_termination t
join USER_DB_FALCON.RAW_public.int_customer_enriched e
  using (individual_id)
left join USER_DB_FALCON.RAW_public.stg_autoinsurance_churn c
  using (individual_id)


where t.churn_date > (select max(churn_date) from USER_DB_FALCON.RAW_public.fact_churn)

  );
[0m00:05:02.084555 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:05:02.092189 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.dim_address"
[0m00:05:02.093463 [debug] [Thread-1 (]: On model.customer_churn.dim_address: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.dim_address"} */
create or replace transient table USER_DB_FALCON.RAW_public.dim_address
         as
        (-- models/marts/dim_address.sql


select distinct
  individual_id,
  city,
  state,
  county,
  lat,
  lon
from USER_DB_FALCON.RAW_public.int_customer_enriched
        );
[0m00:05:02.094155 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:05:02.095469 [debug] [Thread-2 (]: Using snowflake connection "model.customer_churn.dim_customer"
[0m00:05:02.096353 [debug] [Thread-2 (]: On model.customer_churn.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.dim_customer"} */
create or replace transient table USER_DB_FALCON.RAW_public.dim_customer
         as
        (-- models/marts/dim_customer.sql


select distinct
  individual_id,
  age_in_years as age,
  marital_status,
  has_children,
  length_of_residence
from USER_DB_FALCON.RAW_public.int_customer_enriched
        );
[0m00:05:02.096947 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:05:03.211894 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.127 seconds
[0m00:05:03.219247 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:05:03.220245 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
[0m00:05:03.319673 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 0.098 seconds
[0m00:05:03.325051 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:05:03.325876 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table USER_DB_FALCON.RAW_public.fact_churn
[0m00:05:03.421279 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 0.092 seconds
[0m00:05:03.443331 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:05:03.445267 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table "USER_DB_FALCON"."RAW_PUBLIC"."FACT_CHURN"
[0m00:05:03.565707 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 0.102 seconds
[0m00:05:03.606504 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.fact_churn"
[0m00:05:03.619741 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:05:03.620648 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
-- back compat for old kwarg name
  
  begin;
[0m00:05:03.749189 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.128 seconds
[0m00:05:03.750124 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:05:03.750753 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
merge into USER_DB_FALCON.RAW_public.fact_churn as DBT_INTERNAL_DEST
        using USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.individual_id = DBT_INTERNAL_DEST.individual_id
                ) and (
                    DBT_INTERNAL_SOURCE.churn_date = DBT_INTERNAL_DEST.churn_date
                )

    
    when matched then update set
        "INDIVIDUAL_ID" = DBT_INTERNAL_SOURCE."INDIVIDUAL_ID","CHURN_DATE" = DBT_INTERNAL_SOURCE."CHURN_DATE","CITY" = DBT_INTERNAL_SOURCE."CITY","STATE" = DBT_INTERNAL_SOURCE."STATE","COUNTY" = DBT_INTERNAL_SOURCE."COUNTY","AGE_IN_YEARS" = DBT_INTERNAL_SOURCE."AGE_IN_YEARS","DAYS_TENURE" = DBT_INTERNAL_SOURCE."DAYS_TENURE","ANNUAL_PREMIUM" = DBT_INTERNAL_SOURCE."ANNUAL_PREMIUM","CHURN_FLAG" = DBT_INTERNAL_SOURCE."CHURN_FLAG"
    

    when not matched then insert
        ("INDIVIDUAL_ID", "CHURN_DATE", "CITY", "STATE", "COUNTY", "AGE_IN_YEARS", "DAYS_TENURE", "ANNUAL_PREMIUM", "CHURN_FLAG")
    values
        ("INDIVIDUAL_ID", "CHURN_DATE", "CITY", "STATE", "COUNTY", "AGE_IN_YEARS", "DAYS_TENURE", "ANNUAL_PREMIUM", "CHURN_FLAG")

;
[0m00:05:04.456921 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 0.705 seconds
[0m00:05:04.458006 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:05:04.458814 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
COMMIT
[0m00:05:04.653571 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.194 seconds
[0m00:05:04.667217 [debug] [Thread-3 (]: Applying DROP to: USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
[0m00:05:04.673387 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:05:04.674436 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
drop view if exists USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp cascade
[0m00:05:04.796151 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.120 seconds
[0m00:05:04.831498 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: Close
[0m00:05:04.957551 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a07b691c-87b1-495c-9193-8c5d7a252a40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c84716a50>]}
[0m00:05:04.958564 [info ] [Thread-3 (]: 3 of 5 OK created sql incremental model RAW_public.fact_churn .................. [[32mSUCCESS 0[0m in 3.00s]
[0m00:05:04.959469 [debug] [Thread-3 (]: Finished running node model.customer_churn.fact_churn
[0m00:05:04.960524 [debug] [Thread-4 (]: Began running node model.customer_churn.churn_metrics
[0m00:05:04.961310 [info ] [Thread-4 (]: 4 of 5 START sql table model RAW_public.churn_metrics .......................... [RUN]
[0m00:05:04.962176 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.customer_churn.churn_metrics'
[0m00:05:04.962839 [debug] [Thread-4 (]: Began compiling node model.customer_churn.churn_metrics
[0m00:05:04.967587 [debug] [Thread-4 (]: Writing injected SQL for node "model.customer_churn.churn_metrics"
[0m00:05:04.985838 [debug] [Thread-4 (]: Began executing node model.customer_churn.churn_metrics
[0m00:05:04.990511 [debug] [Thread-4 (]: Writing runtime sql for node "model.customer_churn.churn_metrics"
[0m00:05:05.008907 [debug] [Thread-4 (]: Using snowflake connection "model.customer_churn.churn_metrics"
[0m00:05:05.009608 [debug] [Thread-4 (]: On model.customer_churn.churn_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.churn_metrics"} */
create or replace transient table USER_DB_FALCON.RAW_public.churn_metrics
         as
        (WITH 
  monthly AS (
    SELECT
      DATE_TRUNC('month', churn_date) AS period,
      COUNT(*) AS churn_count
    FROM USER_DB_FALCON.RAW_public.fact_churn
    GROUP BY 1
  ),
  
  by_state AS (
    SELECT
      state AS period,
      COUNT(*) AS churn_count
    FROM USER_DB_FALCON.RAW_public.fact_churn
    GROUP BY 1
  ),
  
  by_age AS (
    SELECT
      CASE
        WHEN age_in_years < 25 THEN 'Under 25'
        WHEN age_in_years < 35 THEN '25-34'
        WHEN age_in_years < 45 THEN '35-44'
        WHEN age_in_years < 55 THEN '45-54'
        WHEN age_in_years < 65 THEN '55-64'
        ELSE '65+'
      END AS period,
      COUNT(*) AS churn_count
    FROM USER_DB_FALCON.RAW_public.fact_churn
    GROUP BY 1
  ),
  
  by_tenure AS (
    SELECT
      CASE
        WHEN days_tenure <= 90 THEN '0-3 months'
        WHEN days_tenure <= 180 THEN '4-6 months'
        WHEN days_tenure <= 365 THEN '7-12 months'
        WHEN days_tenure <= 730 THEN '13-24 months'
        ELSE '25+ months'
      END AS period,
      COUNT(*) AS churn_count
    FROM USER_DB_FALCON.RAW_public.fact_churn
    GROUP BY 1
  ),
  
  by_premium AS (
    SELECT
      CASE
        WHEN annual_premium < 1000 THEN 'Under $1,000'
        WHEN annual_premium < 2000 THEN '$1,000-$1,999'
        WHEN annual_premium < 3000 THEN '$2,000-$2,999'
        ELSE '$3,000+'
      END AS period,
      COUNT(*) AS churn_count
    FROM USER_DB_FALCON.RAW_public.fact_churn
    GROUP BY 1
  )

SELECT
  CAST(period AS VARCHAR) AS period,
  churn_count,
  'monthly'              AS category
FROM monthly

UNION ALL

SELECT
  CAST(period AS VARCHAR) AS period,
  churn_count,
  'by_state'             AS category
FROM by_state

UNION ALL

SELECT
  CAST(period AS VARCHAR) AS period,
  churn_count,
  'by_age'               AS category
FROM by_age

UNION ALL

SELECT
  CAST(period AS VARCHAR) AS period,
  churn_count,
  'by_tenure'            AS category
FROM by_tenure

UNION ALL

SELECT
  CAST(period AS VARCHAR) AS period,
  churn_count,
  'by_premium'           AS category
FROM by_premium
        );
[0m00:05:05.010302 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:05:05.877710 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.781 seconds
[0m00:05:05.884855 [debug] [Thread-2 (]: On model.customer_churn.dim_customer: Close
[0m00:05:06.015393 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a07b691c-87b1-495c-9193-8c5d7a252a40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c7c608890>]}
[0m00:05:06.017666 [info ] [Thread-2 (]: 2 of 5 OK created sql table model RAW_public.dim_customer ...................... [[32mSUCCESS 1[0m in 4.06s]
[0m00:05:06.022462 [debug] [Thread-2 (]: Finished running node model.customer_churn.dim_customer
[0m00:05:06.291321 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.197 seconds
[0m00:05:06.293831 [debug] [Thread-1 (]: On model.customer_churn.dim_address: Close
[0m00:05:06.417041 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a07b691c-87b1-495c-9193-8c5d7a252a40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c7c60e9f0>]}
[0m00:05:06.418587 [info ] [Thread-1 (]: 1 of 5 OK created sql table model RAW_public.dim_address ....................... [[32mSUCCESS 1[0m in 4.46s]
[0m00:05:06.419852 [debug] [Thread-1 (]: Finished running node model.customer_churn.dim_address
[0m00:05:06.421198 [debug] [Thread-3 (]: Began running node model.customer_churn.churn_map
[0m00:05:06.422547 [info ] [Thread-3 (]: 5 of 5 START sql table model RAW_public.churn_map .............................. [RUN]
[0m00:05:06.424056 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer_churn.fact_churn, now model.customer_churn.churn_map)
[0m00:05:06.425274 [debug] [Thread-3 (]: Began compiling node model.customer_churn.churn_map
[0m00:05:06.432191 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.churn_map"
[0m00:05:06.448636 [debug] [Thread-3 (]: Began executing node model.customer_churn.churn_map
[0m00:05:06.452696 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.churn_map"
[0m00:05:06.465102 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.churn_map"
[0m00:05:06.465969 [debug] [Thread-3 (]: On model.customer_churn.churn_map: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.churn_map"} */
create or replace transient table USER_DB_FALCON.RAW_public.churn_map
         as
        (-- models/marts/churn_map.sql


select
  f.individual_id,
  f.churn_date,
  f.churn_flag,
  a.lon,
  a.lat
from USER_DB_FALCON.RAW_public.fact_churn      as f
join USER_DB_FALCON.RAW_public.dim_address    as a
  using (individual_id)
        );
[0m00:05:06.466712 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:05:07.250797 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.240 seconds
[0m00:05:07.258200 [debug] [Thread-4 (]: On model.customer_churn.churn_metrics: Close
[0m00:05:07.948445 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.481 seconds
[0m00:05:07.953541 [debug] [Thread-3 (]: On model.customer_churn.churn_map: Close
[0m00:05:08.197250 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a07b691c-87b1-495c-9193-8c5d7a252a40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c7f7985c0>]}
[0m00:05:08.212493 [info ] [Thread-3 (]: 5 of 5 OK created sql table model RAW_public.churn_map ......................... [[32mSUCCESS 1[0m in 1.77s]
[0m00:05:08.218040 [debug] [Thread-3 (]: Finished running node model.customer_churn.churn_map
[0m00:05:08.223211 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a07b691c-87b1-495c-9193-8c5d7a252a40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c7c6082c0>]}
[0m00:05:08.224952 [info ] [Thread-4 (]: 4 of 5 OK created sql table model RAW_public.churn_metrics ..................... [[32mSUCCESS 1[0m in 3.26s]
[0m00:05:08.226642 [debug] [Thread-4 (]: Finished running node model.customer_churn.churn_metrics
[0m00:05:08.231120 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:05:08.232268 [debug] [MainThread]: Connection 'model.customer_churn.dim_address' was properly closed.
[0m00:05:08.233479 [debug] [MainThread]: Connection 'model.customer_churn.dim_customer' was properly closed.
[0m00:05:08.234685 [debug] [MainThread]: Connection 'model.customer_churn.churn_map' was properly closed.
[0m00:05:08.235911 [debug] [MainThread]: Connection 'model.customer_churn.churn_metrics' was properly closed.
[0m00:05:08.237424 [info ] [MainThread]: 
[0m00:05:08.238787 [info ] [MainThread]: Finished running 1 incremental model, 4 table models in 0 hours 0 minutes and 8.81 seconds (8.81s).
[0m00:05:08.241708 [debug] [MainThread]: Command end result
[0m00:05:08.350856 [info ] [MainThread]: 
[0m00:05:08.352879 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:05:08.358707 [info ] [MainThread]: 
[0m00:05:08.361555 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m00:05:08.364066 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.365226, "process_user_time": 4.019609, "process_kernel_time": 2.696294, "process_mem_max_rss": "240132", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m00:05:08.365929 [debug] [MainThread]: Command `dbt run` succeeded at 00:05:08.365860 after 10.37 seconds
[0m00:05:08.369085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cde7daf00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cde406a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c840724b0>]}
[0m00:05:08.369780 [debug] [MainThread]: Flushing usage events
[0m00:05:12.140420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc49fe850d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4a01efc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc49fe84800>]}


============================== 00:05:12.145896 | cdd5ba8f-fc8d-4dbc-be52-1785db62f004 ==============================
[0m00:05:12.145896 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:05:12.147049 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:05:12.791604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cdd5ba8f-fc8d-4dbc-be52-1785db62f004', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4424a2780>]}
[0m00:05:12.826764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cdd5ba8f-fc8d-4dbc-be52-1785db62f004', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc442aebad0>]}
[0m00:05:12.828203 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m00:05:12.899412 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:05:13.564380 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:05:13.565712 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:05:13.600666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cdd5ba8f-fc8d-4dbc-be52-1785db62f004', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc443b5e690>]}
[0m00:05:13.771321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cdd5ba8f-fc8d-4dbc-be52-1785db62f004', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc44e694230>]}
[0m00:05:13.772122 [info ] [MainThread]: Found 12 models, 10 data tests, 7 sources, 459 macros
[0m00:05:13.772781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cdd5ba8f-fc8d-4dbc-be52-1785db62f004', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4420c56a0>]}
[0m00:05:13.775086 [info ] [MainThread]: 
[0m00:05:13.775977 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:05:13.780376 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON_RAW_public'
[0m00:05:13.793362 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m00:05:13.794154 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show terse objects in USER_DB_FALCON.RAW_public limit 10000
[0m00:05:13.794799 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:05:14.267456 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.473 seconds
[0m00:05:14.269626 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m00:05:14.419795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cdd5ba8f-fc8d-4dbc-be52-1785db62f004', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc441f7ff80>]}
[0m00:05:14.420821 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:05:14.421512 [info ] [MainThread]: 
[0m00:05:14.430726 [debug] [Thread-1 (]: Began running node test.customer_churn.not_null_dim_address_individual_id.efa1478d3c
[0m00:05:14.431117 [debug] [Thread-2 (]: Began running node test.customer_churn.not_null_dim_customer_individual_id.80bf9c0ee7
[0m00:05:14.431517 [debug] [Thread-3 (]: Began running node test.customer_churn.not_null_fact_churn_churn_date.c88bd69eeb
[0m00:05:14.431783 [debug] [Thread-4 (]: Began running node test.customer_churn.not_null_fact_churn_individual_id.96f069e355
[0m00:05:14.432075 [info ] [Thread-1 (]: 1 of 10 START test not_null_dim_address_individual_id .......................... [RUN]
[0m00:05:14.432942 [info ] [Thread-2 (]: 2 of 10 START test not_null_dim_customer_individual_id ......................... [RUN]
[0m00:05:14.433770 [info ] [Thread-3 (]: 3 of 10 START test not_null_fact_churn_churn_date .............................. [RUN]
[0m00:05:14.434519 [info ] [Thread-4 (]: 4 of 10 START test not_null_fact_churn_individual_id ........................... [RUN]
[0m00:05:14.435386 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON_RAW_public, now test.customer_churn.not_null_dim_address_individual_id.efa1478d3c)
[0m00:05:14.436323 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.customer_churn.not_null_dim_customer_individual_id.80bf9c0ee7'
[0m00:05:14.437232 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.customer_churn.not_null_fact_churn_churn_date.c88bd69eeb'
[0m00:05:14.437776 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.customer_churn.not_null_fact_churn_individual_id.96f069e355'
[0m00:05:14.438454 [debug] [Thread-1 (]: Began compiling node test.customer_churn.not_null_dim_address_individual_id.efa1478d3c
[0m00:05:14.439121 [debug] [Thread-2 (]: Began compiling node test.customer_churn.not_null_dim_customer_individual_id.80bf9c0ee7
[0m00:05:14.439951 [debug] [Thread-3 (]: Began compiling node test.customer_churn.not_null_fact_churn_churn_date.c88bd69eeb
[0m00:05:14.440605 [debug] [Thread-4 (]: Began compiling node test.customer_churn.not_null_fact_churn_individual_id.96f069e355
[0m00:05:14.455808 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer_churn.not_null_dim_customer_individual_id.80bf9c0ee7"
[0m00:05:14.456938 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer_churn.not_null_dim_address_individual_id.efa1478d3c"
[0m00:05:14.461232 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer_churn.not_null_fact_churn_churn_date.c88bd69eeb"
[0m00:05:14.464311 [debug] [Thread-4 (]: Writing injected SQL for node "test.customer_churn.not_null_fact_churn_individual_id.96f069e355"
[0m00:05:14.471204 [debug] [Thread-2 (]: Began executing node test.customer_churn.not_null_dim_customer_individual_id.80bf9c0ee7
[0m00:05:14.471564 [debug] [Thread-4 (]: Began executing node test.customer_churn.not_null_fact_churn_individual_id.96f069e355
[0m00:05:14.485176 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer_churn.not_null_dim_customer_individual_id.80bf9c0ee7"
[0m00:05:14.485527 [debug] [Thread-3 (]: Began executing node test.customer_churn.not_null_fact_churn_churn_date.c88bd69eeb
[0m00:05:14.487273 [debug] [Thread-4 (]: Writing runtime sql for node "test.customer_churn.not_null_fact_churn_individual_id.96f069e355"
[0m00:05:14.490043 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer_churn.not_null_fact_churn_churn_date.c88bd69eeb"
[0m00:05:14.490462 [debug] [Thread-1 (]: Began executing node test.customer_churn.not_null_dim_address_individual_id.efa1478d3c
[0m00:05:14.493047 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer_churn.not_null_dim_address_individual_id.efa1478d3c"
[0m00:05:14.496894 [debug] [Thread-4 (]: Using snowflake connection "test.customer_churn.not_null_fact_churn_individual_id.96f069e355"
[0m00:05:14.498252 [debug] [Thread-4 (]: On test.customer_churn.not_null_fact_churn_individual_id.96f069e355: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "test.customer_churn.not_null_fact_churn_individual_id.96f069e355"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select individual_id
from USER_DB_FALCON.RAW_public.fact_churn
where individual_id is null



      
    ) dbt_internal_test
[0m00:05:14.499081 [debug] [Thread-2 (]: Using snowflake connection "test.customer_churn.not_null_dim_customer_individual_id.80bf9c0ee7"
[0m00:05:14.499522 [debug] [Thread-3 (]: Using snowflake connection "test.customer_churn.not_null_fact_churn_churn_date.c88bd69eeb"
[0m00:05:14.499900 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:05:14.500429 [debug] [Thread-2 (]: On test.customer_churn.not_null_dim_customer_individual_id.80bf9c0ee7: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "test.customer_churn.not_null_dim_customer_individual_id.80bf9c0ee7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select individual_id
from USER_DB_FALCON.RAW_public.dim_customer
where individual_id is null



      
    ) dbt_internal_test
[0m00:05:14.501014 [debug] [Thread-3 (]: On test.customer_churn.not_null_fact_churn_churn_date.c88bd69eeb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "test.customer_churn.not_null_fact_churn_churn_date.c88bd69eeb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select churn_date
from USER_DB_FALCON.RAW_public.fact_churn
where churn_date is null



      
    ) dbt_internal_test
[0m00:05:14.502870 [debug] [Thread-1 (]: Using snowflake connection "test.customer_churn.not_null_dim_address_individual_id.efa1478d3c"
[0m00:05:14.503131 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:05:14.503830 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:05:14.504521 [debug] [Thread-1 (]: On test.customer_churn.not_null_dim_address_individual_id.efa1478d3c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "test.customer_churn.not_null_dim_address_individual_id.efa1478d3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select individual_id
from USER_DB_FALCON.RAW_public.dim_address
where individual_id is null



      
    ) dbt_internal_test
[0m00:05:14.507963 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:05:14.929096 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.429 seconds
[0m00:05:14.940820 [debug] [Thread-4 (]: On test.customer_churn.not_null_fact_churn_individual_id.96f069e355: Close
[0m00:05:14.941811 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.438 seconds
[0m00:05:14.944533 [debug] [Thread-3 (]: On test.customer_churn.not_null_fact_churn_churn_date.c88bd69eeb: Close
[0m00:05:15.077674 [info ] [Thread-4 (]: 4 of 10 PASS not_null_fact_churn_individual_id ................................. [[32mPASS[0m in 0.64s]
[0m00:05:15.080116 [debug] [Thread-4 (]: Finished running node test.customer_churn.not_null_fact_churn_individual_id.96f069e355
[0m00:05:15.081840 [debug] [Thread-4 (]: Began running node test.customer_churn.not_null_int_customer_enriched_individual_id.4f23212833
[0m00:05:15.083401 [info ] [Thread-4 (]: 5 of 10 START test not_null_int_customer_enriched_individual_id ................ [RUN]
[0m00:05:15.085195 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.customer_churn.not_null_fact_churn_individual_id.96f069e355, now test.customer_churn.not_null_int_customer_enriched_individual_id.4f23212833)
[0m00:05:15.086542 [debug] [Thread-4 (]: Began compiling node test.customer_churn.not_null_int_customer_enriched_individual_id.4f23212833
[0m00:05:15.097034 [debug] [Thread-4 (]: Writing injected SQL for node "test.customer_churn.not_null_int_customer_enriched_individual_id.4f23212833"
[0m00:05:15.129795 [debug] [Thread-4 (]: Began executing node test.customer_churn.not_null_int_customer_enriched_individual_id.4f23212833
[0m00:05:15.138213 [debug] [Thread-4 (]: Writing runtime sql for node "test.customer_churn.not_null_int_customer_enriched_individual_id.4f23212833"
[0m00:05:15.226090 [debug] [Thread-4 (]: Using snowflake connection "test.customer_churn.not_null_int_customer_enriched_individual_id.4f23212833"
[0m00:05:15.228593 [debug] [Thread-4 (]: On test.customer_churn.not_null_int_customer_enriched_individual_id.4f23212833: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "test.customer_churn.not_null_int_customer_enriched_individual_id.4f23212833"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select individual_id
from USER_DB_FALCON.RAW_public.int_customer_enriched
where individual_id is null



      
    ) dbt_internal_test
[0m00:05:15.230790 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.727 seconds
[0m00:05:15.232264 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:05:15.237833 [debug] [Thread-2 (]: On test.customer_churn.not_null_dim_customer_individual_id.80bf9c0ee7: Close
[0m00:05:15.246925 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.739 seconds
[0m00:05:15.250159 [debug] [Thread-1 (]: On test.customer_churn.not_null_dim_address_individual_id.efa1478d3c: Close
[0m00:05:15.423794 [info ] [Thread-1 (]: 1 of 10 PASS not_null_dim_address_individual_id ................................ [[32mPASS[0m in 0.99s]
[0m00:05:15.424456 [info ] [Thread-2 (]: 2 of 10 PASS not_null_dim_customer_individual_id ............................... [[32mPASS[0m in 0.99s]
[0m00:05:15.425307 [debug] [Thread-1 (]: Finished running node test.customer_churn.not_null_dim_address_individual_id.efa1478d3c
[0m00:05:15.425897 [debug] [Thread-2 (]: Finished running node test.customer_churn.not_null_dim_customer_individual_id.80bf9c0ee7
[0m00:05:15.426521 [debug] [Thread-1 (]: Began running node test.customer_churn.not_null_stg_address_address_id.a26685b6d5
[0m00:05:15.427084 [debug] [Thread-2 (]: Began running node test.customer_churn.not_null_stg_autoinsurance_churn_individual_id.c3c7b154c3
[0m00:05:15.427734 [info ] [Thread-1 (]: 6 of 10 START test not_null_stg_address_address_id ............................. [RUN]
[0m00:05:15.429772 [info ] [Thread-2 (]: 7 of 10 START test not_null_stg_autoinsurance_churn_individual_id .............. [RUN]
[0m00:05:15.430391 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer_churn.not_null_dim_address_individual_id.efa1478d3c, now test.customer_churn.not_null_stg_address_address_id.a26685b6d5)
[0m00:05:15.431059 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer_churn.not_null_dim_customer_individual_id.80bf9c0ee7, now test.customer_churn.not_null_stg_autoinsurance_churn_individual_id.c3c7b154c3)
[0m00:05:15.431599 [debug] [Thread-1 (]: Began compiling node test.customer_churn.not_null_stg_address_address_id.a26685b6d5
[0m00:05:15.432274 [debug] [Thread-2 (]: Began compiling node test.customer_churn.not_null_stg_autoinsurance_churn_individual_id.c3c7b154c3
[0m00:05:15.436976 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer_churn.not_null_stg_address_address_id.a26685b6d5"
[0m00:05:15.440260 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer_churn.not_null_stg_autoinsurance_churn_individual_id.c3c7b154c3"
[0m00:05:15.447897 [debug] [Thread-2 (]: Began executing node test.customer_churn.not_null_stg_autoinsurance_churn_individual_id.c3c7b154c3
[0m00:05:15.450888 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer_churn.not_null_stg_autoinsurance_churn_individual_id.c3c7b154c3"
[0m00:05:15.451237 [debug] [Thread-1 (]: Began executing node test.customer_churn.not_null_stg_address_address_id.a26685b6d5
[0m00:05:15.453354 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer_churn.not_null_stg_address_address_id.a26685b6d5"
[0m00:05:15.458071 [debug] [Thread-2 (]: Using snowflake connection "test.customer_churn.not_null_stg_autoinsurance_churn_individual_id.c3c7b154c3"
[0m00:05:15.458863 [debug] [Thread-2 (]: On test.customer_churn.not_null_stg_autoinsurance_churn_individual_id.c3c7b154c3: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "test.customer_churn.not_null_stg_autoinsurance_churn_individual_id.c3c7b154c3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select individual_id
from USER_DB_FALCON.RAW_public.stg_autoinsurance_churn
where individual_id is null



      
    ) dbt_internal_test
[0m00:05:15.459704 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:05:15.460315 [debug] [Thread-1 (]: Using snowflake connection "test.customer_churn.not_null_stg_address_address_id.a26685b6d5"
[0m00:05:15.461342 [debug] [Thread-1 (]: On test.customer_churn.not_null_stg_address_address_id.a26685b6d5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "test.customer_churn.not_null_stg_address_address_id.a26685b6d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select address_id
from USER_DB_FALCON.RAW_public.stg_address
where address_id is null



      
    ) dbt_internal_test
[0m00:05:15.462060 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:05:15.484973 [info ] [Thread-3 (]: 3 of 10 PASS not_null_fact_churn_churn_date .................................... [[32mPASS[0m in 1.05s]
[0m00:05:15.486620 [debug] [Thread-3 (]: Finished running node test.customer_churn.not_null_fact_churn_churn_date.c88bd69eeb
[0m00:05:15.487772 [debug] [Thread-3 (]: Began running node test.customer_churn.not_null_stg_customer_individual_id.af262c3e65
[0m00:05:15.488283 [info ] [Thread-3 (]: 8 of 10 START test not_null_stg_customer_individual_id ......................... [RUN]
[0m00:05:15.488957 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer_churn.not_null_fact_churn_churn_date.c88bd69eeb, now test.customer_churn.not_null_stg_customer_individual_id.af262c3e65)
[0m00:05:15.489563 [debug] [Thread-3 (]: Began compiling node test.customer_churn.not_null_stg_customer_individual_id.af262c3e65
[0m00:05:15.493655 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer_churn.not_null_stg_customer_individual_id.af262c3e65"
[0m00:05:15.507883 [debug] [Thread-3 (]: Began executing node test.customer_churn.not_null_stg_customer_individual_id.af262c3e65
[0m00:05:15.510282 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer_churn.not_null_stg_customer_individual_id.af262c3e65"
[0m00:05:15.603876 [debug] [Thread-3 (]: Using snowflake connection "test.customer_churn.not_null_stg_customer_individual_id.af262c3e65"
[0m00:05:15.620211 [debug] [Thread-3 (]: On test.customer_churn.not_null_stg_customer_individual_id.af262c3e65: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "test.customer_churn.not_null_stg_customer_individual_id.af262c3e65"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select individual_id
from USER_DB_FALCON.RAW_public.stg_customer
where individual_id is null



      
    ) dbt_internal_test
[0m00:05:15.621516 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:05:15.872717 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.413 seconds
[0m00:05:15.878740 [debug] [Thread-2 (]: On test.customer_churn.not_null_stg_autoinsurance_churn_individual_id.c3c7b154c3: Close
[0m00:05:15.965625 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.733 seconds
[0m00:05:15.970115 [debug] [Thread-4 (]: On test.customer_churn.not_null_int_customer_enriched_individual_id.4f23212833: Close
[0m00:05:16.019754 [info ] [Thread-2 (]: 7 of 10 PASS not_null_stg_autoinsurance_churn_individual_id .................... [[32mPASS[0m in 0.59s]
[0m00:05:16.022458 [debug] [Thread-2 (]: Finished running node test.customer_churn.not_null_stg_autoinsurance_churn_individual_id.c3c7b154c3
[0m00:05:16.024398 [debug] [Thread-2 (]: Began running node test.customer_churn.not_null_stg_demographic_individual_id.68140728ca
[0m00:05:16.026310 [info ] [Thread-2 (]: 9 of 10 START test not_null_stg_demographic_individual_id ...................... [RUN]
[0m00:05:16.027922 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer_churn.not_null_stg_autoinsurance_churn_individual_id.c3c7b154c3, now test.customer_churn.not_null_stg_demographic_individual_id.68140728ca)
[0m00:05:16.028872 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.408 seconds
[0m00:05:16.029175 [debug] [Thread-2 (]: Began compiling node test.customer_churn.not_null_stg_demographic_individual_id.68140728ca
[0m00:05:16.031785 [debug] [Thread-3 (]: On test.customer_churn.not_null_stg_customer_individual_id.af262c3e65: Close
[0m00:05:16.042859 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer_churn.not_null_stg_demographic_individual_id.68140728ca"
[0m00:05:16.083108 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.621 seconds
[0m00:05:16.083955 [debug] [Thread-2 (]: Began executing node test.customer_churn.not_null_stg_demographic_individual_id.68140728ca
[0m00:05:16.085965 [debug] [Thread-1 (]: On test.customer_churn.not_null_stg_address_address_id.a26685b6d5: Close
[0m00:05:16.095750 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer_churn.not_null_stg_demographic_individual_id.68140728ca"
[0m00:05:16.103727 [info ] [Thread-4 (]: 5 of 10 PASS not_null_int_customer_enriched_individual_id ...................... [[32mPASS[0m in 1.02s]
[0m00:05:16.105601 [debug] [Thread-4 (]: Finished running node test.customer_churn.not_null_int_customer_enriched_individual_id.4f23212833
[0m00:05:16.106562 [debug] [Thread-4 (]: Began running node test.customer_churn.not_null_stg_termination_individual_id.b6d8d40bdf
[0m00:05:16.107129 [info ] [Thread-4 (]: 10 of 10 START test not_null_stg_termination_individual_id ..................... [RUN]
[0m00:05:16.108068 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.customer_churn.not_null_int_customer_enriched_individual_id.4f23212833, now test.customer_churn.not_null_stg_termination_individual_id.b6d8d40bdf)
[0m00:05:16.108916 [debug] [Thread-4 (]: Began compiling node test.customer_churn.not_null_stg_termination_individual_id.b6d8d40bdf
[0m00:05:16.113608 [debug] [Thread-4 (]: Writing injected SQL for node "test.customer_churn.not_null_stg_termination_individual_id.b6d8d40bdf"
[0m00:05:16.134890 [debug] [Thread-2 (]: Using snowflake connection "test.customer_churn.not_null_stg_demographic_individual_id.68140728ca"
[0m00:05:16.135812 [debug] [Thread-2 (]: On test.customer_churn.not_null_stg_demographic_individual_id.68140728ca: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "test.customer_churn.not_null_stg_demographic_individual_id.68140728ca"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select individual_id
from USER_DB_FALCON.RAW_public.stg_demographic
where individual_id is null



      
    ) dbt_internal_test
[0m00:05:16.136593 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:05:16.148999 [debug] [Thread-4 (]: Began executing node test.customer_churn.not_null_stg_termination_individual_id.b6d8d40bdf
[0m00:05:16.157446 [debug] [Thread-4 (]: Writing runtime sql for node "test.customer_churn.not_null_stg_termination_individual_id.b6d8d40bdf"
[0m00:05:16.186779 [info ] [Thread-3 (]: 8 of 10 PASS not_null_stg_customer_individual_id ............................... [[32mPASS[0m in 0.70s]
[0m00:05:16.187815 [debug] [Thread-3 (]: Finished running node test.customer_churn.not_null_stg_customer_individual_id.af262c3e65
[0m00:05:16.200138 [debug] [Thread-4 (]: Using snowflake connection "test.customer_churn.not_null_stg_termination_individual_id.b6d8d40bdf"
[0m00:05:16.201170 [debug] [Thread-4 (]: On test.customer_churn.not_null_stg_termination_individual_id.b6d8d40bdf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "test.customer_churn.not_null_stg_termination_individual_id.b6d8d40bdf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select individual_id
from USER_DB_FALCON.RAW_public.stg_termination
where individual_id is null



      
    ) dbt_internal_test
[0m00:05:16.202155 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:05:16.247667 [info ] [Thread-1 (]: 6 of 10 PASS not_null_stg_address_address_id ................................... [[32mPASS[0m in 0.82s]
[0m00:05:16.248750 [debug] [Thread-1 (]: Finished running node test.customer_churn.not_null_stg_address_address_id.a26685b6d5
[0m00:05:16.490559 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.354 seconds
[0m00:05:16.493533 [debug] [Thread-2 (]: On test.customer_churn.not_null_stg_demographic_individual_id.68140728ca: Close
[0m00:05:16.599822 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.397 seconds
[0m00:05:16.605060 [debug] [Thread-4 (]: On test.customer_churn.not_null_stg_termination_individual_id.b6d8d40bdf: Close
[0m00:05:16.612753 [info ] [Thread-2 (]: 9 of 10 PASS not_null_stg_demographic_individual_id ............................ [[32mPASS[0m in 0.58s]
[0m00:05:16.616036 [debug] [Thread-2 (]: Finished running node test.customer_churn.not_null_stg_demographic_individual_id.68140728ca
[0m00:05:16.750257 [info ] [Thread-4 (]: 10 of 10 PASS not_null_stg_termination_individual_id ........................... [[32mPASS[0m in 0.64s]
[0m00:05:16.752691 [debug] [Thread-4 (]: Finished running node test.customer_churn.not_null_stg_termination_individual_id.b6d8d40bdf
[0m00:05:16.758806 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:05:16.760033 [debug] [MainThread]: Connection 'test.customer_churn.not_null_stg_address_address_id.a26685b6d5' was properly closed.
[0m00:05:16.760772 [debug] [MainThread]: Connection 'test.customer_churn.not_null_stg_demographic_individual_id.68140728ca' was properly closed.
[0m00:05:16.761538 [debug] [MainThread]: Connection 'test.customer_churn.not_null_stg_customer_individual_id.af262c3e65' was properly closed.
[0m00:05:16.762503 [debug] [MainThread]: Connection 'test.customer_churn.not_null_stg_termination_individual_id.b6d8d40bdf' was properly closed.
[0m00:05:16.764268 [info ] [MainThread]: 
[0m00:05:16.766035 [info ] [MainThread]: Finished running 10 data tests in 0 hours 0 minutes and 2.99 seconds (2.99s).
[0m00:05:16.768487 [debug] [MainThread]: Command end result
[0m00:05:16.884150 [info ] [MainThread]: 
[0m00:05:16.885348 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:05:16.886322 [info ] [MainThread]: 
[0m00:05:16.887217 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m00:05:16.888741 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.848918, "process_user_time": 4.025212, "process_kernel_time": 2.515757, "process_mem_max_rss": "244724", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m00:05:16.889605 [debug] [MainThread]: Command `dbt test` succeeded at 00:05:16.889522 after 4.85 seconds
[0m00:05:16.890764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4a057eae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4a3f8f980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4a1fc0620>]}
[0m00:05:16.891840 [debug] [MainThread]: Flushing usage events
[0m00:05:20.527912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f677bda23f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f677f204380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f677be7daf0>]}


============================== 00:05:20.535987 | c69e2fd7-1299-48f3-8682-62fd8a55de98 ==============================
[0m00:05:20.535987 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:05:20.537668 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:05:21.278469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c69e2fd7-1299-48f3-8682-62fd8a55de98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f677b6c7f20>]}
[0m00:05:21.317577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c69e2fd7-1299-48f3-8682-62fd8a55de98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f671e024470>]}
[0m00:05:21.319011 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m00:05:21.386462 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:05:21.663944 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:05:21.664835 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:05:21.693823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c69e2fd7-1299-48f3-8682-62fd8a55de98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f677bdba7e0>]}
[0m00:05:21.773384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c69e2fd7-1299-48f3-8682-62fd8a55de98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f671d890d10>]}
[0m00:05:21.773951 [info ] [MainThread]: Found 12 models, 10 data tests, 7 sources, 459 macros
[0m00:05:21.774352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c69e2fd7-1299-48f3-8682-62fd8a55de98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f671d8a6cc0>]}
[0m00:05:21.775704 [info ] [MainThread]: 
[0m00:05:21.776168 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m00:05:21.777387 [debug] [MainThread]: Command end result
[0m00:05:21.807040 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 1.3474702, "process_user_time": 3.072327, "process_kernel_time": 2.802196, "process_mem_max_rss": "232232", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:05:21.807559 [debug] [MainThread]: Command `dbt snapshot` succeeded at 00:05:21.807469 after 1.35 seconds
[0m00:05:21.807907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f677baba450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f671d8b3c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f677bee17c0>]}
[0m00:05:21.808256 [debug] [MainThread]: Flushing usage events
[0m00:28:33.025699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c5c7658e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c5b2ada00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c5ab2b230>]}


============================== 00:28:33.051769 | a656f6bd-95ff-418b-b691-8661269fd116 ==============================
[0m00:28:33.051769 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:28:33.054209 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:28:33.341961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a656f6bd-95ff-418b-b691-8661269fd116', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c5b956840>]}
[0m00:28:33.398015 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m00:28:33.440865 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m00:28:33.443332 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5222183, "process_user_time": 2.282833, "process_kernel_time": 0.311295, "process_mem_max_rss": "165628", "process_in_blocks": "66360", "process_out_blocks": "0"}
[0m00:28:33.444206 [debug] [MainThread]: Command `dbt deps` succeeded at 00:28:33.444109 after 0.52 seconds
[0m00:28:33.445273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c5ae33470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c5b28ebd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c5a6a34d0>]}
[0m00:28:33.446292 [debug] [MainThread]: Flushing usage events
[0m00:28:37.397046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5644df5fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f564366b800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5645873440>]}


============================== 00:28:37.410789 | c27d02ad-e67c-4d80-b925-7e754f3b5eb0 ==============================
[0m00:28:37.410789 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:28:37.412948 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt --select staging', 'send_anonymous_usage_stats': 'True'}
[0m00:28:39.211957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c27d02ad-e67c-4d80-b925-7e754f3b5eb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55e976b6b0>]}
[0m00:28:40.003840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c27d02ad-e67c-4d80-b925-7e754f3b5eb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55e9b36780>]}
[0m00:28:40.005627 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m00:28:41.132900 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:28:41.990337 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:28:41.991437 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:28:42.045098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c27d02ad-e67c-4d80-b925-7e754f3b5eb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55e94e7890>]}
[0m00:28:42.557170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c27d02ad-e67c-4d80-b925-7e754f3b5eb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55e98e7140>]}
[0m00:28:42.559039 [info ] [MainThread]: Found 12 models, 10 data tests, 7 sources, 459 macros
[0m00:28:42.560697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c27d02ad-e67c-4d80-b925-7e754f3b5eb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55e9348e90>]}
[0m00:28:42.566125 [info ] [MainThread]: 
[0m00:28:42.568273 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:28:42.580522 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON'
[0m00:28:42.607909 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON"
[0m00:28:42.609062 [debug] [ThreadPool]: On list_USER_DB_FALCON: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON"} */
show terse schemas in database USER_DB_FALCON
    limit 10000
[0m00:28:42.610075 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:28:43.376291 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.766 seconds
[0m00:28:43.397481 [debug] [ThreadPool]: On list_USER_DB_FALCON: Close
[0m00:28:43.650622 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON, now list_USER_DB_FALCON_RAW_public)
[0m00:28:43.673289 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m00:28:43.678495 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show terse objects in USER_DB_FALCON.RAW_public limit 10000
[0m00:28:43.682082 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:28:44.154935 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.473 seconds
[0m00:28:44.184378 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m00:28:44.325988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c27d02ad-e67c-4d80-b925-7e754f3b5eb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5644918320>]}
[0m00:28:44.341503 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:28:44.385382 [info ] [MainThread]: 
[0m00:28:44.400973 [debug] [Thread-1 (]: Began running node model.customer_churn.stg_address
[0m00:28:44.401335 [debug] [Thread-2 (]: Began running node model.customer_churn.stg_autoinsurance_churn
[0m00:28:44.401676 [debug] [Thread-3 (]: Began running node model.customer_churn.stg_customer
[0m00:28:44.402120 [debug] [Thread-4 (]: Began running node model.customer_churn.stg_demographic
[0m00:28:44.405246 [info ] [Thread-1 (]: 1 of 6 START sql view model RAW_public.stg_address ............................. [RUN]
[0m00:28:44.451508 [info ] [Thread-2 (]: 2 of 6 START sql view model RAW_public.stg_autoinsurance_churn ................. [RUN]
[0m00:28:44.453137 [info ] [Thread-3 (]: 3 of 6 START sql view model RAW_public.stg_customer ............................ [RUN]
[0m00:28:44.466364 [info ] [Thread-4 (]: 4 of 6 START sql view model RAW_public.stg_demographic ......................... [RUN]
[0m00:28:44.468407 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON_RAW_public, now model.customer_churn.stg_address)
[0m00:28:44.469411 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.customer_churn.stg_autoinsurance_churn'
[0m00:28:44.512176 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.customer_churn.stg_customer'
[0m00:28:44.514240 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.customer_churn.stg_demographic'
[0m00:28:44.542004 [debug] [Thread-1 (]: Began compiling node model.customer_churn.stg_address
[0m00:28:44.546342 [debug] [Thread-2 (]: Began compiling node model.customer_churn.stg_autoinsurance_churn
[0m00:28:44.548831 [debug] [Thread-3 (]: Began compiling node model.customer_churn.stg_customer
[0m00:28:44.554212 [debug] [Thread-4 (]: Began compiling node model.customer_churn.stg_demographic
[0m00:28:44.573245 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer_churn.stg_autoinsurance_churn"
[0m00:28:44.574790 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.stg_address"
[0m00:28:44.588197 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.stg_customer"
[0m00:28:44.599132 [debug] [Thread-4 (]: Writing injected SQL for node "model.customer_churn.stg_demographic"
[0m00:28:44.633585 [debug] [Thread-2 (]: Began executing node model.customer_churn.stg_autoinsurance_churn
[0m00:28:44.635006 [debug] [Thread-3 (]: Began executing node model.customer_churn.stg_customer
[0m00:28:44.663709 [debug] [Thread-1 (]: Began executing node model.customer_churn.stg_address
[0m00:28:44.693160 [debug] [Thread-4 (]: Began executing node model.customer_churn.stg_demographic
[0m00:28:44.699307 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.stg_customer"
[0m00:28:44.703741 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer_churn.stg_autoinsurance_churn"
[0m00:28:44.706034 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.stg_address"
[0m00:28:44.709443 [debug] [Thread-4 (]: Writing runtime sql for node "model.customer_churn.stg_demographic"
[0m00:28:44.722538 [debug] [Thread-4 (]: Using snowflake connection "model.customer_churn.stg_demographic"
[0m00:28:44.723265 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.stg_address"
[0m00:28:44.723650 [debug] [Thread-4 (]: On model.customer_churn.stg_demographic: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_demographic"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_demographic
  
   as (
    

select
  individual_id,
  income,
  has_children,
  length_of_residence    as length_of_residence,  -- exact match
  marital_status,
  home_owner,
  home_market_value      as home_market_value,
  college_degree,
  good_credit
from USER_DB_FALCON.RAW.DEMOGRAPHIC_STAGING
  );
[0m00:28:44.724427 [debug] [Thread-2 (]: Using snowflake connection "model.customer_churn.stg_autoinsurance_churn"
[0m00:28:44.724775 [debug] [Thread-1 (]: On model.customer_churn.stg_address: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_address"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_address
  
   as (
    -- models/staging/stg_address.sql

select
  address_id,
  street_address,
  city,
  state,
  county,
  latitude::float as lat,
  longitude::float as lon
from USER_DB_FALCON.RAW.ADDRESS_STAGING
  );
[0m00:28:44.725575 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:28:44.726333 [debug] [Thread-2 (]: On model.customer_churn.stg_autoinsurance_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_autoinsurance_churn"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_autoinsurance_churn
  
   as (
    

select
  individual_id,
  churn              as churn_flag
from USER_DB_FALCON.RAW.AUTOINSURANCE_CHURN_STAGING
  );
[0m00:28:44.727073 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.stg_customer"
[0m00:28:44.727308 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:28:44.728487 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:28:44.729543 [debug] [Thread-3 (]: On model.customer_churn.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_customer"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_customer
  
   as (
    

select
  individual_id,
  address_id,
  curr_ann_amt    as annual_premium,
  days_tenure,
  cust_orig_date,
  age_in_years,            -- bring this in
  date_of_birth            -- and this
from USER_DB_FALCON.RAW.CUSTOMER_STAGING
where individual_id is not null
  );
[0m00:28:44.732361 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:28:45.414434 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.689 seconds
[0m00:28:45.448762 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.716 seconds
[0m00:28:45.450332 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.723 seconds
[0m00:28:45.451742 [debug] [Thread-4 (]: On model.customer_churn.stg_demographic: Close
[0m00:28:45.479751 [debug] [Thread-3 (]: On model.customer_churn.stg_customer: Close
[0m00:28:45.484443 [debug] [Thread-1 (]: On model.customer_churn.stg_address: Close
[0m00:28:45.527472 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.799 seconds
[0m00:28:45.529871 [debug] [Thread-2 (]: On model.customer_churn.stg_autoinsurance_churn: Close
[0m00:28:45.607053 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c27d02ad-e67c-4d80-b925-7e754f3b5eb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55e86c99a0>]}
[0m00:28:45.608059 [info ] [Thread-1 (]: 1 of 6 OK created sql view model RAW_public.stg_address ........................ [[32mSUCCESS 1[0m in 1.14s]
[0m00:28:45.609221 [debug] [Thread-1 (]: Finished running node model.customer_churn.stg_address
[0m00:28:45.610039 [debug] [Thread-1 (]: Began running node model.customer_churn.stg_termination
[0m00:28:45.610940 [info ] [Thread-1 (]: 5 of 6 START sql view model RAW_public.stg_termination ......................... [RUN]
[0m00:28:45.612322 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer_churn.stg_address, now model.customer_churn.stg_termination)
[0m00:28:45.613729 [debug] [Thread-1 (]: Began compiling node model.customer_churn.stg_termination
[0m00:28:45.620345 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.stg_termination"
[0m00:28:45.621354 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c27d02ad-e67c-4d80-b925-7e754f3b5eb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55e8709310>]}
[0m00:28:45.622489 [info ] [Thread-3 (]: 3 of 6 OK created sql view model RAW_public.stg_customer ....................... [[32mSUCCESS 1[0m in 1.11s]
[0m00:28:45.623178 [debug] [Thread-3 (]: Finished running node model.customer_churn.stg_customer
[0m00:28:45.624524 [debug] [Thread-3 (]: Began running node model.customer_churn.stg_turning_movement
[0m00:28:45.625598 [info ] [Thread-3 (]: 6 of 6 START sql view model RAW_public.stg_turning_movement .................... [RUN]
[0m00:28:45.626546 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer_churn.stg_customer, now model.customer_churn.stg_turning_movement)
[0m00:28:45.627109 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c27d02ad-e67c-4d80-b925-7e754f3b5eb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55e9642930>]}
[0m00:28:45.627609 [debug] [Thread-3 (]: Began compiling node model.customer_churn.stg_turning_movement
[0m00:28:45.628912 [info ] [Thread-4 (]: 4 of 6 OK created sql view model RAW_public.stg_demographic .................... [[32mSUCCESS 1[0m in 1.11s]
[0m00:28:45.632618 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.stg_turning_movement"
[0m00:28:45.633645 [debug] [Thread-4 (]: Finished running node model.customer_churn.stg_demographic
[0m00:28:45.637326 [debug] [Thread-1 (]: Began executing node model.customer_churn.stg_termination
[0m00:28:45.639635 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.stg_termination"
[0m00:28:45.643462 [debug] [Thread-3 (]: Began executing node model.customer_churn.stg_turning_movement
[0m00:28:45.646950 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.stg_turning_movement"
[0m00:28:45.662059 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.stg_termination"
[0m00:28:45.665047 [debug] [Thread-1 (]: On model.customer_churn.stg_termination: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_termination"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_termination
  
   as (
    

select
  individual_id,
  acct_suspd_date    as churn_date
from USER_DB_FALCON.RAW.TERMINATION_STAGING
  );
[0m00:28:45.666882 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:28:45.668976 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.stg_turning_movement"
[0m00:28:45.669957 [debug] [Thread-3 (]: On model.customer_churn.stg_turning_movement: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.stg_turning_movement"} */
create or replace   view USER_DB_FALCON.RAW_public.stg_turning_movement
  
   as (
    -- models/staging/stg_turning_movement.sql

select
  objectid,
  facilityid,
  intid,
  intname,
  nodeno,
  longitude::float as tm_lon,
  latitude::float  as tm_lat
from USER_DB_FALCON.RAW.TURNING_MOVEMENT
  );
[0m00:28:45.672118 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:28:45.838775 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c27d02ad-e67c-4d80-b925-7e754f3b5eb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55e858bcb0>]}
[0m00:28:45.851502 [info ] [Thread-2 (]: 2 of 6 OK created sql view model RAW_public.stg_autoinsurance_churn ............ [[32mSUCCESS 1[0m in 1.37s]
[0m00:28:45.858769 [debug] [Thread-2 (]: Finished running node model.customer_churn.stg_autoinsurance_churn
[0m00:28:46.349113 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.682 seconds
[0m00:28:46.358519 [debug] [Thread-1 (]: On model.customer_churn.stg_termination: Close
[0m00:28:46.510028 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.838 seconds
[0m00:28:46.529247 [debug] [Thread-3 (]: On model.customer_churn.stg_turning_movement: Close
[0m00:28:46.666476 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c27d02ad-e67c-4d80-b925-7e754f3b5eb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55e8581d60>]}
[0m00:28:46.667735 [info ] [Thread-3 (]: 6 of 6 OK created sql view model RAW_public.stg_turning_movement ............... [[32mSUCCESS 1[0m in 1.04s]
[0m00:28:46.674185 [debug] [Thread-3 (]: Finished running node model.customer_churn.stg_turning_movement
[0m00:28:46.843640 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c27d02ad-e67c-4d80-b925-7e754f3b5eb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55e85ac2f0>]}
[0m00:28:46.844783 [info ] [Thread-1 (]: 5 of 6 OK created sql view model RAW_public.stg_termination .................... [[32mSUCCESS 1[0m in 1.23s]
[0m00:28:46.846116 [debug] [Thread-1 (]: Finished running node model.customer_churn.stg_termination
[0m00:28:46.848963 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:28:46.849489 [debug] [MainThread]: Connection 'model.customer_churn.stg_termination' was properly closed.
[0m00:28:46.850126 [debug] [MainThread]: Connection 'model.customer_churn.stg_autoinsurance_churn' was properly closed.
[0m00:28:46.850948 [debug] [MainThread]: Connection 'model.customer_churn.stg_turning_movement' was properly closed.
[0m00:28:46.851842 [debug] [MainThread]: Connection 'model.customer_churn.stg_demographic' was properly closed.
[0m00:28:46.852809 [info ] [MainThread]: 
[0m00:28:46.853931 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 4.28 seconds (4.28s).
[0m00:28:46.856329 [debug] [MainThread]: Command end result
[0m00:28:47.116470 [info ] [MainThread]: 
[0m00:28:47.118153 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:28:47.119412 [info ] [MainThread]: 
[0m00:28:47.120603 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m00:28:47.122695 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.286512, "process_user_time": 5.223602, "process_kernel_time": 3.031619, "process_mem_max_rss": "243580", "process_in_blocks": "62608", "process_out_blocks": "8"}
[0m00:28:47.124117 [debug] [MainThread]: Command `dbt run` succeeded at 00:28:47.123892 after 8.29 seconds
[0m00:28:47.126094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56432f0800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56441ebfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55eaa7eae0>]}
[0m00:28:47.139668 [debug] [MainThread]: Flushing usage events
[0m00:28:50.866360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3856a9a060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3856e71070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38590d7020>]}


============================== 00:28:50.881000 | 04131b01-bbe0-4b48-b756-c74021bec38a ==============================
[0m00:28:50.881000 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:28:50.881954 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt --select intermediate', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:28:52.010019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '04131b01-bbe0-4b48-b756-c74021bec38a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3856258d40>]}
[0m00:28:52.064450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '04131b01-bbe0-4b48-b756-c74021bec38a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37fef39a90>]}
[0m00:28:52.066042 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m00:28:52.165223 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:28:54.078260 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:28:54.082001 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:28:54.127365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '04131b01-bbe0-4b48-b756-c74021bec38a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37fc9021e0>]}
[0m00:28:54.529220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '04131b01-bbe0-4b48-b756-c74021bec38a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37fcda7d40>]}
[0m00:28:54.530065 [info ] [MainThread]: Found 12 models, 10 data tests, 7 sources, 459 macros
[0m00:28:54.530605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04131b01-bbe0-4b48-b756-c74021bec38a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37fc473590>]}
[0m00:28:54.532095 [info ] [MainThread]: 
[0m00:28:54.532869 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:28:54.534436 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON'
[0m00:28:54.544950 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON"
[0m00:28:54.545665 [debug] [ThreadPool]: On list_USER_DB_FALCON: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON"} */
show terse schemas in database USER_DB_FALCON
    limit 10000
[0m00:28:54.546159 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:28:55.263105 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.717 seconds
[0m00:28:55.293249 [debug] [ThreadPool]: On list_USER_DB_FALCON: Close
[0m00:28:55.482804 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON, now list_USER_DB_FALCON_RAW_public)
[0m00:28:55.504748 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m00:28:55.506762 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show terse objects in USER_DB_FALCON.RAW_public limit 10000
[0m00:28:55.518526 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:28:55.936765 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.418 seconds
[0m00:28:55.946150 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m00:28:56.183604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04131b01-bbe0-4b48-b756-c74021bec38a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37fca8a120>]}
[0m00:28:56.196409 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:28:56.207485 [info ] [MainThread]: 
[0m00:28:56.218297 [debug] [Thread-1 (]: Began running node model.customer_churn.int_customer_enriched
[0m00:28:56.231946 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW_public.int_customer_enriched ................... [RUN]
[0m00:28:56.238653 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON_RAW_public, now model.customer_churn.int_customer_enriched)
[0m00:28:56.239508 [debug] [Thread-1 (]: Began compiling node model.customer_churn.int_customer_enriched
[0m00:28:56.255160 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.int_customer_enriched"
[0m00:28:56.488049 [debug] [Thread-1 (]: Began executing node model.customer_churn.int_customer_enriched
[0m00:28:56.511078 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.int_customer_enriched"
[0m00:28:56.537659 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.int_customer_enriched"
[0m00:28:56.538336 [debug] [Thread-1 (]: On model.customer_churn.int_customer_enriched: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.int_customer_enriched"} */
create or replace   view USER_DB_FALCON.RAW_public.int_customer_enriched
  
   as (
    

with cust as (
    select
        individual_id,
        annual_premium,
        days_tenure,
        cust_orig_date,
        age_in_years,
        date_of_birth,
        address_id
    from USER_DB_FALCON.RAW_public.stg_customer
),

demo as (
    select
        individual_id,
        has_children,
        length_of_residence,
        marital_status,
        home_owner,
        home_market_value,
        college_degree,
        good_credit
    from USER_DB_FALCON.RAW_public.stg_demographic
),

addr as (
    select
        address_id,
        city,
        state,
        county,
        lat,
        lon
    from USER_DB_FALCON.RAW_public.stg_address
)

select
    cust.individual_id,
    cust.annual_premium,
    cust.days_tenure,
    cust.cust_orig_date,
    cust.age_in_years,
    cust.date_of_birth,
    demo.has_children,
    demo.length_of_residence,
    demo.marital_status,
    demo.home_owner,
    demo.home_market_value,
    addr.city,
    addr.state,
    addr.county,
    addr.lat,
    addr.lon
from cust
left join demo using (individual_id)
left join addr using (address_id)
  );
[0m00:28:56.539117 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:28:57.373592 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.834 seconds
[0m00:28:57.408221 [debug] [Thread-1 (]: On model.customer_churn.int_customer_enriched: Close
[0m00:28:57.542584 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04131b01-bbe0-4b48-b756-c74021bec38a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37fc9f2c90>]}
[0m00:28:57.544410 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW_public.int_customer_enriched .............. [[32mSUCCESS 1[0m in 1.30s]
[0m00:28:57.546194 [debug] [Thread-1 (]: Finished running node model.customer_churn.int_customer_enriched
[0m00:28:57.551286 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:28:57.552988 [debug] [MainThread]: Connection 'model.customer_churn.int_customer_enriched' was properly closed.
[0m00:28:57.554481 [info ] [MainThread]: 
[0m00:28:57.556249 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.02 seconds (3.02s).
[0m00:28:57.558805 [debug] [MainThread]: Command end result
[0m00:28:57.704332 [info ] [MainThread]: 
[0m00:28:57.705223 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:28:57.705883 [info ] [MainThread]: 
[0m00:28:57.706994 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:28:57.708747 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.0802703, "process_user_time": 4.892745, "process_kernel_time": 2.753094, "process_mem_max_rss": "252416", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m00:28:57.709876 [debug] [MainThread]: Command `dbt run` succeeded at 00:28:57.709702 after 7.08 seconds
[0m00:28:57.710901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3856670ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38567c7ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3859df9250>]}
[0m00:28:57.712020 [debug] [MainThread]: Flushing usage events
[0m00:29:01.956333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dde5e3f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ddfd64b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ddc03bda0>]}


============================== 00:29:01.971590 | f4daac60-1468-4a10-b6cb-09fe5adc3a9b ==============================
[0m00:29:01.971590 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:29:01.979500 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt --select marts', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:29:03.336065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4daac60-1468-4a10-b6cb-09fe5adc3a9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d7e70dd30>]}
[0m00:29:03.404838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4daac60-1468-4a10-b6cb-09fe5adc3a9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d8498baa0>]}
[0m00:29:03.406581 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m00:29:03.535775 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:29:04.318557 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:29:04.319834 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:29:04.380459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4daac60-1468-4a10-b6cb-09fe5adc3a9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d7e13cbc0>]}
[0m00:29:04.590462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4daac60-1468-4a10-b6cb-09fe5adc3a9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d7e08e8a0>]}
[0m00:29:04.591860 [info ] [MainThread]: Found 12 models, 10 data tests, 7 sources, 459 macros
[0m00:29:04.593096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4daac60-1468-4a10-b6cb-09fe5adc3a9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d7de654c0>]}
[0m00:29:04.596446 [info ] [MainThread]: 
[0m00:29:04.598320 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:29:04.605929 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON'
[0m00:29:04.630121 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON"
[0m00:29:04.631160 [debug] [ThreadPool]: On list_USER_DB_FALCON: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON"} */
show terse schemas in database USER_DB_FALCON
    limit 10000
[0m00:29:04.632252 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:29:05.186832 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.555 seconds
[0m00:29:05.202180 [debug] [ThreadPool]: On list_USER_DB_FALCON: Close
[0m00:29:05.369452 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON, now list_USER_DB_FALCON_RAW_public)
[0m00:29:05.392999 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m00:29:05.394277 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show terse objects in USER_DB_FALCON.RAW_public limit 10000
[0m00:29:05.395350 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:29:05.957717 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.562 seconds
[0m00:29:05.959753 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m00:29:06.115351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4daac60-1468-4a10-b6cb-09fe5adc3a9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d841dcbf0>]}
[0m00:29:06.116286 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:29:06.117070 [info ] [MainThread]: 
[0m00:29:06.132493 [debug] [Thread-1 (]: Began running node model.customer_churn.dim_address
[0m00:29:06.132922 [debug] [Thread-2 (]: Began running node model.customer_churn.dim_customer
[0m00:29:06.133240 [debug] [Thread-3 (]: Began running node model.customer_churn.fact_churn
[0m00:29:06.143998 [info ] [Thread-1 (]: 1 of 5 START sql table model RAW_public.dim_address ............................ [RUN]
[0m00:29:06.145332 [info ] [Thread-2 (]: 2 of 5 START sql table model RAW_public.dim_customer ........................... [RUN]
[0m00:29:06.152866 [info ] [Thread-3 (]: 3 of 5 START sql incremental model RAW_public.fact_churn ....................... [RUN]
[0m00:29:06.155137 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON_RAW_public, now model.customer_churn.dim_address)
[0m00:29:06.158785 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.customer_churn.dim_customer'
[0m00:29:06.160675 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.customer_churn.fact_churn'
[0m00:29:06.162647 [debug] [Thread-1 (]: Began compiling node model.customer_churn.dim_address
[0m00:29:06.164716 [debug] [Thread-2 (]: Began compiling node model.customer_churn.dim_customer
[0m00:29:06.166009 [debug] [Thread-3 (]: Began compiling node model.customer_churn.fact_churn
[0m00:29:06.177653 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_churn.dim_address"
[0m00:29:06.180221 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer_churn.dim_customer"
[0m00:29:06.190573 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.fact_churn"
[0m00:29:06.217759 [debug] [Thread-1 (]: Began executing node model.customer_churn.dim_address
[0m00:29:06.230360 [debug] [Thread-2 (]: Began executing node model.customer_churn.dim_customer
[0m00:29:06.242441 [debug] [Thread-3 (]: Began executing node model.customer_churn.fact_churn
[0m00:29:06.271278 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_churn.dim_address"
[0m00:29:06.269367 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer_churn.dim_customer"
[0m00:29:06.308368 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:29:06.309573 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
create or replace  temporary view USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
  
   as (
    -- models/marts/fact_churn.sql


select
  t.individual_id,
  t.churn_date,
  e.city,
  e.state,
  e.county,
  e.age_in_years,
  e.days_tenure,
  e.annual_premium,
  c.churn_flag
from USER_DB_FALCON.RAW_public.stg_termination t
join USER_DB_FALCON.RAW_public.int_customer_enriched e
  using (individual_id)
left join USER_DB_FALCON.RAW_public.stg_autoinsurance_churn c
  using (individual_id)


where t.churn_date > (select max(churn_date) from USER_DB_FALCON.RAW_public.fact_churn)

  );
[0m00:29:06.310353 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:29:06.311037 [debug] [Thread-1 (]: Using snowflake connection "model.customer_churn.dim_address"
[0m00:29:06.312785 [debug] [Thread-1 (]: On model.customer_churn.dim_address: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.dim_address"} */
create or replace transient table USER_DB_FALCON.RAW_public.dim_address
         as
        (-- models/marts/dim_address.sql


select distinct
  individual_id,
  city,
  state,
  county,
  lat,
  lon
from USER_DB_FALCON.RAW_public.int_customer_enriched
        );
[0m00:29:06.314308 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:29:06.316793 [debug] [Thread-2 (]: Using snowflake connection "model.customer_churn.dim_customer"
[0m00:29:06.317354 [debug] [Thread-2 (]: On model.customer_churn.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.dim_customer"} */
create or replace transient table USER_DB_FALCON.RAW_public.dim_customer
         as
        (-- models/marts/dim_customer.sql


select distinct
  individual_id,
  age_in_years as age,
  marital_status,
  has_children,
  length_of_residence
from USER_DB_FALCON.RAW_public.int_customer_enriched
        );
[0m00:29:06.317953 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:29:07.164414 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.854 seconds
[0m00:29:07.188685 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:29:07.193046 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
[0m00:29:07.306121 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 0.106 seconds
[0m00:29:07.322247 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:29:07.349146 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table USER_DB_FALCON.RAW_public.fact_churn
[0m00:29:07.516843 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 0.158 seconds
[0m00:29:07.535659 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:29:07.537550 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
describe table "USER_DB_FALCON"."RAW_PUBLIC"."FACT_CHURN"
[0m00:29:07.652938 [debug] [Thread-3 (]: SQL status: SUCCESS 9 in 0.114 seconds
[0m00:29:07.694187 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.fact_churn"
[0m00:29:07.719931 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:29:07.720882 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
-- back compat for old kwarg name
  
  begin;
[0m00:29:07.859414 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.138 seconds
[0m00:29:07.860219 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:29:07.862019 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
merge into USER_DB_FALCON.RAW_public.fact_churn as DBT_INTERNAL_DEST
        using USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.individual_id = DBT_INTERNAL_DEST.individual_id
                ) and (
                    DBT_INTERNAL_SOURCE.churn_date = DBT_INTERNAL_DEST.churn_date
                )

    
    when matched then update set
        "INDIVIDUAL_ID" = DBT_INTERNAL_SOURCE."INDIVIDUAL_ID","CHURN_DATE" = DBT_INTERNAL_SOURCE."CHURN_DATE","CITY" = DBT_INTERNAL_SOURCE."CITY","STATE" = DBT_INTERNAL_SOURCE."STATE","COUNTY" = DBT_INTERNAL_SOURCE."COUNTY","AGE_IN_YEARS" = DBT_INTERNAL_SOURCE."AGE_IN_YEARS","DAYS_TENURE" = DBT_INTERNAL_SOURCE."DAYS_TENURE","ANNUAL_PREMIUM" = DBT_INTERNAL_SOURCE."ANNUAL_PREMIUM","CHURN_FLAG" = DBT_INTERNAL_SOURCE."CHURN_FLAG"
    

    when not matched then insert
        ("INDIVIDUAL_ID", "CHURN_DATE", "CITY", "STATE", "COUNTY", "AGE_IN_YEARS", "DAYS_TENURE", "ANNUAL_PREMIUM", "CHURN_FLAG")
    values
        ("INDIVIDUAL_ID", "CHURN_DATE", "CITY", "STATE", "COUNTY", "AGE_IN_YEARS", "DAYS_TENURE", "ANNUAL_PREMIUM", "CHURN_FLAG")

;
[0m00:29:08.606759 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 0.744 seconds
[0m00:29:08.608025 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:29:08.608902 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
COMMIT
[0m00:29:08.874241 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.265 seconds
[0m00:29:08.884957 [debug] [Thread-3 (]: Applying DROP to: USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp
[0m00:29:08.896575 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.fact_churn"
[0m00:29:08.897580 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.fact_churn"} */
drop view if exists USER_DB_FALCON.RAW_public.fact_churn__dbt_tmp cascade
[0m00:29:09.043153 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.145 seconds
[0m00:29:09.069260 [debug] [Thread-3 (]: On model.customer_churn.fact_churn: Close
[0m00:29:09.185391 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4daac60-1468-4a10-b6cb-09fe5adc3a9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d7e3fb200>]}
[0m00:29:09.187599 [info ] [Thread-3 (]: 3 of 5 OK created sql incremental model RAW_public.fact_churn .................. [[32mSUCCESS 0[0m in 3.02s]
[0m00:29:09.189180 [debug] [Thread-3 (]: Finished running node model.customer_churn.fact_churn
[0m00:29:09.190631 [debug] [Thread-4 (]: Began running node model.customer_churn.churn_metrics
[0m00:29:09.191717 [info ] [Thread-4 (]: 4 of 5 START sql table model RAW_public.churn_metrics .......................... [RUN]
[0m00:29:09.194819 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.customer_churn.churn_metrics'
[0m00:29:09.200299 [debug] [Thread-4 (]: Began compiling node model.customer_churn.churn_metrics
[0m00:29:09.209965 [debug] [Thread-4 (]: Writing injected SQL for node "model.customer_churn.churn_metrics"
[0m00:29:09.240552 [debug] [Thread-4 (]: Began executing node model.customer_churn.churn_metrics
[0m00:29:09.247497 [debug] [Thread-4 (]: Writing runtime sql for node "model.customer_churn.churn_metrics"
[0m00:29:09.303754 [debug] [Thread-4 (]: Using snowflake connection "model.customer_churn.churn_metrics"
[0m00:29:09.305457 [debug] [Thread-4 (]: On model.customer_churn.churn_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.churn_metrics"} */
create or replace transient table USER_DB_FALCON.RAW_public.churn_metrics
         as
        (WITH 
  monthly AS (
    SELECT
      DATE_TRUNC('month', churn_date) AS period,
      COUNT(*) AS churn_count
    FROM USER_DB_FALCON.RAW_public.fact_churn
    GROUP BY 1
  ),
  
  by_state AS (
    SELECT
      state AS period,
      COUNT(*) AS churn_count
    FROM USER_DB_FALCON.RAW_public.fact_churn
    GROUP BY 1
  ),
  
  by_age AS (
    SELECT
      CASE
        WHEN age_in_years < 25 THEN 'Under 25'
        WHEN age_in_years < 35 THEN '25-34'
        WHEN age_in_years < 45 THEN '35-44'
        WHEN age_in_years < 55 THEN '45-54'
        WHEN age_in_years < 65 THEN '55-64'
        ELSE '65+'
      END AS period,
      COUNT(*) AS churn_count
    FROM USER_DB_FALCON.RAW_public.fact_churn
    GROUP BY 1
  ),
  
  by_tenure AS (
    SELECT
      CASE
        WHEN days_tenure <= 90 THEN '0-3 months'
        WHEN days_tenure <= 180 THEN '4-6 months'
        WHEN days_tenure <= 365 THEN '7-12 months'
        WHEN days_tenure <= 730 THEN '13-24 months'
        ELSE '25+ months'
      END AS period,
      COUNT(*) AS churn_count
    FROM USER_DB_FALCON.RAW_public.fact_churn
    GROUP BY 1
  ),
  
  by_premium AS (
    SELECT
      CASE
        WHEN annual_premium < 1000 THEN 'Under $1,000'
        WHEN annual_premium < 2000 THEN '$1,000-$1,999'
        WHEN annual_premium < 3000 THEN '$2,000-$2,999'
        ELSE '$3,000+'
      END AS period,
      COUNT(*) AS churn_count
    FROM USER_DB_FALCON.RAW_public.fact_churn
    GROUP BY 1
  )

SELECT
  CAST(period AS VARCHAR) AS period,
  churn_count,
  'monthly'              AS category
FROM monthly

UNION ALL

SELECT
  CAST(period AS VARCHAR) AS period,
  churn_count,
  'by_state'             AS category
FROM by_state

UNION ALL

SELECT
  CAST(period AS VARCHAR) AS period,
  churn_count,
  'by_age'               AS category
FROM by_age

UNION ALL

SELECT
  CAST(period AS VARCHAR) AS period,
  churn_count,
  'by_tenure'            AS category
FROM by_tenure

UNION ALL

SELECT
  CAST(period AS VARCHAR) AS period,
  churn_count,
  'by_premium'           AS category
FROM by_premium
        );
[0m00:29:09.316128 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:29:10.299856 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.982 seconds
[0m00:29:10.305736 [debug] [Thread-2 (]: On model.customer_churn.dim_customer: Close
[0m00:29:10.453173 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4daac60-1468-4a10-b6cb-09fe5adc3a9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d7d36ecf0>]}
[0m00:29:10.454587 [info ] [Thread-2 (]: 2 of 5 OK created sql table model RAW_public.dim_customer ...................... [[32mSUCCESS 1[0m in 4.29s]
[0m00:29:10.455465 [debug] [Thread-2 (]: Finished running node model.customer_churn.dim_customer
[0m00:29:10.715095 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.401 seconds
[0m00:29:10.720525 [debug] [Thread-1 (]: On model.customer_churn.dim_address: Close
[0m00:29:10.841258 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.525 seconds
[0m00:29:10.850113 [debug] [Thread-4 (]: On model.customer_churn.churn_metrics: Close
[0m00:29:10.858053 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4daac60-1468-4a10-b6cb-09fe5adc3a9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d7d36d430>]}
[0m00:29:10.862906 [info ] [Thread-1 (]: 1 of 5 OK created sql table model RAW_public.dim_address ....................... [[32mSUCCESS 1[0m in 4.70s]
[0m00:29:10.864884 [debug] [Thread-1 (]: Finished running node model.customer_churn.dim_address
[0m00:29:10.866356 [debug] [Thread-3 (]: Began running node model.customer_churn.churn_map
[0m00:29:10.867331 [info ] [Thread-3 (]: 5 of 5 START sql table model RAW_public.churn_map .............................. [RUN]
[0m00:29:10.869830 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer_churn.fact_churn, now model.customer_churn.churn_map)
[0m00:29:10.870666 [debug] [Thread-3 (]: Began compiling node model.customer_churn.churn_map
[0m00:29:10.874616 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer_churn.churn_map"
[0m00:29:10.924300 [debug] [Thread-3 (]: Began executing node model.customer_churn.churn_map
[0m00:29:10.928206 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer_churn.churn_map"
[0m00:29:11.787840 [debug] [Thread-3 (]: Using snowflake connection "model.customer_churn.churn_map"
[0m00:29:11.788545 [debug] [Thread-3 (]: On model.customer_churn.churn_map: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "model.customer_churn.churn_map"} */
create or replace transient table USER_DB_FALCON.RAW_public.churn_map
         as
        (-- models/marts/churn_map.sql


select
  f.individual_id,
  f.churn_date,
  f.churn_flag,
  a.lon,
  a.lat
from USER_DB_FALCON.RAW_public.fact_churn      as f
join USER_DB_FALCON.RAW_public.dim_address    as a
  using (individual_id)
        );
[0m00:29:11.789302 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:29:11.797092 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4daac60-1468-4a10-b6cb-09fe5adc3a9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d7d372270>]}
[0m00:29:11.799151 [info ] [Thread-4 (]: 4 of 5 OK created sql table model RAW_public.churn_metrics ..................... [[32mSUCCESS 1[0m in 2.60s]
[0m00:29:11.800197 [debug] [Thread-4 (]: Finished running node model.customer_churn.churn_metrics
[0m00:29:14.007434 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.204 seconds
[0m00:29:14.009500 [debug] [Thread-3 (]: On model.customer_churn.churn_map: Close
[0m00:29:14.154058 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4daac60-1468-4a10-b6cb-09fe5adc3a9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d7dec69c0>]}
[0m00:29:14.155390 [info ] [Thread-3 (]: 5 of 5 OK created sql table model RAW_public.churn_map ......................... [[32mSUCCESS 1[0m in 3.28s]
[0m00:29:14.156674 [debug] [Thread-3 (]: Finished running node model.customer_churn.churn_map
[0m00:29:14.158800 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:29:14.159819 [debug] [MainThread]: Connection 'model.customer_churn.dim_address' was properly closed.
[0m00:29:14.160583 [debug] [MainThread]: Connection 'model.customer_churn.dim_customer' was properly closed.
[0m00:29:14.161081 [debug] [MainThread]: Connection 'model.customer_churn.churn_map' was properly closed.
[0m00:29:14.161627 [debug] [MainThread]: Connection 'model.customer_churn.churn_metrics' was properly closed.
[0m00:29:14.163341 [info ] [MainThread]: 
[0m00:29:14.164854 [info ] [MainThread]: Finished running 1 incremental model, 4 table models in 0 hours 0 minutes and 9.57 seconds (9.57s).
[0m00:29:14.167593 [debug] [MainThread]: Command end result
[0m00:29:14.303141 [info ] [MainThread]: 
[0m00:29:14.304125 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:29:14.305481 [info ] [MainThread]: 
[0m00:29:14.306313 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m00:29:14.307746 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.711218, "process_user_time": 5.736613, "process_kernel_time": 2.865028, "process_mem_max_rss": "266808", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m00:29:14.309042 [debug] [MainThread]: Command `dbt run` succeeded at 00:29:14.308953 after 10.71 seconds
[0m00:29:14.310585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dde5e3f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ddc33e060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ddc33eae0>]}
[0m00:29:14.311849 [debug] [MainThread]: Flushing usage events
[0m00:29:17.809946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98ee5c1ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98ef092cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98ee86a480>]}


============================== 00:29:17.822996 | e8ce6455-f22f-4b4c-af9d-3c4c8de0d99f ==============================
[0m00:29:17.822996 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:29:17.824762 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:29:19.057088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8ce6455-f22f-4b4c-af9d-3c4c8de0d99f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9896dd8230>]}
[0m00:29:19.101607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e8ce6455-f22f-4b4c-af9d-3c4c8de0d99f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9894e57e00>]}
[0m00:29:19.117427 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m00:29:19.241072 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:29:20.183856 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:29:20.184509 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:29:20.219422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8ce6455-f22f-4b4c-af9d-3c4c8de0d99f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98ee44a2d0>]}
[0m00:29:20.512124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8ce6455-f22f-4b4c-af9d-3c4c8de0d99f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9894201820>]}
[0m00:29:20.513016 [info ] [MainThread]: Found 12 models, 10 data tests, 7 sources, 459 macros
[0m00:29:20.513766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8ce6455-f22f-4b4c-af9d-3c4c8de0d99f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98944a2780>]}
[0m00:29:20.516658 [info ] [MainThread]: 
[0m00:29:20.517872 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:29:20.523689 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_FALCON_RAW_public'
[0m00:29:20.540198 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_FALCON_RAW_public"
[0m00:29:20.541274 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "connection_name": "list_USER_DB_FALCON_RAW_public"} */
show terse objects in USER_DB_FALCON.RAW_public limit 10000
[0m00:29:20.542173 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:29:21.143379 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.601 seconds
[0m00:29:21.151701 [debug] [ThreadPool]: On list_USER_DB_FALCON_RAW_public: Close
[0m00:29:21.326325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8ce6455-f22f-4b4c-af9d-3c4c8de0d99f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9894227680>]}
[0m00:29:21.328631 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:29:21.338854 [info ] [MainThread]: 
[0m00:29:21.351033 [debug] [Thread-1 (]: Began running node test.customer_churn.not_null_dim_address_individual_id.efa1478d3c
[0m00:29:21.352173 [debug] [Thread-2 (]: Began running node test.customer_churn.not_null_dim_customer_individual_id.80bf9c0ee7
[0m00:29:21.353192 [debug] [Thread-3 (]: Began running node test.customer_churn.not_null_fact_churn_churn_date.c88bd69eeb
[0m00:29:21.354284 [debug] [Thread-4 (]: Began running node test.customer_churn.not_null_fact_churn_individual_id.96f069e355
[0m00:29:21.357334 [info ] [Thread-1 (]: 1 of 10 START test not_null_dim_address_individual_id .......................... [RUN]
[0m00:29:21.362472 [info ] [Thread-2 (]: 2 of 10 START test not_null_dim_customer_individual_id ......................... [RUN]
[0m00:29:21.368812 [info ] [Thread-3 (]: 3 of 10 START test not_null_fact_churn_churn_date .............................. [RUN]
[0m00:29:21.370419 [info ] [Thread-4 (]: 4 of 10 START test not_null_fact_churn_individual_id ........................... [RUN]
[0m00:29:21.372304 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_FALCON_RAW_public, now test.customer_churn.not_null_dim_address_individual_id.efa1478d3c)
[0m00:29:21.379755 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.customer_churn.not_null_dim_customer_individual_id.80bf9c0ee7'
[0m00:29:21.387770 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.customer_churn.not_null_fact_churn_churn_date.c88bd69eeb'
[0m00:29:21.415275 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.customer_churn.not_null_fact_churn_individual_id.96f069e355'
[0m00:29:21.417734 [debug] [Thread-1 (]: Began compiling node test.customer_churn.not_null_dim_address_individual_id.efa1478d3c
[0m00:29:21.418902 [debug] [Thread-2 (]: Began compiling node test.customer_churn.not_null_dim_customer_individual_id.80bf9c0ee7
[0m00:29:21.420956 [debug] [Thread-3 (]: Began compiling node test.customer_churn.not_null_fact_churn_churn_date.c88bd69eeb
[0m00:29:21.421555 [debug] [Thread-4 (]: Began compiling node test.customer_churn.not_null_fact_churn_individual_id.96f069e355
[0m00:29:21.450792 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer_churn.not_null_dim_address_individual_id.efa1478d3c"
[0m00:29:21.453959 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer_churn.not_null_dim_customer_individual_id.80bf9c0ee7"
[0m00:29:21.462446 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer_churn.not_null_fact_churn_churn_date.c88bd69eeb"
[0m00:29:21.465649 [debug] [Thread-4 (]: Writing injected SQL for node "test.customer_churn.not_null_fact_churn_individual_id.96f069e355"
[0m00:29:21.488423 [debug] [Thread-4 (]: Began executing node test.customer_churn.not_null_fact_churn_individual_id.96f069e355
[0m00:29:21.490970 [debug] [Thread-3 (]: Began executing node test.customer_churn.not_null_fact_churn_churn_date.c88bd69eeb
[0m00:29:21.505696 [debug] [Thread-4 (]: Writing runtime sql for node "test.customer_churn.not_null_fact_churn_individual_id.96f069e355"
[0m00:29:21.507712 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer_churn.not_null_fact_churn_churn_date.c88bd69eeb"
[0m00:29:21.509092 [debug] [Thread-2 (]: Began executing node test.customer_churn.not_null_dim_customer_individual_id.80bf9c0ee7
[0m00:29:21.511487 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer_churn.not_null_dim_customer_individual_id.80bf9c0ee7"
[0m00:29:21.511868 [debug] [Thread-1 (]: Began executing node test.customer_churn.not_null_dim_address_individual_id.efa1478d3c
[0m00:29:21.514873 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer_churn.not_null_dim_address_individual_id.efa1478d3c"
[0m00:29:21.518275 [debug] [Thread-3 (]: Using snowflake connection "test.customer_churn.not_null_fact_churn_churn_date.c88bd69eeb"
[0m00:29:21.518818 [debug] [Thread-4 (]: Using snowflake connection "test.customer_churn.not_null_fact_churn_individual_id.96f069e355"
[0m00:29:21.519114 [debug] [Thread-3 (]: On test.customer_churn.not_null_fact_churn_churn_date.c88bd69eeb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "test.customer_churn.not_null_fact_churn_churn_date.c88bd69eeb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select churn_date
from USER_DB_FALCON.RAW_public.fact_churn
where churn_date is null



      
    ) dbt_internal_test
[0m00:29:21.519992 [debug] [Thread-4 (]: On test.customer_churn.not_null_fact_churn_individual_id.96f069e355: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "test.customer_churn.not_null_fact_churn_individual_id.96f069e355"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select individual_id
from USER_DB_FALCON.RAW_public.fact_churn
where individual_id is null



      
    ) dbt_internal_test
[0m00:29:21.520533 [debug] [Thread-2 (]: Using snowflake connection "test.customer_churn.not_null_dim_customer_individual_id.80bf9c0ee7"
[0m00:29:21.521459 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:29:21.522321 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:29:21.523302 [debug] [Thread-1 (]: Using snowflake connection "test.customer_churn.not_null_dim_address_individual_id.efa1478d3c"
[0m00:29:21.523595 [debug] [Thread-2 (]: On test.customer_churn.not_null_dim_customer_individual_id.80bf9c0ee7: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "test.customer_churn.not_null_dim_customer_individual_id.80bf9c0ee7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select individual_id
from USER_DB_FALCON.RAW_public.dim_customer
where individual_id is null



      
    ) dbt_internal_test
[0m00:29:21.526539 [debug] [Thread-1 (]: On test.customer_churn.not_null_dim_address_individual_id.efa1478d3c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "test.customer_churn.not_null_dim_address_individual_id.efa1478d3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select individual_id
from USER_DB_FALCON.RAW_public.dim_address
where individual_id is null



      
    ) dbt_internal_test
[0m00:29:21.527163 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:29:21.527932 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:29:21.934290 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.413 seconds
[0m00:29:21.943699 [debug] [Thread-3 (]: On test.customer_churn.not_null_fact_churn_churn_date.c88bd69eeb: Close
[0m00:29:21.971441 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.449 seconds
[0m00:29:21.976686 [debug] [Thread-4 (]: On test.customer_churn.not_null_fact_churn_individual_id.96f069e355: Close
[0m00:29:22.130820 [info ] [Thread-4 (]: 4 of 10 PASS not_null_fact_churn_individual_id ................................. [[32mPASS[0m in 0.72s]
[0m00:29:22.132246 [debug] [Thread-4 (]: Finished running node test.customer_churn.not_null_fact_churn_individual_id.96f069e355
[0m00:29:22.131789 [info ] [Thread-3 (]: 3 of 10 PASS not_null_fact_churn_churn_date .................................... [[32mPASS[0m in 0.74s]
[0m00:29:22.133837 [debug] [Thread-4 (]: Began running node test.customer_churn.not_null_int_customer_enriched_individual_id.4f23212833
[0m00:29:22.134737 [debug] [Thread-3 (]: Finished running node test.customer_churn.not_null_fact_churn_churn_date.c88bd69eeb
[0m00:29:22.135507 [info ] [Thread-4 (]: 5 of 10 START test not_null_int_customer_enriched_individual_id ................ [RUN]
[0m00:29:22.136299 [debug] [Thread-3 (]: Began running node test.customer_churn.not_null_stg_address_address_id.a26685b6d5
[0m00:29:22.137128 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.customer_churn.not_null_fact_churn_individual_id.96f069e355, now test.customer_churn.not_null_int_customer_enriched_individual_id.4f23212833)
[0m00:29:22.137761 [info ] [Thread-3 (]: 6 of 10 START test not_null_stg_address_address_id ............................. [RUN]
[0m00:29:22.138329 [debug] [Thread-4 (]: Began compiling node test.customer_churn.not_null_int_customer_enriched_individual_id.4f23212833
[0m00:29:22.139062 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer_churn.not_null_fact_churn_churn_date.c88bd69eeb, now test.customer_churn.not_null_stg_address_address_id.a26685b6d5)
[0m00:29:22.145073 [debug] [Thread-4 (]: Writing injected SQL for node "test.customer_churn.not_null_int_customer_enriched_individual_id.4f23212833"
[0m00:29:22.145777 [debug] [Thread-3 (]: Began compiling node test.customer_churn.not_null_stg_address_address_id.a26685b6d5
[0m00:29:22.153392 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer_churn.not_null_stg_address_address_id.a26685b6d5"
[0m00:29:22.164883 [debug] [Thread-4 (]: Began executing node test.customer_churn.not_null_int_customer_enriched_individual_id.4f23212833
[0m00:29:22.171932 [debug] [Thread-4 (]: Writing runtime sql for node "test.customer_churn.not_null_int_customer_enriched_individual_id.4f23212833"
[0m00:29:22.172519 [debug] [Thread-3 (]: Began executing node test.customer_churn.not_null_stg_address_address_id.a26685b6d5
[0m00:29:22.176723 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer_churn.not_null_stg_address_address_id.a26685b6d5"
[0m00:29:22.183080 [debug] [Thread-4 (]: Using snowflake connection "test.customer_churn.not_null_int_customer_enriched_individual_id.4f23212833"
[0m00:29:22.183909 [debug] [Thread-4 (]: On test.customer_churn.not_null_int_customer_enriched_individual_id.4f23212833: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "test.customer_churn.not_null_int_customer_enriched_individual_id.4f23212833"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select individual_id
from USER_DB_FALCON.RAW_public.int_customer_enriched
where individual_id is null



      
    ) dbt_internal_test
[0m00:29:22.184837 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:29:22.189102 [debug] [Thread-3 (]: Using snowflake connection "test.customer_churn.not_null_stg_address_address_id.a26685b6d5"
[0m00:29:22.190106 [debug] [Thread-3 (]: On test.customer_churn.not_null_stg_address_address_id.a26685b6d5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "test.customer_churn.not_null_stg_address_address_id.a26685b6d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select address_id
from USER_DB_FALCON.RAW_public.stg_address
where address_id is null



      
    ) dbt_internal_test
[0m00:29:22.191329 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:29:22.248486 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.721 seconds
[0m00:29:22.252878 [debug] [Thread-2 (]: On test.customer_churn.not_null_dim_customer_individual_id.80bf9c0ee7: Close
[0m00:29:22.392738 [info ] [Thread-2 (]: 2 of 10 PASS not_null_dim_customer_individual_id ............................... [[32mPASS[0m in 1.01s]
[0m00:29:22.394201 [debug] [Thread-2 (]: Finished running node test.customer_churn.not_null_dim_customer_individual_id.80bf9c0ee7
[0m00:29:22.395329 [debug] [Thread-2 (]: Began running node test.customer_churn.not_null_stg_autoinsurance_churn_individual_id.c3c7b154c3
[0m00:29:22.396435 [info ] [Thread-2 (]: 7 of 10 START test not_null_stg_autoinsurance_churn_individual_id .............. [RUN]
[0m00:29:22.397659 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer_churn.not_null_dim_customer_individual_id.80bf9c0ee7, now test.customer_churn.not_null_stg_autoinsurance_churn_individual_id.c3c7b154c3)
[0m00:29:22.398730 [debug] [Thread-2 (]: Began compiling node test.customer_churn.not_null_stg_autoinsurance_churn_individual_id.c3c7b154c3
[0m00:29:22.407226 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer_churn.not_null_stg_autoinsurance_churn_individual_id.c3c7b154c3"
[0m00:29:22.423894 [debug] [Thread-2 (]: Began executing node test.customer_churn.not_null_stg_autoinsurance_churn_individual_id.c3c7b154c3
[0m00:29:22.428877 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer_churn.not_null_stg_autoinsurance_churn_individual_id.c3c7b154c3"
[0m00:29:22.446914 [debug] [Thread-2 (]: Using snowflake connection "test.customer_churn.not_null_stg_autoinsurance_churn_individual_id.c3c7b154c3"
[0m00:29:22.448325 [debug] [Thread-2 (]: On test.customer_churn.not_null_stg_autoinsurance_churn_individual_id.c3c7b154c3: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "test.customer_churn.not_null_stg_autoinsurance_churn_individual_id.c3c7b154c3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select individual_id
from USER_DB_FALCON.RAW_public.stg_autoinsurance_churn
where individual_id is null



      
    ) dbt_internal_test
[0m00:29:22.449569 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:29:22.467254 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.939 seconds
[0m00:29:22.472300 [debug] [Thread-1 (]: On test.customer_churn.not_null_dim_address_individual_id.efa1478d3c: Close
[0m00:29:22.600414 [info ] [Thread-1 (]: 1 of 10 PASS not_null_dim_address_individual_id ................................ [[32mPASS[0m in 1.23s]
[0m00:29:22.606527 [debug] [Thread-1 (]: Finished running node test.customer_churn.not_null_dim_address_individual_id.efa1478d3c
[0m00:29:22.607657 [debug] [Thread-1 (]: Began running node test.customer_churn.not_null_stg_customer_individual_id.af262c3e65
[0m00:29:22.608827 [info ] [Thread-1 (]: 8 of 10 START test not_null_stg_customer_individual_id ......................... [RUN]
[0m00:29:22.610007 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer_churn.not_null_dim_address_individual_id.efa1478d3c, now test.customer_churn.not_null_stg_customer_individual_id.af262c3e65)
[0m00:29:22.610978 [debug] [Thread-1 (]: Began compiling node test.customer_churn.not_null_stg_customer_individual_id.af262c3e65
[0m00:29:22.620284 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer_churn.not_null_stg_customer_individual_id.af262c3e65"
[0m00:29:22.659652 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.475 seconds
[0m00:29:22.664043 [debug] [Thread-4 (]: On test.customer_churn.not_null_int_customer_enriched_individual_id.4f23212833: Close
[0m00:29:22.760581 [debug] [Thread-1 (]: Began executing node test.customer_churn.not_null_stg_customer_individual_id.af262c3e65
[0m00:29:22.767678 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer_churn.not_null_stg_customer_individual_id.af262c3e65"
[0m00:29:22.871710 [info ] [Thread-4 (]: 5 of 10 PASS not_null_int_customer_enriched_individual_id ...................... [[32mPASS[0m in 0.73s]
[0m00:29:22.872884 [debug] [Thread-4 (]: Finished running node test.customer_churn.not_null_int_customer_enriched_individual_id.4f23212833
[0m00:29:22.874302 [debug] [Thread-4 (]: Began running node test.customer_churn.not_null_stg_demographic_individual_id.68140728ca
[0m00:29:22.875933 [info ] [Thread-4 (]: 9 of 10 START test not_null_stg_demographic_individual_id ...................... [RUN]
[0m00:29:22.884714 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.customer_churn.not_null_int_customer_enriched_individual_id.4f23212833, now test.customer_churn.not_null_stg_demographic_individual_id.68140728ca)
[0m00:29:22.886248 [debug] [Thread-4 (]: Began compiling node test.customer_churn.not_null_stg_demographic_individual_id.68140728ca
[0m00:29:22.894691 [debug] [Thread-1 (]: Using snowflake connection "test.customer_churn.not_null_stg_customer_individual_id.af262c3e65"
[0m00:29:22.897331 [debug] [Thread-4 (]: Writing injected SQL for node "test.customer_churn.not_null_stg_demographic_individual_id.68140728ca"
[0m00:29:22.898610 [debug] [Thread-1 (]: On test.customer_churn.not_null_stg_customer_individual_id.af262c3e65: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "test.customer_churn.not_null_stg_customer_individual_id.af262c3e65"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select individual_id
from USER_DB_FALCON.RAW_public.stg_customer
where individual_id is null



      
    ) dbt_internal_test
[0m00:29:22.914983 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:29:22.928734 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.479 seconds
[0m00:29:22.933597 [debug] [Thread-2 (]: On test.customer_churn.not_null_stg_autoinsurance_churn_individual_id.c3c7b154c3: Close
[0m00:29:22.950323 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.759 seconds
[0m00:29:22.951485 [debug] [Thread-4 (]: Began executing node test.customer_churn.not_null_stg_demographic_individual_id.68140728ca
[0m00:29:22.955354 [debug] [Thread-3 (]: On test.customer_churn.not_null_stg_address_address_id.a26685b6d5: Close
[0m00:29:22.962519 [debug] [Thread-4 (]: Writing runtime sql for node "test.customer_churn.not_null_stg_demographic_individual_id.68140728ca"
[0m00:29:23.007403 [debug] [Thread-4 (]: Using snowflake connection "test.customer_churn.not_null_stg_demographic_individual_id.68140728ca"
[0m00:29:23.008833 [debug] [Thread-4 (]: On test.customer_churn.not_null_stg_demographic_individual_id.68140728ca: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "test.customer_churn.not_null_stg_demographic_individual_id.68140728ca"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select individual_id
from USER_DB_FALCON.RAW_public.stg_demographic
where individual_id is null



      
    ) dbt_internal_test
[0m00:29:23.009995 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:29:23.090065 [info ] [Thread-2 (]: 7 of 10 PASS not_null_stg_autoinsurance_churn_individual_id .................... [[32mPASS[0m in 0.69s]
[0m00:29:23.097814 [debug] [Thread-2 (]: Finished running node test.customer_churn.not_null_stg_autoinsurance_churn_individual_id.c3c7b154c3
[0m00:29:23.101187 [debug] [Thread-2 (]: Began running node test.customer_churn.not_null_stg_termination_individual_id.b6d8d40bdf
[0m00:29:23.102819 [info ] [Thread-2 (]: 10 of 10 START test not_null_stg_termination_individual_id ..................... [RUN]
[0m00:29:23.104876 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer_churn.not_null_stg_autoinsurance_churn_individual_id.c3c7b154c3, now test.customer_churn.not_null_stg_termination_individual_id.b6d8d40bdf)
[0m00:29:23.105575 [debug] [Thread-2 (]: Began compiling node test.customer_churn.not_null_stg_termination_individual_id.b6d8d40bdf
[0m00:29:23.109637 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer_churn.not_null_stg_termination_individual_id.b6d8d40bdf"
[0m00:29:23.129159 [debug] [Thread-2 (]: Began executing node test.customer_churn.not_null_stg_termination_individual_id.b6d8d40bdf
[0m00:29:23.135498 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer_churn.not_null_stg_termination_individual_id.b6d8d40bdf"
[0m00:29:23.151043 [info ] [Thread-3 (]: 6 of 10 PASS not_null_stg_address_address_id ................................... [[32mPASS[0m in 1.01s]
[0m00:29:23.152109 [debug] [Thread-3 (]: Finished running node test.customer_churn.not_null_stg_address_address_id.a26685b6d5
[0m00:29:23.241500 [debug] [Thread-2 (]: Using snowflake connection "test.customer_churn.not_null_stg_termination_individual_id.b6d8d40bdf"
[0m00:29:23.251337 [debug] [Thread-2 (]: On test.customer_churn.not_null_stg_termination_individual_id.b6d8d40bdf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "customer_churn", "target_name": "dev", "node_id": "test.customer_churn.not_null_stg_termination_individual_id.b6d8d40bdf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select individual_id
from USER_DB_FALCON.RAW_public.stg_termination
where individual_id is null



      
    ) dbt_internal_test
[0m00:29:23.252401 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:29:23.416304 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.501 seconds
[0m00:29:23.420450 [debug] [Thread-1 (]: On test.customer_churn.not_null_stg_customer_individual_id.af262c3e65: Close
[0m00:29:23.556063 [info ] [Thread-1 (]: 8 of 10 PASS not_null_stg_customer_individual_id ............................... [[32mPASS[0m in 0.95s]
[0m00:29:23.557795 [debug] [Thread-1 (]: Finished running node test.customer_churn.not_null_stg_customer_individual_id.af262c3e65
[0m00:29:23.810630 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.801 seconds
[0m00:29:23.821370 [debug] [Thread-4 (]: On test.customer_churn.not_null_stg_demographic_individual_id.68140728ca: Close
[0m00:29:23.961605 [info ] [Thread-4 (]: 9 of 10 PASS not_null_stg_demographic_individual_id ............................ [[32mPASS[0m in 1.08s]
[0m00:29:23.963312 [debug] [Thread-4 (]: Finished running node test.customer_churn.not_null_stg_demographic_individual_id.68140728ca
[0m00:29:24.004511 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.752 seconds
[0m00:29:24.006988 [debug] [Thread-2 (]: On test.customer_churn.not_null_stg_termination_individual_id.b6d8d40bdf: Close
[0m00:29:24.528686 [info ] [Thread-2 (]: 10 of 10 PASS not_null_stg_termination_individual_id ........................... [[32mPASS[0m in 1.42s]
[0m00:29:24.529923 [debug] [Thread-2 (]: Finished running node test.customer_churn.not_null_stg_termination_individual_id.b6d8d40bdf
[0m00:29:24.532619 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:29:24.533275 [debug] [MainThread]: Connection 'test.customer_churn.not_null_stg_customer_individual_id.af262c3e65' was properly closed.
[0m00:29:24.534002 [debug] [MainThread]: Connection 'test.customer_churn.not_null_stg_termination_individual_id.b6d8d40bdf' was properly closed.
[0m00:29:24.534522 [debug] [MainThread]: Connection 'test.customer_churn.not_null_stg_address_address_id.a26685b6d5' was properly closed.
[0m00:29:24.535021 [debug] [MainThread]: Connection 'test.customer_churn.not_null_stg_demographic_individual_id.68140728ca' was properly closed.
[0m00:29:24.535575 [info ] [MainThread]: 
[0m00:29:24.536137 [info ] [MainThread]: Finished running 10 data tests in 0 hours 0 minutes and 4.02 seconds (4.02s).
[0m00:29:24.537883 [debug] [MainThread]: Command end result
[0m00:29:24.658469 [info ] [MainThread]: 
[0m00:29:24.659112 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:29:24.659575 [info ] [MainThread]: 
[0m00:29:24.659998 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m00:29:24.660814 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 6.981513, "process_user_time": 5.103661, "process_kernel_time": 2.827132, "process_mem_max_rss": "239076", "process_in_blocks": "1128", "process_out_blocks": "8"}
[0m00:29:24.661472 [debug] [MainThread]: Command `dbt test` succeeded at 00:29:24.661402 after 6.98 seconds
[0m00:29:24.661920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98f0ecb350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98f18cb200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9894625af0>]}
[0m00:29:24.662349 [debug] [MainThread]: Flushing usage events
[0m00:29:28.708460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa66ece9c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa66f351340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa670a7fd10>]}


============================== 00:29:28.714246 | d84324ba-f7ed-4208-b897-5691ae229c9d ==============================
[0m00:29:28.714246 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:29:28.715052 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:29:29.880638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd84324ba-f7ed-4208-b897-5691ae229c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa614f56a50>]}
[0m00:29:29.948913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd84324ba-f7ed-4208-b897-5691ae229c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa614ecbf50>]}
[0m00:29:29.950427 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m00:29:30.068470 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:29:31.363662 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:29:31.364526 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:29:31.409006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd84324ba-f7ed-4208-b897-5691ae229c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa614eca5a0>]}
[0m00:29:31.546427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd84324ba-f7ed-4208-b897-5691ae229c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa614b42030>]}
[0m00:29:31.547605 [info ] [MainThread]: Found 12 models, 10 data tests, 7 sources, 459 macros
[0m00:29:31.548621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd84324ba-f7ed-4208-b897-5691ae229c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa614e18080>]}
[0m00:29:31.551728 [info ] [MainThread]: 
[0m00:29:31.552659 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m00:29:31.555456 [debug] [MainThread]: Command end result
[0m00:29:31.610129 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 2.9815426, "process_user_time": 4.101573, "process_kernel_time": 2.831543, "process_mem_max_rss": "266648", "process_in_blocks": "8", "process_out_blocks": "0"}
[0m00:29:31.610770 [debug] [MainThread]: Command `dbt snapshot` succeeded at 00:29:31.610679 after 2.98 seconds
[0m00:29:31.611304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa66eecac60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa614d9ac00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa614d98bf0>]}
[0m00:29:31.612007 [debug] [MainThread]: Flushing usage events
